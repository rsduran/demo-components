[
  {
    "topic": 1,
    "index": 1,
    "url": "https://www.examtopics.com/discussions/microsoft/view/7464-exam-70-761-topic-1-question-1-discussion/",
    "body": "Note: This question is part of a series of questions that present the same scenario. Each question in the series contains a unique solution that might meet the stated goals. Some question sets might have more than one correct solution, while others might not have a correct solution.<br>After you answer a question in this section. You will NOT be able to return to it. As a result, these questions will not appear in the review screen.<br>You create a table named Products by running the following Transact-SQL statement:<br><img src=\"/assets/media/exam-media/02675/0000200001.png\" class=\"in-exam-image\"><br>You have the following stored procedure:<br><img src=\"/assets/media/exam-media/02675/0000200002.png\" class=\"in-exam-image\"><br>You need to modify the stored procedure to meet the following new requirements:<br>\u2711 Insert product records as a single unit of work.<br>\u2711 Return error number 51000 when a product fails to insert into the database.<br>\u2711 If a product record insert operation fails, the product information must not be permanently written to the database.<br>Solution: You run the following Transact-SQL statement:<br><img src=\"/assets/media/exam-media/02675/0000300001.png\" class=\"in-exam-image\"><br>Does the solution meet the goal?<br>",
    "options": [
      "<span class=\"multi-choice-letter\" data-choice-letter=\"A\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tYes",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"B\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tB.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tNo"
    ],
    "answer": "B",
    "answerDescription": "With X_ABORT ON the INSERT INTO statement and the transaction will be rolled back when an error is raised, it would then not be possible to ROLLBACK it again in the IF XACT_STATE() &lt;&gt; O ROLLBACK TRANSACTION statement.<br>Note: A transaction is correctly defined for the INSERT INTO ..VALUES statement, and if there is an error in the transaction it will be caughtant he transaction will be rolled back, finally an error 51000 will be raised.<br>Note: When SET XACT_ABORT is ON, if a Transact-SQL statement raises a run-time error, the entire transaction is terminated and rolled back.<br>XACT_STATE is a scalar function thatreports the user transaction state of a current running request. XACT_STATE indicates whether the request has an active user transaction, and whether the transaction is capable of being committed.<br>The states of XACT_STATE are:<br>\u2711 0 There is no active user transaction for the current request.<br>\u2711 1 The current request has an active user transaction. The request can perform any actions, including writing data and committing the transaction.<br>\u2711 2 The current request has an active user transaction, but an error hasoccurred that has caused the transaction to be classified as an uncommittable transaction.<br>References:<br>https://msdn.microsoft.com/en-us/library/ms188792.aspx<br>https://msdn.microsoft.com/en-us/library/ms189797.aspx",
    "votes": [],
    "comments": [
      {
        "date": "2020-01-24T00:23:00.000Z",
        "voteCount": 8,
        "content": "B is the right answer because semicolon /terminator is not present after transaction statement"
      },
      {
        "date": "2020-02-26T10:03:00.000Z",
        "voteCount": 5,
        "content": "So, think this is B for another reason:\n\nINSERT INTO Products(... ) has ProductPrice, but the tables defines UnitPrice\n...so that should get Invalid Column name, right?"
      },
      {
        "date": "2022-03-14T10:15:00.000Z",
        "voteCount": 1,
        "content": "Answer is B"
      },
      {
        "date": "2021-01-06T21:22:00.000Z",
        "voteCount": 1,
        "content": "This question is basically a duplicate of question 1"
      },
      {
        "date": "2021-01-06T21:23:00.000Z",
        "voteCount": 1,
        "content": "Sorry, this is a duplicated (but with better text) in question 121"
      },
      {
        "date": "2020-12-31T13:50:00.000Z",
        "voteCount": 1,
        "content": "Answer is A assuming syntax is correct. See example C here - XACT_ABORT ON still passes errors to the CATCH: https://docs.microsoft.com/en-us/sql/t-sql/language-elements/try-catch-transact-sql?view=sql-server-ver15"
      },
      {
        "date": "2020-12-07T15:53:00.000Z",
        "voteCount": 1,
        "content": "There is incorrect XACT_STATE() value for the transaction that cannot be commited  in the solution explanation . it must be  '-1' instead of '2'"
      },
      {
        "date": "2020-11-21T07:42:00.000Z",
        "voteCount": 1,
        "content": "There are 2 errors in the Script with will cause it it fail at compilation. 1. A column is misnamed ProductPrice vs UnitPrice. 2. The line before a THROW must end in a semicolon.\n\nIf both of these are corrected, then A is the correct answer. The effect of XACT_ABORT = ON is that XACT_STATE() will return -1 rather than 1 if there is a problem with the INSERT. You can ROLLBACK from either of these conditions. You cannot ROLLBACK to a savepoint when XACT_STATE() will returns -1, but not using a SavePoint in this case"
      },
      {
        "date": "2020-11-14T23:49:00.000Z",
        "voteCount": 1,
        "content": "I tried to reproduce the scripts with some corrections (consistent column names and semicolon) and I can say that this stored procedure works. Here are the scripts\nCREATE TABLE Products(\nProductId int IDENTITY(1,1) NOT NULL PRIMARY KEY,\nProductName nvarchar(100) NULL,\nUnitPrice decimal (18,2) NOT NULL,\nUnitsInStock int NOT NULL,\nUnitsOnOrder int NOT NULL);\nGO\n\nCREATE PROC InsertProducts\n@productname nvarchar(100),\n@unitprice decimal(18,2),\n@unitsinstock int,\n@unitonoder int\n\nAS \nBEGIN \n     SET XACT_ABORT ON \n   BEGIN TRY\n\t   BEGIN TRAN\n\t   INSERT INTO Products (ProductName, UnitPrice, UnitsInStock, UnitsOnOrder)\n\t   VALUES               (@productname, @unitprice, @unitsinstock, @unitonoder)\n\t   COMMIT TRAN\n    END TRY\n\tBEGIN CATCH\n\tIF XACT_STATE() &lt;&gt;0 ROLLBACK TRAN;\n\tTHROW 51000, 'The product could not be created',1\n\tEND CATCH\n    END;\n\nEXEC InsertProducts 'bike', 160.5, NULL, 2"
      },
      {
        "date": "2020-11-04T04:54:00.000Z",
        "voteCount": 1,
        "content": "Answer is B for sure.\n\n1. There's already a first thing that will fail. The insert statement lists columns that are not in the table DDL. \nYou should use this :\nINSERT INTO PRODUCTS(PRODUCTNAME, unitprice, unitsinstock, unitsonorder)\nVALUES (@PRODUCTNAME, @UNITPRICE, @UNITSINSTOCK, @UNITSONORDER)\n2. You shouldn't put the XACT_STATE() statement right before the THROW\nsince it will make the THROW statement completely useless. XACT_STATE\ncan be either -1 or 1. If the transaction is committable you get 1.\nIf it isn't you get -1. So it will ALWAYS rollback. SS recognizes this\nand does not accept the THROW after this statement.\n\nYou could do this :\nTHROW 51000, 'The product could not be created', 1\nIF XACT_STATE() = -1  ROLLBACK TRANSACTION"
      },
      {
        "date": "2020-09-17T00:49:00.000Z",
        "voteCount": 1,
        "content": "The column names are different in the table and in the procedure. Table column names are UnitePrice, UniteStock etc, but in the procedure mentioned ProductPrice, ProductsInStock."
      },
      {
        "date": "2020-09-12T19:50:00.000Z",
        "voteCount": 2,
        "content": "Look this will work with a ; on the IF XACT_STATE() &lt;&gt; 0 ROLLBACK TRANSACTION; \nBut like most questions on this site I think there are mistakes. On the test I believe they will not be testing you logic on a ; So beware if this question comes up makes sure you look at syntax juts in case. Should be B in this question."
      },
      {
        "date": "2020-08-24T21:19:00.000Z",
        "voteCount": 1,
        "content": "When set xact_abort is on and the transaction raises a runtime error the entire transaction is terminated and rolled back.\n\nHowever in this case the are syntax errors (incorrect column names and no semicolon after rollback transaction) that make the code to not run... Therefore the answer is B."
      },
      {
        "date": "2020-08-16T02:25:00.000Z",
        "voteCount": 1,
        "content": "definitely a NO, wrong column name."
      },
      {
        "date": "2020-11-14T23:02:00.000Z",
        "voteCount": 1,
        "content": "people write these questions relying on their memories. And it might by the matter of wrong representation of what was remembered during the exam test. The size of the question is big and it isn't surprise to represent  the question with mistakes like absent ';' or wrong column name"
      },
      {
        "date": "2020-05-06T03:23:00.000Z",
        "voteCount": 2,
        "content": "As others have pointed out, the column names in the stored procedure are wrong (e.g. ProductPrice rather than UnitPrice) and there is a missing terminator after Rollback Transaction. So, as it stands, it would not work but not for the reason stated?\n\nHowever, as @flashed has shown in their simplified, but syntactically correct, example, it would throw a 51000 error and rollback therefore meeting requirements?\n\nThe inclusion of the SET XACT_ABORT ON statement suggests it is knowledge of this that is being tested rather than identifying the syntax errors. \n\nAnyone have a definitive answer? Is it just a poor question (that has been replicated on dozens of sites a quick google shows)?"
      },
      {
        "date": "2020-05-01T12:08:00.000Z",
        "voteCount": 2,
        "content": "answare is B\n\ntable columns is \n\tproductid, productname, unitprice, unitsinstock,unitsonorder\n\nand insert of procedure is  \n        productname,producprice,productsinstock,productsonorder\n\ncolumns not exists"
      },
      {
        "date": "2020-05-01T11:38:00.000Z",
        "voteCount": 2,
        "content": "answer is B. Before throw no statement terminator ;\n\n\tif XACT_STATE() &lt;&gt; 0 rollback transaction\n\t\t\tthrow 51000, 'the product could not be created.',1\n\n\tif XACT_STATE() &lt;&gt; 0 rollback transaction;\n\t\t\tthrow 51000, 'the product could not be created.',1"
      },
      {
        "date": "2020-03-18T03:09:00.000Z",
        "voteCount": 1,
        "content": "Just tried @indu07 is right. It missed a terminator and failed to compile."
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 2,
    "url": "https://www.examtopics.com/discussions/microsoft/view/11552-exam-70-761-topic-1-question-2-discussion/",
    "body": "Note: This question is part of a series of questions that present the same scenario. Each question in the series contains a unique solution that might meet the stated goals. Some question sets might have more than one correct solution, while others might not have a correct solution.<br>After you answer a question in this section. You will NOT be able to return to it. As a result, these questions will not appear in the review screen.<br>You create a table named Products by running the following Transact-SQL statement:<br><img src=\"/assets/media/exam-media/02675/0000400004.png\" class=\"in-exam-image\"><br>You have the following stored procedure:<br><img src=\"/assets/media/exam-media/02675/0000400005.png\" class=\"in-exam-image\"><br>You need to modify the stored procedure to meet the following new requirements:<br>\u2711 Insert product records as a single unit of work.<br>\u2711 Return error number 51000 when a product fails to insert into the database.<br>\u2711 If a product record insert operation fails, the product information must not be permanently written to the database.<br>Solution: You run the following Transact-SQL statement:<br><img src=\"/assets/media/exam-media/02675/0000500004.png\" class=\"in-exam-image\"><br>Does the solution meet the goal?<br>",
    "options": [
      "<span class=\"multi-choice-letter\" data-choice-letter=\"A\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tYes",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"B\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tB.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tNo"
    ],
    "answer": "B",
    "answerDescription": "A transaction is correctly defined for the INSERT INTO .VALUES statement, and if there is an error in the transaction it will be caught ant he transaction will be rolled back. However, error number 51000 will not be returned, as it is only used in an IF @ERROR = 51000 statement.<br>Note: @@TRANCOUNT returns the number of BEGIN TRANSACTION statements that have occurred on the current connection.<br>References:<br>https://msdn.microsoft.com/en-us/library/ms187967.aspx",
    "votes": [],
    "comments": [
      {
        "date": "2022-03-14T10:13:00.000Z",
        "voteCount": 1,
        "content": "Answer is B"
      },
      {
        "date": "2020-12-31T13:53:00.000Z",
        "voteCount": 1,
        "content": "Agree on answer B since 51000 won't be returned as the value. @@error also used incorrectly"
      },
      {
        "date": "2020-11-23T02:51:00.000Z",
        "voteCount": 1,
        "content": "Anyway, I have created this logic in MSSMS and this procedure will show you as an effect that there was 0 rows affected and error won't be shown\n\ndefinitely B"
      },
      {
        "date": "2020-05-01T12:20:00.000Z",
        "voteCount": 2,
        "content": "answare is B\n\ntable columns is\nproductid, productname, unitprice, unitsinstock,unitsonorder\n\nand insert of procedure is\nproductname,producprice,productsinstock,productsonorder\n\ncolumns not exists\n\nAnd @@error check it immediately following the statement being verified, or save it to a local variable that can be checked later."
      },
      {
        "date": "2020-11-15T00:09:00.000Z",
        "voteCount": 1,
        "content": "I think you should not pay attention to this. It  isn't the point  of the test question , just a mistake of the website copywriter"
      },
      {
        "date": "2020-11-15T00:10:00.000Z",
        "voteCount": 1,
        "content": "I meant the column names"
      },
      {
        "date": "2020-01-08T18:34:00.000Z",
        "voteCount": 3,
        "content": "btw: @@error only makes sense when you capture/save it to variable IMMEDIATELY after statement that might raise error. it will be reset even in IF statement, so in this case ERROR_NUMBER function is the best choice if you really want to check some error in catch block. \n\nhttps://docs.microsoft.com/en-us/sql/t-sql/functions/error-transact-sql?view=sql-server-ver15"
      },
      {
        "date": "2020-01-06T15:20:00.000Z",
        "voteCount": 1,
        "content": "It doesn't meet the requirement as explanation of answer, below 2 links could be used to reference:\nhttps://docs.microsoft.com/en-us/sql/t-sql/language-elements/try-catch-transact-sql?view=sql-server-ver15#uncommittable-transactions-and-xact_state\n\nhttps://docs.microsoft.com/en-us/sql/t-sql/functions/trancount-transact-sql?redirectedfrom=MSDN&amp;view=sql-server-ver15\n\nhttps://docs.microsoft.com/en-us/sql/t-sql/functions/error-transact-sql?view=sql-server-ver15"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 3,
    "url": "https://www.examtopics.com/discussions/microsoft/view/11843-exam-70-761-topic-1-question-3-discussion/",
    "body": "Note: This question is part of a series of questions that present the same scenario. Each question in the series contains a unique solution that might meet the stated goals. Some question sets might have more than one correct solution, while others might not have a correct solution.<br>After you answer a question in this section. You will NOT be able to return to it. As a result, these questions will not appear in the review screen.<br>You create a table named Products by running the following Transact-SQL statement:<br><img src=\"/assets/media/exam-media/02675/0000600001.png\" class=\"in-exam-image\"><br>You have the following stored procedure:<br><img src=\"/assets/media/exam-media/02675/0000600002.png\" class=\"in-exam-image\"><br>You need to modify the stored procedure to meet the following new requirements:<br>\u2711 Insert product records as a single unit of work.<br>\u2711 Return error number 51000 when a product fails to insert into the database.<br>If a product record insert operation fails, the product information must not be permanently written to the database.<br><img src=\"/assets/media/exam-media/02675/0000600005.png\" class=\"in-exam-image\"><br>Solution: You run the following Transact-SQL statement:<br><img src=\"/assets/media/exam-media/02675/0000700001.png\" class=\"in-exam-image\"><br>Does the solution meet the goal?<br>",
    "options": [
      "<span class=\"multi-choice-letter\" data-choice-letter=\"A\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tYes",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"B\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tB.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tNo"
    ],
    "answer": "A",
    "answerDescription": "If the INSERT INTO statement raises an error, the statement will be caught and an error 51000 will be thrown. In this case no records will have been inserted.<br>Note:<br>You can implement error handling for the INSERT statement by specifying the statement in a TRY\"\u00a6CATCH construct.<br>If an INSERT statement violates a constraint or rule, or if it has a value incompatible with the data type of the column, the statement fails and an error message is returned.<br>References:<br>https://msdn.microsoft.com/en-us/library/ms174335.aspx",
    "votes": [],
    "comments": [
      {
        "date": "2020-02-05T03:37:00.000Z",
        "voteCount": 10,
        "content": "A single insert statement acts as a transaction. There would be B if there were 2 or more inserts."
      },
      {
        "date": "2020-02-26T10:24:00.000Z",
        "voteCount": 4,
        "content": "so, then the answer is A\n* single unit of work...b/c single INSERT statement (regardless of how many rows passed in)\n* error message kicks out\n* bad data not written (even though Rollback isn't done)"
      },
      {
        "date": "2020-06-23T16:52:00.000Z",
        "voteCount": 3,
        "content": "Assuming the typos in the code snippet is an accident, then A is correct. This is because the default transaction handling for SQL Server is autocommit."
      },
      {
        "date": "2020-07-22T01:30:00.000Z",
        "voteCount": 6,
        "content": "It works, so answer should be A. Tested.\n\nCREATE TABLE #Products(\n[ProudctName] [nvarchar](100),\n[ProductID] [nvarchar](2)\n) ON [PRIMARY]\nGO\n\n\nBEGIN\n\tBEGIN TRY\n\t\t\tINSERT INTO #Products ([ProudctName],[ProductID])\n\t\t\tVALUES ('123', '123')\n\tEND TRY\n\tBEGIN CATCH\n\t\tTHROW 51000, 'The product could not be created.', 1\n\t\tEND CATCH\nEND"
      },
      {
        "date": "2022-03-14T10:16:00.000Z",
        "voteCount": 1,
        "content": "A is Correct"
      },
      {
        "date": "2020-12-31T14:01:00.000Z",
        "voteCount": 1,
        "content": "A is correct. The INSERT statement is a single DML statement. With implicit transaction by default, that would fail and fall through to the CATCH block which handles the error correctly. Don't a transaction and BEGIN/END/COMMIT TRAN with a single DML statement with implicit transaction"
      },
      {
        "date": "2020-12-16T15:38:00.000Z",
        "voteCount": 2,
        "content": "If the Insert is not in an explicit transaction, SQL Server automatically performs the operation in an implicit transaction to guarantee atomic behaviour.  So for single-statement data modifications, an explicit transaction is not required for all-or-none behaviour.  The INSERT will automatically commit or, in the event of an error, rollback.\n\nAnswer is A"
      },
      {
        "date": "2020-11-23T03:19:00.000Z",
        "voteCount": 2,
        "content": "It works but it's not one unit of work, so it's not correct. - B\nTo make it happen we need begin tran/transaction.\n\nFYI, TRAN and TRANSACTION it's the same, for those who thinks it's mispelled. ;)"
      },
      {
        "date": "2020-11-15T00:05:00.000Z",
        "voteCount": 1,
        "content": "Procedure works in general\nCREATE TABLE Products(\nProductId int IDENTITY(1,1) NOT NULL PRIMARY KEY,\nProductName nvarchar(100) NULL,\nUnitPrice decimal (18,2) NOT NULL,\nUnitsInStock int NOT NULL,\nUnitsOnOrder int NOT NULL);\nGO\nCREATE PROC InsertProducts1\n@productname nvarchar(100),\n@unitprice decimal(18,2),\n@unitsinstock int,\n@unitonoder int\n\nAS \nBEGIN \n     BEGIN TRY\n\t   INSERT INTO Products (ProductName, UnitPrice, UnitsInStock, UnitsOnOrder)\n\t   VALUES               (@productname, @unitprice, @unitsinstock, @unitonoder)\n    END TRY\n\tBEGIN CATCH\n\tTHROW 51000, 'The product could not be created',1\n\tEND CATCH\n    END;\n\nEXEC InsertProducts1'bike', 160.5, NULL, 2\n\nBut it's not created as a single units of works. So, in my opinion correct answer is B."
      },
      {
        "date": "2020-11-14T23:08:00.000Z",
        "voteCount": 1,
        "content": "The answer must use  TRANSACTION . The correct answer is B."
      },
      {
        "date": "2020-09-12T19:59:00.000Z",
        "voteCount": 1,
        "content": "Works 100 % A is the answer."
      },
      {
        "date": "2020-07-11T03:17:00.000Z",
        "voteCount": 1,
        "content": "in general, i find that typos on this site are not on the actual exams. the exam might have joins on the wrong columns, but that is intentional to test you."
      },
      {
        "date": "2020-05-01T12:31:00.000Z",
        "voteCount": 4,
        "content": "answare is B\n\ntable columns is\nproductid, productname, unitprice, unitsinstock,unitsonorder\n\nand insert of procedure is\nproductname,producprice,productsinstock,productsonorder\n\ncolumns not exists\n\nit will not rollback"
      },
      {
        "date": "2020-03-07T13:17:00.000Z",
        "voteCount": 3,
        "content": "So looks like answer is a, but how about incorrect columns names in query(UnitPrices, im mean)? maybe it just mistake, but how about REAL exam question with this case?"
      },
      {
        "date": "2020-01-21T04:52:00.000Z",
        "voteCount": 2,
        "content": "the answer is B because it will not rollback"
      },
      {
        "date": "2020-02-09T10:53:00.000Z",
        "voteCount": 4,
        "content": "it's not it, it will rollback. It's because MsMartaa and anonimdom said, single insert statement."
      },
      {
        "date": "2020-03-10T08:17:00.000Z",
        "voteCount": 1,
        "content": "would this transaction be \"doomed\"? b/c there is no rollback? so it would actually do the rollback after the transaction times out?"
      },
      {
        "date": "2020-01-12T11:40:00.000Z",
        "voteCount": 4,
        "content": "I think that right answer is B, because solution doesn't follow requirement of inserting as a single unit of work (begin/commit transaction)"
      },
      {
        "date": "2020-05-21T03:49:00.000Z",
        "voteCount": 1,
        "content": "And column table doesn't match with the one in the insert statement"
      },
      {
        "date": "2020-10-04T21:27:00.000Z",
        "voteCount": 1,
        "content": "TRY/CATCH is a single unit of work. Should be A, unless the table columns purposely don't match then it's B."
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 4,
    "url": "https://www.examtopics.com/discussions/microsoft/view/19425-exam-70-761-topic-1-question-4-discussion/",
    "body": "Note: This question is part of a series of questions that present the same scenario. Each question in the series contains a unique solution that might meet the stated goals. Some question sets might have more than one correct solution, while others might not have a correct solution.<br>After you answer a question in this section. You will NOT be able to return to it. As a result, these questions will not appear in the review screen.<br>You create a table named Customer by running the following Transact-SQL statement:<br><img src=\"/assets/media/exam-media/02675/0000800001.png\" class=\"in-exam-image\"><br>You must insert the following data into the Customer table:<br><img src=\"/assets/media/exam-media/02675/0000800002.png\" class=\"in-exam-image\"><br>You need to ensure that both records are inserted or neither record is inserted.<br>Solution: You run the following Transact-SQL statement:<br><img src=\"/assets/media/exam-media/02675/0000800003.png\" class=\"in-exam-image\"><br>Does the solution meet the goal?<br>",
    "options": [
      "<span class=\"multi-choice-letter\" data-choice-letter=\"A\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tYes",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"B\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tB.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tNo"
    ],
    "answer": "B",
    "answerDescription": "As there are two separate INSERT INTO statements we cannot ensure that both or neither records are inserted.",
    "votes": [],
    "comments": [
      {
        "date": "2022-03-14T10:17:00.000Z",
        "voteCount": 1,
        "content": "B is correct"
      },
      {
        "date": "2020-12-31T14:06:00.000Z",
        "voteCount": 1,
        "content": "B is correct - accepting/rejecting both requires a BEGIN/END/COMMIT TRAN construct that doesn't exist. Wihtout it, each INSERT fails independently and error isn't severe enough to abort the connection"
      },
      {
        "date": "2020-11-04T10:45:00.000Z",
        "voteCount": 1,
        "content": "I think the statement they want to make that if a fatal error happens such as a server crash, right before the crash the one record could have been inserted whereas the other one hasn't.\nIf you want all or nothing the use SET XACT_ABORT ON I would say.\nBut this is a rather far fetched answer."
      },
      {
        "date": "2020-11-21T08:42:00.000Z",
        "voteCount": 1,
        "content": "Both or neither would require the use a Transaction. As there is no Transaction, it can't work. SET XACT_ABORT by itself would not achieve anything."
      },
      {
        "date": "2020-09-12T20:14:00.000Z",
        "voteCount": 1,
        "content": "Querying Data with Transact-SQL Book has an example like this and this would be B because if there is an error in the second insert it but the first one is fine, it will insert the first one."
      },
      {
        "date": "2020-08-22T07:05:00.000Z",
        "voteCount": 1,
        "content": "The example works fine, but if you try to insert a number that violate the check constraint in one of the statements the insert fails only for that statement. \nThe correct answer is NO."
      },
      {
        "date": "2020-06-01T09:25:00.000Z",
        "voteCount": 1,
        "content": "I think the answer is A because GO designates a batch... if there is any kind of error, the whole batch will not execute"
      },
      {
        "date": "2020-11-14T23:17:00.000Z",
        "voteCount": 1,
        "content": "Sorry, You aren't correct. There should be either TRANSACTION or one INSERT statement for with to rows."
      },
      {
        "date": "2020-05-23T07:31:00.000Z",
        "voteCount": 2,
        "content": "Sorry, answer is B, As there are two separate INSERT INTO statements we cannot ensure that both or neither records are inserted."
      },
      {
        "date": "2020-05-23T07:31:00.000Z",
        "voteCount": 3,
        "content": "Sorry, As there are two separate INSERT INTO statements we cannot ensure that both or neither records are inserted."
      },
      {
        "date": "2020-05-01T13:00:00.000Z",
        "voteCount": 1,
        "content": "ANSWARE IS A\nBECAUSE TOWNID IS CREATED AS NULL"
      },
      {
        "date": "2020-05-06T04:04:00.000Z",
        "voteCount": 3,
        "content": "Correct Answer is B as shown. This needs to be 'all or nothing', but writing 2 separate inserts does not meet this requirement. If the first insert works it is committed even if the second fails."
      },
      {
        "date": "2020-07-31T05:45:00.000Z",
        "voteCount": 1,
        "content": "correct but if u execute  2 statements at a time with wrong data \n\ninsert into testTop (id, name) values (2,a1)\ninsert into testTop (id, name) values (2,'b1')\ngo\nlike this it is working scenario Answer is A"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 5,
    "url": "https://www.examtopics.com/discussions/microsoft/view/19426-exam-70-761-topic-1-question-5-discussion/",
    "body": "Note: This question is part of a series of questions that present the same scenario. Each question in the series contains a unique solution that might meet the stated goals. Some question sets might have more than one correct solution, while others might not have a correct solution.<br>After you answer a question in this section. You will NOT be able to return to it. As a result, these questions will not appear in the review screen.<br>You create a table named Customer by running the following Transact-SQL statement:<br><img src=\"/assets/media/exam-media/02675/0000900001.png\" class=\"in-exam-image\"><br>You must insert the following data into the Customer table:<br><img src=\"/assets/media/exam-media/02675/0001000001.png\" class=\"in-exam-image\"><br>You need to ensure that both records are inserted or neither record is inserted.<br>Solution: You run the following Transact-SQL statement:<br><img src=\"/assets/media/exam-media/02675/0001000002.png\" class=\"in-exam-image\"><br>Does the solution meet the goal?<br>",
    "options": [
      "<span class=\"multi-choice-letter\" data-choice-letter=\"A\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tYes",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"B\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tB.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tNo"
    ],
    "answer": "B",
    "answerDescription": "As there are two separate INSERT INTO statements we cannot ensure that both or neither records are inserted.",
    "votes": [],
    "comments": [
      {
        "date": "2022-03-14T10:17:00.000Z",
        "voteCount": 1,
        "content": "The answer is B, Because of References on Town ID"
      },
      {
        "date": "2020-11-04T10:53:00.000Z",
        "voteCount": 1,
        "content": "Same reason as previous question I would say. you explicitely need to set XACT_ABORT to ON to make sure either ALL or NONE of the records are inserted. Not my favourite kind of question though. Kind of a trap."
      },
      {
        "date": "2020-11-01T12:51:00.000Z",
        "voteCount": 1,
        "content": "The answer is B, Because of References on TownID column"
      },
      {
        "date": "2020-09-14T16:07:00.000Z",
        "voteCount": 1,
        "content": "Even if you put it in a Begin and END statement it still will be answer B. Think some people get confused with that"
      },
      {
        "date": "2020-09-12T20:14:00.000Z",
        "voteCount": 1,
        "content": "B same as the previous question look at the book: Querying Data with Transact-SQL"
      },
      {
        "date": "2020-05-23T07:30:00.000Z",
        "voteCount": 2,
        "content": "Sorry Answer B As there are two separate INSERT INTO statements we cannot ensure that both or neither records are inserted."
      },
      {
        "date": "2020-05-01T13:00:00.000Z",
        "voteCount": 1,
        "content": "ANSWARE IS A\nBECAUSE TOWNID IS CREATED AS NULL"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 6,
    "url": "https://www.examtopics.com/discussions/microsoft/view/11844-exam-70-761-topic-1-question-6-discussion/",
    "body": "Note: This question is part of a series of questions that present the same scenario. Each question in the series contains a unique solution that might meet the stated goals. Some question sets might have more than one correct solution, while others might not have a correct solution.<br>After you answer a question in this section. You will NOT be able to return to it. As a result, these questions will not appear in the review screen.<br>You create a table named Customer by running the following Transact-SQL statement:<br><img src=\"/assets/media/exam-media/02675/0001100001.png\" class=\"in-exam-image\"><br>You must insert the following data into the Customer table:<br><img src=\"/assets/media/exam-media/02675/0001100002.png\" class=\"in-exam-image\"><br>You need to ensure that both records are inserted or neither record is inserted.<br>Solution: You run the following Transact-SQL statement:<br><img src=\"/assets/media/exam-media/02675/0001100003.png\" class=\"in-exam-image\"><br>Does the solution meet the goal?<br>",
    "options": [
      "<span class=\"multi-choice-letter\" data-choice-letter=\"A\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tYes",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"B\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tB.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tNo"
    ],
    "answer": "A",
    "answerDescription": "With the INSERT INTO..VALUES statement we can insert both values with just one statement. This ensures that both records or neither is inserted.<br>References:<br>https://msdn.microsoft.com/en-us/library/ms174335.aspx",
    "votes": [],
    "comments": [
      {
        "date": "2022-03-14T10:20:00.000Z",
        "voteCount": 1,
        "content": "rows are either inserted or not, answer is A"
      },
      {
        "date": "2021-01-07T12:37:00.000Z",
        "voteCount": 1,
        "content": "the answer is A"
      },
      {
        "date": "2020-09-13T09:21:00.000Z",
        "voteCount": 3,
        "content": "A yes the rows are either inserted or not."
      },
      {
        "date": "2020-07-11T03:21:00.000Z",
        "voteCount": 1,
        "content": "in general, i find that typos on this site are not on the actual exams. the exam might have joins on the wrong columns, but that is intentional to test you. i've repeated this comment so people will see it. this site is great because of these discussions."
      },
      {
        "date": "2020-05-01T13:09:00.000Z",
        "voteCount": 1,
        "content": "totally agree answer \n\nIf the double quote (\") in front of Jossef is a typo while it should be a single quote ('), then it should be A. Otherwise, it should be \"B\".\n\nduring the exam you should mark B for the double quote"
      },
      {
        "date": "2020-03-18T03:23:00.000Z",
        "voteCount": 3,
        "content": "If the double quote (\") in front of Jossef is a typo while it should be a single quote ('), then it should be A. Otherwise, it should be \"B\"."
      },
      {
        "date": "2020-10-04T21:47:00.000Z",
        "voteCount": 1,
        "content": "it doesn't ask if that statement WILL insert or give an error, it asks if both or none, and the answer is Yes, regardless if it is typo or intentional, BOTH records will not get inserted."
      },
      {
        "date": "2020-02-10T10:51:00.000Z",
        "voteCount": 3,
        "content": "Solution meets needs, Ansewer is A. Yes"
      },
      {
        "date": "2020-01-12T11:50:00.000Z",
        "voteCount": 2,
        "content": "In above solution are not inserting all needed data, so right answer is B"
      },
      {
        "date": "2020-02-02T07:52:00.000Z",
        "voteCount": 13,
        "content": "\"both records are inserted or neither record is inserted\" - solution meets expectations."
      },
      {
        "date": "2020-11-23T03:41:00.000Z",
        "voteCount": 1,
        "content": "Lukis92 is absolutely right. Typos can be made here by the authors.\nIt does meet expectations even if it doesn't have any sophisticated command to rollback or something ;)"
      },
      {
        "date": "2020-03-04T06:14:00.000Z",
        "voteCount": 4,
        "content": "TownID allows for nulls and create date will default to the current date if no record is inserted into those columns. They do not need to be specified in the insert statement."
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 7,
    "url": "https://www.examtopics.com/discussions/microsoft/view/7465-exam-70-761-topic-1-question-7-discussion/",
    "body": "Note: This question is part of a series of questions that present the same scenario. Each question in the series contains a unique solution that might meet the stated goals. Some question sets might have more than one correct solution, while others might not have a correct solution.<br>After you answer a question in this section. You will NOT be able to return to it. As a result, these questions will not appear in the review screen.<br>You have a database that tracks orders and deliveries for customers in North America. The database contains the following tables:<br><br>Sales.Customers -<br><img src=\"/assets/media/exam-media/02675/0001200001.png\" class=\"in-exam-image\"><br><br>Application.Cities -<br><img src=\"/assets/media/exam-media/02675/0001300001.png\" class=\"in-exam-image\"><br><br>Sales.CustomerCategories -<br><img src=\"/assets/media/exam-media/02675/0001300002.png\" class=\"in-exam-image\"><br>The company's development team is designing a customer directory application. The application must list customers by the area code of their phone number. The area code is defined as the first three characters of the phone number.<br>The main page of the application will be based on an indexed view that contains the area and phone number for all customers.<br>You need to return the area code from the PhoneNumber field.<br>Solution: You run the following Transact-SQL statement:<br><img src=\"/assets/media/exam-media/02675/0001300003.png\" class=\"in-exam-image\"><br>Does the solution meet the goal?<br>",
    "options": [
      "<span class=\"multi-choice-letter\" data-choice-letter=\"A\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tYes",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"B\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tB.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tNo"
    ],
    "answer": "B",
    "answerDescription": "The function should return nvarchar(10) and not a TABLE.<br>References:<br>https://sqlstudies.com/2014/08/06/schemabinding-what-why/",
    "votes": [],
    "comments": [
      {
        "date": "2019-10-29T22:47:00.000Z",
        "voteCount": 6,
        "content": "even if the function is defined to return nvarchar, the select top 1 col1, col2 still returns 2 columns and 1 row"
      },
      {
        "date": "2020-10-05T11:15:00.000Z",
        "voteCount": 2,
        "content": "why do we need a new function to display an area code in the view, should just add  left(PhoneNumber,3) as AreaCode   in that indexed view"
      },
      {
        "date": "2020-03-07T13:28:00.000Z",
        "voteCount": 6,
        "content": "I think answer s A because there are no requirements for only one value."
      },
      {
        "date": "2020-09-06T06:06:00.000Z",
        "voteCount": 1,
        "content": "i agree. the requirement states \"need to return the area code\" not \"only the area code\". The area code will be included in the return table."
      },
      {
        "date": "2022-03-14T10:21:00.000Z",
        "voteCount": 1,
        "content": "I think answer s A"
      },
      {
        "date": "2021-01-25T00:16:00.000Z",
        "voteCount": 1,
        "content": "Vermonster is right. The answer to this question is A. Tested it. Additional info :\nCREATE FUNCTION AreaCode(@phoneNumber NVARCHAR(20))\nRETURNS\nTABLE\nWITH SCHEMABINDING\nAS\nRETURN\n(SELECT TOP 1 @phoneNumber as PhoneNumber, VALUE as AreaCode\nFROM string_split(@phoneNumber,'-')\n)\nGO\n\ndrop table customer\ncreate table customer \n( id INT primary key identity,\nphonenumber nvarchar(20)\n)\n\ninsert into customer\nvalues('123-256955'), ('511-956266')\n\ndrop view dbo.PhoneWithAreaCode\nCREATE VIEW dbo.PhoneWithAreaCode\nwith schemabinding\nAS\nSELECT    AreaCode\nFROM dbo.Customer\nCROSS APPLY dbo.AreaCode(PhoneNumber) as AreaCode\nGO"
      },
      {
        "date": "2020-12-31T14:44:00.000Z",
        "voteCount": 1,
        "content": "The in-line Table-Valued Function works. This doesn't show how the function is being used but it does return a single row, 2 column table. This was tested to make sure:\nCREATE FUNCTION AreaCode(@phoneNumber NVARCHAR(20))\nRETURNS\nTABLE\nWITH SCHEMABINDING\nAS\nRETURN\n(SELECT TOP 1 @phoneNumber as PhoneNumber, VALUE as AreaCode\nFROM string_split(@phoneNumber,'-')\n)\nGO\n\nSELECT AreaCode FROM dbo.AreaCode(N'888-888-0000')\n\nReturns 888"
      },
      {
        "date": "2020-12-31T15:15:00.000Z",
        "voteCount": 1,
        "content": "And here is a view that uses it that meets the original question:\nCREATE VIEW dbo.PhoneWithAreaCode\nAS\nSELECT FirstName, LastName, PhoneNumber, AreaCode\nFROM dbo.Customer\nCROSS APPLY dbo.AreaCode(PhoneNumber) as AreaCode\nGO"
      },
      {
        "date": "2020-12-21T07:58:00.000Z",
        "voteCount": 1,
        "content": "we have to think of nested table valued functions and figure out how to insert the table returned by split_string into the table that functions AreaCode is supposed to return."
      },
      {
        "date": "2020-12-21T07:55:00.000Z",
        "voteCount": 1,
        "content": "ANSWER IS B. Remember split_string function is a table valued function and so it returns a \ntable."
      },
      {
        "date": "2020-12-16T06:11:00.000Z",
        "voteCount": 1,
        "content": "The query should be : CREATE Function areacode (@PhoneNumber NVARCHAR(20)) RETURNS NVARCHAR(10)  AS BEGIN DECLARE @areacode NVARCHAR(MAX) SELECT TOP 1 @areacode = VALUE FROM STRING_SPLIT(@phonenumer, '-') RETURN@areacode END"
      },
      {
        "date": "2020-09-26T04:11:00.000Z",
        "voteCount": 3,
        "content": "Answer is B because string_split() function doesn't guarantee ordering of values returned"
      },
      {
        "date": "2020-09-13T09:42:00.000Z",
        "voteCount": 2,
        "content": "In this case the answer is B you should not return a table because it will return more than just the zip code and the questions wants you to return just the zip code."
      },
      {
        "date": "2020-07-29T06:44:00.000Z",
        "voteCount": 2,
        "content": "B, because you can not to return table in view, only scalar value."
      },
      {
        "date": "2020-09-06T06:13:00.000Z",
        "voteCount": 1,
        "content": "CREATE FUNCTION dbo.SAMPLE_FUNC1()\nRETURNS TABLE\nAS\n        RETURN\n        (\n        SELECT 1 AS ID, 'FNAME' AS FNAME, 'LNAME' AS LNAME, 30 AS AGE\n        )\nGO\nCREATE VIEW SAMPLE_VIEW\nAS\nSELECT  *\nFROM    SAMPLE_FUNC1() AS MYPROFILE\nGO\nSELECT * FROM SAMPLE_VIEW"
      },
      {
        "date": "2020-09-06T06:14:00.000Z",
        "voteCount": 2,
        "content": "we can use table function inside view"
      },
      {
        "date": "2020-07-06T15:56:00.000Z",
        "voteCount": 1,
        "content": "It says you need to return the area code. The table will return the area code and the next 3 digits then the last 4 in 3 different columns so the answer is no this soultion is not correct."
      },
      {
        "date": "2020-05-07T02:20:00.000Z",
        "voteCount": 2,
        "content": "I think it is OK. answer is Yes"
      },
      {
        "date": "2020-02-03T23:24:00.000Z",
        "voteCount": 2,
        "content": "'does not allow new values' what does it means and how can we accomplish it"
      },
      {
        "date": "2020-03-17T03:21:00.000Z",
        "voteCount": 1,
        "content": "I think, it means that the values should be UNIQUE."
      },
      {
        "date": "2020-03-17T03:31:00.000Z",
        "voteCount": 1,
        "content": "sorry,  I'm mistaken! it can not mean it"
      },
      {
        "date": "2020-01-08T19:46:00.000Z",
        "voteCount": 3,
        "content": "agreed with Avramov, 2 parts need to be fixed, first function return type should be varchar, second that sql should return only value column."
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 8,
    "url": "https://www.examtopics.com/discussions/microsoft/view/13435-exam-70-761-topic-1-question-8-discussion/",
    "body": "Note: This question is part of a series of questions that present the same scenario. Each question in the series contains a unique solution that might meet the stated goals. Some question sets might have more than one correct solution, while others might not have a correct solution.<br>After you answer a question in this section. You will NOT be able to return to it. As a result, these questions will not appear in the review screen.<br>You have a database that tracks orders and deliveries for customers in North America. The database contains the following tables:<br><br>Sales.Customers -<br><img src=\"/assets/media/exam-media/02675/0001400001.png\" class=\"in-exam-image\"><br><br>Application.Cities -<br><img src=\"/assets/media/exam-media/02675/0001500001.png\" class=\"in-exam-image\"><br><br>Sales.CustomerCategories -<br><img src=\"/assets/media/exam-media/02675/0001500002.png\" class=\"in-exam-image\"><br>The company's development team is designing a customer directory application. The application must list customers by the area code of their phone number. The area code is defined as the first three characters of the phone number.<br>The main page of the application will be based on an indexed view that contains the area and phone number for all customers.<br>You need to return the area code from the PhoneNumber field.<br>Solution: You run the following Transact-SQL statement:<br><img src=\"/assets/media/exam-media/02675/0001500003.png\" class=\"in-exam-image\"><br>Does the solution meet the goal?<br>",
    "options": [
      "<span class=\"multi-choice-letter\" data-choice-letter=\"A\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tYes",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"B\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tB.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tNo"
    ],
    "answer": "B",
    "answerDescription": "As the result of the function will be used in an indexed view we should use schemabinding.<br>References:<br>https://sqlstudies.com/2014/08/06/schemabinding-what-why/",
    "votes": [],
    "comments": [
      {
        "date": "2020-05-01T13:41:00.000Z",
        "voteCount": 6,
        "content": "ANSWER B. \n\nAs the result of the function will be used in an indexed view we should use schemabinding."
      },
      {
        "date": "2020-03-23T02:09:00.000Z",
        "voteCount": 5,
        "content": "correct answer is A."
      },
      {
        "date": "2022-03-14T10:22:00.000Z",
        "voteCount": 1,
        "content": "answer is B"
      },
      {
        "date": "2021-01-25T00:29:00.000Z",
        "voteCount": 1,
        "content": "Oredie is right. If you add schemabinding to the function it works :\n\nCREATE FUNCTION dbo.AreaCode (@phoneNumber NVARCHAR(20))\nRETURNS NVARCHAR(10)\nwith schemabinding\nAS\nBEGIN\nDECLARE @areaCode NVARCHAR(max)\n\nBear in mind that you to refer to schema in the function. Otherwise it still won't work."
      },
      {
        "date": "2020-12-31T15:30:00.000Z",
        "voteCount": 1,
        "content": "Absolutely B as described because function must be schema-bound to work in a view. If it were schema-bound, it would work"
      },
      {
        "date": "2020-12-16T07:19:00.000Z",
        "voteCount": 1,
        "content": "ANSWER SHOULD BE A Yes. However, it seems that \"WITH SCHEMABINDING\" has been omitted as a typo (?) after RETUNRS nvarchar(10). However, if there is no omission, it should be B (No) ."
      },
      {
        "date": "2020-12-16T06:27:00.000Z",
        "voteCount": 1,
        "content": "correct Answer is A."
      },
      {
        "date": "2020-12-02T15:35:00.000Z",
        "voteCount": 1,
        "content": "Answer is correct, B.\nUser-defined functions referenced in the view must be created by using the WITH SCHEMABINDING option.\nAny user-defined functions referenced in the view must be referenced by two-part names, &lt;schema&gt;.&lt;function&gt;...\nhttps://docs.microsoft.com/en-us/sql/relational-databases/views/create-indexed-views?view=sql-server-ver15"
      },
      {
        "date": "2020-11-17T00:39:00.000Z",
        "voteCount": 1,
        "content": "I don\u00b4t understand why do you need a SCHEMABINDING if you are not using any table or view. Do you use directly a parameter."
      },
      {
        "date": "2020-08-19T14:03:00.000Z",
        "voteCount": 4,
        "content": "Correct answer is B. An Indexed view must be schemabound, the function used in the view must therefore also be schemabound.\nTested:\nDROP VIEW IF EXISTS dbo.AreaPhoneNumbers;\nDROP FUNCTION IF EXISTS dbo.areaCode\nDROP TABLE IF EXISTS sales.PhoneNumbers;\nGO\n\nCREATE TABLE sales.PhoneNumbers (\n\tId INT identity NOT NULL\n\t,PhoneNumber NVARCHAR(20) NOT NULL\n\t);\n\nINSERT INTO sales.PhoneNumbers (PhoneNumber)\nVALUES ('123-4567-89')\n\t,('234-5678-90');\nGO\n\nCREATE FUNCTION AreaCode (@phoneNumber NVARCHAR(20))\nRETURNS NVARCHAR(10)\nAS\nBEGIN\n\tDECLARE @areaCode NVARCHAR(max)\n\n\tSELECT TOP 1 @areaCode = value\n\tFROM string_split(@phoneNumber, '-')\n\n\tRETURN @areaCode\nEND;\nGO\n\nCREATE VIEW AreaPhoneNumbers\n\tWITH schemabinding\nAS\nSELECT dbo.AreaCode(PhoneNumbers.PhoneNumber) AreaCode\n\t,PhoneNumbers.PhoneNumber\nFROM sales.PhoneNumbers;\n\nResult:\n(2 rows affected)\nMsg 4513, Level 16, State 2, Procedure AreaPhoneNumbers, Line 5 [Batch Start Line 27]\nCannot schema bind view 'AreaPhoneNumbers'. 'dbo.AreaCode' is not schema bound."
      },
      {
        "date": "2020-10-05T12:06:00.000Z",
        "voteCount": 1,
        "content": "Yes Oredie, you are right! It says in Microsoft documents on the Create Indexed Views page - User-defined functions referenced in the view must be created by using the WITH SCHEMABINDING option.\n\nhttps://docs.microsoft.com/en-us/sql/relational-databases/views/create-indexed-views?view=sql-server-ver15"
      },
      {
        "date": "2020-10-17T17:20:00.000Z",
        "voteCount": 1,
        "content": "The function is schemabound  did you not read the code?"
      },
      {
        "date": "2020-05-23T07:47:00.000Z",
        "voteCount": 3,
        "content": "Answer: B\nAs the result of the function will be used in an indexed view we should use schemabinding."
      },
      {
        "date": "2020-05-13T05:37:00.000Z",
        "voteCount": 1,
        "content": "I don't see VIEW, there is FUNCTION."
      },
      {
        "date": "2020-05-08T04:03:00.000Z",
        "voteCount": 2,
        "content": "correct is B"
      },
      {
        "date": "2020-05-07T02:33:00.000Z",
        "voteCount": 3,
        "content": "but i return first 3 characters of phonenumber and that's what the question asks. I think it is OK. So the answer I think is A, don't you think so?"
      },
      {
        "date": "2020-03-10T08:32:00.000Z",
        "voteCount": 2,
        "content": "this returns nvachar(10), but declares it as \"max\", does that get implicit conversion. And if so, what kind?\nRealize it should only be 3 long...more just curious at a higher level"
      },
      {
        "date": "2020-02-27T09:26:00.000Z",
        "voteCount": 1,
        "content": "What does schemabinding actually do here? Since there is no table referenced, how does this function actually get involved in the Index? Seems like that would be on the actual query that pulls all Phones"
      },
      {
        "date": "2020-10-17T17:21:00.000Z",
        "voteCount": 1,
        "content": "to create a indexed view the function has to be schemabound"
      },
      {
        "date": "2020-02-05T01:22:00.000Z",
        "voteCount": 1,
        "content": "no where in the query table name is specified , how will the query know which table it has to use ."
      },
      {
        "date": "2020-02-09T11:10:00.000Z",
        "voteCount": 1,
        "content": "try to pay more attention. Don't need any table in this case."
      },
      {
        "date": "2020-03-10T08:26:00.000Z",
        "voteCount": 2,
        "content": "right, but if you don't have a table name, what does the SchemaBinding do"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 9,
    "url": "https://www.examtopics.com/discussions/microsoft/view/19431-exam-70-761-topic-1-question-9-discussion/",
    "body": "Note: This question is part of a series of questions that present the same scenario. Each question in the series contains a unique solution that might meet the stated goals. Some question sets might have more than one correct solution, while others might not have a correct solution.<br>After you answer a question in this section. You will NOT be able to return to it. As a result, these questions will not appear in the review screen.<br>You have a database that tracks orders and deliveries for customers in North America. The database contains the following tables:<br><br>Sales.Customers -<br><img src=\"/assets/media/exam-media/02675/0001600001.png\" class=\"in-exam-image\"><br><br>Application.Cities -<br><img src=\"/assets/media/exam-media/02675/0001700001.png\" class=\"in-exam-image\"><br><br>Sales.CustomerCategories -<br><img src=\"/assets/media/exam-media/02675/0001700002.png\" class=\"in-exam-image\"><br>The company's development team is designing a customer directory application. The application must list customers by the area code of their phone number. The area code is defined as the first three characters of the phone number.<br>The main page of the application will be based on an indexed view that contains the area and phone number for all customers.<br>You need to return the area code from the PhoneNumber field.<br>Solution: You run the following Transact-SQL statement:<br><img src=\"/assets/media/exam-media/02675/0001800001.png\" class=\"in-exam-image\"><br>Does the solution meet the goal?<br>",
    "options": [
      "<span class=\"multi-choice-letter\" data-choice-letter=\"A\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tYes",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"B\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tB.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tNo"
    ],
    "answer": "B",
    "answerDescription": "We need SELECT TOP 1 @areacode =.. to ensure that only one value is returned.",
    "votes": [],
    "comments": [
      {
        "date": "2020-05-01T13:42:00.000Z",
        "voteCount": 5,
        "content": "ANSWER B.\n\nWe need SELECT TOP 1 @areacode =.. to ensure that only one value is returned."
      },
      {
        "date": "2022-03-14T10:23:00.000Z",
        "voteCount": 1,
        "content": "B is the right answer"
      },
      {
        "date": "2020-12-31T15:34:00.000Z",
        "voteCount": 1,
        "content": "B but the answer should be that you need TOP(1) to ensure that the FIRST substring is returned vs. the last"
      },
      {
        "date": "2021-01-02T10:09:00.000Z",
        "voteCount": 1,
        "content": "Test it yourself:\nDECLARE @areacode nvarchar(max)\nSELECT @areacode = value FROM string_split('802-233-2003','-')\nPRINT @areacode"
      },
      {
        "date": "2020-09-13T12:09:00.000Z",
        "voteCount": 1,
        "content": "I actually thought this would be a No but it really is A. When you return a NVARCHAR(10) on a string_split it will return only the first string so A yes this will work."
      },
      {
        "date": "2020-11-13T12:47:00.000Z",
        "voteCount": 3,
        "content": "The output rows might be in any order. The order is not guaranteed to match the order of the substrings in the input string. https://docs.microsoft.com/en-us/sql/t-sql/functions/string-split-transact-sql?view=sql-server-ver15"
      },
      {
        "date": "2020-08-19T14:11:00.000Z",
        "voteCount": 2,
        "content": "Answer is A.\nTested:\nDROP VIEW IF EXISTS dbo.AreaPhoneNumbers;\nDROP FUNCTION IF EXISTS dbo.areaCode\nDROP TABLE IF EXISTS sales.PhoneNumbers;\nGO\n\nCREATE TABLE sales.PhoneNumbers (\n\tId INT identity NOT NULL\n\t,PhoneNumber NVARCHAR(20) NOT NULL\n\t);\n\nINSERT INTO sales.PhoneNumbers (PhoneNumber)\nVALUES ('123-456-8900')\n\t,('234-567-9000');\nGO\n\nCREATE FUNCTION AreaCode (@phoneNumber NVARCHAR(20))\nRETURNS NVARCHAR(10)\nWITH SCHEMABINDING\nAS\nBEGIN\n\tDECLARE @areaCode NVARCHAR(max)\n\n\tSELECT @areaCode = value\n\tFROM string_split(@phoneNumber, '-')\n\n\tRETURN @areaCode\nEND;\nGO\n\nCREATE VIEW AreaPhoneNumbers\n\tWITH schemabinding\nAS\nSELECT dbo.AreaCode(PhoneNumbers.PhoneNumber) AreaCode\n\t,PhoneNumbers.PhoneNumber\nFROM sales.PhoneNumbers;\n\nGO\nSELECT * FROM dbo.AreaPhoneNumbers"
      },
      {
        "date": "2020-09-11T09:16:00.000Z",
        "voteCount": 2,
        "content": "I also tested and it returns the last part and not the first (area code). Eg. \ndeclare @aa nvarchar(max)\nselect @aa = value from string_split('123-456-980', '-' )\nselect @aa\n\nThe SQL above returns 980"
      },
      {
        "date": "2020-09-20T22:07:00.000Z",
        "voteCount": 1,
        "content": "actually seems that using the above logic, from function, returns only the last row. in your code add \"order by value desc\" and you should get \"123\". same code in query -without order, you get \"123\" like default descending ordering."
      },
      {
        "date": "2020-08-18T21:59:00.000Z",
        "voteCount": 1,
        "content": "Actually it's A \nSelect @areacode can only contain one value and the input value @phonenumber is a scalar too so how many values could there be? But even a \"select @var = col1 from table1\" will always contain exactly one value (the value from the last row selected)."
      },
      {
        "date": "2020-08-18T22:02:00.000Z",
        "voteCount": 2,
        "content": "My bad. it returns one value, but the wrong one. namely the phonenum and not the areacode\nAnswer is B - sorry"
      },
      {
        "date": "2020-05-07T02:49:00.000Z",
        "voteCount": 3,
        "content": "Yes B. It return last 4 numbers"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 10,
    "url": "https://www.examtopics.com/discussions/microsoft/view/21201-exam-70-761-topic-1-question-10-discussion/",
    "body": "Note: This question is part of a series of questions that use the same scenario. For your convenience, the scenario is repeated in each question. Each question presents a different goal and answer choices, but the text of the scenario is exactly the same in each question in this series.<br>You query a database that includes two tables: Project and Task. The Project table includes the following columns:<br><img src=\"/assets/media/exam-media/02675/0001900001.png\" class=\"in-exam-image\"><br>The Task table includes the following columns:<br><img src=\"/assets/media/exam-media/02675/0001900002.png\" class=\"in-exam-image\"><br>You plan to run the following query to update tasks that are not yet started:<br>UPDATE Task SET StartTime = GETDATE() WHERE StartTime IS NULL<br>You need to return the total count of tasks that are impacted by this UPDATE operation, but are not associated with a project.<br>What set of Transact-SQL statements should you run?<br><img src=\"/assets/media/exam-media/02675/0001900003.png\" class=\"in-exam-image\"><br>A.<br><img src=\"/assets/media/exam-media/02675/0002000001.png\" class=\"in-exam-image\"><br>B.<br><img src=\"/assets/media/exam-media/02675/0002000002.png\" class=\"in-exam-image\"><br>C.<br><img src=\"/assets/media/exam-media/02675/0002000003.png\" class=\"in-exam-image\"><br>D.<br>",
    "options": [],
    "answer": "B",
    "answerDescription": "The WHERE clause of the third line should be WHERE ProjectID IS NULL, as we want to count the tasks that are not associated with a project.",
    "votes": [],
    "comments": [
      {
        "date": "2020-05-23T07:53:00.000Z",
        "voteCount": 5,
        "content": "Answer: B\nThe WHERE clause of the third line should be WHERE ProjectID IS NULL, as we want to count the tasks that are not associated with a project."
      },
      {
        "date": "2022-03-14T10:24:00.000Z",
        "voteCount": 1,
        "content": "B is Correct"
      },
      {
        "date": "2020-12-31T15:50:00.000Z",
        "voteCount": 1,
        "content": "It is the 3rd answer (probably C) because nothing will show up in deleted if the value was previously NULL so you need to count inserted"
      },
      {
        "date": "2020-07-23T02:29:00.000Z",
        "voteCount": 3,
        "content": "I tested it on database and Answer is B."
      },
      {
        "date": "2020-09-12T05:57:00.000Z",
        "voteCount": 1,
        "content": "could you please show the whole script ?"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 11,
    "url": "https://www.examtopics.com/discussions/microsoft/view/3690-exam-70-761-topic-1-question-11-discussion/",
    "body": "HOTSPOT -<br>Note: This question is part of a series of questions that use the same scenario. For your convenience, the scenario is repeated in each question. Each question presents a different goal and answer choices, but the text of the scenario is exactly the same in each question in this series.<br>You query a database that includes two tables: Project and Task. The Project table includes the following columns:<br><img src=\"/assets/media/exam-media/02675/0002100001.png\" class=\"in-exam-image\"><br><img src=\"/assets/media/exam-media/02675/0002100002.png\" class=\"in-exam-image\"><br>You need to identify the owner of each task by using the following rules:<br>\u2711 Return each task's owner if the task has an owner.<br>\u2711 If a task has no owner, but is associated with a project that has an owner, return the project's owner.<br>\u2711 Return the value-1for all other cases.<br>How should you complete the Transact-SQL statement? To answer, select the appropriate Transact-SQL segments in the answer area.<br>Hot Area:<br><img src=\"/assets/media/exam-media/02675/0002200001.png\" class=\"in-exam-image\"><br>",
    "options": [],
    "answer": "<img src=\"/assets/media/exam-media/02675/0002200002.png\" class=\"in-exam-image\">",
    "answerDescription": "Box 1: COALESCE -<br>COALESCE evaluates the arguments in order and returns the current value of the first expression that initially does not evaluate to NULL.<br><br>Box 2: T.UserID, p.UserID, -1 -<br>\u2711 Return each task's owner if the task has an owner.<br>\u2711 If a task has no owner, but is associated with a project that has an owner, return the project's owner.<br>\u2711 Return the value -1 for all other cases.<br><br>Box 3: RIGHT JOIN -<br>The RIGHT JOIN keyword returns all rows from the right table (table2), with the matching rows in the left table (table1). The result is NULL in the left side when there is no match. Here the right side could be NULL as the projectID of the task could be NULL.<br>References:<br>https://msdn.microsoft.com/en-us/library/ms190349.aspx<br>http://www.w3schools.com/Sql/sql_join_right.asp",
    "votes": [],
    "comments": [
      {
        "date": "2019-08-17T21:11:00.000Z",
        "voteCount": 33,
        "content": "Correct: Left Join"
      },
      {
        "date": "2020-07-23T02:30:00.000Z",
        "voteCount": 11,
        "content": "I confirm 100% that correct answer is LEFT JOIN. Passed exam today with 970 score and had this question"
      },
      {
        "date": "2022-03-14T10:26:00.000Z",
        "voteCount": 1,
        "content": "You didn't count that fact that the Task table is on the left side of the join , not on the right one. Table 2 is on the left side"
      },
      {
        "date": "2020-09-02T00:02:00.000Z",
        "voteCount": 2,
        "content": "Guys the correct answer in Left join.(110% sure)"
      },
      {
        "date": "2020-07-09T05:02:00.000Z",
        "voteCount": 2,
        "content": "must be Left join"
      },
      {
        "date": "2020-07-06T16:13:00.000Z",
        "voteCount": 3,
        "content": "Left join is correct we want to bring in all tasks not all projects."
      },
      {
        "date": "2020-06-25T11:42:00.000Z",
        "voteCount": 3,
        "content": "It cannot be RIGHT JOIN because there could be a task without a project, and  RIGHT JOIN on projects would not pick up such tasks\nLEFT JOIN picks up all tasks, not necessarily all projects"
      },
      {
        "date": "2020-05-23T08:14:00.000Z",
        "voteCount": 1,
        "content": "Box 1: COALESCE -\nCOALESCE evaluates the arguments in order and returns the current value of the rst expression that initially does not evaluate to NULL.\nBox 2: T.UserID, p.UserID, -1 -\n\u2711 Return each task's owner if the task has an owner.\n\u2711 If a task has no owner, but is associated with a project that has an owner, return the project's owner.\n\u2711 Return the value -1 for all other cases.\nBox 3: RIGHT JOIN -\nThe RIGHT JOIN keyword returns all rows from the right table (table2), with the matching rows in the left table (table1). The result is NULL in the\nleft side when there is no match. Here the right side could be NULL as the projectID of the task could be NULL."
      },
      {
        "date": "2020-11-05T19:48:00.000Z",
        "voteCount": 1,
        "content": "You didn't count that fact that the Task table is on the left side of the join , not on the right one. Table 2 is on the left side"
      },
      {
        "date": "2020-05-08T04:04:00.000Z",
        "voteCount": 1,
        "content": "Its correct besides LEFT JOIN"
      },
      {
        "date": "2020-05-07T01:56:00.000Z",
        "voteCount": 1,
        "content": "Has to be a LEFT join surely - we want ALL tasks (LEFT hand table) regardless of whether they are associated with a project."
      },
      {
        "date": "2020-03-18T03:38:00.000Z",
        "voteCount": 4,
        "content": "left join"
      },
      {
        "date": "2020-01-08T21:01:00.000Z",
        "voteCount": 8,
        "content": "agreed, left join it is since select result only concerned about task. If we go with right join then for a task that has no project, we will get an all null value row result which doesn't make any sense in any context and requirement."
      },
      {
        "date": "2019-11-06T03:50:00.000Z",
        "voteCount": 7,
        "content": "The columns selected are concerning Tasks. Therefore we should use LEFT JOIN. Otherwise the result will Induce error."
      },
      {
        "date": "2019-09-21T20:07:00.000Z",
        "voteCount": 9,
        "content": "Should be left join. Question is about tasks."
      },
      {
        "date": "2019-09-06T06:58:00.000Z",
        "voteCount": 1,
        "content": "RIGHT JOIN is correct, as given in the answer. The task table (left) is containing the potentially empty values and is joined onto the right project table."
      },
      {
        "date": "2020-11-17T03:07:00.000Z",
        "voteCount": 2,
        "content": "If you choose the right join, the select only will show tasks with a project."
      },
      {
        "date": "2020-11-22T15:26:00.000Z",
        "voteCount": 2,
        "content": "LEFT OUTER will give you a result set including all the Tasks without a Project. RIGHT OUTER give a result set including all the Projects without a Task.\nFrom you question you need a LEFT OUTER JOIN"
      },
      {
        "date": "2019-09-03T06:01:00.000Z",
        "voteCount": 9,
        "content": "Its a LEFT JOIN"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 12,
    "url": "https://www.examtopics.com/discussions/microsoft/view/3691-exam-70-761-topic-1-question-12-discussion/",
    "body": "DRAG DROP -<br>Note: This question is part of a series of questions that use the same scenario. For your convenience, the scenario is repeated in each question. Each question presents a different goal and answer choices, but the text of the scenario is exactly the same in each question in this series.<br>You query a database that includes two tables: Project and Task. The Project table includes the following columns:<br><img src=\"/assets/media/exam-media/02675/0002300004.png\" class=\"in-exam-image\"><br><img src=\"/assets/media/exam-media/02675/0002400001.png\" class=\"in-exam-image\"><br>Task level is defined using the following rules:<br><img src=\"/assets/media/exam-media/02675/0002400002.png\" class=\"in-exam-image\"><br>You need to determine the task level for each task in the hierarchy.<br>Which five Transact-SQL segments should you use to develop the solution? To answer, move the appropriate Transact-SQL segments from the list of Transact-<br>SQL segments to the answer area and arrange them in the correct order.<br>Select and Place:<br><img src=\"/assets/media/exam-media/02675/0002500001.jpg\" class=\"in-exam-image\"><br>",
    "options": [],
    "answer": "<img src=\"/assets/media/exam-media/02675/0002600001.jpg\" class=\"in-exam-image\">",
    "answerDescription": "Box 1: SELECT CAST (NULL AS INT) AS ParentTaskID, etc.<br>This statement selects all tasks with task level 0.<br>The ParentTaskID could be null so we should use CAST (NULL AS INT) AS ParentTaskID.<br><br>Box 2: UNION -<br>We should use UNION and not UNION ALL as we do not went duplicate rows.<br>UNION specifies that multiple result sets are to be combined and returned as a single result set.<br>Incorrect Answers:<br>Not UNION ALL: ALL incorporates all rows into the results. This includes duplicates. If not specified, duplicate rows are removed.<br>Box 3, Box 4, Box 5:<br>These statements select all tasks with task level &gt;0.<br>References:<br>https://msdn.microsoft.com/en-us/library/ms180026.aspx",
    "votes": [],
    "comments": [
      {
        "date": "2019-08-17T22:30:00.000Z",
        "voteCount": 45,
        "content": "Correct Answer: With TaskWithTaskLevel (ParentTaskID,TaskID,TaskName,TaskLevel)\nAs (\n\n\tSelect Cast(null as int) ParentTaskID, T.TaskID,T.TaskName,0 as TaskLevel \n\tFrom Task T where ParentTaskID is null\n\n\tUnion All\n\n\tSelect R.TaskID as ParentTaskID, T.TaskID,T.TaskName,R.TaskLevel + 1 as TaskLevel \n\tFrom Task T Inner join TaskWithTaskLevel R on T.ParentTaskID = R.TaskID\n\n)\nSelect * from TaskWithTaskLevel"
      },
      {
        "date": "2019-11-06T04:10:00.000Z",
        "voteCount": 2,
        "content": "I agree, but it can be just UNION"
      },
      {
        "date": "2019-12-06T08:03:00.000Z",
        "voteCount": 13,
        "content": "I was wrong. It has to be UNION ALL.\nRecursive CTE will only work with UNION ALL."
      },
      {
        "date": "2020-03-22T14:47:00.000Z",
        "voteCount": 6,
        "content": "union cannot be used in WIth recursive."
      },
      {
        "date": "2022-03-14T10:27:00.000Z",
        "voteCount": 1,
        "content": "It can be just UNION"
      },
      {
        "date": "2021-01-20T10:31:00.000Z",
        "voteCount": 1,
        "content": "3 2 7 5 1"
      },
      {
        "date": "2020-09-15T15:07:00.000Z",
        "voteCount": 4,
        "content": "UNION ALLL\nDrop TABLE IF EXISTS #Task\nDrop TABLE IF EXISTS #Project\n\n\nCREATE Table #Project\n(\n\tProjectId UNIQUEIDENTIFIER NOT NULL,\n\tProjectName varchar(100),\n\tStartTime dateTime2(7),\n\tEndTime dateTime2(7),\n\tUserId Int\n)\nCREATE Table #Task\n(\n\tTaskId UNIQUEIDENTIFIER NOT NULL,\n\tTaskName varchar(100),\n\tParentTaskId int,\n\tProjectId int,\n\tStartTime dateTime2(7),\n\tEndTime dateTime2(7),\n\tUserId Int\n)\n\n\nWith TaskWithTaskLevel (ParentTaskID,TaskID,TaskName,TaskLevel)\nAs (\n\nSelect Cast(null as int) ParentTaskID, T.TaskID,T.TaskName,0 as TaskLevel\nFrom Task T where ParentTaskID is null\n\nUnion ALL\n\nSelect R.TaskID as ParentTaskID, T.TaskID,T.TaskName,R.TaskLevel + 1 as TaskLevel\nFrom Task T Inner join TaskWithTaskLevel R on T.ParentTaskID = R.TaskID\n\n)\nSelect * from TaskWithTaskLevel"
      },
      {
        "date": "2020-10-19T10:57:00.000Z",
        "voteCount": 1,
        "content": "agreed that is the correct solution"
      },
      {
        "date": "2020-12-31T16:02:00.000Z",
        "voteCount": 1,
        "content": "Agreed - need UNION ALL to make recursion work. 0 is top level, +1 on bottom"
      },
      {
        "date": "2020-07-09T05:13:00.000Z",
        "voteCount": 2,
        "content": "Select Cast(null as int)  returns a null, not a zero"
      },
      {
        "date": "2019-09-03T06:08:00.000Z",
        "voteCount": 3,
        "content": "UNION OR UNION ALL, I think UNION for filter duplicates"
      },
      {
        "date": "2020-12-16T15:42:00.000Z",
        "voteCount": 1,
        "content": "Union cannot be used with Recursive CTEs. Only Union All can."
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 13,
    "url": "https://www.examtopics.com/discussions/microsoft/view/2845-exam-70-761-topic-1-question-13-discussion/",
    "body": "DRAG DROP -<br>Note: This question is part of a series of questions that use the same scenario. For your convenience, the scenario is repeated in each question. Each question presents a different goal and answer choices, but the text of the scenario is exactly the same in each question in this series.<br>You query a database that includes two tables: Project and Task. The Project table includes the following columns:<br><img src=\"/assets/media/exam-media/02675/0002700001.png\" class=\"in-exam-image\"><br><img src=\"/assets/media/exam-media/02675/0002700002.png\" class=\"in-exam-image\"><br>When running an operation, you updated a column named EndTime for several records in the Project table, but updates to the corresponding task records in the<br>Task table failed.<br>You need to synchronize the value of the EndTime column in the Task table with the value of the EndTime column in the project table. The solution must meet the following requirements:<br>\u2711 If the EndTime column has a value, make no changes to the record.<br>\u2711 If the value of the EndTime column is null and the corresponding project record is marked as completed, update the record with the project finish time.<br>Which four Transact-SQL segments should you use to develop the solution? To answer, move the appropriate Transact-SQL segments from the list of Transact-<br>SQL segments to the answer area and arrange them in the correct order.<br>Select and Place:<br><img src=\"/assets/media/exam-media/02675/0002800003.png\" class=\"in-exam-image\"><br>",
    "options": [],
    "answer": "<img src=\"/assets/media/exam-media/02675/0002900001.png\" class=\"in-exam-image\">",
    "answerDescription": "Box 1: UPDATE T SET T.EndTime = P.EndTime<br>We are updating the EndTime column in the Task table.<br><br>Box 2: FROM Task AS T -<br>Where are updating the task table.<br>Box 3:INNER JOIN Project AS P on T.ProjectID = P.ProjectID<br>We join with the Project table (on the ProjectID columnID column).<br>Box 4: WHERE P.EndTime is NOT NULL AND T.EndTime is NULL<br>We select the columns in the Task Table where the EndTime column in the Project table has a value (NOT NULL),but where it is NULL in the Task Table.<br>References:<br>https://msdn.microsoft.com/en-us/library/ms177523.aspx",
    "votes": [],
    "comments": [
      {
        "date": "2019-07-24T12:18:00.000Z",
        "voteCount": 37,
        "content": "The first box should be the UPDATE T statement, as we are updating the T table, not the P table."
      },
      {
        "date": "2019-09-21T20:32:00.000Z",
        "voteCount": 37,
        "content": "Answer should be -\nUpdate T SET T.EndTime = P.EndTime\nFROM Tasks as T\nINNER JOIN Projects AS P ON T.ProjectId = P.ProjectID\nWHERE P.EndTime is not null and T.EndTime is NULL"
      },
      {
        "date": "2022-03-14T10:27:00.000Z",
        "voteCount": 1,
        "content": "The requirements: \"column named EndTime for several records in the Project table, but updates to the corresponding task records in the\nTask table failed.\".\nSo, the information on Project is ok. You need to synchronize Task table."
      },
      {
        "date": "2020-05-23T08:36:00.000Z",
        "voteCount": 2,
        "content": "You need to synchronize the value of the EndTime column in the Task table with the value of the EndTime column in the project table\n\nupdate p set p.endtime = t.endtime\nfrom task as t\ninner join project as p on t.projectid = p.projectid\nwhere p.endtime is not null and t.endtime is null"
      },
      {
        "date": "2020-09-12T00:08:00.000Z",
        "voteCount": 1,
        "content": "The requirements: \"column named EndTime for several records in the Project table, but updates to the corresponding task records in the\nTask table failed.\". \nSo, the information on Project is ok. You need to synchronize Task table."
      },
      {
        "date": "2020-11-17T03:43:00.000Z",
        "voteCount": 1,
        "content": "You need to update Task!!"
      },
      {
        "date": "2020-11-17T03:45:00.000Z",
        "voteCount": 1,
        "content": "If you have to write values in Task table, you should update task, never project."
      },
      {
        "date": "2019-08-18T02:31:00.000Z",
        "voteCount": 19,
        "content": "Box 1: UPDATE T SET T.EndTime = P.EndTime"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 14,
    "url": "https://www.examtopics.com/discussions/microsoft/view/12459-exam-70-761-topic-1-question-14-discussion/",
    "body": "You need to create a database object that meets the following requirements:<br>\u2711 accepts a product identified as input<br>\u2711 calculates the total quantity of a specific product, including quantity on hand and quantity on order<br>\u2711 caches and reuses execution plan<br>\u2711 returns a value<br>\u2711 can be called from within a SELECT statement<br>\u2711 can be used in a JOIN clause<br>What should you create?<br>",
    "options": [
      "<span class=\"multi-choice-letter\" data-choice-letter=\"A\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tan extended stored procedure",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"B\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tB.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\ta user-defined scalar function",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"C\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tC.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\ta user-defined stored procedure that has an OUTPUT parameter",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"D\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tD.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\ta temporary table that has a columnstore index"
    ],
    "answer": "B",
    "answerDescription": "User-defined scalar functions are execution plans that accept parameters, perform an action such as a complex calculation, and returns the result of that action as a value. The return value can either be a single scalar value or a result set. Furthermore the execution plan is cached and reusable.<br>User-defined scalar functions can also be called from within a SELECT statement and can be used in a JOIN clause.<br>Incorrect Answers:<br>A: Using extended stored procedures is not recommended as they has been deprecated. CLR Integration should be used instead of extended stored procedures.<br>C: Stored procedures cannot be used in a SELECT statement or in a JOIN clause.<br>D: A temporary table is a result set and not a value.<br>References:<br>https://www.c-sharpcorner.com/UploadFile/996353/difference-between-stored-procedure-and-user-defined-functio/",
    "votes": [],
    "comments": [
      {
        "date": "2022-03-14T10:31:00.000Z",
        "voteCount": 1,
        "content": "User-defined scalar functions are execution plans that accept parameters, perform an action such as a complex calculation, and returns the result of that action as a value. The return value can either be a single scalar value or a result set. Furthermore the execution plan is cached and reusable, B"
      },
      {
        "date": "2020-12-31T16:32:00.000Z",
        "voteCount": 1,
        "content": "UDF. You can use in JOIN:\nSELECT T1\nINNER JOIN T2\nON T1.ID = T2.ID AND T1.Val = scalar UDF\n\nAn extended case of JOIN but it fits everything listed"
      },
      {
        "date": "2020-11-17T03:49:00.000Z",
        "voteCount": 1,
        "content": "Scalar valued function return single value (not table) so you cannot use joins.\n\nhttps://docs.microsoft.com/en-us/sql/relational-databases/user-defined-functions/create-user-defined-functions-database-engine?redirectedfrom=MSDN&amp;view=sql-server-ver15"
      },
      {
        "date": "2020-11-02T06:56:00.000Z",
        "voteCount": 1,
        "content": "it can be a user defined function..but not a user defined scalar function."
      },
      {
        "date": "2020-06-28T06:21:00.000Z",
        "voteCount": 3,
        "content": "This is correct a scaler function can be used in the join clause. They are not saying as a table join but as a clause."
      },
      {
        "date": "2020-02-25T06:59:00.000Z",
        "voteCount": 3,
        "content": "Scalar valued function return single value (not table) so you cannot use joins.\n\nIf it is a table valued function you can use the following as another way then Using Apply."
      },
      {
        "date": "2020-02-28T04:15:00.000Z",
        "voteCount": 11,
        "content": "You could use it in a join, as the value of something, couldn't you, very similar to\nFROM Y\nJOIN x \n    ON x.key = y.key AND x.someFilterCol = dbo.functA(prodId)\nright?"
      },
      {
        "date": "2020-02-10T06:29:00.000Z",
        "voteCount": 2,
        "content": "But how user-defined SCALAR function can be used in JOIN clause? I think this imposible"
      },
      {
        "date": "2020-11-22T15:59:00.000Z",
        "voteCount": 1,
        "content": "I think the question is wrong. The question states that it can be called from the SELECT and used in the JOIN clause. Nothing here fits this, but the closest is a UDF. It can be used in a JOIN in the predicate, although not as the (virtual) table."
      },
      {
        "date": "2020-01-22T01:14:00.000Z",
        "voteCount": 1,
        "content": "I Think it is inlined."
      },
      {
        "date": "2020-01-21T09:41:00.000Z",
        "voteCount": 1,
        "content": "Can a user-defined scalar function be inlined?"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 15,
    "url": "https://www.examtopics.com/discussions/microsoft/view/3835-exam-70-761-topic-1-question-15-discussion/",
    "body": "HOTSPOT -<br>You have the following stored procedure:<br><img src=\"/assets/media/exam-media/02675/0003100001.png\" class=\"in-exam-image\"><br>You run the following Transact-SQL statements:<br><img src=\"/assets/media/exam-media/02675/0003100002.png\" class=\"in-exam-image\"><br>What is the result of each Transact-SQL statement? To answer, select the appropriate options in the answer area.<br>Hot Area:<br><img src=\"/assets/media/exam-media/02675/0003200001.png\" class=\"in-exam-image\"><br>",
    "options": [],
    "answer": "<img src=\"/assets/media/exam-media/02675/0003200002.png\" class=\"in-exam-image\">",
    "answerDescription": "Box 1: All transactions are rolled back.<br>The first IF-statement, IF @CODE = 'C2323' AND @ApplicationID = 1, will be true, an error will be raised, the error will be caught in the CATCH block, and the only transaction that has been started will be rolled back.<br>Box 2: Only Log1, Log2, and Log3 tables are updated.<br>The second IF-statement, IF @Code = 'C2323', will be true, so the second transaction will be rolled back, but log1, log2, and log3 was updated before the second transaction.",
    "votes": [],
    "comments": [
      {
        "date": "2019-08-19T18:47:00.000Z",
        "voteCount": 33,
        "content": "For both case, correct answer:All Transactions are Rolled Back\nRef:\"When nesting transactions, this same statement rolls back all inner transactions to the outermost BEGIN TRANSACTION statement. \"\nhttps://docs.microsoft.com/en-us/sql/t-sql/language-elements/rollback-transaction-transact-sql?view=sql-server-2016"
      },
      {
        "date": "2020-11-17T04:06:00.000Z",
        "voteCount": 2,
        "content": "Me too. For both case, correct answer:All Transactions are Rolled Back"
      },
      {
        "date": "2019-08-19T18:50:00.000Z",
        "voteCount": 12,
        "content": "I've tested the code as well"
      },
      {
        "date": "2019-09-03T06:13:00.000Z",
        "voteCount": 22,
        "content": "Me too. For both case, correct answer:All Transactions are Rolled Back"
      },
      {
        "date": "2022-03-14T10:32:00.000Z",
        "voteCount": 1,
        "content": "Agree - one rollback at any level of transaction stack rolls back everything. Both result in everything being rolled back. RAISERROR transfers control to CATCH block with XACT_STATE=1"
      },
      {
        "date": "2020-12-31T16:48:00.000Z",
        "voteCount": 1,
        "content": "Agree - one rollback at any level of transaction stack rolls back everything. Both result in everything being rolled back. RAISERROR transfers control to CATCH block with XACT_STATE=1"
      },
      {
        "date": "2020-09-09T10:15:00.000Z",
        "voteCount": 1,
        "content": "100% the answer for both is : All transactions rolled back.(Tested)"
      },
      {
        "date": "2020-05-08T09:18:00.000Z",
        "voteCount": 3,
        "content": "All of you are cporrec, I executed and for both executions the answer is:\nAll Transactions are Rolled Back"
      },
      {
        "date": "2020-04-07T08:04:00.000Z",
        "voteCount": 2,
        "content": "The right answer is All of the transaction are rolled back."
      },
      {
        "date": "2020-02-28T10:00:00.000Z",
        "voteCount": 1,
        "content": "Question here, I changed the IF @Code = 'C2323' --ROLLBACK TRAN\nto COMMIT TRAN\nIt actually changes my @@TRANCOUNT from 2 -&gt; 0, I would have expected 1 and it to not actually commit b/c in a nested TRAN"
      },
      {
        "date": "2020-01-03T22:59:00.000Z",
        "voteCount": 9,
        "content": "correct answer for both : All Transactions are Rolled Back"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 16,
    "url": "https://www.examtopics.com/discussions/microsoft/view/4501-exam-70-761-topic-1-question-16-discussion/",
    "body": "HOTSPOT -<br>You need to develop a Transact-SQL statement that meets the following requirements:<br>\u2711 The statement must return a custom error when there are problems updating a table.<br>\u2711 The error number must be value50555.<br>\u2711 Theerror severity level must be14.<br>\u2711 A Microsoft SQL Server alert must be triggered when the error condition occurs.<br>Which Transact-SQL segment should you use for each requirement? To answer, select the appropriate Transact-SQL segments in the answer area.<br>Hot Area:<br><img src=\"/assets/media/exam-media/02675/0003400001.png\" class=\"in-exam-image\"><br>",
    "options": [],
    "answer": "<img src=\"/assets/media/exam-media/02675/0003400002.png\" class=\"in-exam-image\">",
    "answerDescription": "Box 1: TRY\"\u00a6CATCH -<br>The TRY...CATCH Transact-SQL construct implements error handling for Transact-SQL that is similar to the exception handling in the Microsoft Visual C# and<br>Microsoft Visual C++ languages. A group of Transact-SQL statements can be enclosed in a TRY block. If an error occurs in the TRY block, control is passed to another group of statements that is enclosed in a CATCH block.<br>Box 2: RAISERROR(50555, 14, 1 'The update failed.\") WITH LOG<br>We must use RAISERROR to be able to specify the required severity level of 14, and we should also use the LOG option, which Logs the error in the error log and the application log for the instance of the Microsoft SQL Server Database Engine, as this enable a MS MS SQL SERVER alert to be triggered.<br>Note: RAISERROR generates an error message and initiates error processing for the session. RAISERROR can either reference a user-defined message stored in the sys.messages catalog view or build a message dynamically. The message is returned as a server error message to the calling application or to an associated CATCH block of a TRY\"\u00a6CATCH construct.<br>Incorrect Answers:<br>Not THROW: THROW does not have a severity parameter.<br>References:<br>https://msdn.microsoft.com/en-us/library/ms175976.aspx<br>https://msdn.microsoft.com/en-us/library/ms178592.aspx",
    "votes": [],
    "comments": [
      {
        "date": "2020-07-23T02:56:00.000Z",
        "voteCount": 11,
        "content": "Correct answers are:\nTRY...CATCH\nRaiseerror ... WITH LOG\nPassed exam today with 970 score and had it on my exam."
      },
      {
        "date": "2020-12-31T16:51:00.000Z",
        "voteCount": 1,
        "content": "TRY..CATCH, RAISERROR WITH LOG - 100%"
      },
      {
        "date": "2020-12-21T23:47:00.000Z",
        "voteCount": 1,
        "content": "The answer is WITH NOWAIT.  To raise error with severity 19 and above you have to add the option WITH LOG, which logs the error in the SQL Server error log as well as the Windows \napplication log. To use the WITH LOG option you must be a member of the sysadmin role\nor have the ALTER TRACE permission. SQL Server Agent fires an alert when a specific error occurs. For example, you might specify error number 2571 to respond to unauthorized attempts to invoke Database Console Commands (DBCC).  SQL Server Agent fires an alert when any error of the specific severity occurs. For example, you might specify a severity level of 15 to respond to syntax errors in Transact-SQL statements."
      },
      {
        "date": "2020-11-25T17:18:00.000Z",
        "voteCount": 2,
        "content": "The 2 important requirements are that it be Severity 14 and a SQL Server Alert be triggered. For any severity other than 16, you have to use RAISERROR. \nA SQL Server Alert is an object setup under the SQL Server Agent. You can specify the Alert by error number or severity. The alert with trigger when an error is raised WITH LOG.\nSo the option has to be RAISERROR....WITH LOG\nA SQL Server Alert is nothing to do with the client."
      },
      {
        "date": "2020-09-09T11:07:00.000Z",
        "voteCount": 1,
        "content": "Continuing..So first you need to make an entry in sys.messages using a stored procedure sp_addmessage (you cannot just insert a value in system objects)\n\"exec sp_addmessage 50555,14,N'the update failed'\"\n4. And now use RAISERROR so the answer is either 2 or 3 (most probably 3 because NOWAIT send the log message instantly to the user or the client)\nHappy learning :)"
      },
      {
        "date": "2020-11-25T17:20:00.000Z",
        "voteCount": 2,
        "content": "A SQL Server Alert is the Alert you will find under the SQL Server Agent. Once you have setup an Alert, it will trigger when a matching error is raised WITH LOG.\nAlerts are nothing to do tith the user / client"
      },
      {
        "date": "2020-09-09T11:06:00.000Z",
        "voteCount": 1,
        "content": "Okay there are couple of things this question sheds some light on - \n1. The answer cannot be THROW because when you use THROW to throw an user defined error, the severity is always set to 16.\n2.When THROW is used to throw and user defined function, the message_id doesn't need to be stored in sys.messages table.(Here the message id is 50555)\n3.However when you use RAISERROR to throw an UD error message then it is mandatory to have a message_ID  associated with the user defined test message in sys.messages. If you just raiserror with that message_id it will raise an error but the error message wouldn't have the user defined message becasue it doesnt have that particular message_id in sys.messages table. This is the error  message that is thrown:\n\n\"Error 50555, severity 14, state 1 was raised, but no message with that error number was found in sys.messages. If error is larger than 50000, make sure the user-defined message is added using sp_addmessage.\"  Continued in next comment"
      },
      {
        "date": "2020-09-09T11:04:00.000Z",
        "voteCount": 1,
        "content": "The correct answer is Raiserror with nowait"
      },
      {
        "date": "2020-02-04T07:11:00.000Z",
        "voteCount": 2,
        "content": "xp_logevent can be used to log a user-defined message in the SQL Server log file and in the Windows Event Viewer. xp_logevent can be used to send an alert without sending a message to the client.\n\nCorrect answer is WITH LOG: \n\nhttps://docs.microsoft.com/en-us/sql/relational-databases/system-stored-procedures/xp-logevent-transact-sql?view=sql-server-ver15"
      },
      {
        "date": "2020-01-09T19:24:00.000Z",
        "voteCount": 1,
        "content": "It has to be raiserror to meet requirement of 'severity level must be 14.' since by default throw always return 16. Plus we need nowait option to return error to client immediately."
      },
      {
        "date": "2020-02-09T12:28:00.000Z",
        "voteCount": 1,
        "content": "No, the condition severity 16 is only for THROW, not for RAISEERROR"
      },
      {
        "date": "2019-09-01T11:48:00.000Z",
        "voteCount": 1,
        "content": "\"A Microsoft SQL Server alert must be triggered when the error condition occurs.\"\n\nSeems to be correct answer \"..With Nowait\"\n\nRef. Itzik Ben-Gan QUerying Microsoft Sql Server 2014\" \n\"You can issue RAISERROR with a severity level &gt; 20 if you use the WITH LOG option\nand if you have the SQL Server sysadmin role. SQL Server will then terminate the connection\nwhen the error is raised.\n-You can use RAISERROR with NOWAIT to send messages immediately to the client. The\nmessage does not wait in the output buffer before being sent.\""
      },
      {
        "date": "2019-09-03T06:19:00.000Z",
        "voteCount": 6,
        "content": "With NO WAIT you send immediately the error to the CLIENT (ASP.NET, Console, ecc) with LOG you send the error to the SQL Server logging.\nhttps://docs.microsoft.com/en-us/sql/t-sql/language-elements/raiserror-transact-sql?view=sql-server-2017"
      },
      {
        "date": "2020-02-28T09:28:00.000Z",
        "voteCount": 1,
        "content": "so, what are you saying, it mentioned \"when the error condition occurs\", which seems like the NO WAIT\nWITH LOG seems like it would buffer...then send, right?"
      },
      {
        "date": "2020-11-25T16:49:00.000Z",
        "voteCount": 1,
        "content": "You can use WITH LOG at any severity, but require the correct permissions,\nYou have to use WITH LOG for severity 19 or higher. \nSeverity 20 or higher will kill the connection"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 17,
    "url": "https://www.examtopics.com/discussions/microsoft/view/11699-exam-70-761-topic-1-question-17-discussion/",
    "body": "DRAG DROP -<br>You need to create a stored procedure to update a table named Sales.Customers. The structure of the table is shown in the exhibit. (Click the exhibit button.)<br><img src=\"/assets/media/exam-media/02675/0003600001.jpg\" class=\"in-exam-image\"><br>The stored procedure must meet the following requirements:<br>\u2711 Accept two input parameters.<br>\u2711 Update the company name if the customer exists.<br>\u2711 Return a custom error message if the customer does not exist.<br>Which five Transact-SQL segments should you use to develop the solution? To answer, move the appropriate Transact-SQL segments from the list of Transact-<br>SQL segments to the answer area and arrange them in the correct order.<br>NOTE: More than one order of answer choices is correct. You will receive credit for any of the correct orders you select.<br>Select and Place:<br><img src=\"/assets/media/exam-media/02675/0003700001.png\" class=\"in-exam-image\"><br>",
    "options": [],
    "answer": "<img src=\"/assets/media/exam-media/02675/0003800001.png\" class=\"in-exam-image\">",
    "answerDescription": "",
    "votes": [],
    "comments": [
      {
        "date": "2020-12-31T16:57:00.000Z",
        "voteCount": 1,
        "content": "The order is wrong. IF without BEGIN/END will only execute the first statement so the highlighted answer is flat out wrong.\n\n1.CREATE PROCEDURE sales.modcompanyname @custId int, @newname nvarchar(40) as\n2.IF NOT EXISTS (SELECT custid FROM Sales.Customers WHERE custid = @custID)\n3.BEGIN THROW 55555, 'The customer ID does not exist' , 1 END\n4.UPDATE sales.customers SET companyname=@newname where custid=@custID"
      },
      {
        "date": "2021-01-02T10:51:00.000Z",
        "voteCount": 1,
        "content": "Ignore - looks good - the UPDATE SET is one statement"
      },
      {
        "date": "2020-12-22T00:30:00.000Z",
        "voteCount": 1,
        "content": "CREATE or alter PROCEDURE modcompanyname @custId int, @newname nvarchar(40) \nas\nif exists (SELECT custid From cust where custid = @custId)\nUPDATE cust SET companyname=@newname where custid=@custID\n\nIF NOT EXISTS (SELECT custid FROM Cust WHERE custid = @custID)\nBEGIN THROW 55555, 'The customer ID does not exist Simon' , 1\nEND"
      },
      {
        "date": "2020-07-28T23:49:00.000Z",
        "voteCount": 1,
        "content": "but question requires 5 statements"
      },
      {
        "date": "2020-07-09T06:34:00.000Z",
        "voteCount": 1,
        "content": "all comments excellent work!  but question requires 5 statements."
      },
      {
        "date": "2020-02-02T10:47:00.000Z",
        "voteCount": 1,
        "content": "@Robintang0924 Excellent, thanks!"
      },
      {
        "date": "2020-01-09T18:58:00.000Z",
        "voteCount": 4,
        "content": "By given statements, below version should be the optimized one since it only needs to read table once when there is no existing custid in the table. \n\n1.CREATE PROCEDURE sales.modcompanyname @custId int, @newname nvarchar(40) as\n\n2.IF NOT EXISTS (SELECT custid FROM Sales.Customers WHERE custid = @custID)\n\n3.BEGIN THROW 55555, 'The customer ID does not exist' , 1 END\n\n4.UPDATE sales.customers SET companyname=@newname where custid=@custID\n\n\n\n\nHowever, if we can come up something by ourselves, then below should be even better performance since we only need to touch table once no matter we got existing custid in table or not (above solution still need to access table twice when custid existed in table):\n\n1.CREATE PROCEDURE sales.modcompanyname @custId int, @newname nvarchar(40) as\n\n2.UPDATE sales.customers SET companyname=@newname where custid=@custID\n\n3. IF @@ROWCOUNT = 0  \n\n4.BEGIN THROW 55555, 'The customer ID does not exist' , 1 END"
      },
      {
        "date": "2020-02-09T22:08:00.000Z",
        "voteCount": 19,
        "content": "but the response is asking for 5 not 4 sql statements\nwhich means is \n1. create stored procedure....\n2. if exist ....\n3. update...\n4. if not exist...\n5. throw error"
      },
      {
        "date": "2020-02-10T07:06:00.000Z",
        "voteCount": 2,
        "content": "but also can be \n1. create stored procedure....\n2. if not exist \n3. throw error...\n4. rollback?(useless)\n5.  update"
      },
      {
        "date": "2020-05-08T10:37:00.000Z",
        "voteCount": 1,
        "content": "Yes. And the answer is correct in the answer area."
      },
      {
        "date": "2020-11-25T17:28:00.000Z",
        "voteCount": 2,
        "content": "Definitely the real world answer, but not the \"right\" answer. Hey ho"
      },
      {
        "date": "2020-12-14T21:11:00.000Z",
        "voteCount": 1,
        "content": "update..\nif @@rowcount = 0\nthrow\n^ this is the best answer, unfortunately, these choices are not available"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 18,
    "url": "https://www.examtopics.com/discussions/microsoft/view/3951-exam-70-761-topic-1-question-18-discussion/",
    "body": "You need to create an indexed view that requires logic statements to manipulate the data that the view displays.<br>Which two database objects should you use? Each correct answer presents a complete solution.<br>",
    "options": [
      "<span class=\"multi-choice-letter\" data-choice-letter=\"A\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\ta user-defined table-valued function",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"B\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tB.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\ta CRL function",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"C\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tC.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\ta stored procedure",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"D\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tD.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\ta user-defined scalar function"
    ],
    "answer": "AC",
    "answerDescription": "You can create a database object inside an instance of SQL Server that is programmed in an assembly created in the Microsoft .NET Framework common language runtime (CLR). Database objects that can leverage the rich programming model provided by the common language runtime include aggregate functions, functions, stored procedures, triggers, and types.",
    "votes": [],
    "comments": [
      {
        "date": "2019-08-22T16:38:00.000Z",
        "voteCount": 8,
        "content": "B,D\nhttps://www.briefmenow.org/microsoft/which-two-database-objects-should-you-use/"
      },
      {
        "date": "2020-12-31T17:38:00.000Z",
        "voteCount": 1,
        "content": "Definitely A &amp; D - both can be schema bound. You can't call a stored procedure from a view since it needs to be comprised of single SELECT statement."
      },
      {
        "date": "2020-12-13T12:53:00.000Z",
        "voteCount": 2,
        "content": "correct answers AD:\nA: table valued function can be called from index view TESTED.\nB: CRL doesnt exist, exist CLR\nC: Store procedure cant be called from view\nD: scalar function CAN be called from view"
      },
      {
        "date": "2020-07-30T22:03:00.000Z",
        "voteCount": 2,
        "content": "Correct Answer:  B,D"
      },
      {
        "date": "2020-12-13T12:18:00.000Z",
        "voteCount": 1,
        "content": "CRL function doesnt exist haha"
      },
      {
        "date": "2020-07-22T05:57:00.000Z",
        "voteCount": 2,
        "content": "A clustered index can't reference a TVF or MSTVF in the SELECT statement, but it can still be elsewhere such as in the WHERE clause. CLR functions aren't database objects, and stored procedures can't be invoked from a view, so I'd pick A,D. \n\nhttps://docs.microsoft.com/en-us/sql/relational-databases/views/create-indexed-views?view=sql-server-ver15"
      },
      {
        "date": "2020-06-28T16:36:00.000Z",
        "voteCount": 4,
        "content": "Answer: BD\nA: A table-valued function cannot be called from the indexed view\nC: The Stored procedure cannot be called inside of a View."
      },
      {
        "date": "2020-12-13T12:50:00.000Z",
        "voteCount": 1,
        "content": "are you tested? You can call from indexed view a table valued function... TESTED"
      },
      {
        "date": "2020-06-06T05:18:00.000Z",
        "voteCount": 3,
        "content": "I think it A and D (both of them have user-defined functions)\n\nYou can even use a user-defined function to query an indexed view, and with parameter\nsupport, improve its functionality."
      },
      {
        "date": "2020-04-03T09:13:00.000Z",
        "voteCount": 2,
        "content": "CRL function no existe. Es CLR FUNCTION"
      },
      {
        "date": "2020-01-09T19:15:00.000Z",
        "voteCount": 2,
        "content": "A,C\n\na user-defined table-valued function can return what we wanted expression values as long as we specify schemabinding option.\n\nstored procedure with table value variable as output parameter could also achieve the same purpose.\n\nB,D doesn't meet requirement since CLR function is not a DB object and scalar function didn't meet requirement of returning multiple rows."
      },
      {
        "date": "2019-10-16T12:18:00.000Z",
        "voteCount": 2,
        "content": "If you create a function with option \"SCHEMABINDING\" you can use user-defined function table and scalar"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 19,
    "url": "https://www.examtopics.com/discussions/microsoft/view/3281-exam-70-761-topic-1-question-19-discussion/",
    "body": "DRAG DROP -<br>You have two tables named UserLogin and Employee respectively.<br>You need to create a Transact-SQL script that meets the following requirements:<br>\u2711 The script must update the value of the IsDeleted column for the UserLogin table to 1 if the value of the Id column for the UserLogin table is equal to1.<br>\u2711 The script must update the value of the IsDeleted column of the Employee table to 1 if the value of the Id column is equal to 1 for the Employee table when an update to the UserLogin table throws an error.<br>\u2711 The error message \"No tables updated!\" must be produced when an update to the Employee table throws an error.<br>Which five Transact-SQL segments should you use to develop the solution? To answer, move the appropriate Transact-SQL segments from the list of Transact-<br>SQL segments to the answer area and arrange them in the correct order.<br>Select and Place:<br><img src=\"/assets/media/exam-media/02675/0004000001.png\" class=\"in-exam-image\"><br>",
    "options": [],
    "answer": "<img src=\"/assets/media/exam-media/02675/0004100001.png\" class=\"in-exam-image\">",
    "answerDescription": "A TRY block must be immediately followed by an associated CATCH block. Including any other statements between the END TRY and BEGIN CATCH statements generates a syntax error.<br>References:<br>https://msdn.microsoft.com/en-us/library/ms175976.aspx",
    "votes": [],
    "comments": [
      {
        "date": "2020-01-09T20:19:00.000Z",
        "voteCount": 18,
        "content": "Correct(and complete) solution should look like below:\nBEGIN TRY\n\tUPDATE dbo.UserLogin SET IsDeleted = 1 WHERE Id=1\nEND TRY\nBEGIN CATCH\n\n\tBEGIN TRY\n\t\tUPDATE dbo.Employee SET IsDeleted=1 WHERE Id=1\n\tEND TRY\n\tBEGIN CATCH\n\t\tRaiserror ('No tables updated!', 16, 1)\n\tEND CATCH\n\nEND CATCH"
      },
      {
        "date": "2019-08-06T12:09:00.000Z",
        "voteCount": 13,
        "content": "You should have the second TRY CATCH block nested inside the first CATCH block, in order to fulfill the condition: \n\"The script must update the value of the IsDeleted column of the Employee table to 1 if the value of the Id column is equal to 1 for the Employee table when an update to the UserLogin table throws an error.\""
      },
      {
        "date": "2020-12-31T17:52:00.000Z",
        "voteCount": 1,
        "content": "Agree that this answer from @Robintang0924 is correct using nested TRY/CATCH in CATCH block:\nBEGIN TRY\nUPDATE dbo.UserLogin SET IsDeleted = 1 WHERE Id=1\nEND TRY\nBEGIN CATCH\n\nBEGIN TRY\nUPDATE dbo.Employee SET IsDeleted=1 WHERE Id=1\nEND TRY\nBEGIN CATCH\nRaiserror ('No tables updated!', 16, 1)\nEND CATCH\nEND CATCH"
      },
      {
        "date": "2020-07-30T22:22:00.000Z",
        "voteCount": 1,
        "content": "(1) BEGIN TRY\nUPDATE dbo.UserLogin \nSET IsDeleted = 1 \nWHERE Id=1\nEND TRY\n\n(2) BEGIN CATCH\n\n(3) BEGIN TRY\nUPDATE dbo.Employee \nSET IsDeleted=1 \nWHERE Id=1\nEND TRY\n\n(4) BEGIN CATCH\nRaiserror ('No tables updated!', 16, 1)\nEND CATCH\n\n(5) END CATCH"
      },
      {
        "date": "2020-05-09T03:53:00.000Z",
        "voteCount": 7,
        "content": "The question is a little messy, there is no END TRY. And I found this which is the same question and seems to be ok: \nhttps://www.briefmenow.org/microsoft/which-five-transact-sql-segments-should-you-use-to-deve-6/\nSo, the corret answer must be:\n/*1*/\nbegin try \n\tupdate dbo.UserLogin\n\tSet IsDeleted = krugfogbeouegf\n\tWhere Id = 1\nend try\n/*2*/\nbegin catch \n/*3*/\n\tbegin try \n\t\tUpdate dbo.Employee \n\t\tSet IsDeleted = 1\n\t\tWhere Id = 1\n\tend try\n/*4*/\n\tbegin catch \n\t\tRAISERROR('No tables updated!',16,1); \n\tend catch \n/*5*/\nend catch"
      },
      {
        "date": "2020-10-19T10:58:00.000Z",
        "voteCount": 2,
        "content": "agreed that is the correct solution"
      },
      {
        "date": "2020-04-07T11:18:00.000Z",
        "voteCount": 4,
        "content": "It says to throw an error only for Employee table. \nThe bellow example is correct and tested. \nBEGIN TRY\n\tUPDATE dbo.UserLogin\n\tSET IsDeleted = 1\n\tWHERE Id = 1\nEND TRY\n\nBEGIN CATCH\nEND CATCH\n\nBEGIN TRY\n\tUPDATE dbo.Employee\n\tSET IsDeleted = 'a'\n\tWHERE Id = 1\nEND TRY \n\nBEGIN CATCH\nRAISERROR ('No table updated', 16, 1)\nEND CATCH"
      },
      {
        "date": "2020-03-11T03:49:00.000Z",
        "voteCount": 1,
        "content": "-Begin try update duo.employee ...\n-Begin Catch\n-Update dbo.Employee set isdeleted=1 where Id=1\n-Begin Catch Raiserror ('No tables update!', 16,1) end catch\n-End catch"
      },
      {
        "date": "2020-01-02T23:48:00.000Z",
        "voteCount": 1,
        "content": "begin try\n\tupdate\tdbo.userlogin ......\n\tbegin try\n\t\tupdate dbo.employee\n\tend try\n\tbegin catch\n\tend catch\nbegin catch\nraise\nend catch"
      },
      {
        "date": "2020-01-02T23:51:00.000Z",
        "voteCount": 3,
        "content": "sorry, updated:\n\nbegin try\n\tupdate\tdbo.userlogin ......\nbegin catch\n\tbegin try\n\t\tupdate dbo.employee\n\tend try\n\tbegin catch\n\t\traise\n\tend catch\nend catch"
      },
      {
        "date": "2019-10-08T23:14:00.000Z",
        "voteCount": 1,
        "content": "The right order is: 3 --&gt; 5 --&gt; 6 --&gt; 1 --&gt; \nYou have to use nested Try...Catch"
      },
      {
        "date": "2019-09-20T01:41:00.000Z",
        "voteCount": 9,
        "content": "I dont understand as there is no END TRY option?"
      },
      {
        "date": "2020-03-20T08:51:00.000Z",
        "voteCount": 4,
        "content": "yeah, seems they just messed up the question"
      },
      {
        "date": "2020-12-08T07:57:00.000Z",
        "voteCount": 1,
        "content": "Yes, options are not correct . I saw the correct one on another site"
      },
      {
        "date": "2019-09-04T03:08:00.000Z",
        "voteCount": 1,
        "content": "Is not clear WHEN update the Employee table. \nWHEN the UserLogin throw an error \nOR \nALWAYS: also when the userLogin update throw error"
      },
      {
        "date": "2019-09-02T13:17:00.000Z",
        "voteCount": 7,
        "content": "Both condition are fine. You could put something like this answer eg. :\n\nBEGIN TRY\n   SELECT 1/0\nEND TRY\nBEGIN CATCH\nEND CATCH\nBEGIN TRY\n\tSELECT 1/0  \nEND TRY\nBEGIN CATCH\n       RAISERROR ('NO TABLES UPDATED',16,1)\nEND CATCH\n\nAnd it II works fine\n\n\nOr You could do something like Houdinni says like eg :\n\n\n  BEGIN TRY\n\t\t\tSELECT 1/0\n  END TRY\n\n  BEGIN CATCH\n\t\t\n\t\t\t  BEGIN TRY\n\t\t\t\tSELECT 1/0  \n\t\t\t  END TRY\n\n\t\t\t  BEGIN CATCH\n\t\t\t  RAISERROR ('NO TABLES UPDATED',16,1)\n\t\t\t  END CATCH\n\n  END CATCH"
      },
      {
        "date": "2019-09-09T00:11:00.000Z",
        "voteCount": 3,
        "content": "BEGIN TRY\nSELECT 1/0\nEND TRY\nBEGIN CATCH\nEND CATCH\nBEGIN TRY\nSELECT 1/0\nEND TRY\nBEGIN CATCH\nRAISERROR ('NO TABLES UPDATED',16,1)\nEND CATCH\nabove answer is wrong because if condition is true than it gives error. ;\n\nBEGIN TRY\nSELECT 1/1\nEND TRY\nBEGIN CATCH\nEND CATCH\nBEGIN TRY\nSELECT 1/0\nEND TRY\nBEGIN CATCH\nRAISERROR ('NO TABLES UPDATED',16,1)\nEND CATCH\n\nbelow is ok\n\nBEGIN TRY\nSELECT 1/0\nEND TRY\n\nBEGIN CATCH\n\nBEGIN TRY\nSELECT 1/0\nEND TRY\n\nBEGIN CATCH\nRAISERROR ('NO TABLES UPDATED',16,1)\nEND CATCH\n\nEND CATCH"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 20,
    "url": "https://www.examtopics.com/discussions/microsoft/view/3778-exam-70-761-topic-1-question-20-discussion/",
    "body": "SIMULATION -<br>You work for an organization that monitors seismic activity around volcanos. You have a table named GroundSensors. The table stored data collected from seismic sensors. It includes the columns describes in the following table:<br><img src=\"/assets/media/exam-media/02675/0004200001.png\" class=\"in-exam-image\"><br>The database also contains a scalar value function named NearestMountain that returns the name of the mountain that is nearest to the sensor.<br>You need to create a query that shows the average of the normalized readings from the sensors for each mountain. The query must meet the following requirements:<br>\u2711 Include the average normalized readings and nearest mountain name.<br>\u2711 Exclude sensors for which no normalized reading exists.<br>\u2711 Exclude those sensors with value of zero for tremor.<br>Construct the query using the following guidelines:<br>\u2711 Use one part names to reference tables, columns and functions.<br>\u2711 Do not use parentheses unless required.<br>\u2711 Do not use aliases for column names and table names.<br>Do not surround object names with square brackets.<br><img src=\"/assets/media/exam-media/02675/0004200008.png\" class=\"in-exam-image\"><br><img src=\"/assets/media/exam-media/02675/0004300001.png\" class=\"in-exam-image\"><br>Part of the correct Transact-SQL has been provided in the answer area below. Enter the code in the answer area that resolves the problem and meets the stated goals or requirements. You can add code within the code that has been provided as well as below it.<br><img src=\"/assets/media/exam-media/02675/0004400001.jpg\" class=\"in-exam-image\"><br>Use the Check Syntax button to verify your work. Any syntax or spelling errors will be reported by line and character position.<br>",
    "options": [],
    "answer": "Please see explanation",
    "answerDescription": "SELECT Average(NormalizedReading), NearestMountain(SensorID)<br><br>FROM GroundSensors -<br>WHERE TREMOR IS NOT 0 AND NormalizedReading IS NOT NULL<br>GROUP BY NearestMountain(SensorID)<br>GROUP BY is a SELECT statement clause that divides the query result into groups of rows, usually for the purpose of performing one or more aggregations on each group. The SELECT statement returns one row per group.<br>References:<br>https://msdn.microsoft.com/en-us/library/ms177673.aspx",
    "votes": [],
    "comments": [
      {
        "date": "2019-11-01T16:31:00.000Z",
        "voteCount": 14,
        "content": "SELECT AVG(normalizedreading), NearestMountain(SensorID)\nFROM groundsensor\nWHERE normalizedreading is not null AND tremor &lt;&gt; 0 \nGROUP BY NearestMountain(SensorID)"
      },
      {
        "date": "2019-08-19T03:27:00.000Z",
        "voteCount": 13,
        "content": "\"WHERE TREMOR IS NOT 0...L\" &gt; should be \n\"WHERE TREMOR &lt;&gt; 0 \" instead, since you need to check for the value zero."
      },
      {
        "date": "2022-05-12T09:46:00.000Z",
        "voteCount": 1,
        "content": "is NearestMountain a function?"
      },
      {
        "date": "2020-11-12T10:40:00.000Z",
        "voteCount": 1,
        "content": "Could 'and tremor != 0' also be used here?"
      },
      {
        "date": "2020-09-13T23:20:00.000Z",
        "voteCount": 1,
        "content": "SELECT AVG(normalizedreading), NearestMountain(SensorID)\nFROM groundsensor\nWHERE normalizedreading is not null OR tremor &lt;&gt; 0\nGROUP BY NearestMountain(SensorID)"
      },
      {
        "date": "2020-08-29T06:08:00.000Z",
        "voteCount": 1,
        "content": "Select\navg(normalizedreading), NearestMountain(Location)\nfrom groundsensor\nwhere normalizedreading is not null AND tremor &lt;&gt; 0\ngroup by NearestMountain(Location)"
      },
      {
        "date": "2020-03-02T10:25:00.000Z",
        "voteCount": 1,
        "content": "I'm not sure you actually need the NULL check b/c AVG seems to ignore these\nhttps://stackoverflow.com/questions/22220449/sql-avg-with-null-values"
      },
      {
        "date": "2020-02-09T07:10:00.000Z",
        "voteCount": 1,
        "content": "select avg(normalisedReading), nearestmountain(SensorId)\nfrom\nGround sensors\nwhere tremorID &lt;&gt; 0 and normalisedreading is not null\norder by nearestmountain(SensorId)"
      },
      {
        "date": "2020-02-07T06:40:00.000Z",
        "voteCount": 2,
        "content": "select NearestMountain(SensorID),Avg(NormalizeReading)\nfrom GroundSensors\nwhere NormalizedReading is null) or (Tremor=0)\ngroup by NearestMountain(SensorID)"
      },
      {
        "date": "2020-01-12T09:22:00.000Z",
        "voteCount": 4,
        "content": "imo, it's logical to use Location to find the nearest mountain..."
      },
      {
        "date": "2020-05-09T04:34:00.000Z",
        "voteCount": 2,
        "content": "yes but it is calculated in NearestMountain Function through Sensor ID"
      },
      {
        "date": "2019-09-21T22:05:00.000Z",
        "voteCount": 6,
        "content": "Answer should be -\nSelect\navg(normalizedreading), NearestMountain(SensorID)\nfrom groundsensor\nwhere normalizedreading is not null or tremor &lt;&gt; 0 \ngroup by NearestMountain(SensorID)"
      },
      {
        "date": "2020-02-10T07:32:00.000Z",
        "voteCount": 5,
        "content": "this should be AND statement"
      },
      {
        "date": "2019-09-04T03:16:00.000Z",
        "voteCount": 5,
        "content": "SELECT Average(NormalizedReading), NearestMountain(SensorID)\nmust be\nSELECT AVG(NormalizedReading), NearestMountain(SensorID)"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 21,
    "url": "https://www.examtopics.com/discussions/microsoft/view/13564-exam-70-761-topic-1-question-21-discussion/",
    "body": "DRAG DROP -<br>You have a table named HR.Employees as shown in the exhibit. (Click the exhibit button.)<br><img src=\"/assets/media/exam-media/02675/0004500001.jpg\" class=\"in-exam-image\"><br>You need to write a query that will change the value of the job title column to Customer Representative for any employee who lives in Seattle and has a job title of<br>Sales Representative. If the employee does not have a manager defined, you must not change the title.<br>Which three Transact-SQL segments should you use to develop the solution? To answer, move the appropriate Transact-SQL segments from the list of Transact-<br>SQL segments to the answer area and arrange them in the correct order.<br>Select and Place:<br><img src=\"/assets/media/exam-media/02675/0004600001.png\" class=\"in-exam-image\"><br>",
    "options": [],
    "answer": "<img src=\"/assets/media/exam-media/02675/0004600002.png\" class=\"in-exam-image\">",
    "answerDescription": "References:<br>https://msdn.microsoft.com/en-us/library/ms177523.aspx",
    "votes": [],
    "comments": [
      {
        "date": "2020-02-07T08:29:00.000Z",
        "voteCount": 6,
        "content": "update Employees  set title='Custom Representative' \nwhere city ='Seatle' and title = 'Sales Representative'\nand mgrid is not null"
      },
      {
        "date": "2020-07-10T11:10:00.000Z",
        "voteCount": 2,
        "content": "Correct"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 22,
    "url": "https://www.examtopics.com/discussions/microsoft/view/13565-exam-70-761-topic-1-question-22-discussion/",
    "body": "HOTSPOT -<br>You have the following Transact-SQL query:<br><img src=\"/assets/media/exam-media/02675/0004700001.png\" class=\"in-exam-image\"><br>What type of functions are used in the query? To answer, select the appropriate options in the answer area.<br>NOTE: Each correct selection is worth one point.<br>Hot Area:<br><img src=\"/assets/media/exam-media/02675/0004800001.png\" class=\"in-exam-image\"><br>",
    "options": [],
    "answer": "<img src=\"/assets/media/exam-media/02675/0004900001.jpg\" class=\"in-exam-image\">",
    "answerDescription": "Box 1: Scalar -<br>The return value of a function can either be a scalar (single) value or a table.<br><br>Box 2: Table-Valued -<br>The APPLY operator allows you to invoke a table-valued function for each row returned by an outer table expression of a query. The table-valued function acts as the right input and the outer table expression acts as the left input. The right input is evaluated for each row from the left input and the rows produced are combined for the final output. The list of columns produced by the APPLY operator is the set of columns in the left input followed by the list of columns returned by the right input.<br>References:<br>https://msdn.microsoft.com/en-us/library/ms186755.aspx<br>https://technet.microsoft.com/en-us/library/ms175156(v=sql.105).aspx",
    "votes": [],
    "comments": [
      {
        "date": "2020-02-07T08:36:00.000Z",
        "voteCount": 7,
        "content": "The first one is UDF Scalar because only returns a value , whereas the second one is a Table-based function which returns a table"
      },
      {
        "date": "2020-11-20T10:40:00.000Z",
        "voteCount": 1,
        "content": "The answer is correct, CROSS APPLY is used to make a Table coexist with a TABLE FUNCTION, in the SELECT you can only use a SCALAR FUNCTION.\nhttps://www.sqlshack.com/es/la-diferencia-entre-cross-apply-y-outer-apply-en-sql-server/"
      },
      {
        "date": "2020-02-07T08:38:00.000Z",
        "voteCount": 3,
        "content": "I meant the second onse is table-valued instead of table-based"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 23,
    "url": "https://www.examtopics.com/discussions/microsoft/view/7426-exam-70-761-topic-1-question-23-discussion/",
    "body": "DRAG DROP -<br>You have a database that includes the following tables:<br><img src=\"/assets/media/exam-media/02675/0005000001.jpg\" class=\"in-exam-image\"><br>You need to create a list of all customer IDs and the date of the last order that each customer placed. If the customer has not placed any orders, you must return the date January 1, 1900. The column names must be CustomerID and LastOrderDate.<br>Which four Transact-SQL segments should you use to develop the solution? To answer, move the appropriate Transact-SQL segments from the list of Transact-<br>SQL segments to the answer area and arrange them in the correct order.<br>Select and Place:<br><img src=\"/assets/media/exam-media/02675/0005100001.png\" class=\"in-exam-image\"><br>",
    "options": [],
    "answer": "<img src=\"/assets/media/exam-media/02675/0005200001.png\" class=\"in-exam-image\">",
    "answerDescription": "Box 1: SELECT..COALESCE\"\u00a6<br>The COALESCE function evaluates the arguments in order and returns the current value of the first expression that initially does not evaluate to NULL.<br>Box 2: ..LEFT OUTER JOIN..<br>The LEFT JOIN (LEFT OUTER JOIN) keyword returns all rows from the left table (table1), with the matching rows in the right table (table2). The result is NULL in the right side when there is no match. A customer might have no orders so the right table must be allowed have a NULL value.<br><br>Box 3: ON c.custid = o.custid -<br>We JOIN on the custID column, which is available in both tables.<br><br>Box 4: GROUP BY c.custid -<br>References:<br>https://technet.microsoft.com/en-us/library/ms189499(v=sql.110).aspx http://www.w3schools.com/sql/sql_join_left.asp",
    "votes": [],
    "comments": [
      {
        "date": "2020-01-12T19:15:00.000Z",
        "voteCount": 5,
        "content": "2 issues here for Fabzo's question:\n\n1. From data meaning and group by function perspective: we group by only custid column and use aggregate function on last order date means: for those records with same custid(in the same group), find me (only one) max date so our final result would be only one max date for each custid. If we group by both custid and orderdate column then for every custid we will get many order/date back which is not what we wanted -- we only need last order of customer.\n\n2. From SQL syntax perspective, we can't refer to an alias(like LastOrderDate) in group by function in whatever situation because alias was evaluated/assigned value AFTER group by clause thus it will error out regardless if it makes sense from data meaning perspective or not."
      },
      {
        "date": "2020-07-29T13:43:00.000Z",
        "voteCount": 1,
        "content": "so answer is correct in the box right?"
      },
      {
        "date": "2020-11-05T20:18:00.000Z",
        "voteCount": 1,
        "content": "Yes, it's right"
      },
      {
        "date": "2019-11-01T16:58:00.000Z",
        "voteCount": 2,
        "content": "We are not grouping by LastOrderDate because it is an alias of an aggregate function."
      },
      {
        "date": "2019-10-29T05:00:00.000Z",
        "voteCount": 1,
        "content": "WHY or we grouping by Custid and not LastOrderDate"
      },
      {
        "date": "2020-05-08T05:05:00.000Z",
        "voteCount": 3,
        "content": "You need group by custid because the question asks for the last order that each customer placed"
      },
      {
        "date": "2020-11-20T13:29:00.000Z",
        "voteCount": 1,
        "content": "I must list custids according to the quiz requirements , unique customers  and their after that their last orderdate"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 24,
    "url": "https://www.examtopics.com/discussions/microsoft/view/4680-exam-70-761-topic-1-question-24-discussion/",
    "body": "HOTSPOT -<br>You run the following Transact-SQL statement:<br><img src=\"/assets/media/exam-media/02675/0005300001.png\" class=\"in-exam-image\"><br>You need to ensure that you can insert data into the table.<br>What are the characteristics of the data? To answer, select the appropriate options in the answer area.<br>Hot Area:<br><img src=\"/assets/media/exam-media/02675/0005400001.png\" class=\"in-exam-image\"><br>",
    "options": [],
    "answer": "<img src=\"/assets/media/exam-media/02675/0005500001.jpg\" class=\"in-exam-image\">",
    "answerDescription": "Box 1: custid -<br>IDENTITY indicates that the new column is an identity column. When a new row is added to the table, the Database Engine provides a unique, incremental value for the column. Identity columns are typically used with PRIMARY KEY constraints to serve as the unique row identifier for the table.<br><br>Box2: postalcode -<br>postalcode is declared as NOT NULL, which means that a value must be inserted.<br><br>Box 3: region -<br>Fax is also a correct answer. Both these two columns are declared as NULL, which means that data entry is optional.<br>References:<br>https://msdn.microsoft.com/en-us/library/ms174979.aspx",
    "votes": [],
    "comments": [
      {
        "date": "2020-02-08T09:06:00.000Z",
        "voteCount": 9,
        "content": "Values cannot be entered into this column: custid (is generated automatically)\nA must value must be inserted into this column: postalcode\nData entry into this column is optional : fax and region"
      },
      {
        "date": "2020-05-09T05:42:00.000Z",
        "voteCount": 4,
        "content": "yes, the last has 2 options :/"
      },
      {
        "date": "2019-09-04T03:26:00.000Z",
        "voteCount": 5,
        "content": "For optional column also region is a good answer"
      },
      {
        "date": "2020-12-31T18:25:00.000Z",
        "voteCount": 1,
        "content": "1. Custid - Identity (can't insert unless IDENTITY_INSERT ON)\n2. Postal Code - NOT NULL\n3. Fax &amp; Region NULL\n\nON PRIMARY is a red herring - just creating on primary file group"
      },
      {
        "date": "2020-01-12T19:48:00.000Z",
        "voteCount": 1,
        "content": "By default, identity column would be automatically populated according to column increment setting and it can't be inserted/updated. Unless if you manually set Identify_insert on in some situations, e.g. if you want to copy all current values from existing table to this table and you still want to use old identity values instead of generating new identity for each inserted rows. \n\nhttps://docs.microsoft.com/en-us/sql/t-sql/statements/set-identity-insert-transact-sql?view=sql-server-ver15"
      },
      {
        "date": "2019-09-04T12:16:00.000Z",
        "voteCount": 1,
        "content": "Yes and I think for \"..must be inserted\" is for custid also.\ncause is marked as not null and we cannot insert any value without filling identity property"
      },
      {
        "date": "2019-10-08T00:37:00.000Z",
        "voteCount": 4,
        "content": "Custid is auto inserted by identity func."
      },
      {
        "date": "2019-10-16T12:30:00.000Z",
        "voteCount": 1,
        "content": "Almosawi  is correct"
      },
      {
        "date": "2020-12-13T15:49:00.000Z",
        "voteCount": 1,
        "content": "you cant insert values in custid..."
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 25,
    "url": "https://www.examtopics.com/discussions/microsoft/view/3287-exam-70-761-topic-1-question-25-discussion/",
    "body": "SIMULATION -<br>You create a table named Sales.Orders by running the following Transact-SQL statement:<br><img src=\"/assets/media/exam-media/02675/0005600001.png\" class=\"in-exam-image\"><br>You need to write a query that meets the following requirements:<br>\u2711 removes orders from the table that were placed before January 1, 2012<br>\u2711 uses the date format of YYYYMMDD<br>\u2711 ensures that the order has been shipped before deleting the record<br>Construct the query using the following guidelines:<br>\u2711 use one-part column names and two-part table names<br>\u2711 do not use functions<br>\u2711 do not surround object names with square brackets<br>\u2711 do not use variables<br>do not use aliases for column names and table names<br><img src=\"/assets/media/exam-media/02675/0005600009.png\" class=\"in-exam-image\"><br><img src=\"/assets/media/exam-media/02675/0005700001.png\" class=\"in-exam-image\"><br>Part of the correct Transact-SQL has been provided in the answer area below. Enter the code in the answer area that resolves the problem and meets the stated goals or requirements. You can add code within the code that has been provided as well as below it.<br><img src=\"/assets/media/exam-media/02675/0005800001.jpg\" class=\"in-exam-image\"><br>Use the Check Syntax button to verify your work. Any syntax or spelling errors will be reported by line and character position.<br>",
    "options": [],
    "answer": "See the solution below",
    "answerDescription": "DELETE FROM Sales.Orders -<br>WHERE OrderDate &lt; '2012-01-01' AND ShippedDate NOT NULL<br>References:<br>https://msdn.microsoft.com/en-us/library/ms189835.aspx<br>https://msdn.microsoft.com/en-us/library/bb630352.aspx",
    "votes": [],
    "comments": [
      {
        "date": "2019-08-06T13:04:00.000Z",
        "voteCount": 33,
        "content": "DELETE FROM Sales.Orders\nWHERE OrderDate &lt; '20120101' AND ShippedDate IS NOT NULL"
      },
      {
        "date": "2020-03-20T04:11:00.000Z",
        "voteCount": 2,
        "content": "with a small correction: dbo.Sales.Orders because of \n\"use one-part column names and two-part table names\""
      },
      {
        "date": "2020-03-21T04:57:00.000Z",
        "voteCount": 9,
        "content": "This is misleading.\nSales.Orders is already a 2 part table name which consist of both the SchemaName.TableName."
      },
      {
        "date": "2020-11-20T13:35:00.000Z",
        "voteCount": 1,
        "content": "Should be 'ShippedDate IS NOT NULL'  instead of 'ShippedDate NOT NULL'"
      },
      {
        "date": "2020-10-07T11:31:00.000Z",
        "voteCount": 4,
        "content": "drop table if exists Orders\nCreate Table Orders \n(\n\tOrderID int not null,\n\tOrderDate date null,\n\tShippedDate date null,\n\tStatus varchar(20),\n\tConstraint PK_Orders primary key clustered (OrderID)\n)\n\ninsert into Orders values (1011,'2020-05-14','2020-05-25','Shipped'),(1012,'2018-02-04','2020-01-25','Shipped'),(1017,'2011-05-14','2011-12-18','Shipped'),\n(1013,'2017-01-14','2018-01-05','Cancelled'),(1014,null,'2020-12-25','Pending'),(1015,'2000-11-14',null,'Shipped'),(1016,'2011-05-14',null,'Shipped')\n\n\ndelete from dbo.Orders\nwhere OrderDate &lt; '20120101'\nand ShippedDate is not null"
      },
      {
        "date": "2020-05-09T06:25:00.000Z",
        "voteCount": 1,
        "content": "or can be ShippedDate &lt; GETDATE() instead of ShippedDate IS NOT NULL"
      },
      {
        "date": "2020-05-12T08:44:00.000Z",
        "voteCount": 3,
        "content": "But it says not to use functions.\n\nAdditionally, I wonder what the Status column consists of...  Perhaps we could use Status = 'Shipped'"
      },
      {
        "date": "2020-09-16T06:49:00.000Z",
        "voteCount": 1,
        "content": "No we have to go with Shippeddate column. As we are just working with the definition of the column,  we never know what values the column Status holds.(Ex it could be 'Shipped' or 'Yes' or '1' or anything.)"
      },
      {
        "date": "2020-09-16T06:50:00.000Z",
        "voteCount": 1,
        "content": "**definition of the table"
      },
      {
        "date": "2019-10-29T05:15:00.000Z",
        "voteCount": 3,
        "content": "I think both would be correct \"IS NOT NULL\" or \"NOT NULL\""
      },
      {
        "date": "2020-02-10T07:46:00.000Z",
        "voteCount": 5,
        "content": "No, sql don't have command \"not null\" only \"is not null\"\nAlso, we need use YYYYMMDD Format, like Houdinni says - '20120101'"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 26,
    "url": "https://www.examtopics.com/discussions/microsoft/view/5427-exam-70-761-topic-1-question-26-discussion/",
    "body": "SIMULATION -<br>You have a database that contains the following tables.<br><img src=\"/assets/media/exam-media/02675/0005900001.jpg\" class=\"in-exam-image\"><br>You need to create a query that lists the lowest-performing salespersons based on the current year-to-date sales period. The query must meet the following requirements:<br>\u2711 Return a column named Fullname that includes the salesperson FirstName, a space, and then LastName.<br>\u2711 Include the current year-to-date sales for each salesperson.<br>\u2711 Display only data for the three salespersons with the lowest year-to-year sales values.<br>\u2711 Exclude salespersons that have no value for TerritoryID.<br>Construct the query using the following guidelines:<br>\u2711 Use the first letter of a table name as the table alias.<br>\u2711 Use two-part column names.<br>\u2711 Do not surround object names with square brackets.<br>\u2711 Do not use implicit joins.<br>\u2711 Use only single quotes for literal text.<br>Use aliases only if required.<br><img src=\"/assets/media/exam-media/02675/0005900011.png\" class=\"in-exam-image\"><br><img src=\"/assets/media/exam-media/02675/0006000001.png\" class=\"in-exam-image\"><br>Part of the correct Transact-SQL has been provided in the answer area below. Enter the code in the answer area that resolves the problem and meets the stated goals or requirements. You can add code within the code that has been provided as well as below it.<br><img src=\"/assets/media/exam-media/02675/0006100001.jpg\" class=\"in-exam-image\"><br>Use the Check Syntax button to verify your work. Any syntax or spelling errors will be reported by line and character position.<br>",
    "options": [],
    "answer": "Please see explanation",
    "answerDescription": "<img src=\"/assets/media/exam-media/02675/0006100002.png\" class=\"in-exam-image\"><br><br>On ordering: ASC | DESC -<br>Specifies that the values in the specified column should be sorted in ascending or descending order. ASC sorts from the lowest value to highest value. DESC sorts from highest value to lowest value. ASC is the default sort order. Null values are treated as the lowest possible values.<br>References:<br>https://msdn.microsoft.com/en-us/library/ms189463.aspx",
    "votes": [],
    "comments": [
      {
        "date": "2019-09-19T00:18:00.000Z",
        "voteCount": 15,
        "content": "Should be ON S.PersonID = P.PersonID"
      },
      {
        "date": "2020-01-03T00:29:00.000Z",
        "voteCount": 11,
        "content": "select  top(3) concat(p.FirstName, ' ', p.lastname) as FullName, s.SalesYTD as SalesYTD\nfrom\tSalesPerson as s \n\t\tjoin Person as p on(s.PersonId = p.PersonId)\nwhere  s.TerritoryID is not null\norder by s.SalesYTD"
      },
      {
        "date": "2020-05-12T08:54:00.000Z",
        "voteCount": 3,
        "content": "The default order by is already ASC, so I don't think we need to include that"
      },
      {
        "date": "2020-12-31T18:39:00.000Z",
        "voteCount": 1,
        "content": "Important to use CONCAT or get NULL. This fits....\nSELECT TOP(3) CONCAT(p.FirstName, ' ', p.lastname) AS FullName, s.SalesYTD\nFROM Person as p\nINNER JOIN SalesPerson as s\nON p.PersonId = s.SalesPersonId\nwhere s.TerritoryID is not null\norder by s.SalesYTD"
      },
      {
        "date": "2020-08-09T00:32:00.000Z",
        "voteCount": 1,
        "content": "Ok, I understand now, the insturctions force to use SalespersonID and PersonID, no\nS.PersonID = P.PersonID"
      },
      {
        "date": "2020-11-20T13:47:00.000Z",
        "voteCount": 1,
        "content": "You cannot do that these are to differnt columns"
      },
      {
        "date": "2020-07-31T00:19:00.000Z",
        "voteCount": 1,
        "content": "SELECT Top(3) CONCAT(p.FirstName+' '+p.lastname) AS FullName, s.SalesYTD\nFROM Person as p\nINNER JOIN SalesPerson as s\nON p.PersonId = s.SalesPersonId\nwhere s.TerritoryID is not null\norder by s.SalesYTD\n\nNOTE: Use aliases only if required.\nSalespersonID and PersonID are only connected through pk &amp; fk."
      },
      {
        "date": "2020-07-31T00:03:00.000Z",
        "voteCount": 1,
        "content": "SELECT  Top(3)  CONCAT(p.FirstName, ' ', p.lastname) AS FullName, s.SalesYTD \nFROM Person as p\nINNER JOIN SalesPerson as s \nON p.PersonId = s.SalesPersonId\nwhere s.TerritoryID is not null\norder by s.SalesYTD\n\nNOTE: Use aliases only if required.\nSalespersonID and PersonID are only connected through pk &amp; fk."
      },
      {
        "date": "2020-11-20T13:46:00.000Z",
        "voteCount": 3,
        "content": "Sorry, You have a mistake in 'ON' clause. Must be  ON p.PersonID =s.PersonID"
      },
      {
        "date": "2020-05-19T11:45:00.000Z",
        "voteCount": 1,
        "content": "You guys are joining on the wrong key. Notice that there is no PersonID in Salesperson table, only SalesPersonID."
      },
      {
        "date": "2020-06-30T18:03:00.000Z",
        "voteCount": 1,
        "content": "There is a personID in both tables"
      },
      {
        "date": "2020-07-05T22:33:00.000Z",
        "voteCount": 1,
        "content": "forget about he key,,, the question is asking to fill-in-the-blank on the select and where cause."
      },
      {
        "date": "2020-01-12T20:28:00.000Z",
        "voteCount": 3,
        "content": "Besides correct join column, we should also consider possible null values since there is no clear declaration of those columns:\n\n1. NULLability of firstname and lastname, any of null values in these 2 columns could result in a null full name which is NOT what we wanted, Moehijawe already provided a good solution of using concat which could safely take care of null and yield meaning result of concated string.\n\n2. SalesYTD, if it contains null value, then we might see first 3 rows as null value since null is considered the lowest value. \n\nAbove being said, below SQL should be a more complete solution to question(I wish I could come up with something in an elegant way like 'order by s.SalesYTD nulls last' but unfortunately SQL server doesn't support this ANSI SQL feature ):\n\nselect top(3) concat(p.FirstName, ' ', p.lastname) as FullName, s.SalesYTD as SalesYTD\nfrom SalesPerson as s\njoin Person as p on(s.PersonId = p.PersonId)\nwhere s.TerritoryID is not null\nORDER BY \n   CASE \n        WHEN s.SalesYTD IS NULL THEN 1\n        ELSE 0\n   END, s.SalesYTD;"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 27,
    "url": "https://www.examtopics.com/discussions/microsoft/view/3779-exam-70-761-topic-1-question-27-discussion/",
    "body": "SIMULATION -<br>You have a database that contains the following tables.<br><img src=\"/assets/media/exam-media/02675/0006200001.jpg\" class=\"in-exam-image\"><br>You need to create a query that lists all complaints from the Complaints table, and the name of the person handling the complaints if a person is assigned. The<br>ComplaintID must be displayed first, followed by the person name.<br>Construct the query using the following guidelines:<br>\u2711 Use two-part column names.<br>\u2711 Use one-part table names.<br>\u2711 Do not use aliases for column names or table names.<br>\u2711 Do not use Transact-SQL functions.<br>\u2711 Do not use implicit joins.<br>\u2711 Do not surround object names with square brackets.<br>Part of the correct Transact-SQL has been provided in the answer area below. Enter the code in the answer area that resolves the problem and meets the stated goals or requirements. You can add code within the code that has been provided as well as below it.<br><img src=\"/assets/media/exam-media/02675/0006300001.png\" class=\"in-exam-image\"><br><img src=\"/assets/media/exam-media/02675/0006400001.jpg\" class=\"in-exam-image\"><br>Use the Check Syntax button to verify your work. Any syntax or spelling errors will be reported by line and character position.<br>",
    "options": [],
    "answer": "Please see explanation",
    "answerDescription": "<img src=\"/assets/media/exam-media/02675/0006400002.png\" class=\"in-exam-image\"><br>References:<br>https://technet.microsoft.com/en-us/library/ms190014(v=sql.105).aspx",
    "votes": [],
    "comments": [
      {
        "date": "2019-09-05T04:33:00.000Z",
        "voteCount": 11,
        "content": "EXAMPLE CODE AND TWO WAYS OF SOLUTION\n\n\n\nCREATE TABLE #PERSONS (\nPERSONID INT, NAME VARCHAR(15)\n)\nCREATE TABLE #CONTACTS (\nPERSONID INT, COMPLAINTID INT\n)\nCREATE TABLE #COMPLAINTS (\nCOMPLAINTID INT,\nCOMPLAINT VARCHAR(10)\n)\n\n\nINSERT INTO #PERSONS (PERSONID, NAME) VALUES (1, 'BARTEK'), (2,'KASIA'), (3,'TOMEK'),(4,'MARTA')\nINSERT INTO #CONTACTS (PERSONID, COMPLAINTID) VALUES (1,1),(2,2),(3,3),(4,4)\nINSERT INTO #COMPLAINTS (COMPLAINTID, COMPLAINT) VALUES (1,'SKARGA'),(2,'SKARGA'),(3,'SKARGA'),(3,'SKARGA'),(4,'SKARGA'),(5,'SKARGA'),(6,'SKARGA')\n\n\nSELECT \nA.COMPLAINTID,C.NAME\n\nFROM #COMPLAINTS AS A\nLEFT JOIN #CONTACTS AS B\nON A.COMPLAINTID = B.COMPLAINTID\n\nLEFT JOIN #PERSONS AS C\nON C.PERSONID = B.PERSONID\n\n\nSELECT \nC.COMPLAINTID,A.NAME\n\nFROM #PERSONS AS A\nJOIN #CONTACTS AS B\n\nON A.PERSONID = B.PERSONID\n\nRIGHT JOIN #COMPLAINTS AS C\nON B.COMPLAINTID = C.COMPLAINTID"
      },
      {
        "date": "2019-09-11T08:18:00.000Z",
        "voteCount": 11,
        "content": "I do not see any ComplaintID column in Contacts table.. So the only way to link Contact table to Complaints table is Complaint column"
      },
      {
        "date": "2020-12-31T19:02:00.000Z",
        "voteCount": 1,
        "content": "Joins are processed left-to-right so you need to maintain LEFT JOIN on the second join or you will lose the records you preserved on the first LEFT JOIN:\n\nSELECT COMPLAINT.COMPLAINTID,PERSONS.NAME\n\nFROM COMPLAINTS\nLEFT JOIN CONTACTS\nON COMPLAINTS.COMPLAINTID = CONTACTS.COMPLAINT\n\nLEFT JOIN PERSONS\nON CONTACTS.PERSONID = PERSONS.PERSONID"
      },
      {
        "date": "2020-12-26T20:36:00.000Z",
        "voteCount": 1,
        "content": "This will give you the exact answer.\n\nSelect Complaints.ComplaintID, Shivani.Persons.name\nfrom Complaints\nLeft join Shivani.Contacts on (Complaints.ComplaintID = Contacts.ComplaintID)\nINNER join  Persons on (Shivani.Contacts.PersonID = Persons.PersonID);"
      },
      {
        "date": "2020-12-23T14:46:00.000Z",
        "voteCount": 1,
        "content": "so what is the correct join to use? are the LEFT JOIN and INNER JOIN?"
      },
      {
        "date": "2020-12-13T16:41:00.000Z",
        "voteCount": 1,
        "content": "The joins are providen... you dont need invent the wheels with \"its left join\" \"its right joins\" bla bla..."
      },
      {
        "date": "2020-12-14T11:12:00.000Z",
        "voteCount": 1,
        "content": "They're not provided. In the exam you will be expected to state the join."
      },
      {
        "date": "2020-11-20T14:04:00.000Z",
        "voteCount": 1,
        "content": "should be inner join between person and contacts and right outer join between contacts and complaints"
      },
      {
        "date": "2020-11-20T13:59:00.000Z",
        "voteCount": 1,
        "content": "the question is : if there personID when there is no name? If yes we don't need outer joins, but if there is no personID then we need left outer join between Person and Contacts tables. Also there must be ComplaintID instead of Complaint in Contacts. I think it's just a mistake , besides the data type is INT for 'Complaint' so it's definitely 'ComplaintID"
      },
      {
        "date": "2020-11-17T11:58:00.000Z",
        "voteCount": 3,
        "content": "No needed RIGHT/LEFT JOIN\nThe table Contacts not allowing to put NULL values in both id (personid, complaintid) so JOIN (INNER JOIN) is ok for that. The answer is correct"
      },
      {
        "date": "2020-08-29T06:26:00.000Z",
        "voteCount": 1,
        "content": "The Complaint field under Contacts has 'int' datatype. so its the actual link to the Complaints.ComplaintID.\n\n\nSELECT Complaints.ComplaintID, Persons.Name \nFROM Complaints\nLEFT JOIN Contacts ON Contacts.Complaint = Complaints.ComplaintID\nLEFT JOIN Persons ON Persons.PersonID = Contacts.PersonID"
      },
      {
        "date": "2020-07-05T22:44:00.000Z",
        "voteCount": 1,
        "content": "Isn't it the \"Join\" are already provided?  we just need to fill in the rest right?"
      },
      {
        "date": "2020-07-31T00:32:00.000Z",
        "voteCount": 2,
        "content": "1 SELECT Complaints.ComplaintID, Persons.Name\n2 FROM Complaints\n4 LEFT OUTER JOIN Contacts ON Complaints.ComplaintID = Contacts.ComplaintID\n5 LEFT OUTER JOIN Persons ON Contacts.PersonID = Persons.PersonID"
      },
      {
        "date": "2020-01-12T21:45:00.000Z",
        "voteCount": 7,
        "content": "This question seems a bit ambiguous especially for PK/FK naming convention. \n1. Assume we have 1 to M relationship between Complaints and Contacts based on Complaints.ComplaintId(PK) and Contacts.Complaint(FK).\n2. Assume we have 1 to M relationship between Persons and Contacts based on Persons.PersonID(PK) and Contacts.PersonID(FK).\n3. You need to list all complaints from the Complaints table, and the name of the person handling the complaints if a person is assigned. \n\nBased on above assumption, below left join SQL start from Complaints table should work -- it will list every ComplaintID in\nComplaints table but correlated Persons name might be null:\n\nselect Complaints.ComplaintID, Persons.name\nfrom Complaints\nleft join Contacts on (Complaints.ComplaintID = Contacts.Complaint)\nleft join Persons on (Contacts.PersonID = Persons.PersonID);"
      },
      {
        "date": "2020-05-09T07:22:00.000Z",
        "voteCount": 1,
        "content": "or INNER JOIN second join"
      },
      {
        "date": "2020-05-19T11:58:00.000Z",
        "voteCount": 4,
        "content": "If you use INNER JOIN after an OUTER JOIN, it will nullifies the outer part of the join and convert it into an INNER JOIN."
      },
      {
        "date": "2020-05-28T00:38:00.000Z",
        "voteCount": 2,
        "content": "No, you are wrong Anette, sorry. It says:\n1. \"create a query that lists *all* complaints from the Complaints table\".\n2. \"and (\"if available\") the name of the person handling the complaints if a person is assigned\"\n\n(2) doesn't mean to filter the result from (1), but showing a NULL value when having no person assigned. A classical LEFT/RIGHT OUTER JOIN. Otherwise (1) could not be fulfilled."
      },
      {
        "date": "2020-01-03T00:34:00.000Z",
        "voteCount": 10,
        "content": "select\tComplaints.ComplaintID, Persons.name\nfrom    Complaints \n\t\tleft join Contacts on (Complaints.ComplaintID = Contacts.Complaint)\n\t\tleft join Persons on (Contacts.PersonID = Persons.PersonID)"
      },
      {
        "date": "2020-05-09T07:20:00.000Z",
        "voteCount": 1,
        "content": "the second join must be Inner join because it says \"the name of the person\nhandling the complaints if a person is assigned\"\nso, only if a person is assigned, with left join it takes even if a person is not assigned"
      },
      {
        "date": "2020-09-16T13:56:00.000Z",
        "voteCount": 1,
        "content": "If the first left join matches lines means that a personid and complaint should be populated fields as are \"not nulls\" - so lets inner or left same records will showed..."
      },
      {
        "date": "2020-09-30T04:54:00.000Z",
        "voteCount": 1,
        "content": "\"All compliants\" should be listed even though person is not assigned, so it should remain LEFT JOIN in this case"
      },
      {
        "date": "2019-11-06T09:54:00.000Z",
        "voteCount": 6,
        "content": "The exercise says \"All Complaints and the person if assigned\". Meaning the first table should be Complaints and the connection to the others must be LEFT JOIN"
      },
      {
        "date": "2020-05-09T07:17:00.000Z",
        "voteCount": 2,
        "content": "yes and the second JOIN must be inner join"
      },
      {
        "date": "2019-10-29T22:31:00.000Z",
        "voteCount": 10,
        "content": "Would this also be correct: SELECT Complaints.ComplaintID, Persons.Name\nFrom Complaints\nINNER JOIN\nContacts ON Contacts.Complaints=ComplaintsID\nINNER JOIN \nPersons ON Persons.PersonID=Contacts.PersonID\nORDER BY Complaints.ComplaintID, Persons.Name"
      },
      {
        "date": "2019-09-11T09:58:00.000Z",
        "voteCount": 3,
        "content": "But i would rather say that this is a question error and Complaint column should be ComplaintID"
      },
      {
        "date": "2019-08-19T03:49:00.000Z",
        "voteCount": 8,
        "content": "Update: \nFirst JOIN =&gt; INNER JOIN \nSecond JOIN =&gt; RIGHT OUTER JOIN (since all complaints should be displayed)"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 28,
    "url": "https://www.examtopics.com/discussions/microsoft/view/3780-exam-70-761-topic-1-question-28-discussion/",
    "body": "You have a database that includes the tables shown in the exhibit. (Click the exhibit button.)<br><img src=\"/assets/media/exam-media/02675/0006500001.jpg\" class=\"in-exam-image\"><br>You need to create a list of all customers, the order ID for the last order that the customer placed, and the date that the order was placed. For customers who have not placed orders, you must substitute a zero for the order ID and 01/01/1990 for the date.<br>Which Transact-SQL statement should you run?<br>A.<br><img src=\"/assets/media/exam-media/02675/0006600001.png\" class=\"in-exam-image\"><br>B.<br><img src=\"/assets/media/exam-media/02675/0006600002.png\" class=\"in-exam-image\"><br>C.<br><img src=\"/assets/media/exam-media/02675/0006600003.png\" class=\"in-exam-image\"><br>D.<br><img src=\"/assets/media/exam-media/02675/0006600004.png\" class=\"in-exam-image\"><br>",
    "options": [
      "<span class=\"multi-choice-letter\" data-choice-letter=\"A\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tOption A",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"B\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tB.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tOption B",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"C\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tC.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tOption C",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"D\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tD.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tOption D"
    ],
    "answer": "A",
    "answerDescription": "ISNULL Syntax: ISNULL ( check_expression , replacement_value ) author:\"Luxemburg, Rosa\"<br>The ISNULL function replaces NULL with the specified replacement value. The value of check_expression is returned if it is not NULL; otherwise, replacement_value is returned after it is implicitly converted to the type of check_expression.<br>References:<br>https://msdn.microsoft.com/en-us/library/ms184325.aspx",
    "votes": [],
    "comments": [
      {
        "date": "2019-08-25T06:37:00.000Z",
        "voteCount": 20,
        "content": "None of them correct. Correct answer\nSelect C.CustomerID, ISNULL(MAX(SOH.SalesOrderID),0) SalesOrderID, ISNULL(MAX(SOH.OrderDate),'01/01/1990') OrderDate\nfrom Sales.Customers C\nleft outer join Sales.SalesOrderHeader SOH on C.CustomerID=SOH.CustomerID\ngroup by C.CustomerID\norder by C.CustomerID"
      },
      {
        "date": "2019-09-05T04:36:00.000Z",
        "voteCount": 2,
        "content": "ISNULL(MAX(SOH.SalesOrderID),0) SalesOrderID \nThis II  type You max number of digit include in orderid\nThis is wrong, You should group by salesoorderid too"
      },
      {
        "date": "2019-09-14T02:07:00.000Z",
        "voteCount": 4,
        "content": "If you add SalesOrderID to Group By, then result will include all SalesOrderID, not the latest one. You can test using following script-\nSelect C.CustomerID, SOH.SalesOrderID, max(SOH.OrderDate) OrderDate\nfrom Sales.Customers C\nleft outer join Sales.SalesOrderHeader SOH on C.CustomerID=SOH.CustomerID\ngroup by C.CustomerID, SOH.SalesOrderID"
      },
      {
        "date": "2019-08-19T03:51:00.000Z",
        "voteCount": 7,
        "content": "However, A is not totally correct since the replacement of the default date is not mentioned."
      },
      {
        "date": "2019-11-06T10:00:00.000Z",
        "voteCount": 6,
        "content": "If you execute\nDECLARE @TESTE DATE = NULL\nSELECT ISNULL(@TESTE, '')\n, you will find that the result will be 1900-01-01"
      },
      {
        "date": "2019-11-30T15:17:00.000Z",
        "voteCount": 6,
        "content": "true, but 1900-01-01 was not what was requested, it was 01/01/1990.\nyour about 90 years off. =P"
      },
      {
        "date": "2020-07-09T12:19:00.000Z",
        "voteCount": 1,
        "content": "I frankly think this is a question error, since other options dont event attempt to replace"
      },
      {
        "date": "2020-09-03T03:49:00.000Z",
        "voteCount": 1,
        "content": "This is interesting."
      },
      {
        "date": "2020-12-31T19:15:00.000Z",
        "voteCount": 1,
        "content": "Agreee with TCroots on answer but probably too complex for exam so going with A except with LEFT OUTER JOIN vs. JOIN"
      },
      {
        "date": "2020-11-20T16:11:00.000Z",
        "voteCount": 1,
        "content": "ALSO  option A is the only one which uses functions working with NULLs"
      },
      {
        "date": "2020-11-20T16:09:00.000Z",
        "voteCount": 1,
        "content": "the only join that matches is LEFT OUTER JOIN , which is in A"
      },
      {
        "date": "2020-11-20T16:07:00.000Z",
        "voteCount": 1,
        "content": "Out of all queries the closest is A"
      },
      {
        "date": "2020-09-11T07:27:00.000Z",
        "voteCount": 2,
        "content": "A. is incorrect for at least two reasons\n\nReason1 - question asks to substitute 01/01/1990, not 01/01/1900 \n\nReason2 -  incorrect grouping\n      GROUP BY C.CustomerID, SOH.SalesOrderID\nsince SOH.SalesOrderID is the key, MAX(OrderDate) will always\npick up only one OrderDate or NULL, you need \n    GROUP BY C.CustomerID\nbut then you have to remove SOH.SalesOrderID from SELECT\nIf you need both OrderDate and SalesOrderID of the last order then you have\nto redesign the whole query"
      },
      {
        "date": "2020-05-04T09:50:00.000Z",
        "voteCount": 2,
        "content": "USE AdventureWorks2016\nGo\nOPTION A is correct;\n\nSELECT c.CustomerID, ISNULL(soh.SalesOrderID, 0), ISNULL(MAX(soh.OrderDate), '')\nFROM Sales.Customer c\nLEFT JOIN Sales.SalesOrderHeader soh\nON c.CustomerID = soh.CustomerID\nGROUP BY c.CustomerID, soh.SalesOrderID\nORDER BY c.CustomerID;\n\nSame result as:\n\nSELECT c.CustomerID, ISNULL(soh.SalesOrderID, 0), ISNULL(MAX(soh.OrderDate), '01/01/1900')\nFROM Sales.Customer c\nLEFT JOIN Sales.SalesOrderHeader soh\nON c.CustomerID = soh.CustomerID\nGROUP BY c.CustomerID, soh.SalesOrderID\nORDER BY c.CustomerID;"
      },
      {
        "date": "2020-05-12T09:36:00.000Z",
        "voteCount": 2,
        "content": "The question says to substitute 01/01/1990 not 01/01/1900.  Additionally, if you group by SalesOrderID then you may not get a unique list of customers (What if a customer placed more than 1 order?  you are trying to find the OrderID associated with the latest Orderdate).  I think Tazul has the best answer except I don't think you need to use the Order By (since you are looking for a MAX value the order wouldn't matter).  Lastly, I think you need to make an assumption that the larger the OrderID the larger (later) the OrderDate."
      },
      {
        "date": "2020-11-14T10:48:00.000Z",
        "voteCount": 1,
        "content": "Tested it and it returns all orders, not only the last order. None of the queries provide the answer."
      },
      {
        "date": "2020-02-12T04:45:00.000Z",
        "voteCount": 2,
        "content": "CREATE TABLE #PERSONS (\nPERSONID INT, NAME VARCHAR(15)\n)\n\nCREATE TABLE #orders (\norderid int,\npersonid int,\norderdate date\n)\n\nSELECT * FROM #PERSONS\nSELECT * FROM #ORDERS\n\nINSERT INTO #PERSONS (PERSONID, NAME) VALUES (1, 'BARTEK'), (2,'KASIA'), (3,'TOMEK'),(4,'MARTA'),(5,'SHRAVY')\n\nINSERT INTO #ORDERS(orderid,personid,orderdate) VALUES (1,1,'2019-01-01'),(2,2,'2019-01-02'),(3,3,'2019-01-02'),(4,2,'2019-01-03')\n\n\nselect c.PERSONID, isnull(max(o.orderid),0) as orderid, isnull(max(o.orderdate),'19900101') as lastorderdate\nfrom #PERSONS c \nleft join #orders o on c.PERSONID=o.PERSONID\ngroup by c.PERSONID--,isnull(o.orderid,0)\nORDER BY C.PERSONID"
      },
      {
        "date": "2020-03-04T10:06:00.000Z",
        "voteCount": 1,
        "content": "The problem here is what if your latest order has a lower OrderId (flip the 4 and 2 for person 2), it always pulls the 4"
      },
      {
        "date": "2020-03-05T04:11:00.000Z",
        "voteCount": 2,
        "content": "here's the solution using the tables from ShruthiBattuala\n\nhttps://stackoverflow.com/questions/48528584/sql-query-to-get-three-most-recent-records-by-customer\nOR https://stackoverflow.com/questions/331367/sql-statement-help-select-latest-order-for-each-customer\n\nselect PERSONID, NAME, orderdate, orderid\n\t\nFROM (\n\tSELECT \n\tc.PERSONID, c.NAME, o.orderdate, o.orderid,\n\trow_number() OVER(PARTITION BY c.PERSONID\n\t\tORDER BY o.orderdate desc, o.orderid desc) AS rowNum\n\tFROM dbo.Persons AS C\n\tJOIN dbo.Orders AS O\n\tON c.PERSONID = o.personid\n\t) AS Records\nWHERE rowNum = 1;"
      },
      {
        "date": "2020-11-17T12:13:00.000Z",
        "voteCount": 1,
        "content": "But when you add to #orders the value\n(5,2,'2018-12-03')\nthe query will not meet requirements"
      },
      {
        "date": "2019-10-25T05:55:00.000Z",
        "voteCount": 1,
        "content": "Agree with Tazul"
      },
      {
        "date": "2019-12-18T06:02:00.000Z",
        "voteCount": 1,
        "content": "Tazul indeed have written the best solution"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 29,
    "url": "https://www.examtopics.com/discussions/microsoft/view/26414-exam-70-761-topic-1-question-29-discussion/",
    "body": "You have a database that contains the following tables:<br><br>Customer -<br><img src=\"/assets/media/exam-media/02675/0006700001.png\" class=\"in-exam-image\"><br><br>CustomerAudit -<br><img src=\"/assets/media/exam-media/02675/0006700002.png\" class=\"in-exam-image\"><br>Where the value of the CustomerID column equals 3, you need to update the value of the CreditLimit column to 1000 for the customer. You must ensure that the change to the record in the Customer table is recorded on the CustomerAudit table.<br>Which Transact-SQL statement should you run?<br>A.<br><img src=\"/assets/media/exam-media/02675/0006800001.png\" class=\"in-exam-image\"><br>B.<br><img src=\"/assets/media/exam-media/02675/0006800002.png\" class=\"in-exam-image\"><br>C.<br><img src=\"/assets/media/exam-media/02675/0006800003.png\" class=\"in-exam-image\"><br>D.<br><img src=\"/assets/media/exam-media/02675/0006800004.png\" class=\"in-exam-image\"><br>",
    "options": [
      "<span class=\"multi-choice-letter\" data-choice-letter=\"A\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tOption A",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"B\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tB.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tOption B",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"C\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tC.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tOption C",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"D\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tD.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tOption D"
    ],
    "answer": "D",
    "answerDescription": "The OUTPUT Clause returns information from, or expressions based on, each row affected by an INSERT, UPDATE, DELETE, or MERGE statement. These results can be returned to the processing application for use in such things as confirmation messages, archiving, and other such application requirements. The results can also be inserted into a table or table variable. Additionally, you can capture the results of an OUTPUT clause in a nested INSERT, UPDATE, DELETE, or MERGE statement, and insert those results into a target table or view.<br>Note: If the column modified by the .RITE clause is referenced in an OUTPUT clause, the complete value of the column, either the before image in deleted.column_name or the after image in inserted.column_name, is returned to the specified column in the tablevariable.<br>Incorrect Answers:<br>C: The deleted.Creditlimit should be inserted in the second column, the OldCreditLimit column, not the third column.<br>References:<br>https://msdn.microsoft.com/en-us/library/ms177564.aspx",
    "votes": [],
    "comments": [
      {
        "date": "2020-07-22T09:41:00.000Z",
        "voteCount": 5,
        "content": "D. is correct, tested"
      },
      {
        "date": "2020-11-20T17:23:00.000Z",
        "voteCount": 1,
        "content": "why should the WHERE clause go last step . It doesn't seem logical. First step we do update for specific ID which is mentioned in WHERE clause then we ensure changes were made in Audit table"
      },
      {
        "date": "2020-07-25T01:35:00.000Z",
        "voteCount": 1,
        "content": "I think A is also correct. If not why?"
      },
      {
        "date": "2020-08-27T13:08:00.000Z",
        "voteCount": 2,
        "content": "\"You must ensure that the change to the record in the Customer table\" means you should use OUTPUT to verify."
      },
      {
        "date": "2020-09-21T05:11:00.000Z",
        "voteCount": 1,
        "content": "You would add the same value CreditLimit as the old and the new limit at the same time."
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 30,
    "url": "https://www.examtopics.com/discussions/microsoft/view/4487-exam-70-761-topic-1-question-30-discussion/",
    "body": "DRAG DROP -<br>Note: This question is part of a series of questions that use the same scenario. For your convenience, the scenario is repeated in each question. Each question presents a different goal and answer choices, but the text of the scenario is exactly the same in each question on this series.<br>You have a database that tracks orders and deliveries for customers in North America. System versioning is enabled for all tables. The database contains the<br>Sales.Customers, Application.Cities, and Sales.CustomerCategories tables.<br>Details for the Sales.Customers table are shown in the following table:<br><img src=\"/assets/media/exam-media/02675/0007000001.png\" class=\"in-exam-image\"><br>Details for the Application.Cities table are shown in the following table:<br><img src=\"/assets/media/exam-media/02675/0007000002.png\" class=\"in-exam-image\"><br>Details for the Sales.CustomerCategories table are shown in the following table:<br><img src=\"/assets/media/exam-media/02675/0007000003.png\" class=\"in-exam-image\"><br>You are creating a report to show when the first customer account was opened in each city. The report contains a line chart with the following characteristics:<br>\u2711 The chart contains a data point for each city, with lines connecting the points.<br>\u2711 The X axis contains the position that the city occupies relative to other cities.<br>\u2711 The Y axis contains the date that the first account in any city was opened.<br>An example chart is shown below for five cities:<br><img src=\"/assets/media/exam-media/02675/0007100001.png\" class=\"in-exam-image\"><br>During a sales promotion, customers from various cities open new accounts on the same date.<br>You need to write a query that returns the data for the chart.<br>How should you complete the Transact-SQL statement? To answer, drag the appropriate Transact-SQL segments to the correct locations. Each Transact-SQL segment may be used once, more than once, or not at all. You may need to drag the split bar between panes or scroll to view content.<br>NOTE: Each correct selection is worth one point.<br>Select and Place:<br><img src=\"/assets/media/exam-media/02675/0007200001.png\" class=\"in-exam-image\"><br>",
    "options": [],
    "answer": "<img src=\"/assets/media/exam-media/02675/0007300001.png\" class=\"in-exam-image\">",
    "answerDescription": "Box 1: RANK() OVER -<br>RANK returns the rank of each row within the partition of a result set. The rank of a row is one plus thenumber of ranks that come before the row in question.<br>ROW_NUMBER and RANK are similar. ROW_NUMBER numbers all rows sequentially (for example 1, 2, 3, 4, 5).<br>Incorrect Answers:<br>DENSE_RANK returns the rank of rows within the partition of a result set, without any gaps in the ranking. The rank of a row is one plus the number of distinct ranks that come before the row in question.<br>Box 2: (PARTITION BY CityID ORDER BY MIN(AccountOpenedDate) DESC)<br>Syntax for RANK: RANK ( ) OVER ( [ partition_by_clause ] order_by_clause )<br><br>Box 3: GROUP BY CityID -<br>References:<br>https://msdn.microsoft.com/en-us/library/ms176102.aspx",
    "votes": [],
    "comments": [
      {
        "date": "2019-10-31T05:17:00.000Z",
        "voteCount": 16,
        "content": "isn't it:\nSelect\nCityID,\nmin(AccountOpenedDate),\nDENSE_RANK() OVER(order by min(AccountOpenedDate) desc)\nFrom Application.Cities\ninner join Sales.Customer on CityID=PostalCityID\ngroup by CityID\norder by min(AccountOpenedDate) desc\n\nwhy needed a partition by?"
      },
      {
        "date": "2020-01-13T00:34:00.000Z",
        "voteCount": 2,
        "content": "correct, it should be without partition by, otherwise we don't compare with the other cities"
      },
      {
        "date": "2020-01-23T02:41:00.000Z",
        "voteCount": 2,
        "content": "This is the CORRECT answer. NO partition by needed here"
      },
      {
        "date": "2020-06-24T16:05:00.000Z",
        "voteCount": 1,
        "content": "I agree, avramov is correct"
      },
      {
        "date": "2020-09-12T09:17:00.000Z",
        "voteCount": 2,
        "content": "tested and avramov is correct. We don't need a partition here. \n2 comments:\n1)The option with OVER( order by AccountOpenedDate) gives a compilation error. We need to put min(AccountOpenedDate). \n2) If we put PARTITION BY, all ranks are equal to 1"
      },
      {
        "date": "2019-09-17T19:05:00.000Z",
        "voteCount": 9,
        "content": "wondering why rank function needed??, one possible reason could be ranking the cities based on min(accountopendate) desc order. In that case, following fits the answer boxes.\nSelect \nCityID,\nmin(AccountOpenedDate),\nRANK() OVER(order by min(AccountOpenedDate) desc)\nFrom Application.Cities\ninner join Sales.Customer on CityID=PostalCityID\ngroup by CityID\norder by min(AccountOpenedDate) desc"
      },
      {
        "date": "2020-01-23T02:40:00.000Z",
        "voteCount": 5,
        "content": "It should be DENSE_RANK here."
      },
      {
        "date": "2021-01-13T01:15:00.000Z",
        "voteCount": 1,
        "content": "Can anybody explain to me why t\na. the DESC is used ?\nb. dense_rank would be wrong ? (there's only 1 date per city, so 1 rank number)\nc. why the partition is used ? (there's only 1 categorie you rank)\n\nThere's a lot to this question which I don't understand"
      },
      {
        "date": "2020-12-31T19:32:00.000Z",
        "voteCount": 1,
        "content": "Given solution is fine. RANK() OVER(PARTITION BY City ORDER BY MIN(AccountOpened)) is correct. DENSE_RANK could yield multiple cities with same rank and not go to 6. GROUP BY required because of other aggregation"
      },
      {
        "date": "2020-07-31T10:28:00.000Z",
        "voteCount": 1,
        "content": "NOTE: Each correct selection is worth one point. ? \nMeans if two right answer from the three will still get point? How point works in this kind of questions ? If we get one wrong out of three.?"
      },
      {
        "date": "2020-06-30T19:07:00.000Z",
        "voteCount": 1,
        "content": "Not sure what everyone means the solution is fine. Rank over partitions the city by lowest date. So if the cities that are lowest will be ranked 1"
      },
      {
        "date": "2020-06-30T19:09:00.000Z",
        "voteCount": 1,
        "content": "Sorry 1 will be the newest date 2 will be second newest date and so on."
      },
      {
        "date": "2020-05-19T16:29:00.000Z",
        "voteCount": 2,
        "content": "1. Shouldn't do PARTITION BY CityID bc you are not ranking each date by city 2. Should do DENSE_RANK"
      },
      {
        "date": "2020-01-13T18:25:00.000Z",
        "voteCount": 1,
        "content": "After 2nd thought, Bartek is right and rank/dense_rank is required AFTER group by function, since X axis is defined as 'The X axis contains the position that the city occupies relative to other cities.' and it seems it returns rank number instead of city id. \n\nTazul already given correct data window function rank SQL based on assumption that rank is required."
      },
      {
        "date": "2020-01-13T17:16:00.000Z",
        "voteCount": 1,
        "content": "With above being said, if we really want to achieve the same result by window rani function, then below SQL should work the same way like a groupby/max only query.  \n\nwith top_city_date as (\nSelect CityID, AccountOpenedDate,RANK() OVER (PARTITION BY CityID ORDER BY AccountOpenedDate desc) as DateRank\nfrom Application.Cities\njoin Sales.Customers ON  CityID=PostalCityID)\nselect CityID,AccountOpenedDate\nfrom top_city_date\nwhere DateRank=1\norder by CityID;"
      },
      {
        "date": "2020-01-13T17:15:00.000Z",
        "voteCount": 1,
        "content": "We don't need rank function, let's take a closer look at below requirements, a group by/max combination is good enough to get what we wanted data.\n\u2711 The X axis contains the position that the city occupies relative to other cities.\n\u2711 The Y axis contains the date that the first account in any city was opened.\n\n\nFurthermore, using data window function with group by clause could be very tricky and challenge especially when they are working on \nsame group (cityID in our case), please check below SQL logic execution order,  data window function was evaluated AFTER group by function(step 5-1 and 6) \nso it will NOT return what we wanted since data is already grouped/aggregrated by the same groupid/partition. \n1. FROM\n2. WHERE\n3. GROUP BY\n4. HAVING\n5. SELECT\n5-1. Evaluate Expressions\n5-2. Remove Duplicates\n6. ORDER BY\n7. OFFSET-FETCH/TOP"
      },
      {
        "date": "2019-09-01T03:09:00.000Z",
        "voteCount": 2,
        "content": "Rank function is irrelevant here, as we need only cityid and min(accountopendate) for the chart"
      },
      {
        "date": "2019-09-05T06:25:00.000Z",
        "voteCount": 11,
        "content": "Not true. On the chart we have numbers like 1,2,3,4,5 despite of citynames. We have attribute the earlier date to number 5 and the newest date to number 1. In addition I think DENSE_RANK () II be better than RANK () cause RANK() is returning eg. x = 1 | RANK(x) = 1, x = 1 | RANK(x) = 1, x = 2 | RANK (x) = 3 WHEN DENSE_RANK() II return x = 1 | DENSE_RANK(x) = 1, x = 1 | DENSE_RANK(x) = 1, x = 2 | DENSE_RANK (x) = 2"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 31,
    "url": "https://www.examtopics.com/discussions/microsoft/view/3987-exam-70-761-topic-1-question-31-discussion/",
    "body": "Note: This question is part of a series of questions that use the same scenario. For your convenience, the scenario is repeated in each question. Each question presents a different goal and answer choices, but the text of the scenario is exactly the same in each question on this series.<br>You have a database that tracks orders and deliveries for customers in North America. System versioning is enabled for all tables. The database contains the<br>Sales.Customers, Application.Cities, and Sales.CustomerCategories tables.<br>Details for the Sales.Customers table are shown in the following table:<br><img src=\"/assets/media/exam-media/02675/0007400001.png\" class=\"in-exam-image\"><br>Details for the Application.Cities table are shown in the following table:<br><img src=\"/assets/media/exam-media/02675/0007400002.png\" class=\"in-exam-image\"><br>Details for the Sales.CustomerCategories table are shown in the following table:<br><img src=\"/assets/media/exam-media/02675/0007500001.png\" class=\"in-exam-image\"><br>You need to create a query that meets the following requirements:<br>\u2711 For customers that are not on a credit hold, return the CustomerID and the latest recorded population for the delivery city that is associated with the customer.<br>\u2711 For customers that are on a credit hold, return the CustomerID and the latest recorded population for the postal city that is associated with the customer.<br>Which two Transact-SQL queries will achieve the goal? Each correct answer presents a complete solution.<br><img src=\"/assets/media/exam-media/02675/0007500004.png\" class=\"in-exam-image\"><br>A.<br><img src=\"/assets/media/exam-media/02675/0007500005.png\" class=\"in-exam-image\"><br>B.<br><img src=\"/assets/media/exam-media/02675/0007500006.png\" class=\"in-exam-image\"><br>C.<br><img src=\"/assets/media/exam-media/02675/0007500007.png\" class=\"in-exam-image\"><br>D.<br>",
    "options": [],
    "answer": "A",
    "answerDescription": "Using Cross Joins -<br>A cross join that does not have a WHERE clause produces the Cartesian product of the tables involved in the join. The size of a Cartesian product result set is the number of rows in the first table multiplied by the number of rows in the second table.<br>However, if a WHERE clause is added, the cross join behaves as an inner join.<br>B: You can use the IIF in the ON-statement.<br>IIF returns one of two values, depending on whether the Boolean expression evaluates to true or false in SQL Server.<br>References:<br>https://technet.microsoft.com/en-us/library/ms190690(v=sql.105).aspx https://msdn.microsoft.com/en-us/library/hh213574.aspx",
    "votes": [],
    "comments": [
      {
        "date": "2019-08-23T23:52:00.000Z",
        "voteCount": 9,
        "content": "It appears to me that B is also correct."
      },
      {
        "date": "2019-09-04T03:51:00.000Z",
        "voteCount": 7,
        "content": "You're Right. The question ask: \"Which TWO Transact-SQL queries will achieve the goal? Each correct answer presents a complete solution.\" ==&gt; A,B"
      },
      {
        "date": "2019-09-17T20:14:00.000Z",
        "voteCount": 7,
        "content": "Answer: A,B"
      },
      {
        "date": "2020-12-10T19:25:00.000Z",
        "voteCount": 1,
        "content": "Both A and B are correct.\n\ncreate table customer (\n\tcustid int Primary Key,\n\tpostalCityId int  FOREIGN KEY REFERENCES city(cityId),\n\tdeliveryCityId int FOREIGN KEY REFERENCES city(cityId),\n\tiscredithold bit\n)\ninsert into customer(custid, postalCityid, deliveryCityId, iscredithold)\n\tvalues(1000, 1, 1, 0),(1001,2, 2, 1),\n\t(1002, 3, 3, 0), (1004, 4, 4, 1)\n\n \ncreate table city(\ncityid int primary key,\nLatestRecordedPopulation bigint\n)\ninsert into city values(1,2000),(2,3000),(3,3000),(4, 4000)\n\n--select * from customer\n--select * from city\n\nselect custId, LatestRecordedPopulation\nfrom customer\ncross join city\nwhere (iscredithold = 0 and DeliveryCityid = cityid)\nor (iscredithold = 1 and postalcityId = cityid)\n\nselect custid, LatestRecordedPopulation\nfrom customer \ninner join city as a\non a.cityId = IIf(iscredithold = 0, deliveryCityId, postalCityId)"
      },
      {
        "date": "2020-09-16T07:36:00.000Z",
        "voteCount": 2,
        "content": "The question asks for two correct transact queries. Answer is A and B."
      },
      {
        "date": "2019-09-01T03:21:00.000Z",
        "voteCount": 5,
        "content": "B is also correct"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 32,
    "url": "https://www.examtopics.com/discussions/microsoft/view/3988-exam-70-761-topic-1-question-32-discussion/",
    "body": "Note: This question is part of a series of questions that use the same scenario. For your convenience, the scenario is repeated in each question. Each question presents a different goal and answer choices, but the text of the scenario is exactly the same in each question on this series.<br>You have a database that tracks orders and deliveries for customers in North America. System versioning is enabled for all tables. The database contains the<br>Sales.Customers, Application.Cities, and Sales.CustomerCategories tables.<br>Details for the Sales.Customers table are shown in the following table:<br><img src=\"/assets/media/exam-media/02675/0007700001.png\" class=\"in-exam-image\"><br>Details for the Application.Cities table are shown in the following table:<br><img src=\"/assets/media/exam-media/02675/0007700002.png\" class=\"in-exam-image\"><br>Details for the Sales.CustomerCategories table are shown in the following table:<br><img src=\"/assets/media/exam-media/02675/0007700003.png\" class=\"in-exam-image\"><br>You discover an application bug that impacts customer data for records created on or after January 1, 2014. In order to fix the data impacted by the bug, application programmers require a report that contains customer data as it existed on December 31, 2013.<br>You need to provide the query for the report.<br>Which Transact-SQL statement should you use?<br><img src=\"/assets/media/exam-media/02675/0007800001.png\" class=\"in-exam-image\"><br>A.<br><img src=\"/assets/media/exam-media/02675/0007800002.png\" class=\"in-exam-image\"><br>B.<br><img src=\"/assets/media/exam-media/02675/0007800003.png\" class=\"in-exam-image\"><br>C.<br><img src=\"/assets/media/exam-media/02675/0007800004.png\" class=\"in-exam-image\"><br>D.<br><img src=\"/assets/media/exam-media/02675/0007800005.png\" class=\"in-exam-image\"><br>E.<br>",
    "options": [],
    "answer": "D",
    "answerDescription": "The datetime datetype defines a date that is combined with a time of day with fractional seconds that is based on a 24-hour clock.<br>The DATEFROMPARTS function returns a date value for the specified year, month, and day.<br>Incorrect Answers:<br>A: ValidFrom should be less (&lt;) than @sdate AND ValidTo should be greater (&gt;) than @edate.<br>B: We should add a day with DATEADD, not subtract one day.<br>C: We cannot compare a date to an exact datetime.<br>References:<br>https://msdn.microsoft.com/en-us/library/ms187819.aspx",
    "votes": [],
    "comments": [
      {
        "date": "2019-09-07T03:11:00.000Z",
        "voteCount": 10,
        "content": "Correct answer is C, because you have system versioning enabled for all the tables. FOR SYSTEM_TIME with AS OF option because the question says, state AS OF @DATE.\n\nhttps://docs.microsoft.com/en-us/sql/relational-databases/tables/temporal-tables?view=sql-server-2017"
      },
      {
        "date": "2019-09-17T02:09:00.000Z",
        "voteCount": 4,
        "content": "No. In AS OF it compare also the TIME portion.\nhttps://docs.microsoft.com/en-US/sql/relational-databases/tables/querying-data-in-a-system-versioned-temporal-table?view=sql-server-2017"
      },
      {
        "date": "2020-06-07T06:43:00.000Z",
        "voteCount": 1,
        "content": "No, AS OF uses the type of @Date which is DATE, DATEFROMPARTS() includes time but implicit cast cuts it out and @Date is just DATE"
      },
      {
        "date": "2019-09-18T03:04:00.000Z",
        "voteCount": 5,
        "content": "Correct answer: C"
      },
      {
        "date": "2021-01-13T02:02:00.000Z",
        "voteCount": 1,
        "content": "D must be wrong. Theory clearly tells that the answer should be C.\n Using the AS OF sub clause can return a state of the data for each row containing the values that were current \n at the specified time in the past. The AS OF sub clause returns all the records from the SQL Server system versioned \n and history table that satisfied the below criteria:\nStartTime &lt;= SpecifiedTime AND EndTime &gt; SpecifiedTime"
      },
      {
        "date": "2020-12-31T19:45:00.000Z",
        "voteCount": 1,
        "content": "I agree with  FOR SYSTEM_TIME as of  since it doesn't say what time and doesn't say that it has to be SQL SERVER 2012 (when the feature didn't exist)"
      },
      {
        "date": "2020-12-31T19:49:00.000Z",
        "voteCount": 1,
        "content": "Could also be a temporal table but we'd need to know the history table...."
      },
      {
        "date": "2020-12-03T16:45:00.000Z",
        "voteCount": 1,
        "content": "None of them work in my test, A returns data but as specifying a ValidTo date do not return the actual records but expired on ValidTo date. C with AS OF do not return anything without an specific DATETIME Value, using only a date value won't return anything. And the rest do not return anything at all."
      },
      {
        "date": "2020-03-30T08:17:00.000Z",
        "voteCount": 1,
        "content": "TLDR...all seemed flawed, but C seems closed to me. thoughts?\n\nA - this is wrong b/c it gets sdate and edate backwards...so no results...even if worked, could have dupes if changed during window\nB - this seems close, but is going to miss anything changed on 12-30 and 12-31...same dupe issue as A\nC - Seems just about best, think it only misses 12-31...also no dupes\nD - Doesn't work b/c only queries against main table (e.g. anything changed in January doesn't show up)\nE - Contained in same dates should never work"
      },
      {
        "date": "2020-06-07T06:45:00.000Z",
        "voteCount": 1,
        "content": "What's wrong with E? start and end date can be the same because CONTAINED IN assumes inclusive for start and end"
      },
      {
        "date": "2019-11-23T17:13:00.000Z",
        "voteCount": 4,
        "content": "Correct Answer is C\n\nA: incorrect because it specfies ValidTo so any data that has not been changed since before that date will not be included\nB: incorrect edate is set do the date before, should dateadd(d,1,@sdate) but still has the same issue as answer A\nC: Correct (If you are testing this yourself, be careful that you test AS OF @DATE, a day after you create you temporal table. If you dont the date wil not be valid for that day as the time portion is after the start of the day)\nD: incorrect there is no FOR SYSTEM TIME, so no historical data\nE: incorrect, same issue as A, we set an enddate so we will not include records with the edate set to '9999-12-31 23:59:59.9999999'"
      },
      {
        "date": "2019-10-17T15:56:00.000Z",
        "voteCount": 3,
        "content": "I have tested it C SEEMS TO BE CORRECT"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 33,
    "url": "https://www.examtopics.com/discussions/microsoft/view/2998-exam-70-761-topic-1-question-33-discussion/",
    "body": "DRAG DROP -<br>Note: This question is part of a series of questions that use the same scenario. For your convenience, the scenario is repeated in each question. Each question presents a different goal and answer choices, but the text of the scenario is exactly the same in each question on this series.<br>You have a database that tracks orders and deliveries for customers in North America. System versioning is enabled for all tables. The database contains the<br>Sales.Customers, Application.Cities, and Sales.CustomerCategories tables.<br>Details for the Sales.Customers table are shown in the following table:<br><img src=\"/assets/media/exam-media/02675/0008000001.png\" class=\"in-exam-image\"><br>Details for the Application.Cities table are shown in the following table:<br><img src=\"/assets/media/exam-media/02675/0008000002.png\" class=\"in-exam-image\"><br>Details for the Sales.CustomerCategories table are shown in the following table:<br><img src=\"/assets/media/exam-media/02675/0008000003.png\" class=\"in-exam-image\"><br>You are creating a report to measure the impact of advertising efforts that were designed to attract new customers. The report must show the number of new customers per day for each customer category, but only if the number of new customers is greater than five.<br>You need to write the query to return data for the report.<br>How should you complete the Transact-SQL statement? To answer, drag the appropriate Transact-SQL segments to the correct locations. Each Transact-SQL segment may be used once, more than once, or not at all. You may need to drag the split bar between panes or scroll to view content.<br>Select and Place:<br><img src=\"/assets/media/exam-media/02675/0008100001.png\" class=\"in-exam-image\"><br>",
    "options": [],
    "answer": "<img src=\"/assets/media/exam-media/02675/0008100002.png\" class=\"in-exam-image\">",
    "answerDescription": "",
    "votes": [],
    "comments": [
      {
        "date": "2019-07-29T15:28:00.000Z",
        "voteCount": 35,
        "content": "I believe the WHERE statement should actually be a HAVING statement, as it is filtering based on groupings."
      },
      {
        "date": "2019-09-21T23:15:00.000Z",
        "voteCount": 6,
        "content": "yeah, It should be 'having' instead of 'where'."
      },
      {
        "date": "2020-08-01T13:27:00.000Z",
        "voteCount": 1,
        "content": "The report must show the number of new customers per day for each customer category\n\nGROUP BY C.CustomerCategoryName,DATEPART(DAY,e.AccountOpenedDate )   is correct"
      },
      {
        "date": "2020-07-21T14:35:00.000Z",
        "voteCount": 2,
        "content": "Should be \nSELECT COUNT( e.custid),C.CustomerCategoryName ,DATEPART(DAY,e.AccountOpenedDate )\nFROM Sales.Customers AS e\nINNER JOIN Sales.CustomerCategories as c\nON E.customerCategoryId=C.customerCategoryId\nGROUP BY C.CustomerCategoryName,DATEPART(DAY,e.AccountOpenedDate )\nHAVING COUNT( e.custid)&gt;5"
      },
      {
        "date": "2020-07-21T14:36:00.000Z",
        "voteCount": 1,
        "content": "The report must show the number of new customers per day for each customer category,"
      },
      {
        "date": "2020-07-22T10:18:00.000Z",
        "voteCount": 4,
        "content": "its not correct because it will group by like day 1 of each month as so on which doesnt make sense. Using CAST to DATE is correct, datepart doesnt make sense"
      },
      {
        "date": "2020-07-23T10:42:00.000Z",
        "voteCount": 5,
        "content": "Yes please Ignore my answer."
      },
      {
        "date": "2020-01-13T21:55:00.000Z",
        "voteCount": 5,
        "content": "Fabzo is correct, we have below SQL logical execution order so it should be having after group by:\n\n1. FROM\n2. WHERE\n3. GROUP BY\n4. HAVING\n5. SELECT\n5-1. Evaluate Expressions\n5-2. Remove Duplicates\n6. ORDER BY\n7. OFFSET-FETCH/TOP"
      },
      {
        "date": "2019-11-21T01:08:00.000Z",
        "voteCount": 4,
        "content": "Correct, Having is correct.  Where comes before grouping and Having comes after grouping"
      },
      {
        "date": "2019-11-02T18:16:00.000Z",
        "voteCount": 6,
        "content": "HAVING is the correct answer. Filtering by group level"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 34,
    "url": "https://www.examtopics.com/discussions/microsoft/view/3000-exam-70-761-topic-1-question-34-discussion/",
    "body": "DRAG DROP -<br>Note: This question is part of a series of questions that use the same scenario. For your convenience, the scenario is repeated in each question. Each question presents a different goal and answer choices, but the text of the scenario is exactly the same in each question on this series.<br>You have a database that tracks orders and deliveries for customers in North America. System versioning is enabled for all tables. The database contains the<br>Sales.Customers, Application.Cities, and Sales.CustomerCategories tables.<br>Details for the Sales.Customers table are shown in the following table:<br><img src=\"/assets/media/exam-media/02675/0008200001.png\" class=\"in-exam-image\"><br>Details for the Application.Cities table are shown in the following table:<br><img src=\"/assets/media/exam-media/02675/0008300001.png\" class=\"in-exam-image\"><br>Details for the Sales.CustomerCategories table are shown in the following table:<br><img src=\"/assets/media/exam-media/02675/0008300002.png\" class=\"in-exam-image\"><br>The marketing department is performing an analysis of how discount affect credit limits. They need to know the average credit limit per standard discount percentage for customers whose standard discount percentage is between zero and four.<br>You need to create a query that returns the data for the analysis.<br>How should you complete the Transact-SQL statement? To answer, drag the appropriate Transact-SQL segments to the correct locations. Each Transact-SQL segments may be used once, more than once, or not at all. You may need to drag the split bar between panes or scroll to view content.<br>Select and Place:<br><img src=\"/assets/media/exam-media/02675/0008300003.png\" class=\"in-exam-image\"><br>",
    "options": [],
    "answer": "<img src=\"/assets/media/exam-media/02675/0008400001.png\" class=\"in-exam-image\">",
    "answerDescription": "Box 1: 0, 1, 2, 3, 4 -<br>Pivot example:<br>-- Pivot table with one rowand five columns<br>SELECT 'AverageCost' AS Cost_Sorted_By_Production_Days,<br>[0], [1], [2], [3], [4]<br><br>FROM -<br>(SELECT DaysToManufacture, StandardCost<br>FROM Production.Product) AS SourceTable<br><br>PIVOT -<br>(<br>AVG(StandardCost)<br>FOR DaysToManufacture IN ([0], [1], [2], [3], [4])<br>) AS PivotTable;<br>Box 2: [CreditLimit]<br><br>Box 3: PIVOT -<br>You can use the PIVOT and UNPIVOT relational operators to change a table-valued expression into another table. PIVOT rotates a table-valued expression by turning the unique values from one column in the expression into multiple columns in the output, and performs aggregations where they are required on any remaining column values that are wanted in the final output.<br><br>Box 4: 0, 1, 2, 3, 4 -<br>The IN clause determines whether a specified value matches any value in a subquery or a list.<br>Syntax: test_expression [ NOT ] IN ( subquery | expression [ ,...n ] )<br>Where expression[ ,... n ] is a list of expressions to test for a match. All expressions must be of the same type as test_expression.<br>References:<br>https://technet.microsoft.com/en-us/library/ms177410(v=sql.105).aspx",
    "votes": [],
    "comments": [
      {
        "date": "2020-01-13T22:10:00.000Z",
        "voteCount": 17,
        "content": "Answer is correct but column name as select result blank and in the in list blank should surround with bracket like below since number(or start letter is number) is irregular SQL server identifier. \n\n[0], [1], [2], [3], [4]"
      },
      {
        "date": "2019-08-19T04:16:00.000Z",
        "voteCount": 7,
        "content": "@Exam_taker5: The solution is correct since the Select clause has to be the same as the IN whtin the PIVOT clause"
      },
      {
        "date": "2019-07-29T15:40:00.000Z",
        "voteCount": 1,
        "content": "I think it should be SELECT AVG(CreditLimit)"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 35,
    "url": "https://www.examtopics.com/discussions/microsoft/view/3781-exam-70-761-topic-1-question-35-discussion/",
    "body": "DRAG DROP -<br>Note: This question is part of a series of questions that use the same scenario. For your convenience, the scenario is repeated in each question. Each question presents a different goal and answer choices, but the text of the scenario is exactly the same in each question on this series.<br>You have a database that tracks orders and deliveries for customers in North America. System versioning is enabled for all tables. The database contains the<br>Sales.Customers, Application.Cities, and Sales.CustomerCategories tables.<br>Details for the Sales.Customers table are shown in the following table:<br><img src=\"/assets/media/exam-media/02675/0008500001.png\" class=\"in-exam-image\"><br>Details for the Application.Cities table are shown in the following table:<br><img src=\"/assets/media/exam-media/02675/0008600001.png\" class=\"in-exam-image\"><br>Details for the Sales.CustomerCategories table are shown in the following table:<br><img src=\"/assets/media/exam-media/02675/0008600002.png\" class=\"in-exam-image\"><br>You are preparing a promotional mailing. The mailing must only be sent to customers in good standing that live in medium and large cities.<br>You need to write a query that returns all customers that are not on credit hold who live in cities with a population greater than 10,000.<br>How should you complete the Transact-SQL statement? To answer, drag the appropriate Transact-SQL segments to the correct locations. Each Transact-SQL segment may be used once, more than once, or not at all. You may need to drag the split bar between panes or scroll to view content.<br>Select and Place:<br><img src=\"/assets/media/exam-media/02675/0008600003.png\" class=\"in-exam-image\"><br>",
    "options": [],
    "answer": "<img src=\"/assets/media/exam-media/02675/0008700001.png\" class=\"in-exam-image\">",
    "answerDescription": "Box 1: IN (<br>The IN clause determines whether a specified value matches any value in a subquery or a list.<br>Syntax: test_expression [ NOT ] IN ( subquery | expression [ ,...n ] )<br>Where subquery is a subquery that has a result set of one column. This column must have the same data type as test_expression.<br><br>Box 2: WHERE -<br><br>Box 3: AND [IsOnCreditHold] = 0 -<br>Box 4: )<br>References:<br>https://msdn.microsoft.com/en-us/library/ms177682.aspx",
    "votes": [],
    "comments": [
      {
        "date": "2019-09-21T03:24:00.000Z",
        "voteCount": 25,
        "content": "Select CustomerID\nfrom customers\nwhere postalCityID in\n\n(select citiyID\nfrom Cities\nwhere LatestRecordedPopulation &gt; 10000)\nand IsoncreditHold = 0"
      },
      {
        "date": "2019-08-19T04:21:00.000Z",
        "voteCount": 23,
        "content": "The \")\" must be defined before the AND clause since Cities do not have a Credithold-Column. AND belongs to customer table"
      },
      {
        "date": "2019-10-02T04:23:00.000Z",
        "voteCount": 21,
        "content": "Missing open brackets \"(\""
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 36,
    "url": "https://www.examtopics.com/discussions/microsoft/view/1426-exam-70-761-topic-1-question-36-discussion/",
    "body": "Note: This question is part of a series of questions that use the same or similar answer choices. An answer choice may be correct for more than one question in the series. Each question is independent of the other questions in this series. Information and details provided in a question apply only to that question.<br>You have a table named Products that contains information about the products that your company sells. The table contains many columns that do not always contain values.<br>You need to implement an ANSI standard method to convert the NULL values in the query output to the phrase \"Not Applicable\".<br>What should you implement?<br>",
    "options": [
      "<span class=\"multi-choice-letter\" data-choice-letter=\"A\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tthe COALESCE function",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"B\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tB.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\ta view",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"C\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tC.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\ta table-valued function",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"D\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tD.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tthe TRY_PARSE function",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"E\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tE.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\ta stored procedure",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"F\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tF.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tthe ISNULL function",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"G\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tG.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\ta scalar function",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"H\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tH.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tthe TRY_CONVERT function"
    ],
    "answer": "F",
    "answerDescription": "The ISNULL function replaces NULL with the specified replacement value.<br>References:<br>https://msdn.microsoft.com/en-us/library/ms184325.aspx",
    "votes": [],
    "comments": [
      {
        "date": "2019-06-12T22:01:00.000Z",
        "voteCount": 28,
        "content": "COALESCE is standard."
      },
      {
        "date": "2019-05-20T11:24:00.000Z",
        "voteCount": 16,
        "content": "but ISNULL is not a standard sql function"
      },
      {
        "date": "2021-01-13T03:48:00.000Z",
        "voteCount": 1,
        "content": "This must be wrong. COALESCE is the ANSI standard"
      },
      {
        "date": "2020-11-21T17:23:00.000Z",
        "voteCount": 2,
        "content": "ISNULL isn't ANSI. Must be COALESCE()"
      },
      {
        "date": "2020-08-09T09:58:00.000Z",
        "voteCount": 2,
        "content": "Coalesce is the correct answer ISNULL is T-SQL."
      },
      {
        "date": "2020-07-31T11:46:00.000Z",
        "voteCount": 2,
        "content": "Correct answer: A\nCOALESCE evaluates the arguments in order and returns the current value of the first expression that initially doesn't evaluate to NULL.\nIncorrect Answer: F\nISNULL is not a ANSI standard function. The COALESCE function is preferred."
      },
      {
        "date": "2020-07-11T04:26:00.000Z",
        "voteCount": 1,
        "content": "Yea its coalesce"
      },
      {
        "date": "2020-03-03T02:14:00.000Z",
        "voteCount": 6,
        "content": "COALESCE"
      },
      {
        "date": "2019-09-07T03:12:00.000Z",
        "voteCount": 15,
        "content": "Option A as COALESCE is the ANSI standard function.\n\nhttps://docs.microsoft.com/en-us/sql/t-sql/language-elements/coalesce-transact-sql?view=sql-server-2017"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 37,
    "url": "https://www.examtopics.com/discussions/microsoft/view/3989-exam-70-761-topic-1-question-37-discussion/",
    "body": "Note: This question is part of a series of questions that use the same or similar answer choices. An answer choice may be correct for more than one question in the series. Each question is independent of the other questions in this series. Information and details provided in a question apply only to that question.<br>You have a database that is denormalized. Users make frequent changes to data in a primary table.<br>You need to ensure that users cannot change the tables directly, and that changes made to the primary table also update any related tables.<br>What should you implement?<br>",
    "options": [
      "<span class=\"multi-choice-letter\" data-choice-letter=\"A\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tthe COALESCE function",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"B\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tB.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\ta view",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"C\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tC.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\ta table-valued function",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"D\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tD.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tthe TRY_PARSE function",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"E\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tE.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\ta stored procedure",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"F\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tF.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tthe ISNULL function",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"G\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tG.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\ta scalar function",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"H\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tH.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tthe TRY_CONVERT function"
    ],
    "answer": "B",
    "answerDescription": "Using an Indexed View would allow you to keep your base data in properly normalized tables and maintain data-integrity while giving you the denormalized \"view\" of that data.<br>References:<br>http://stackoverflow.com/questions/4789091/updating-redundant-denormalized-data-automatically-in-sql-server",
    "votes": [],
    "comments": [
      {
        "date": "2020-09-12T10:24:00.000Z",
        "voteCount": 6,
        "content": "I think the correct answer should be store procedure because it satisfies the 2 requirements:\n1) The users can't change the table directly\n2) It also updates the related tables\n\nWith a view, you can only update one table per time."
      },
      {
        "date": "2020-01-15T20:51:00.000Z",
        "voteCount": 5,
        "content": "There is no correct answer listed. To maintain a set of denormalized tables, normally we need an instead of trigger on primary table to interpret every insert/update/delete operations on this table and make sure it will map to get reflected to related redundant columns in other tables. \n\nI.e. an after trigger on table is necessary and should be an answer/solution to this question.  \n\nKindly note: For the solution mentioned in the stackoverflow link, an indexed view is just used to bridge the gap for querying when there are denormalized tables but it won't help when there are insert/update/delete happens on primary table.  Unless we go step further and create an instead of trigger on that indexed view and encapsulate every details of underlying table from Application logic for not only select but also I/U/D operations. Even in that case the answer should be View and Trigger other than just a view which is not a complete solution."
      },
      {
        "date": "2020-06-24T17:15:00.000Z",
        "voteCount": 2,
        "content": "Thanks for digging deeper."
      },
      {
        "date": "2020-10-11T20:32:00.000Z",
        "voteCount": 1,
        "content": "No, not 'After' trigger, should be 'Instead Of' trigger"
      },
      {
        "date": "2021-01-01T08:12:00.000Z",
        "voteCount": 1,
        "content": "Stored procedure if you want to update multiple tables while obscuring the database schema to the user. Only option since triggers aren't listed."
      },
      {
        "date": "2020-12-14T12:49:00.000Z",
        "voteCount": 1,
        "content": "basic work for store procedure/trigger..."
      },
      {
        "date": "2020-11-29T09:07:00.000Z",
        "voteCount": 1,
        "content": "I think view is correct, because you can modify the insert into multiple base tables through an instead of trigger."
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 38,
    "url": "https://www.examtopics.com/discussions/microsoft/view/33545-exam-70-761-topic-1-question-38-discussion/",
    "body": "Note: This question is part of a series of questions that use the same or similar answer choices. An answer choice may be correct for more than one question in the series. Each question is independent of the other questions in this series. Information and details provided in a question apply only to that question.<br>You have a database that stores sales and order information.<br>Users must be able to extract information from the tables on an ad hoc basis. They must also be able to reference the extracted information as a single table.<br>You need to implement a solution that allows users to retrieve the data required, based on variables defined at the time of the query.<br>What should you implement?<br>",
    "options": [
      "<span class=\"multi-choice-letter\" data-choice-letter=\"A\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tthe COALESCE function",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"B\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tB.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\ta view",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"C\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tC.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\ta table-valued function",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"D\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tD.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tthe TRY_PARSE function",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"E\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tE.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\ta stored procedure",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"F\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tF.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tthe ISNULL function",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"G\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tG.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\ta scalar function",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"H\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tH.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tthe TRY_CONVERT function"
    ],
    "answer": "C",
    "answerDescription": "User-defined functions that return a table data type can be powerful alternatives to views. These functions are referred to as table-valued functions. A table-valued user-defined function can be used where table or view expressions are allowed in Transact-SQL queries. While views are limited to a single SELECT statement, user-defined functions can contain additional statements that allow more powerful logic than is possible in views.<br>A table-valued user-defined function can also replace stored procedures that return a single result set.<br>References:<br>https://technet.microsoft.com/en-us/library/ms191165(v=sql.105).aspx",
    "votes": [],
    "comments": [
      {
        "date": "2020-10-03T15:59:00.000Z",
        "voteCount": 1,
        "content": "the correct answer is B. a View"
      },
      {
        "date": "2020-11-14T14:51:00.000Z",
        "voteCount": 5,
        "content": "\"You need to implement a solution that allows users to retrieve the data required, based on variables defined at the time of the query.\"\nA table-value function which allows to introduce variables at the time of execution."
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 39,
    "url": "https://www.examtopics.com/discussions/microsoft/view/3019-exam-70-761-topic-1-question-39-discussion/",
    "body": "Note: This question is part of a series of questions that use the same or similar answer choices. An answer choice may be correct for more than one question in the series. Each question is independent of the other questions in this series. Information and details provided in a question apply only to that question.<br>You have a table named AuditTrail that tracks modifications to data in other tables. The AuditTrail table is updated by many processes. Data input into AuditTrail may contain improperly formatted date time values. You implement a process that retrieves data from the various columns in AuditTrail, but sometimes the process throws an error when it is unable to convert the data into valid date time values.<br>You need to convert the data into a valid date time value using the en-US format culture code. If the conversion fails, a null value must be returned in the column output. The conversion process must not throw an error.<br>What should you implement?<br>",
    "options": [
      "<span class=\"multi-choice-letter\" data-choice-letter=\"A\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tthe COALESCE function",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"B\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tB.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\ta view",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"C\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tC.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\ta table-valued function",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"D\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tD.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tthe TRY_PARSE function",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"E\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tE.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\ta stored procedure",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"F\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tF.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tthe ISNULL function",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"G\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tG.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\ta scalar function",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"H\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tH.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tthe TRY_CONVERT function"
    ],
    "answer": "H",
    "answerDescription": "A TRY_CONVERT function returns a value cast to the specified data type if the cast succeeds; otherwise, returns null.<br>References:<br>https://msdn.microsoft.com/en-us/library/hh230993.aspx",
    "votes": [],
    "comments": [
      {
        "date": "2019-07-30T07:25:00.000Z",
        "voteCount": 27,
        "content": "I believe this should be TRY_PARSE, which is used specifically for date conversion. It includes an input parameter for culture type."
      },
      {
        "date": "2019-09-04T12:43:00.000Z",
        "voteCount": 6,
        "content": "TRY_PARSE accept a string_value AS data_type, since question do not specify the column type I think TRY_CONVERT is a better answer."
      },
      {
        "date": "2020-05-06T04:24:00.000Z",
        "voteCount": 2,
        "content": "TRY_CONVERT does not have any 'culture format', since the 'en-US' was specified, it cannot be TRY_CONVERT.\n\nSELECT TRY_PARSE('Jabberwokkie' AS datetime2 USING 'en-US') AS Result;\n---While this will return NULL as Result;\n\nSELECT TRY_CONVERT(datetime2, '12/31/2010', 'en-US') AS Result;\n---this will return an error--- \"Msg 8116, Level 16, State 1, Line 31\n\nBut, \n\nSELECT TRY_CONVERT(datetime2, '12/31/2010', 1) AS Result;\n---will return a NULL.\n\nSo the simple fact that you can't specify 'en-US' as the third parameter for a TRY_CONVERT\neliminates it completely as an option.\nArgument data type varchar is invalid for argument 3 of convert function.\""
      },
      {
        "date": "2020-05-06T04:27:00.000Z",
        "voteCount": 1,
        "content": "TRY_CONVERT does not have any 'culture format', since the 'en-US' was specified, it cannot be TRY_CONVERT.\n\nSELECT TRY_PARSE('Jabberwokkie' AS datetime2 USING 'en-US') AS Result;\n---While this will return NULL as Result;\n\nSELECT TRY_CONVERT(datetime2, '12/31/2010', 'en-US') AS Result;\n---this will return an error--- \"Msg 8116, Level 16, State 1, Line 31 \nArgument data type varchar is invalid for argument 3 of convert function.\"\n\nBut,\n\nSELECT TRY_CONVERT(datetime2, '12/31/2010', 1) AS Result;\n---will return a NULL.\n\nSo the simple fact that you can't specify 'en-US' as the third parameter for a TRY_CONVERT\neliminates it completely as an option.\n\n\nEDIT: the last line of the first response was misplaced. this is the correct response."
      },
      {
        "date": "2021-01-13T04:06:00.000Z",
        "voteCount": 1,
        "content": "\"You need to convert the data into a valid date time value using the en-US format culture code.\"\nHow about that ?"
      },
      {
        "date": "2021-01-19T02:54:00.000Z",
        "voteCount": 1,
        "content": "select TRY_PARSE('2/1/2019' AS datetime USING 'en-US')\n\nselect TRY_Convert( datetime,'2/1/2019',101)\n\nselect TRY_PARSE('22/1/2019' AS datetime USING 'en-US')\n\nselect TRY_Convert( datetime,'22/1/2019',101)\n\n101 is style format for en-us in convert.\nand convert can be used to convert from any data type to date time. So try_convert is correct answer in this case."
      },
      {
        "date": "2021-01-01T08:15:00.000Z",
        "voteCount": 2,
        "content": "Definitely TRY_PARSE due to requirement for 'en-US' format. Not sure why there is discussion"
      },
      {
        "date": "2020-12-10T04:10:00.000Z",
        "voteCount": 1,
        "content": "TRY_PARSE will only accept a String, and convert that to most data types. You can specify a culture (i.e. en-US) of the input string.\n\nTRY_CONVERT will take most data types and convert to most data types. It's possible to specify a format of the output string when converting from a date(time), but influenced by the current culture\n\nThe requirement is to convert a string (It's not possible to have a datetime in an \"invalid\" format, so the source has to be a string), using a given culture, into a datetime. The only answer is TRY_PARSE."
      },
      {
        "date": "2020-11-21T17:30:00.000Z",
        "voteCount": 1,
        "content": "TRY_PARSE uses the culture as argument. The answer is TRY_PARSE"
      },
      {
        "date": "2020-09-10T11:45:00.000Z",
        "voteCount": 1,
        "content": "guys the answer is try_parse. \nThe correct syntax for try_parse is TRY_PARSE(string as datatype [using culture]). \nCulture is an optional argument which helps to convert the value into culture format. \nEx you want to display the date in french then you can pass the culture type as 'Fr-FR' for US English it should be 'en-US'\nHope this clears. Happy learning :)"
      },
      {
        "date": "2020-11-17T09:27:00.000Z",
        "voteCount": 1,
        "content": "SELECT TRY_PARSE(@field_to_convert AS DATE USING 'en-US');"
      },
      {
        "date": "2020-08-18T06:26:00.000Z",
        "voteCount": 1,
        "content": "'using the en-US format culture code' this clearly for TRY_PARSE"
      },
      {
        "date": "2020-07-31T12:02:00.000Z",
        "voteCount": 1,
        "content": "I would say: [H] the TRY_CONVERT function. \nWhat think guys? \nI have exam in 5 days if you can response before then that would be good?"
      },
      {
        "date": "2020-06-10T10:22:00.000Z",
        "voteCount": 1,
        "content": "Truthee, question did not specify that you must use \u2018en-US\u2019, it reference the used of code \u201cusing the en-US format culture code\u201d.  Either one would work, but more correct was TRY_CONVERT"
      },
      {
        "date": "2020-05-06T04:30:00.000Z",
        "voteCount": 2,
        "content": "TRY_CONVERT does not have any 'culture format', since the 'en-US' was specified, it cannot be TRY_CONVERT.\n\nSELECT TRY_PARSE('Jabberwokkie' AS datetime2 USING 'en-US') AS Result;\n---While this will return NULL as Result;\n\nSELECT TRY_CONVERT(datetime2, '12/31/2010', 'en-US') AS Result;\n---this will return an error--- \"Msg 8116, Level 16, State 1, Line 31\nArgument data type varchar is invalid for argument 3 of convert function.\"\n\nBut,\n\nSELECT TRY_CONVERT(datetime2, '12/31/2010', 1) AS Result;\n---will return a NULL.\n\nSo the simple fact that you can't specify 'en-US' as the third parameter for a TRY_CONVERT\neliminates it completely as an option.\n\n\nSo the answer is TRY_PARSE"
      },
      {
        "date": "2020-02-27T00:36:00.000Z",
        "voteCount": 3,
        "content": "I think Try_CONVERT since it wants null if it fails, TRY_PARSE will return error on failure to convert"
      },
      {
        "date": "2020-01-30T08:50:00.000Z",
        "voteCount": 1,
        "content": "Both TRY_CONVERT and TRY_PARSE will work with this scenario however, there is an overhead to using TRY_PARSE.   Because of this, TRY_CONVERT is the best solution:   https://docs.microsoft.com/en-us/sql/t-sql/functions/try-parse-transact-sql?view=sql-server-ver15,"
      },
      {
        "date": "2020-01-15T21:31:00.000Z",
        "voteCount": 2,
        "content": "agreed with Exam_taker5 and Avramov, Try_Parse and Try_Convert both could take date string input and return null if error happens, however question clearly asked for 'culture code' which is specific  to try_parse definition below. \n\nTRY_PARSE ( string_value AS data_type [ USING culture ] )\nhttps://docs.microsoft.com/en-us/sql/t-sql/functions/try-parse-transact-sql?view=sql-server-ver15"
      },
      {
        "date": "2020-01-11T01:44:00.000Z",
        "voteCount": 1,
        "content": "I think it should be try_parse due to the hint 'using the en-US format culture code'"
      },
      {
        "date": "2019-11-23T18:24:00.000Z",
        "voteCount": 2,
        "content": "\"Try_Convert\" does not throw an error when the conversion is not explicitly permitted. \nAnd base on the reference book, it recommends using \"Try_Convert\" rather than Try_Parse, even though the  \"Try_Convert\" has lower performance"
      },
      {
        "date": "2019-11-07T07:47:00.000Z",
        "voteCount": 1,
        "content": "The requirement is \"The conversion process must not throw an error\". \"Try_Convert\" throws an error when we try to perform a conversion that is not explicitly permitted. On the other hand, \"TRY_PARSE\" function can only convert strings to numeric or date data types. It seems to me that the most probable answer is \"TRY_PARSE\"."
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 40,
    "url": "https://www.examtopics.com/discussions/microsoft/view/37016-exam-70-761-topic-1-question-40-discussion/",
    "body": "HOTSPOT -<br>You have the following subqueries: Subquery1, Subquery2, and Subquery3.<br>You need to replace the three subqueries with named result sets or temporary tables. The following requirements must be met:<br><img src=\"/assets/media/exam-media/02675/0009100001.png\" class=\"in-exam-image\"><br>Which replacement techniques should you use? To answer, select the appropriate options in the answer area.<br>Hot Area:<br><img src=\"/assets/media/exam-media/02675/0009200001.png\" class=\"in-exam-image\"><br>",
    "options": [],
    "answer": "<img src=\"/assets/media/exam-media/02675/0009300001.jpg\" class=\"in-exam-image\">",
    "answerDescription": "Subquery1: common table expression (CTE)<br>A common table expression (CTE) can be thought of as a temporary result set that is defined within the execution scope of a single SELECT, INSERT, UPDATE,<br>DELETE, or CREATE VIEW statement. A CTE is similar to a derived table in that it is not stored as an object and lasts only for the duration of the query. Unlike a derived table, a CTE can be self-referencing and can be referenced multiple times in the same query.<br>Subquery2: global temporary table<br>Global temporary tables are visible to any user and any connection after they are created, and are deleted when all users that are referencing the table disconnect from the instance of SQL Server.<br>Subquery3: local temporary table<br>Local temporary tables are visible only to their creators during the same connection to an instance of SQL Server as when the tables were first created or referenced. Local temporary tables are deleted after the user disconnects from the instance of SQL Server.<br>References:<br>https://technet.microsoft.com/en-us/library/ms190766(v=sql.105).aspx https://technet.microsoft.com/en-us/library/ms186986.aspx",
    "votes": [],
    "comments": [
      {
        "date": "2020-11-14T15:28:00.000Z",
        "voteCount": 6,
        "content": "This is correct."
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 41,
    "url": "https://www.examtopics.com/discussions/microsoft/view/3990-exam-70-761-topic-1-question-41-discussion/",
    "body": "You have a database that stored information about servers and application errors. The database contains the following tables.<br><br>Servers -<br><img src=\"/assets/media/exam-media/02675/0009400001.png\" class=\"in-exam-image\"><br><br>Errors -<br><img src=\"/assets/media/exam-media/02675/0009400002.png\" class=\"in-exam-image\"><br>You need to return all error log messages and the server where the error occurs most often.<br>Which Transact-SQL statement should you run?<br><img src=\"/assets/media/exam-media/02675/0009500001.png\" class=\"in-exam-image\"><br>A.<br><img src=\"/assets/media/exam-media/02675/0009500002.png\" class=\"in-exam-image\"><br>B.<br><img src=\"/assets/media/exam-media/02675/0009500003.png\" class=\"in-exam-image\"><br>C.<br><img src=\"/assets/media/exam-media/02675/0009500004.png\" class=\"in-exam-image\"><br>D.<br>",
    "options": [],
    "answer": "C",
    "answerDescription": "",
    "votes": [],
    "comments": [
      {
        "date": "2019-09-07T07:30:00.000Z",
        "voteCount": 16,
        "content": "More A Than C:\n\n\nDROP TABLE #ERRORS\nCREATE TABLE #ERRORS (\nERRORID INT PRIMARY KEY,\nSERVERID INT,\nOCCURENCES INT,\nLOGMESSAGE NVARCHAR(MAX)\n)\n\nINSERT INTO #ERRORS (ERRORID, SERVERID, OCCURENCES, LOGMESSAGE)\nVALUES \n(1, 1,3,'ERROR1'),\n(2,1,2,'ERROR2'),\n(3,1,10,'ERROR2'),\n(4,2,4,'ERROR2'),\n(5,2,14,'ERROR2'),\n(6,2,24,'ERROR1'),\n(7,3,10,'ERROR3'),\n(8,3,24,'ERROR3')\n\nSELECT DISTINCT SERVERID, LOGMESSAGE FROM #ERRORS AS E1\nWHERE OCCURENCES &gt; ALL (\nSELECT E2.OCCURENCES FROM #ERRORS AS E2\nWHERE E2.LOGMESSAGE = E1.LOGMESSAGE AND E2.SERVERID &lt;&gt; E1.SERVERID)\n\nSELECT\nDISTINCT SERVERID, LOGMESSAGE FROM #ERRORS AS E1 WHERE LOGMESSAGE IN (\nSELECT TOP 1 E2.LOGMESSAGE FROM #ERRORS AS E2 WHERE E1.LOGMESSAGE = E2.LOGMESSAGE AND E1.SERVERID &lt;&gt; E2.SERVERID\nORDER BY OCCURENCES \n)"
      },
      {
        "date": "2019-08-24T00:31:00.000Z",
        "voteCount": 9,
        "content": "C returns all errors for all servers. A is fine except that it will fail to return the entry when more than one server share the same highest occurrence of an error / errors."
      },
      {
        "date": "2019-09-20T06:25:00.000Z",
        "voteCount": 3,
        "content": "Agreed, Occurances &gt;= ALL will include both"
      },
      {
        "date": "2021-01-10T07:59:00.000Z",
        "voteCount": 1,
        "content": "Going further on the data set up by @Bartek. The best option should look like this:\n\nSELECT DISTINCT SERVERID, LOGMESSAGE FROM #ERRORS AS E1\nWHERE OCCURENCES &gt; ALL (\nSELECT  E2.OCCURENCES FROM #ERRORS AS E2\nWHERE E2.LOGMESSAGE = E1.LOGMESSAGE AND E2.SERVERID &lt;&gt; E1.SERVERID) \nGROUP BY OCCURENCES, SERVERID, LOGMESSAGE \nHAVING OCCURENCES = MAX(OCCURENCES)\n\nThis isn't part of the answer tho. So A comes closest"
      },
      {
        "date": "2020-12-10T05:40:00.000Z",
        "voteCount": 2,
        "content": "The correct answer is A\nThe subquery is joining to the main query on the LogMessage. So for each LogMessage, return the rows where ALL the rows in the subquery have fewer Occurrences. There is a filter to not compare a server with itself. \n\nThe query could be modified to leave out the e1.ServerID &lt;&gt; e2.ServerID can be left out. \nAnd we would then have the following fragment, which I think is more readable\nWHERE Occurrences &gt;= ALL (....)"
      },
      {
        "date": "2020-07-31T13:45:00.000Z",
        "voteCount": 3,
        "content": "Correct Answer: A"
      },
      {
        "date": "2020-01-15T22:50:00.000Z",
        "voteCount": 3,
        "content": "Frankly speaking none of existing solution seems clear/complete to the questions. Therefore come up with something new and try to make it look elegant. \n\n--kindly note: since question only asked most occurrences so in case there are same max  occurrences for the same error message across different servers, I used serverid as tiebreak.\nwith MOST_OCCURRENCES as\n\t(\n\tselect SERVERID, LOGMESSAGE, OCCURRENCES, ROW_NUMBER( ) over (PARTITION BY LOGMESSAGE order by OCCURRENCES, SERVERID desc) as occurrences_rank\n\tfrom ERRORS\n\t)\nselect DNS, LOGMESSAGE\nfrom MOST_OCCURRENCES mo join SERVERS sv on mo.SERVERID=sv.SERVERID\nwhere occurrences_rank=1\norder by OCCURRENCES desc;"
      },
      {
        "date": "2020-01-29T03:36:00.000Z",
        "voteCount": 1,
        "content": "Best to use rank() rather than row_number(), also order by should not include serverid."
      },
      {
        "date": "2020-08-19T05:05:00.000Z",
        "voteCount": 1,
        "content": "As you used row_number() instead of rank() there is no need for a \"tiebreaker\""
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 42,
    "url": "https://www.examtopics.com/discussions/microsoft/view/4861-exam-70-761-topic-1-question-42-discussion/",
    "body": "DRAG DROP -<br>You have a database that stored information about servers and application errors. The database contains the following tables.<br><br>Servers -<br><img src=\"/assets/media/exam-media/02675/0009600001.png\" class=\"in-exam-image\"><br><br>Errors -<br><img src=\"/assets/media/exam-media/02675/0009600002.png\" class=\"in-exam-image\"><br>You are building a webpage that shows the three most common errors for each server.<br>You need to return the data for the webpage.<br>How should you complete the Transact-SQL statement? To answer, drag the appropriate Transact-SQL segments to the correct location. Each Transact-SQL segment may be used once, more than once, or not at all. You may need to drag the split bar between panes or scroll to view content.<br>NOTE: Each correct selection is worth one point.<br>Select and Place:<br><img src=\"/assets/media/exam-media/02675/0009700001.jpg\" class=\"in-exam-image\"><br>",
    "options": [],
    "answer": "<img src=\"/assets/media/exam-media/02675/0009800001.jpg\" class=\"in-exam-image\">",
    "answerDescription": "",
    "votes": [],
    "comments": [
      {
        "date": "2019-09-07T08:50:00.000Z",
        "voteCount": 14,
        "content": "ORDER BY OCCURENCES DESC"
      },
      {
        "date": "2020-10-12T11:29:00.000Z",
        "voteCount": 3,
        "content": "missing distinct and desc \n\nCREATE TABLE #ERRORS (\nERRORID INT PRIMARY KEY,\nSERVERID INT,\nOCCURENCES INT,\nLOGMESSAGE NVARCHAR(MAX)\n)\n\nINSERT INTO #ERRORS (ERRORID, SERVERID, OCCURENCES, LOGMESSAGE)\nVALUES\n(1, 1,3,'ERROR1'),\n(2,1,2,'ERROR2'),\n(3,1,25,'ERROR4'),\n(4,1,24,'ERROR3'),\n(5,2,4,'ERROR2'),\n(6,2,14,'ERROR6'),\n(7,2,24,'ERROR1'),\n(8,2,24,'ERROR3'),\n(9,2,25,'ERROR5'),\n(10,3,10,'ERROR3'),\n(11,3,24,'ERROR7')\n\n\nselect distinct svr.SERVERID , errs.LOGMESSAGE \nfrom #ERRORS as svr\ncross apply\n( select top (3) LOGMESSAGE \n\tfrom #ERRORS \n\twhere SERVERID = svr.SERVERID\n\torder by OCCURENCES desc) as errs"
      },
      {
        "date": "2020-01-16T15:26:00.000Z",
        "voteCount": 2,
        "content": "Besides Bartek mentioned 'desc' issue, this solution seems doesn't work since ServerID exist in both tables and first reference without table name is ambiguous. \n\nwhere ServerID=svr.ServerID"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 43,
    "url": "https://www.examtopics.com/discussions/microsoft/view/3782-exam-70-761-topic-1-question-43-discussion/",
    "body": "You have a database named MyDb. You run the following Transact-SQL statements:<br><img src=\"/assets/media/exam-media/02675/0009900001.png\" class=\"in-exam-image\"><br>A value of 1 in the IsActive column indicates that a user is active.<br>You need to create a count for active users in each role. If a role has no active users. You must display a zero as the active users count.<br>Which Transact-SQL statement should you run?<br><img src=\"/assets/media/exam-media/02675/0009900002.png\" class=\"in-exam-image\"><br>A.<br><img src=\"/assets/media/exam-media/02675/0009900003.png\" class=\"in-exam-image\"><br>B.<br><img src=\"/assets/media/exam-media/02675/0009900004.png\" class=\"in-exam-image\"><br>C.<br><img src=\"/assets/media/exam-media/02675/0009900005.png\" class=\"in-exam-image\"><br>D.<br>",
    "options": [],
    "answer": "C",
    "answerDescription": "",
    "votes": [],
    "comments": [
      {
        "date": "2019-10-17T03:52:00.000Z",
        "voteCount": 12,
        "content": "the correct is A.\n\"If a role has no active users. You must display a zero as the active users count\"\nWITH COUNT(*) RETURN ALWAYS 1"
      },
      {
        "date": "2019-09-08T05:24:00.000Z",
        "voteCount": 8,
        "content": "explanation: COUNT(*) \u2013 Returns the total number of records in a table (Including NULL valued records). COUNT(Column Name) \u2013 Returns the total number of Non-NULL records"
      },
      {
        "date": "2021-01-13T06:34:00.000Z",
        "voteCount": 1,
        "content": "\"If a role has no active users. You must display a zero as the active users count.\"\nYou can only achieve this if you do a count on userid, so the answer has to be A."
      },
      {
        "date": "2021-01-01T08:33:00.000Z",
        "voteCount": 1,
        "content": "Correct answer is A although you can't GROUP BY roleID since it isn't in the select clause"
      },
      {
        "date": "2020-08-31T08:54:00.000Z",
        "voteCount": 1,
        "content": "Correct Ans is A \nwe have to count the no. of active users so, COUNT(UserID) will also work."
      },
      {
        "date": "2020-08-31T09:03:00.000Z",
        "voteCount": 1,
        "content": "Yes i have tested it. The correct ans is A. coz Count(*) will return 1 when there is no active user not 0."
      },
      {
        "date": "2020-08-10T19:34:00.000Z",
        "voteCount": 2,
        "content": "tested. the answer is \"A\""
      },
      {
        "date": "2020-07-06T10:51:00.000Z",
        "voteCount": 2,
        "content": "B: inner join omits roles with no active users\n\nC: group by has r.roleid...that is wrong\n\nD: cross join has no \"ON\" clause\n\nthus A is best answer"
      },
      {
        "date": "2020-05-08T07:13:00.000Z",
        "voteCount": 4,
        "content": "the answer is A"
      },
      {
        "date": "2020-05-07T22:03:00.000Z",
        "voteCount": 5,
        "content": "CREATE TABLE tblRole (\nRoleID int NOT NULL IDENTITY(1,1) PRIMARY KEY CLUSTERED,\nRoleName varchar(20) NOT NULL\n)\n\nCREATE TABLE tblUsers (\nUserID int NOT NULL IDENTITY(1000,1) PRIMARY KEY CLUSTERED,\nUserName varchar(20) UNIQUE NOT NULL,\nRoleID int NULL FOREIGN KEY REFERENCES tblRole(RoleID),\nIsActive bit NOT NULL DEFAULT(1)\n)\n\nINSERT INTO tblRole\nVALUES ('Supervisory'),\n       ('Management'),\n\t   ('HR'),\n\t   ('Accounting')\n\nINSERT INTO tblUsers\nVALUES ('Grakie', 2, DEFAULT),\n       ('Jen', 2, 0),\n\t   ('Bar', 2, DEFAULT),\n\t   ('Jude', 3, DEFAULT),\n\t   ('Paoula', 4, 0 ),\n\t   ('Gooses', 3, DEFAULT),\n\t   ('Harri', 3, DEFAULT)\n\n\nSELECT R.RoleName, ISNULL (U.ActiveUserCount,0) AS ActiveUserCount\nFROM tblRole R \nLEFT JOIN\n    (SELECT RoleId, COUNT(*) AS ActiveUserCount\n\tFROM tblUsers \n\tWHERE IsActive = 1 \n\tGROUP BY RoleId) U\nON r.RoleID = U.RoleID"
      },
      {
        "date": "2020-11-23T01:37:00.000Z",
        "voteCount": 1,
        "content": "The correct Answer is A. If you would choose C the NULL values are recorded as 1 not as 0.\nSELECT R.RoleName, COUNT(U.UserId) AS ActiveUserCount\nFROM tblRole R\nLEFT JOIN (SELECT UserId, RoleId FROM tblUsers WHERE IsActive = 1) U ON U.RoleID = R.RoleID\nGROUP BY R.RoleID, R.RoleName\n\nSELECT R.RoleName, COUNT(*) AS ActiveUserCount\nFROM tblRole R\nLEFT JOIN (SELECT UserId, RoleId FROM tblUsers WHERE IsActive = 1) U ON U.RoleID = R.RoleID\nGROUP BY R.RoleID, R.RoleName"
      },
      {
        "date": "2019-10-30T21:38:00.000Z",
        "voteCount": 2,
        "content": "How does C return a 0 when a role has no active user?"
      },
      {
        "date": "2020-12-10T06:00:00.000Z",
        "voteCount": 1,
        "content": "It won't"
      },
      {
        "date": "2019-10-17T03:54:00.000Z",
        "voteCount": 2,
        "content": "because the record in table Roles is always present"
      },
      {
        "date": "2019-08-19T04:39:00.000Z",
        "voteCount": 2,
        "content": "Any ideas for an explanatio why you cannot use Count(UserID)?"
      },
      {
        "date": "2020-11-21T18:24:00.000Z",
        "voteCount": 1,
        "content": "it's left join .  We need to count all rows for each  group or roles. not the rows which have userID not NULL"
      },
      {
        "date": "2019-08-21T02:37:00.000Z",
        "voteCount": 25,
        "content": "Actually we should use COUNT(U.UserID) as included in option A. It fulfills the requirement that when no active user it returns a 0, while COUNT(*) returns 1."
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 44,
    "url": "https://www.examtopics.com/discussions/microsoft/view/3991-exam-70-761-topic-1-question-44-discussion/",
    "body": "SIMULATION -<br>You have a table named Cities that has the following two columns: CityID and CityName. The CityID column uses the int data type, and CityName uses nvarchar<br>(max).<br>You have a table named RawSurvey. Each row includes an identifier for a question and the number of persons that responded to that question from each of four cities. The table contains the following representative data:<br><img src=\"/assets/media/exam-media/02675/0010000001.png\" class=\"in-exam-image\"><br>A reporting table named SurveyReport has the following columns: CityID, QuestionID, and RawCount, where RawCount is the value from the RawSurvey table.<br>You need to write a Transact-SQL query to meet the following requirements:<br>\u2711 Retrieve data from the RawSurvey table in the format of the SurveyReport table.<br>\u2711 The CityID must contain the CityID of the city that was surveyed.<br>\u2711 The order of cities in all SELECT queries must match the order in the RawSurvey table.<br>\u2711 The order of cities in all IN statements must match the order in the RawSurvey table.<br>Construct the query using the following guidelines:<br>\u2711 Use one-part names to reference tables and columns, except where not possible.<br>\u2711 ALL SELECT statements must specify columns.<br>\u2711 Do not use column or table aliases, except those provided.<br>Do not surround object names with square brackets.<br><img src=\"/assets/media/exam-media/02675/0010000009.png\" class=\"in-exam-image\"><br><img src=\"/assets/media/exam-media/02675/0010100001.png\" class=\"in-exam-image\"><br>Part of the correct Transact-SQL has been provided in the answer area below. Enter the code in the answer area that resolves the problem and meets the stated goals or requirements. You can add code within the code that has been provided as well as below it.<br><img src=\"/assets/media/exam-media/02675/0010200001.jpg\" class=\"in-exam-image\"><br>Use the Check Syntax button to verify your work. Any syntax or spelling errors will be reported by line and character position.<br>",
    "options": [],
    "answer": "Please see explanation",
    "answerDescription": "<img src=\"/assets/media/exam-media/02675/0010200002.png\" class=\"in-exam-image\"><br>UNPIVOT must be used to rotate columns of the Rawsurvey table into column values.<br>References:<br>https://technet.microsoft.com/en-us/library/ms177410(v=sql.105).aspx",
    "votes": [],
    "comments": [
      {
        "date": "2019-09-03T11:24:00.000Z",
        "voteCount": 21,
        "content": "The correct answer is:\nSELECT CityId, QuestionId, RawCount\nFROM RawSurvey AS t1\nUNPIVOT (RawCount FOR CityName IN ('Tokyo', 'Boston', 'London', 'NewYork')) AS t2\nJOIN Cities ON CityName = CityName;"
      },
      {
        "date": "2019-09-21T07:20:00.000Z",
        "voteCount": 10,
        "content": "----- IN (Tokyo, Boston, London, [New York])"
      },
      {
        "date": "2019-11-08T07:52:00.000Z",
        "voteCount": 6,
        "content": "SELECT CityId, QuestionId, RawCount\nFROM #RawSurvey AS t1\nUNPIVOT (RawCount FOR CityName IN (Tokyo, Boston, London, [New York])) AS t2\nJOIN #Cities C ON t2.CityName = C.CityName;"
      },
      {
        "date": "2020-10-12T12:58:00.000Z",
        "voteCount": 2,
        "content": "it says- Do not use column or table aliases, except those provided. - can't do Cities as C.\nWhy to give alias to #RawSurvey if that alias is not used ?\nShould be :\nSELECT CityID, QuestionID, RawCount \nFROM RawSurvey \nUNPIVOT (RawCount FOR CityName IN (Tokyo, Boston, London, [New York])) as t1\nJOIN Cities as t2 ON t1.CityName = t2.CityName"
      },
      {
        "date": "2020-01-29T08:34:00.000Z",
        "voteCount": 2,
        "content": "Tazul is RIGHT. No quotation marks here for column names"
      },
      {
        "date": "2020-07-31T22:10:00.000Z",
        "voteCount": 5,
        "content": "DECLARE @Cities TABLE(CityID int, CityName nvarchar(max))\nINSERT INTO @Cities SELECT 1, 'Tokyo'\nINSERT INTO @Cities SELECT 2, 'Boston'\nINSERT INTO @Cities SELECT 3, 'London'\nINSERT INTO @Cities SELECT 4, 'New York'\n\nDECLARE @RawSurvey TABLE(QuestionID nvarchar(2), Tokyo int, Boston int, London int, [New York] int)\nINSERT INTO @RawSurvey SELECT 'Q1', 1, 42, 48, 51\nINSERT INTO @RawSurvey SELECT 'Q2', 22, 39, 58, 42\nINSERT INTO @RawSurvey SELECT 'Q3', 29, 41, 61, 33\nINSERT INTO @RawSurvey SELECT 'Q4', 62, 70, 60, 50\nINSERT INTO @RawSurvey SELECT 'Q5', 63, 31, 41, 21\nINSERT INTO @RawSurvey SELECT 'Q6', 32, 1, 16, 34\n\nSELECT CityID, QuestionID, RawCount FROM @RawSurvey AS t1\nUNPIVOT (RawCount FOR CityName IN (Tokyo, Boston, London, [New York])) AS t2\nJOIN @Cities c ON t2.CityName = c.CityName"
      },
      {
        "date": "2020-09-12T11:12:00.000Z",
        "voteCount": 1,
        "content": "Tested and Worked"
      },
      {
        "date": "2020-12-10T08:46:00.000Z",
        "voteCount": 1,
        "content": "No single quotes are needed, cause these are column names not values."
      },
      {
        "date": "2019-11-08T07:53:00.000Z",
        "voteCount": 9,
        "content": "SELECT CityId, QuestionId, RawCount\nFROM\t\n(\n\tSELECT QuestionId, Tokyo, Boston, London, [New York] FROM #RawSurvey\n) AS t1\nUNPIVOT \n(\n\tRawCount FOR CityName IN (Tokyo, Boston, London, [New York])\n) AS t2\nINNER JOIN Cities \n\tON t2.CityName = Cities.CityName"
      },
      {
        "date": "2020-01-29T08:37:00.000Z",
        "voteCount": 2,
        "content": "confirmed. RIGHT"
      },
      {
        "date": "2020-05-15T12:56:00.000Z",
        "voteCount": 1,
        "content": "yes its very RIGHT"
      },
      {
        "date": "2020-05-15T13:03:00.000Z",
        "voteCount": 1,
        "content": "but the thing is that it must be New York and NOT NewYork"
      },
      {
        "date": "2020-07-31T14:25:00.000Z",
        "voteCount": 1,
        "content": "Select CityID, QuestionID, RawCount\nFROM (SELECT QuestionId, Tokyo, Boston, London, [New York] FROM RawSurvey) AS t1\nUNPIVOT (RawCount FOR CityName IN (Tokyo, Boston, London, [New York]) AS t2\nJOIN Cities ON t2.CityName = t1.CityName"
      },
      {
        "date": "2020-07-30T19:20:00.000Z",
        "voteCount": 2,
        "content": "1 Select CityID, QuestionID, RawCount\n2 FROM (SELECT QuestionId, Tokyo, Boston, London, [NewYork] FROM RawSurvey) AS t1\n3 UNPIVOT (RawCount FOR CityName IN (Tokyo, Boston, London, [NewYork]) AS t2\n4 JOIN Cities ON t2.CityName = t1.CityName"
      },
      {
        "date": "2020-07-30T19:19:00.000Z",
        "voteCount": 3,
        "content": "1 Select CityID, QuestionID, RawCount\n2 FROM (SELECT QuestionId, Tokyo, Boston, London, NewYork FROM RawSurvey) AS t1\n3 UNPIVOT (RawCount FOR CityName IN (Tokyo, Boston, London, NewYork)) AS t2\n4 JOIN Cities ON t2.CityName = t1.CityName"
      },
      {
        "date": "2020-05-08T10:25:00.000Z",
        "voteCount": 1,
        "content": "select CityId,QuestionId,RawCount\n\tfrom (select QuestionId,\n\t\t\t\t[Tokyo] as [1],\n\t\t\t\t[Boston] as [2],\n\t\t\t\t[London] as [3],\n\t\t\t\t[NewYork] as [4] from RawSurvey) as Src\nunpivot(Rawcount for CityId in ([1],[2],[3],[4])) as Unp"
      },
      {
        "date": "2020-02-23T10:05:00.000Z",
        "voteCount": 1,
        "content": "with Cities  as (\nselect * from (values\n(1,'Tokyo'     ),\n(2,'Boston'   ),\n(3,'London'   ),\n(4,'New York'))v(CityId,CityName))\n,RawSurvey as (\nselect * from (values \n('Q1',1, 42,48,51),\n('Q2',22,39,58,42),\n('Q3',29,41,61,33),\n('Q4',62,70,60,50),\n('Q5',63,31,41,21),\n('Q6',32,1, 16,34))v(QuestionId,\n[Tokyo],   \n[Boston], \n[London],\n[New York]))\nSELECT CityID, questionId, rawCount\n\nfrom RawSurvey as t1\nunpivot (rawCount for City in( \n[Tokyo],   \n[Boston], \n[London],\n[New York])) as t2\njoin Cities  on CityName = t2.City"
      },
      {
        "date": "2020-05-08T07:25:00.000Z",
        "voteCount": 1,
        "content": "There is no keyword 'with' so you can't use CTE"
      },
      {
        "date": "2020-05-29T04:32:00.000Z",
        "voteCount": 1,
        "content": "The purpose was just to have the example data from the question in your query to try it out on your own. The answer is just the last part."
      },
      {
        "date": "2020-02-10T02:08:00.000Z",
        "voteCount": 1,
        "content": "select cityid, questionid, rawcount\nfrom (select questionid, tokyo, etc)) as t1\nunpivot( rawcount for cityname in(tokyo, etc) as t2\njoin cities on t2.cityname = t1.cityname"
      },
      {
        "date": "2020-01-13T07:06:00.000Z",
        "voteCount": 1,
        "content": "my version (not tested)\nselect CityID, QuestionID, RawCount\nfrom\n (select QuestionID, CityName, RawCount\n from Rawsurvey\n   unpivot RawCount for CityName in (Tokyo, Boston, London, [New York]) as t1) as t2\njoin Cities on Cities.CityName = t2.CityName"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 45,
    "url": "https://www.examtopics.com/discussions/microsoft/view/3523-exam-70-761-topic-1-question-45-discussion/",
    "body": "DRAG DROP -<br>You create three tables by running the following Transact-SQL statements:<br><img src=\"/assets/media/exam-media/02675/0010300001.jpg\" class=\"in-exam-image\"><br>For reporting purposes, you need to find the active user count for each role, and the total active user count. The result must be ordered by active user count of each role. You must use common table expressions (CTEs).<br>Which four Transact-SQL segments should you use to develop the solution? To answer, move the appropriate Transact-SQL segments from the list of Transact-<br>SQL segments to the answer area and arrange them in the correct order.<br>Select and Place:<br><img src=\"/assets/media/exam-media/02675/0010400001.png\" class=\"in-exam-image\"><br>",
    "options": [],
    "answer": "<img src=\"/assets/media/exam-media/02675/0010500001.png\" class=\"in-exam-image\">",
    "answerDescription": "",
    "votes": [],
    "comments": [
      {
        "date": "2019-08-12T23:21:00.000Z",
        "voteCount": 31,
        "content": "\"With ActiveUsers\" segment should be the first one followed by \"RoleNCount\" segment, because \"WITH\" keyword is used to start the CTE definition which is then followed by multiple CTE definitions with same \"WITH\" keyword separtaed by \"Commas\". Also the \"RoleSummary\" segment should be the one wihout \"ORDER BY\" clause because CTEs are not allowed to have \"ORDER BY\" clause without \"TOP\" or \"FETCH\" caluses inside."
      },
      {
        "date": "2020-05-08T11:42:00.000Z",
        "voteCount": 3,
        "content": "Plus the forth segment whish is the CTE that starts with Total and ends with order by .."
      },
      {
        "date": "2020-11-16T13:00:00.000Z",
        "voteCount": 10,
        "content": "Answer:\n;WITH ActiveUsers AS (\n\t\t\t\t\t\tSELECT userID\n\t\t\t\t\t\tFROM tblUsers\n\t\t\t\t\t\tWHERE IsActive = 1\n\t\t\t\t\t\t),\nRoleNCount AS\t\t\t(\n\t\t\t\t\t\tSELECT RoleId, COUNT (*) AS ActiveUserCount\n\t\t\t\t\t\tFROM tblUsersInRoles BRG\n\t\t\t\t\t\tINNER JOIN ActiveUsers U ON BRG.UserID = U.UserID\n\t\t\t\t\t\tGROUP BY BRG.RoleID\n\t\t\t\t\t\t),\nRoleSummary AS\t\t\t(\n\t\t\t\t\t\tSELECT R.RoleName, ISNULL(S.ActiveUserCount,0) AS ActiveUserCount\n\t\t\t\t\t\tFROM tblRole R\n\t\t\t\t\t\tLEFT JOIN RoleNCount S ON R.RoleID = S.RoleID\n\t\t\t\t\t\t),\nTotal AS\t\t\t\t(\n\t\t\t\t\t\tSELECT COUNT (*) AS TotalCountInAllRoles\n\t\t\t\t\t\tFROM ActiveUsers\n\t\t\t\t\t\t)\nSELECT S.*, Total.TotalCountInAllRoles\nFROM RoleSummary AS S, Total\nORDER BY S.ActiveUserCount;"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 46,
    "url": "https://www.examtopics.com/discussions/microsoft/view/17565-exam-70-761-topic-1-question-46-discussion/",
    "body": "Note: This question is part of a series of questions that use the same or similar answer choices. An answer choice may be correct for more than one question in the series. Each question is independent of the other questions in this series. Information and details provided in a question apply only to that question.<br>You have a database that contains tables named Customer_CRMSystem and Customer_HRSystem. Both tables use the following structure:<br><img src=\"/assets/media/exam-media/02675/0010600001.png\" class=\"in-exam-image\"><br>The tables include the following records:<br><br>Customer_CRMSystem -<br><img src=\"/assets/media/exam-media/02675/0010600002.png\" class=\"in-exam-image\"><br><br>Customer_HRSystem -<br><img src=\"/assets/media/exam-media/02675/0010700001.png\" class=\"in-exam-image\"><br>Records that contain null values for CustomerCode can be uniquely identified by CustomerName.<br>You need to display a list of customers that do not appear in the Customer_HRSystem table.<br>Which Transact-SQL statement should you run?<br><img src=\"/assets/media/exam-media/02675/0010700002.png\" class=\"in-exam-image\"><br>A.<br><img src=\"/assets/media/exam-media/02675/0010700003.png\" class=\"in-exam-image\"><br>B.<br><img src=\"/assets/media/exam-media/02675/0010700004.png\" class=\"in-exam-image\"><br>C.<br><img src=\"/assets/media/exam-media/02675/0010800001.png\" class=\"in-exam-image\"><br>D.<br><img src=\"/assets/media/exam-media/02675/0010800002.png\" class=\"in-exam-image\"><br>E.<br><img src=\"/assets/media/exam-media/02675/0010800003.png\" class=\"in-exam-image\"><br>F.<br><img src=\"/assets/media/exam-media/02675/0010800004.png\" class=\"in-exam-image\"><br>G.<br><img src=\"/assets/media/exam-media/02675/0010800005.png\" class=\"in-exam-image\"><br>H.<br>",
    "options": [],
    "answer": "D",
    "answerDescription": "EXCEPT returns distinct rows from the left input query that aren't output by the right input query.<br>References:<br>https://msdn.microsoft.com/en-us/library/ms188055.aspx",
    "votes": [],
    "comments": [
      {
        "date": "2020-05-02T04:11:00.000Z",
        "voteCount": 8,
        "content": "D is the correct answer, only gives what is in CRM"
      },
      {
        "date": "2020-09-12T10:12:00.000Z",
        "voteCount": 7,
        "content": "D is the correct Answer. The question clearly says the CustomerNames can be uniquely identified even though the CustomerCode is null, so we need to to retrieve those customers as well whose customerCode is null . This is possible using except. Except will give you all the rows in CRM which are not present in HRS. \nThis can be achieved by left outer join as well but the join condition should be on CustomerName but in option C its joined in CustoemrCode which contains nulll values hence whenever the join finds null in customerCode it straight away ignores it. so you would not get expected results with Left outer join in C option, so the answer is D.\nHope this helps.\nHappy learning :)"
      },
      {
        "date": "2021-01-06T22:39:00.000Z",
        "voteCount": 1,
        "content": "yes agreed"
      },
      {
        "date": "2021-01-13T07:15:00.000Z",
        "voteCount": 1,
        "content": "It should be D. Given the fact that the answer letters are below the possible solutions this causes confusion. But it is the one with the 'EXCEPT' in it."
      },
      {
        "date": "2021-01-01T08:54:00.000Z",
        "voteCount": 1,
        "content": "EXCEPT is correct, can't use LEFT OUTER JOIN because you'll get every entry in the CRM system regardless of the ON clause"
      },
      {
        "date": "2020-10-22T18:33:00.000Z",
        "voteCount": 1,
        "content": "D is the correct answer. Except returns the distinct values from the left query only."
      },
      {
        "date": "2020-04-09T23:51:00.000Z",
        "voteCount": 1,
        "content": "C is the correct one."
      },
      {
        "date": "2020-04-24T10:47:00.000Z",
        "voteCount": 4,
        "content": "D is the correct on"
      },
      {
        "date": "2020-06-25T16:44:00.000Z",
        "voteCount": 1,
        "content": "Incorrect. C returns all rows from CRMSystem, regardless of whether they appear in HRSystem."
      },
      {
        "date": "2020-11-17T11:22:00.000Z",
        "voteCount": 1,
        "content": "Only returns rows that aren\u00b4t in HRSystem. Check the ON condition"
      },
      {
        "date": "2020-03-27T19:47:00.000Z",
        "voteCount": 1,
        "content": "I think C and D are both okay."
      },
      {
        "date": "2020-06-25T16:44:00.000Z",
        "voteCount": 2,
        "content": "Incorrect. C returns all rows from CRMSystem, regardless of whether they appear in HRSystem."
      },
      {
        "date": "2020-11-17T11:21:00.000Z",
        "voteCount": 1,
        "content": "Only returns rows that aren\u00b4t in HRSystem. Check the ON condition"
      },
      {
        "date": "2020-12-25T14:00:00.000Z",
        "voteCount": 1,
        "content": "C isn't okay  because it 's filtering by CustomerCode  then values where CustomerCode is NULL will be excluded from the result set."
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 47,
    "url": "https://www.examtopics.com/discussions/microsoft/view/5560-exam-70-761-topic-1-question-47-discussion/",
    "body": "Note: This question is part of a series of questions that use the same or similar answer choices. An answer choice may be correct for more than one question in the series. Each question is independent of the other questions in this series. Information and details provided in a question apply only to that question.<br>You have a database that contains tables named Customer_CRMSystem and Customer_HRSystem. Both tables use the following structure:<br><img src=\"/assets/media/exam-media/02675/0010900001.png\" class=\"in-exam-image\"><br>The tables include the following records:<br><br>Customer_CRMSystem -<br><img src=\"/assets/media/exam-media/02675/0010900002.png\" class=\"in-exam-image\"><br><br>Customer_HRSystem -<br><img src=\"/assets/media/exam-media/02675/0011000001.png\" class=\"in-exam-image\"><br>Records that contain null values for CustomerCode can be uniquely identified by CustomerName.<br>You need to display customers who appear in both tables and have a proper CustomerCode.<br>Which Transact-SQL statement should you run?<br><img src=\"/assets/media/exam-media/02675/0011000002.png\" class=\"in-exam-image\"><br>A.<br><img src=\"/assets/media/exam-media/02675/0011000003.png\" class=\"in-exam-image\"><br>B.<br><img src=\"/assets/media/exam-media/02675/0011000004.png\" class=\"in-exam-image\"><br>C.<br><img src=\"/assets/media/exam-media/02675/0011100001.png\" class=\"in-exam-image\"><br>D.<br><img src=\"/assets/media/exam-media/02675/0011100002.png\" class=\"in-exam-image\"><br>E.<br>",
    "options": [],
    "answer": "A",
    "answerDescription": "When there are null values in the columns of the tables being joined, the null values do not match each other. The presence of null values in a column from one of the tables being joined can be returned only by using an outer join (unless the WHERE clause excludes null values).<br>References:<br>https://technet.microsoft.com/en-us/library/ms190409(v=sql.105).aspx",
    "votes": [],
    "comments": [
      {
        "date": "2020-05-29T06:14:00.000Z",
        "voteCount": 4,
        "content": "The one and only correct answer A for everyone to try out:\n\nCREATE TABLE #CRM (\n       CustomerID INT NOT NULL,\n       CustomerCode char(4) NULL,\n       CustomerName varchar(50) NOT NULL\n);\n\nCREATE TABLE #HR (\n       CustomerID INT NOT NULL,\n       CustomerCode char(4) NULL,\n       CustomerName varchar(50) NOT NULL\n);\n \nINSERT INTO #CRM(CustomerID, CustomerCode, CustomerName)\nVALUES\n       (1, 'CUS1', 'Roya'),\n       (2, 'CUS9', 'Almundena'),\n       (3, 'CUS4', 'Jack'),\n       (4, NULL, 'Jane'),\n       (5, NULL, 'Francisco');\n\nINSERT INTO #HR(CustomerID, CustomerCode, CustomerName)\nVALUES\n       (1, 'CUS1', 'Roya'),\n       (2, 'CUS2', 'Jose'),\n       (3, 'CUS9', 'Almundena'),\n       (4, NULL, 'Jane');\n\nSELECT c.CustomerCode, c.CustomerName, h.CustomerCode, h.CustomerName\nFROM #CRM c\nINNER JOIN #HR h ON c.CustomerCode = h.CustomerCode AND c.CustomerName = h.CustomerName;\n\nDROP TABLE #CRM;\nDROP TABLE #HR;"
      },
      {
        "date": "2020-07-09T08:18:00.000Z",
        "voteCount": 1,
        "content": "this is goood; does not return Jane bc her null custcode\nCustomerCode\tCustomerName\tCustomerCode\tCustomerName\nCUS1\tRoya\tCUS1\tRoya\nCUS9\tAlmundena\tCUS9\tAlmundena"
      },
      {
        "date": "2021-01-01T09:13:00.000Z",
        "voteCount": 1,
        "content": "Agree - thanks for the code. Could leave out the AND CustomerName part of the join - has nothing to do with the question asked"
      },
      {
        "date": "2020-02-26T14:22:00.000Z",
        "voteCount": 1,
        "content": "I checked it. Both A and B is correct answer"
      },
      {
        "date": "2020-01-20T11:29:00.000Z",
        "voteCount": 2,
        "content": "A is correct.\n\nB incorrect see comment Bartek.\nD isncorrect: The T-SQL EXCEPT operator, added in SQL Server 2005, returns only distinct rows that appear in one set and not the other. Specifically, EXCEPT returns rows from the input set listed first in the query."
      },
      {
        "date": "2019-11-13T00:25:00.000Z",
        "voteCount": 1,
        "content": "Both A and B is incorrect man.  The correct answer is  \"SELECT CustomerCode, CustomerName\nFROM Customer_CRMSystem\nEXCEPT\nSELECT CustomerCode, CustomerName\nFROM Customer_HRSystem\""
      },
      {
        "date": "2019-09-21T23:51:00.000Z",
        "voteCount": 2,
        "content": "I think correct answer is both A and B."
      },
      {
        "date": "2019-09-24T11:47:00.000Z",
        "voteCount": 26,
        "content": "Just A \n\"..and have a proper CustomerCode.\"\nIntersect II keep NULL values"
      },
      {
        "date": "2020-11-16T14:14:00.000Z",
        "voteCount": 1,
        "content": "Only A is correct, with Intersect it reads the Nulls as equals, therefore it will return all Customers whether or not they have a proper CustomerCode."
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 48,
    "url": "https://www.examtopics.com/discussions/microsoft/view/37131-exam-70-761-topic-1-question-48-discussion/",
    "body": "Note: This question is part of a series of questions that use the same or similar answer choices. An answer choice may be correct for more than one question in the series. Each question is independent of the other questions in this series. Information and details provided in a question apply only to that question.<br>You have a database that contains tables named Customer_CRMSystem and Customer_HRSystem. Both tables use the following structure:<br><img src=\"/assets/media/exam-media/02675/0011100003.png\" class=\"in-exam-image\"><br>The tables include the following records:<br><br>Customer_CRMSystem -<br><img src=\"/assets/media/exam-media/02675/0011200001.png\" class=\"in-exam-image\"><br><br>Customer_HRSystem -<br><img src=\"/assets/media/exam-media/02675/0011200002.png\" class=\"in-exam-image\"><br>Records that contain null values for CustomerCode can be uniquely identified by CustomerName.<br>You need to display a Cartesian product, combining both tables.<br>Which Transact-SQL statement should you run?<br><img src=\"/assets/media/exam-media/02675/0011200003.png\" class=\"in-exam-image\"><br>A.<br><img src=\"/assets/media/exam-media/02675/0011300001.png\" class=\"in-exam-image\"><br>B.<br><img src=\"/assets/media/exam-media/02675/0011300002.png\" class=\"in-exam-image\"><br>C.<br><img src=\"/assets/media/exam-media/02675/0011300003.png\" class=\"in-exam-image\"><br>D.<br><img src=\"/assets/media/exam-media/02675/0011300004.png\" class=\"in-exam-image\"><br>E.<br><img src=\"/assets/media/exam-media/02675/0011300005.png\" class=\"in-exam-image\"><br>F.<br><img src=\"/assets/media/exam-media/02675/0011400001.png\" class=\"in-exam-image\"><br>G.<br><img src=\"/assets/media/exam-media/02675/0011400002.png\" class=\"in-exam-image\"><br>H.<br>",
    "options": [],
    "answer": "G",
    "answerDescription": "A cross join that does not have a WHERE clause produces the Cartesian product of the tables involved in the join. The size of a Cartesian product result set is the number of rows in the first table multiplied by the number of rows in the second table.<br>References:<br>https://technet.microsoft.com/en-us/library/ms190690(v=sql.105).aspx",
    "votes": [],
    "comments": [
      {
        "date": "2020-11-16T14:19:00.000Z",
        "voteCount": 5,
        "content": "Pretty easy, huh!"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 49,
    "url": "https://www.examtopics.com/discussions/microsoft/view/37761-exam-70-761-topic-1-question-49-discussion/",
    "body": "Note: This question is part of a series of questions that use the same or similar answer choices. An answer choice may be correct for more than one question in the series. Each question is independent of the other questions in this series. Information and details provided in a question apply only to that question.<br>You have a database that contains tables named Customer_CRMSystem and Customer_HRSystem. Both tables use the following structure:<br>The tables include the following records:<br><br>Customer_CRMSystem -<br><img src=\"/assets/media/exam-media/02675/0011500001.png\" class=\"in-exam-image\"><br><br>Customer_HRSystem -<br><img src=\"/assets/media/exam-media/02675/0011500002.png\" class=\"in-exam-image\"><br>Records that contain null values for CustomerCode can be uniquely identified by CustomerName.<br>You need to create a list of all unique customers that appear in either table.<br>Which Transact-SQL statement should you run?<br><img src=\"/assets/media/exam-media/02675/0011500003.png\" class=\"in-exam-image\"><br>A.<br><img src=\"/assets/media/exam-media/02675/0011600001.png\" class=\"in-exam-image\"><br>B.<br><img src=\"/assets/media/exam-media/02675/0011600002.png\" class=\"in-exam-image\"><br>C.<br><img src=\"/assets/media/exam-media/02675/0011600003.png\" class=\"in-exam-image\"><br>D.<br><img src=\"/assets/media/exam-media/02675/0011600004.png\" class=\"in-exam-image\"><br>E.<br><img src=\"/assets/media/exam-media/02675/0011600005.png\" class=\"in-exam-image\"><br>F.<br><img src=\"/assets/media/exam-media/02675/0011700001.png\" class=\"in-exam-image\"><br>G.<br><img src=\"/assets/media/exam-media/02675/0011700002.png\" class=\"in-exam-image\"><br>H.<br>",
    "options": [],
    "answer": "E",
    "answerDescription": "UNION combines the results of two or more queries into a single result set that includes all the rows that belong to all queries in the union. The UNION operation is different from using joins that combine columns from two tables.<br>Incorrect Answers:<br>F: UNION ALL incorporates all rows into the results. This includes duplicates. If not specified, duplicate rows are removed.<br>References:<br>https://msdn.microsoft.com/en-us/library/ms180026.aspx",
    "votes": [],
    "comments": [
      {
        "date": "2020-11-25T05:36:00.000Z",
        "voteCount": 5,
        "content": "I agree"
      },
      {
        "date": "2021-01-04T14:19:00.000Z",
        "voteCount": 2,
        "content": "E is correct."
      },
      {
        "date": "2020-12-21T14:02:00.000Z",
        "voteCount": 4,
        "content": "Correct"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 50,
    "url": "https://www.examtopics.com/discussions/microsoft/view/40081-exam-70-761-topic-1-question-50-discussion/",
    "body": "DRAG DROP -<br>Note: This question is part of a series of questions that use the same scenario. For your convenience, the scenario is repeated in each question. Each question presents a different goal and answer choices, but the text of the scenario is exactly the same in each question in this series.<br>You are developing a database to track customer orders. The database contains the following tables: Sales.Customers, Sales.Orders, and Sales.OrderLines. The following table describes the columns in Sales.Customers.<br><img src=\"/assets/media/exam-media/02675/0011800001.png\" class=\"in-exam-image\"><br>The following table describes the columns in Sales.Orders.<br><img src=\"/assets/media/exam-media/02675/0011800002.png\" class=\"in-exam-image\"><br>The following table describes the columns in Sales.OrderLines.<br><img src=\"/assets/media/exam-media/02675/0011800003.png\" class=\"in-exam-image\"><br>You need to create a function that accepts a CustomerID as a parameter and returns the following information:<br>\u2711 all customer information for the customer<br>the total number of orders for the customer<br><img src=\"/assets/media/exam-media/02675/0011800005.png\" class=\"in-exam-image\"><br>\u2711 the total price of all orders for the customer<br>\u2711 the average quantity of items per order<br>How should you complete the function definition? To answer, drag the appropriate Transact-SQL segment to the correct locations. Transact-SQL segment may be used once, more than once, or not at all. You may need to drag the split bar between panes or scroll to view content.<br>Select and Place:<br><img src=\"/assets/media/exam-media/02675/0011900003.jpg\" class=\"in-exam-image\"><br>",
    "options": [],
    "answer": "<img src=\"/assets/media/exam-media/02675/0012000001.jpg\" class=\"in-exam-image\">",
    "answerDescription": "Box1: RETURNS TABLE -<br>The function should return the following information:<br>\u2711 all customer information for the customer<br>\u2711 the total number of orders for the customer<br>\u2711 the total price of all orders for the customer<br>\u2711 the average quantity of items per order<br><br>Box 2: COUNT -<br>The function should return the total number of orders for the customer.<br><br>Box 3: SUM -<br>The function should return the total price of all orders for the customer.<br><br>Box 3. AVG -<br>The function should return the average quantity of items per order.<br><br>Box 4: GROUP BY -<br>Need to use GROUP BY for the aggregate functions.<br>References:<br>https://msdn.microsoft.com/en-us/library/ms186755.aspx",
    "votes": [],
    "comments": [
      {
        "date": "2021-01-07T04:17:00.000Z",
        "voteCount": 1,
        "content": "I agree"
      },
      {
        "date": "2020-12-16T11:39:00.000Z",
        "voteCount": 2,
        "content": "Correctimundo"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 51,
    "url": "https://www.examtopics.com/discussions/microsoft/view/40082-exam-70-761-topic-1-question-51-discussion/",
    "body": "HOTSPOT -<br>Note: This question is part of a series of questions that use the same scenario. For your convenience, the scenario is repeated in each question. Each question presents a different goal and answer choices, but the text of the scenario is exactly the same in each question in this series.<br>You are developing a database to track customer orders. The database contains the following tables: Sales.Customers, Sales.Orders, and Sales.OrderLines.<br>The following table describes the columns in Sales.Customers.<br><img src=\"/assets/media/exam-media/02675/0012100001.png\" class=\"in-exam-image\"><br>The following table describes the columns in Sales.Orders.<br><img src=\"/assets/media/exam-media/02675/0012200001.png\" class=\"in-exam-image\"><br>The following table describes the columns in Sales.OrderLines.<br><img src=\"/assets/media/exam-media/02675/0012200002.png\" class=\"in-exam-image\"><br>You need to create a database object that calculates the total price of an order including the sales tax. The database object must meet the following requirements:<br>\u2711 Reduce the compilation cost of Transact-SQL code by caching the plans and reusing them for repeated execution.<br>\u2711 Return a value.<br>\u2711 Be callable from a SELECT statement.<br>How should you complete the Transact-SQL statements? To answer, select the appropriate Transact-SQL segments in the answer area.<br>Hot Area:<br><img src=\"/assets/media/exam-media/02675/0012300001.png\" class=\"in-exam-image\"><br>",
    "options": [],
    "answer": "<img src=\"/assets/media/exam-media/02675/0012400001.jpg\" class=\"in-exam-image\">",
    "answerDescription": "Box 1: FUNCTION -<br>To be able to return a value we should use a scalar function.<br>CREATE FUNCTION creates a user-defined function in SQL Server and Azure SQL Database. The return value can either be a scalar (single) value or a table.<br>Box 2: RETURNS decimal(18,2)<br>Use the same data format as used in the UnitPrice column.<br><br>Box 3: BEGIN -<br>Transact-SQL Scalar Function Syntax include the BEGIN ..END construct.<br>CREATE [ OR ALTER ] FUNCTION [ schema_name. ] function_name<br>( [ { @parameter_name [ AS ][ type_schema_name. ] parameter_data_type<br>[ = default ] [ READONLY ] }<br>[ ,...n ]<br>]<br>)<br><br>RETURNSreturn_data_type -<br>[ WITH &lt;function_option&gt; [ ,...n ] ]<br>[ AS ]<br><br>BEGIN -<br>function_body<br><br>RETURN scalar_expression -<br><br>END -<br>[ ; ]<br>Box 4: @OrderPrice * @CalculatedTaxRate<br>Calculate the price including tax.<br><br>Box 5: END -<br>Transact-SQL Scalar Function Syntax include theBEGIN ..END construct.<br>References:<br>https://msdn.microsoft.com/en-us/library/ms186755.aspx",
    "votes": [],
    "comments": [
      {
        "date": "2021-01-05T08:45:00.000Z",
        "voteCount": 1,
        "content": "Correct"
      },
      {
        "date": "2020-12-16T11:39:00.000Z",
        "voteCount": 2,
        "content": "Correctimundo"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 52,
    "url": "https://www.examtopics.com/discussions/microsoft/view/4681-exam-70-761-topic-1-question-52-discussion/",
    "body": "DRAG DROP -<br>Note: This question is part of a series of questions that use the same scenario. For your convenience, the scenario is repeated in each question. Each question presents a different goal and answer choices, but the text of the scenario is exactly the same in each question in this series.<br>You are developing a database to track customer orders. The database contains the following tables: Sales.Customers, Sales.Orders, and Sales.OrderLines. The following table describes the columns in Sales.Customers.<br><img src=\"/assets/media/exam-media/02675/0012600001.png\" class=\"in-exam-image\"><br>The following table describes the columns in Sales.Orders.<br><img src=\"/assets/media/exam-media/02675/0012600002.png\" class=\"in-exam-image\"><br>The following table describes the columns in Sales.OrderLines.<br><img src=\"/assets/media/exam-media/02675/0012600003.png\" class=\"in-exam-image\"><br>You need to create a stored procedure that inserts data into the Customers table. The stored procedure must meet the following requirements:<br>\u2711 Data changes occur as a single unit of work.<br>Data modifications that are successful are committed and a value of 0 is returned to the calling procedure.<br><img src=\"/assets/media/exam-media/02675/0012600005.png\" class=\"in-exam-image\"><br>\u2711 Data modifications that are unsuccessful are rolled back. You must display a message that uses severity level 16 and a value of -1.<br>\u2711 The stored procedure uses a built-in scalar function to evaluate the current condition of data modifications.<br>\u2711 The entire unit of work is terminated and rolled back if a run-time error occurs during execution of the stored procedure.<br>How should complete the stored procedure definition? To answer, drag the appropriate Transact-SQL segments to the correct targets. Each Transact-SQL segment may be used once, more than once, or not at all. You may need to drag the split bar between panes or scroll to view content.<br>NOTE: Each correct selection is worth one point.<br>Select and Place:<br><img src=\"/assets/media/exam-media/02675/0012700004.jpg\" class=\"in-exam-image\"><br>",
    "options": [],
    "answer": "<img src=\"/assets/media/exam-media/02675/0012800001.jpg\" class=\"in-exam-image\">",
    "answerDescription": "Box 1: XACT_ABORT -<br>XACT_ABORT specifies whether SQL Server automatically rolls back the current transaction when a Transact-SQL statement raises a run-time error.<br>When SET XACT_ABORT is ON, if a Transact-SQL statement raises a run-timeerror, the entire transaction is terminated and rolled back.<br><br>Box 2: COMMIT -<br>Commit the transaction.<br><br>Box 3: XACT_STATE -<br><br>Box 4: ROLLBACK -<br><br>Rollback the transaction -<br><br>Box 5: THROW -<br>THROW raises an exception and the severity is set to 16.<br>Requirement: Data modifications that are unsuccessful are rolled back. The exception severity level is set to 16 and a value of -1 is returned.<br>References:<br>https://msdn.microsoft.com/en-us/library/ms188792.aspx<br>https://msdn.microsoft.com/en-us/library/ee677615.aspx",
    "votes": [],
    "comments": [
      {
        "date": "2019-09-04T03:28:00.000Z",
        "voteCount": 13,
        "content": "a line terminator ; is required before THROW keyword, otherwise it will throw syntax error"
      },
      {
        "date": "2020-05-16T04:44:00.000Z",
        "voteCount": 2,
        "content": "YES\n ; is needed in the end of Print statement"
      },
      {
        "date": "2021-01-10T12:03:00.000Z",
        "voteCount": 2,
        "content": "CREATE PROCEDURE InsertCustomer\n@CustomerName nvarchar(100),\n@PhoneNumber nvarchar(20),\n@AccountOpenedDate date,\n@StandardDiscountPercentage decimal(18,3),\n@CreditLimit decimal(18,2),\n@IsCreditOnHold bit,\n@DeliveryLongitude nvarchar(50),\n@DeliveryLatitude nvarchar(50)\nAS\nBEGIN\n\tSET NOCOUNT ON\n\t\tSET XACT_ABORT ON\n\nBEGIN TRY\n\tBEGIN TRANSACTION\n\t\tINSERT INTO Customer(CustomerName,PhoneNumber,AccountOpenedDate,StandardDiscountPercentage, CreditLimit,IsCreditOnHold, DeliveryLocation)\n\t\tVALUES\n\t\t(@CustomerName,@PhoneNumber,@AccountOpenedDate, @StandardDiscountPercentage, @CreditLimit,@IsCreditOnHold, geography::Point(ISNULL(@DeliveryLongitude, ''), ISNULL(@DeliveryLatitude, ''), 4326))\n\t\tCOMMIT TRANSACTION\n\tEND TRY\n\t\tBEGIN CATCH\n\t\t\tIF XACT_STATE () &lt;&gt; 0 ROLLBACK TRANSACTION\n\t\t\tPRINT 'Unable to create the customer record.';\n\t\t\tTHROW;\n\t\t\tRETURN -1\n\t\tEND CATCH\n\t\tRETURN 0\n\t\tEND"
      },
      {
        "date": "2021-01-10T12:03:00.000Z",
        "voteCount": 1,
        "content": "Tested answer:\nDROP TABLE Customer\nCREATE TABLE Customer (\nCustomerName nvarchar(100) NOT NULL,\nPhoneNumber nvarchar(20) NULL,\nAccountOpenedDate date NOT NULL,\nStandardDiscountPercentage decimal(18,3) NULL,\nCreditLimit decimal(18,2) NULL,\nIsCreditOnHold bit NOT NULL,\nDeliveryLocation geography NOT NULL)\n\nINSERT INTO Customer\nVALUES \n('Person Name', '0612345678', '2019-01-05', 15, 10000, 0, '145125255'),\n('Someone Lastname', '0698765432', '2019-07-15', 6, 0, 1000, '145752755')\nContinue next comment...."
      },
      {
        "date": "2021-01-04T14:41:00.000Z",
        "voteCount": 1,
        "content": "Why are so many ppl commenting about things that have NOTHING to do with the freaking answer? Who cares that there's \"return -1\" at the very end. In no way, shape, or form, does that dictate the answer selections. Stop wasting people's time."
      },
      {
        "date": "2021-01-01T09:44:00.000Z",
        "voteCount": 1,
        "content": "Agreed that everything is correct except that there is no possible way to return -1 becaue THROW would end the CATCH and RAISERROR as a statement with no parameters wouldn't work"
      },
      {
        "date": "2020-12-10T14:36:00.000Z",
        "voteCount": 1,
        "content": "THROW in this context won't work for several reasons.\n1. THROW with no arguments in a CATCH block is re-throwing the original exception, with that exceptions Severity\n2. Control is returned to the caller, so the \"RETURN -1\" will not be called \nWhile not possible to call RAISERROR by itself, with the 2 issues pointed out, it has to be correct answer. If THROW were used with additional arguments to cause a Level 16 to be returned, we still wouldn't call the RETURN -1"
      },
      {
        "date": "2020-10-05T13:55:00.000Z",
        "voteCount": 2,
        "content": "I believe throw is the last statement in catch block to raise an error and exit the catch block , no other statement will work, how come return -1 statement will work here ???"
      },
      {
        "date": "2020-11-03T06:55:00.000Z",
        "voteCount": 2,
        "content": "Correct, It should be RaisError"
      },
      {
        "date": "2020-09-17T11:47:00.000Z",
        "voteCount": 1,
        "content": "Probably want to set XACT_ABORT as OFF since we can't consistently THROW the desired error. Once XACT_ABORT is ON then any run-time error will end the execution of code."
      },
      {
        "date": "2020-05-20T06:32:00.000Z",
        "voteCount": 3,
        "content": "You are not using @@Transcount because it doesn't have parentheses behind. Only XACT_STATE () does."
      },
      {
        "date": "2020-05-20T07:03:00.000Z",
        "voteCount": 3,
        "content": "Also when XACT_ABORT is on, it dooms the transaction, so @@transcount can't tell you whether the transaction is doomed or committed. You need XACT_STATE to tell you that"
      },
      {
        "date": "2020-02-23T10:29:00.000Z",
        "voteCount": 2,
        "content": "there are need to be a @@Trancount, not XACT_STATE"
      },
      {
        "date": "2020-02-27T01:54:00.000Z",
        "voteCount": 1,
        "content": "No, different from 0 (&lt;&gt;) is XCAT_STATE while &gt; 0 is @@Trancount"
      },
      {
        "date": "2020-04-10T06:52:00.000Z",
        "voteCount": 2,
        "content": "XACT_STATE is correct.  \nhttps://docs.microsoft.com/en-us/sql/t-sql/functions/trancount-transact-sql?view=sql-server-ver15"
      },
      {
        "date": "2020-05-16T04:51:00.000Z",
        "voteCount": 1,
        "content": "if Rollback, @@TRANCOUNT is 0 not &lt;&gt;0. SO it is XACT_STATE"
      },
      {
        "date": "2020-11-16T16:16:00.000Z",
        "voteCount": 4,
        "content": "The key is here \"\u2711 The stored procedure uses a built-in scalar function to evaluate the current condition of data modifications.\". XACT_STATE() is a built-in function, @@TRANCOUNT is a variable. ;)"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 53,
    "url": "https://www.examtopics.com/discussions/microsoft/view/7834-exam-70-761-topic-1-question-53-discussion/",
    "body": "DRAG DROP -<br>Note: This question is part of a series of questions that use the same scenario. For your convenience, the scenario is repeated in each question. Each question presents a different goal and answer choices, but the text of the scenario is exactly the same in each question in this series.<br>You are developing a database to track customer orders. The database contains the following tables: Sales.Customers, Sales.Orders, and Sales.OrderLines. The following table describes the columns in Sales.Customers.<br><img src=\"/assets/media/exam-media/02675/0012900001.png\" class=\"in-exam-image\"><br>The following table describes the columns in Sales.Orders.<br><img src=\"/assets/media/exam-media/02675/0013000001.png\" class=\"in-exam-image\"><br>The following table describes the columns in Sales.OrderLines.<br><img src=\"/assets/media/exam-media/02675/0013000002.png\" class=\"in-exam-image\"><br>You need to create a function that calculates the highest tax rate charged for an item in a specific order.<br>Which five Transact-SQL segments should you use to develop the solution? To answer, move the appropriate Transact-SQL segments from the list of Transact-<br>SQL segments to the answer area and arrange them in the correct order.<br>Select and Place:<br><img src=\"/assets/media/exam-media/02675/0013100001.png\" class=\"in-exam-image\"><br>",
    "options": [],
    "answer": "<img src=\"/assets/media/exam-media/02675/0013200001.png\" class=\"in-exam-image\">",
    "answerDescription": "Box1: CREATE FUNCTION\"\u00a6@OrderID<br>Include definition for the \"\u00a6@OrderID parameter.<br>Box 2: RETURNS decimal(18,2)<br>The function is defined to return a scalar value.<br>Box 3: AS BEGIN \"\u00a6<br>Declare the local variables of the function.<br>Box 4: SET @CalculatedTaxRate = (..<br>Calculate the tax rate.<br>Box 5: RETURN @CalculatedRate END<br>Return a scalar value.<br>References:<br>https://msdn.microsoft.com/en-us/library/ms186755.aspx",
    "votes": [],
    "comments": [
      {
        "date": "2019-11-08T08:30:00.000Z",
        "voteCount": 9,
        "content": "In the last script should be \n\"RETURN @CalculatedTaxRate\nEND\""
      },
      {
        "date": "2020-03-03T03:55:00.000Z",
        "voteCount": 7,
        "content": "but how are we supposed to write correct answers with these incorrect variables in script.?"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 54,
    "url": "https://www.examtopics.com/discussions/microsoft/view/20686-exam-70-761-topic-1-question-54-discussion/",
    "body": "Note: This question is part of a series of questions that use the same or similar answer choices. An answer choice may be correct for more than one question in the series. Each question is independent of the other questions in this series. Information and details provided in a question apply only to that question.<br>You create a table by running the following Transact-SQL statement:<br><img src=\"/assets/media/exam-media/02675/0013300001.png\" class=\"in-exam-image\"><br>You need to audit all customer data.<br>Which Transact-SQL statement should you run?<br><img src=\"/assets/media/exam-media/02675/0013400001.png\" class=\"in-exam-image\"><br>A.<br><img src=\"/assets/media/exam-media/02675/0013400002.png\" class=\"in-exam-image\"><br>B.<br><img src=\"/assets/media/exam-media/02675/0013400003.png\" class=\"in-exam-image\"><br>C.<br><img src=\"/assets/media/exam-media/02675/0013400004.png\" class=\"in-exam-image\"><br>D.<br><img src=\"/assets/media/exam-media/02675/0013400005.png\" class=\"in-exam-image\"><br>E.<br><img src=\"/assets/media/exam-media/02675/0013400006.png\" class=\"in-exam-image\"><br>F.<br><img src=\"/assets/media/exam-media/02675/0013400007.png\" class=\"in-exam-image\"><br>G.<br><img src=\"/assets/media/exam-media/02675/0013400008.png\" class=\"in-exam-image\"><br>H.<br>",
    "options": [],
    "answer": "B",
    "answerDescription": "The FOR SYSTEM_TIME ALL clause returns all the row versions from both the Temporal and History table.<br>Note: A system-versioned temporal table defined through is a new type of user table in SQL Server 2016, here defined on the last line WITH<br>(SYSTEM_VERSIONING = ON\"\u00a6, is designed to keep a full history of data changes and allow easy point in time analysis.<br>To query temporal data, the SELECT statement FROM&lt;table&gt; clause has a new clause FOR SYSTEM_TIME with five temporal-specific sub-clauses to query data across the current and history tables.<br>References:<br>https://msdn.microsoft.com/en-us/library/dn935015.aspx",
    "votes": [],
    "comments": [
      {
        "date": "2020-05-16T05:33:00.000Z",
        "voteCount": 7,
        "content": "Defenitely B"
      },
      {
        "date": "2020-07-04T09:16:00.000Z",
        "voteCount": 1,
        "content": "doubt, Can you explain?"
      },
      {
        "date": "2020-10-12T15:35:00.000Z",
        "voteCount": 3,
        "content": "It says - You need to audit *ALL* customer data. So FOR SYSTEM_TIME ALL is correct"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 55,
    "url": "https://www.examtopics.com/discussions/microsoft/view/3025-exam-70-761-topic-1-question-55-discussion/",
    "body": "Note: This question is part of a series of questions that use the same or similar answer choices. An answer choice may be correct for more than one question in the series. Each question is independent of the other questions in this series. Information and details provided in a question apply only to that question.<br>You create a table by running the following Transact-SQL statement:<br><img src=\"/assets/media/exam-media/02675/0013500001.png\" class=\"in-exam-image\"><br>You need to return normalized data for all customers that were added in the year 2014.<br>Which Transact-SQL statement should you run?<br><img src=\"/assets/media/exam-media/02675/0013600001.png\" class=\"in-exam-image\"><br>A.<br><img src=\"/assets/media/exam-media/02675/0013600002.png\" class=\"in-exam-image\"><br>B.<br><img src=\"/assets/media/exam-media/02675/0013600003.png\" class=\"in-exam-image\"><br>C.<br><img src=\"/assets/media/exam-media/02675/0013600004.png\" class=\"in-exam-image\"><br>D.<br><img src=\"/assets/media/exam-media/02675/0013600005.png\" class=\"in-exam-image\"><br>E.<br><img src=\"/assets/media/exam-media/02675/0013600006.png\" class=\"in-exam-image\"><br>F.<br><img src=\"/assets/media/exam-media/02675/0013700001.png\" class=\"in-exam-image\"><br>G.<br><img src=\"/assets/media/exam-media/02675/0013700002.png\" class=\"in-exam-image\"><br>H.<br>",
    "options": [],
    "answer": "G",
    "answerDescription": "The following query searches for row versions for Employee row with EmployeeID = 1000 that were active at least for a portion of period between 1st January of<br>2014 and 1st January 2015 (including the upper boundary):<br><br>SELECT * FROM Employee -<br><br>FOR SYSTEM_TIME -<br>BETWEEN '2014-01-01 00:00:00.0000000' AND '2015-01-01 00:00:00.0000000'<br>WHERE EmployeeID = 1000ORDER BY ValidFrom;<br>References:<br>https://msdn.microsoft.com/en-us/library/dn935015.aspx",
    "votes": [],
    "comments": [
      {
        "date": "2020-09-22T10:39:00.000Z",
        "voteCount": 5,
        "content": "Answer is H\n\"customers that were  added in the year 2014\" refers to  the column DateCreated and it has nothing to do with the system column ValidFrom. Answer G will return more than the question asks for"
      },
      {
        "date": "2021-01-01T10:04:00.000Z",
        "voteCount": 1,
        "content": "Can't be H because the data type is wrong, can't be G because that will show all records touched in that timeframe, not just ones created. Therefore, I would go with XML PATH"
      },
      {
        "date": "2020-12-14T11:20:00.000Z",
        "voteCount": 1,
        "content": "The answer should be E since it needs a normalized data. G is wrong because it was asking for data created in 2014, DataCreated column should be used instead of SYSTEM_TIME. H is wrong because the result is not normalized. H will return multiple records for the same clientID etc of different validFrom and ValidTo."
      },
      {
        "date": "2020-12-12T04:58:00.000Z",
        "voteCount": 1,
        "content": "We need customers added , historical data may shows changes to customers that were added earlier than in 2014 . So in my opinion it's H."
      },
      {
        "date": "2020-12-10T14:51:00.000Z",
        "voteCount": 1,
        "content": "There is no good answer here\nH suffers for 2 reasons. 1) We aren't looking at when the rows were created, rather created or modified. We could create a Customer in 2013, then update the address is 2014. 2)The BETWEEN will include anything update at midnight 2015-01-01\nG suffers as it will not include anything that occurred on the 2014-12-31\nThe PIVOT answer has potential, except the YEAR function isn't used and the PIVOT is incorrectly formed. Something to check when doing the exam"
      },
      {
        "date": "2020-10-31T08:27:00.000Z",
        "voteCount": 2,
        "content": "If you create customer and set DateCreated explicitely to 2015-01-01 00:00:00.000000 it will be visible in G. If you use FOR SYSTEM TIME - you actually query temporal and historical tables - you get redundant data so its no longer normalized data. Probably H misses some casting (i didnt check that though) but still it fits more to the requirements than G."
      },
      {
        "date": "2020-09-14T03:40:00.000Z",
        "voteCount": 3,
        "content": "I don't think we can use FOR SYSTEM TIME here. The question is about data created and not data active. The G option, for example, could show data created before 2014. The closest option would be H, but there isn't any option correct in my opinion."
      },
      {
        "date": "2020-08-31T10:07:00.000Z",
        "voteCount": 1,
        "content": "I think the correct ans is E coz, in G option System_Time Between option is used. Using BETWEEN '2014-01-01' AND  '2015-01-01' will include data for '2015-01-01 00:00:00.0000000' as well."
      },
      {
        "date": "2020-08-20T06:32:00.000Z",
        "voteCount": 1,
        "content": "answer is G but can we use FROM.. TO instead of BETWEEN.. AND?"
      },
      {
        "date": "2020-05-24T05:25:00.000Z",
        "voteCount": 2,
        "content": "If row was inserted in 2014 and then deleted the H don't show this row - only G."
      },
      {
        "date": "2020-05-20T09:28:00.000Z",
        "voteCount": 1,
        "content": "G has flaw. If you want to use SYSTEM_TIME, SYSTEM_TIME AS OF '2015-01-01' is the correct one. Using BETWEEN .. AND '2015-01-01' will include data that was created at '2015-01-01 00:00:00.0000000'."
      },
      {
        "date": "2020-05-20T09:30:00.000Z",
        "voteCount": 2,
        "content": "Nvm, I think G is right."
      },
      {
        "date": "2019-07-30T11:27:00.000Z",
        "voteCount": 2,
        "content": "The explanation does not fit the question... I believe the answer is G, but I'm not positive."
      },
      {
        "date": "2019-07-30T11:28:00.000Z",
        "voteCount": 14,
        "content": "**I believe the answer is H"
      },
      {
        "date": "2019-08-24T00:54:00.000Z",
        "voteCount": 2,
        "content": "Agree because normalized data is required here."
      },
      {
        "date": "2019-09-05T07:29:00.000Z",
        "voteCount": 10,
        "content": "You are wrong! The field is datetime2 NOT date, '20141231' is expanded to '2014-12-31 00:00:00.0000000' and you lost ALL records created between 00:00:00.0000001 and 23:59:59.9999999'"
      },
      {
        "date": "2019-09-23T18:07:00.000Z",
        "voteCount": 3,
        "content": "I think, H is the closest answer. \nTo be correct, we need to cast DateCreated column to Date. \nWhere cast(DateCreated as Date) Between  '20140101'  and  '20141231'"
      },
      {
        "date": "2020-07-31T08:26:00.000Z",
        "voteCount": 2,
        "content": "I believe H is wrong since it does not include results from the customerHistory table"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 56,
    "url": "https://www.examtopics.com/discussions/microsoft/view/3026-exam-70-761-topic-1-question-56-discussion/",
    "body": "Note: This question is part of a series of questions that use the same or similar answer choices. An answer choice may be correct for more than one question in the series. Each question is independent of the other questions in this series. Information and details provided in a question apply only to that question.<br>You create a table by running the following Transact-SQL statement:<br><img src=\"/assets/media/exam-media/02675/0013800001.png\" class=\"in-exam-image\"><br>You are developing a report that displays customer information. The report must contain a grand total column.<br>You need to write a query that returns the data for the report.<br>Which Transact-SQL statement should you run?<br><img src=\"/assets/media/exam-media/02675/0013800002.png\" class=\"in-exam-image\"><br>A.<br><img src=\"/assets/media/exam-media/02675/0013800003.png\" class=\"in-exam-image\"><br>B.<br><img src=\"/assets/media/exam-media/02675/0013800004.png\" class=\"in-exam-image\"><br>C.<br><img src=\"/assets/media/exam-media/02675/0013900001.png\" class=\"in-exam-image\"><br>D.<br><img src=\"/assets/media/exam-media/02675/0013900002.png\" class=\"in-exam-image\"><br>E.<br><img src=\"/assets/media/exam-media/02675/0013900003.png\" class=\"in-exam-image\"><br>F.<br><img src=\"/assets/media/exam-media/02675/0013900004.png\" class=\"in-exam-image\"><br>G.<br><img src=\"/assets/media/exam-media/02675/0013900005.png\" class=\"in-exam-image\"><br>H.<br>",
    "options": [],
    "answer": "E",
    "answerDescription": "Calculate aggregate column through AVG function and GROUP BY clause.",
    "votes": [],
    "comments": [
      {
        "date": "2019-07-30T11:36:00.000Z",
        "voteCount": 23,
        "content": "Should be A. You can get grand totals using grouping sets."
      },
      {
        "date": "2019-09-23T19:32:00.000Z",
        "voteCount": 9,
        "content": "It will fail, because there is no aggregate function, and TaxIDNumber and DateCreated columns are not included in the grouping sets."
      },
      {
        "date": "2020-05-14T10:50:00.000Z",
        "voteCount": 10,
        "content": "The question is asking for a Grand Total Column... Even if there was an aggregator in choice A, that would give a Grand Total Row rather than a Column..."
      },
      {
        "date": "2020-06-25T18:58:00.000Z",
        "voteCount": 1,
        "content": "Wow at first I thought you were wrong, but then I went back to the exam ref and realized you were right. Thanks for the comment."
      },
      {
        "date": "2021-01-13T08:57:00.000Z",
        "voteCount": 1,
        "content": "E. does not provdide a grand total meaning no single answer is good."
      },
      {
        "date": "2021-01-10T12:19:00.000Z",
        "voteCount": 1,
        "content": "Tested. Answer is E"
      },
      {
        "date": "2020-12-12T05:02:00.000Z",
        "voteCount": 1,
        "content": "Definitely, it's A because it has ()what means grand total in GROUPING SETS just learned it in 20-761 Course Book ))"
      },
      {
        "date": "2020-11-23T07:25:00.000Z",
        "voteCount": 1,
        "content": "Only E gives a proper answer to this question. Although the 2014 is confusing"
      },
      {
        "date": "2020-09-17T15:44:00.000Z",
        "voteCount": 1,
        "content": "Correct is E\nMainly by elimination of other choices A and D, both with incorrect syntax, neither will even compile\n\nIn choice E \n  GROUP BY CustomerID, FirstName, LastName, Address, DateCreated\nis effectively \n  GROUP BY CustomerID\nbecause CustomerID is the key, meaning \n  AVG(AnnualRevenue) = SUM(AnnualRevenue)"
      },
      {
        "date": "2020-09-12T13:17:00.000Z",
        "voteCount": 1,
        "content": "The answer can be A if the second last column has sum as the aggregate function sum(annualrevenue) because how can you use a grouping set if there is no aggregate function. Also avg doesnt give a grand total it gives average (simple) so if the typo or that mistake is ignored the answer is A because in that option only you are going to get grand total and that would be last row(question clearly says the report must contain the grand total)"
      },
      {
        "date": "2020-04-24T11:19:00.000Z",
        "voteCount": 7,
        "content": "none of them looks correct, in the select line should be a SUM(AnnualRevenue)"
      },
      {
        "date": "2019-12-01T10:26:00.000Z",
        "voteCount": 3,
        "content": "nothing in the question says anything about 2014, that is from the previous question. it looks like some of the answer options are in the incorrect spot, also it looks like A is the correct answer. E also has no \"GrandTotal\" column"
      },
      {
        "date": "2019-09-22T00:47:00.000Z",
        "voteCount": 3,
        "content": "A is correct."
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 57,
    "url": "https://www.examtopics.com/discussions/microsoft/view/14742-exam-70-761-topic-1-question-57-discussion/",
    "body": "Note: This question is part of a series of questions that use the same or similar answer choices. An answer choice may be correct for more than one question in the series. Each question is independent of the other questions in this series. Information and details provided in a question apply only to that question.<br>You create a table named Customers. Data stored in the table must be exchanged between web pages and web servers by using AJAX calls that use REST endpoint.<br>You need to return all customer information by using a data exchange format that is text-based and lightweight.<br>Which Transact-SQL statement should you run?<br><img src=\"/assets/media/exam-media/02675/0014000001.png\" class=\"in-exam-image\"><br>A.<br><img src=\"/assets/media/exam-media/02675/0014000002.png\" class=\"in-exam-image\"><br>B.<br><img src=\"/assets/media/exam-media/02675/0014000003.png\" class=\"in-exam-image\"><br>C.<br><img src=\"/assets/media/exam-media/02675/0014000004.png\" class=\"in-exam-image\"><br>D.<br><img src=\"/assets/media/exam-media/02675/0014000005.png\" class=\"in-exam-image\"><br>E.<br><img src=\"/assets/media/exam-media/02675/0014000006.png\" class=\"in-exam-image\"><br>F.<br><img src=\"/assets/media/exam-media/02675/0014100001.png\" class=\"in-exam-image\"><br>G.<br><img src=\"/assets/media/exam-media/02675/0014100002.png\" class=\"in-exam-image\"><br>H.<br>",
    "options": [],
    "answer": "C",
    "answerDescription": "JSON can be used to pass AJAX updates between the client and the server.<br>Export data from SQL Server as JSON, or format query results as JSON, by adding the FOR JSON clause to a SELECT statement.<br>When you use the FOR JSON clause, you can specify the structure of the output explicitly, or let the structure of the SELECT statement determine the output.<br>References:<br>https://msdn.microsoft.com/en-us/library/dn921882.aspx",
    "votes": [],
    "comments": [
      {
        "date": "2020-12-15T08:57:00.000Z",
        "voteCount": 2,
        "content": "C is correct."
      },
      {
        "date": "2020-02-23T10:45:00.000Z",
        "voteCount": 1,
        "content": "xml also possible answer"
      },
      {
        "date": "2020-04-04T08:47:00.000Z",
        "voteCount": 8,
        "content": "You need to return all customer information by using a data exchange format that is text-based and lightweight.\n\nXML is not lightweight when you compare with JSON."
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 58,
    "url": "https://www.examtopics.com/discussions/microsoft/view/3992-exam-70-761-topic-1-question-58-discussion/",
    "body": "Note: This question is part of a series of questions that use the same or similar answer choices. An answer choice may be correct for more than one question in the series. Each question is independent of the other questions in this series. Information and details provided in a question apply only to that question.<br>You create a table by running the following Transact-SQL statement:<br><img src=\"/assets/media/exam-media/02675/0014200001.png\" class=\"in-exam-image\"><br>You are developing a report that aggregates customer data only for the year 2014. The report requires that the data be denormalized.<br>You need to return the data for the report.<br>Which Transact-SQL statement should you run?<br><img src=\"/assets/media/exam-media/02675/0014200002.png\" class=\"in-exam-image\"><br>A.<br><img src=\"/assets/media/exam-media/02675/0014200003.png\" class=\"in-exam-image\"><br>B.<br><img src=\"/assets/media/exam-media/02675/0014300001.png\" class=\"in-exam-image\"><br>C.<br><img src=\"/assets/media/exam-media/02675/0014300002.png\" class=\"in-exam-image\"><br>D.<br><img src=\"/assets/media/exam-media/02675/0014300003.png\" class=\"in-exam-image\"><br>E.<br><img src=\"/assets/media/exam-media/02675/0014300004.png\" class=\"in-exam-image\"><br>F.<br><img src=\"/assets/media/exam-media/02675/0014300005.png\" class=\"in-exam-image\"><br>G.<br><img src=\"/assets/media/exam-media/02675/0014300006.png\" class=\"in-exam-image\"><br>H.<br>",
    "options": [],
    "answer": "G",
    "answerDescription": "",
    "votes": [],
    "comments": [
      {
        "date": "2020-02-10T08:30:00.000Z",
        "voteCount": 11,
        "content": "Answer is D"
      },
      {
        "date": "2021-01-01T10:24:00.000Z",
        "voteCount": 1,
        "content": "Answer is E (looks like D but 5th answer) - SELECT FROM WHERE GROUP BY - creates aggregated data that is denormalized because it is aggregated"
      },
      {
        "date": "2021-01-01T10:32:00.000Z",
        "voteCount": 1,
        "content": "D (PIVOT) would work if YEAR(DateCreated) IN [2014] but year isn't specified. It is a valid PIVOT construct though because of the SELECT * FROM (SELECT....) AS"
      },
      {
        "date": "2020-12-12T05:13:00.000Z",
        "voteCount": 1,
        "content": "G doesn't have aggregated data"
      },
      {
        "date": "2020-10-19T11:00:00.000Z",
        "voteCount": 1,
        "content": "G is the correct answer"
      },
      {
        "date": "2020-11-23T04:10:00.000Z",
        "voteCount": 1,
        "content": "What is your point?"
      },
      {
        "date": "2020-06-25T00:35:00.000Z",
        "voteCount": 3,
        "content": "G does not give you aggregated data (i.e. no SUM, AVG, etc. included). Answer D does give you aggregated, denormalized data. However, I agree that answer D also has flaws so none of the answers seem correct."
      },
      {
        "date": "2020-05-16T13:42:00.000Z",
        "voteCount": 1,
        "content": "Why not H?"
      },
      {
        "date": "2020-06-07T12:09:00.000Z",
        "voteCount": 1,
        "content": "sorry, it is required data (means valid to and from) not date created. Probably its G"
      },
      {
        "date": "2019-08-24T01:04:00.000Z",
        "voteCount": 4,
        "content": "As denormalized data is required I'm not sure if G contains that while D is not a valid pivot query."
      },
      {
        "date": "2019-09-06T03:02:00.000Z",
        "voteCount": 2,
        "content": "I suppose that in this question Denormalize mean no ValidFrom, ValidTo column on result"
      },
      {
        "date": "2020-11-23T04:09:00.000Z",
        "voteCount": 1,
        "content": "D also specifies DateCreated, that is not mentioned in the requirements"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 59,
    "url": "https://www.examtopics.com/discussions/microsoft/view/39928-exam-70-761-topic-1-question-59-discussion/",
    "body": "Note: This question is part of a series of questions that use the same or similar answer choices. An answer choice may be correct for more than one question in the series. Each question is independent of the other questions in this series. Information and details provided in a question apply only to that question.<br>You create a table by running the following Transact-SQL statement:<br><img src=\"/assets/media/exam-media/02675/0014400001.png\" class=\"in-exam-image\"><br>You need to develop a query that meets the following requirements:<br>\u2711 Output data by using a tree-like structure.<br>\u2711 Allow mixed content types.<br>\u2711 Use custom metadata attributes.<br>Which Transact-SQL statement should you run?<br><img src=\"/assets/media/exam-media/02675/0014500001.png\" class=\"in-exam-image\"><br>A.<br><img src=\"/assets/media/exam-media/02675/0014500002.png\" class=\"in-exam-image\"><br>B.<br><img src=\"/assets/media/exam-media/02675/0014500003.png\" class=\"in-exam-image\"><br>C.<br><img src=\"/assets/media/exam-media/02675/0014500004.png\" class=\"in-exam-image\"><br>D.<br><img src=\"/assets/media/exam-media/02675/0014500005.png\" class=\"in-exam-image\"><br>E.<br><img src=\"/assets/media/exam-media/02675/0014500006.png\" class=\"in-exam-image\"><br>F.<br><img src=\"/assets/media/exam-media/02675/0014500007.png\" class=\"in-exam-image\"><br>G.<br><img src=\"/assets/media/exam-media/02675/0014500008.png\" class=\"in-exam-image\"><br>H.<br>",
    "options": [],
    "answer": "F",
    "answerDescription": "In a FOR XML clause, you specify one of these modes: RAW, AUTO, EXPLICIT, and PATH.<br>\u2711 The EXPLICIT mode allows more control over the shape of the XML. You can mix attributes and elements at will in deciding the shape of the XML. It requires a specific format for the resulting rowset that is generated because of query execution. This row set format is then mapped into XML shape. The power of<br>EXPLICIT mode is to mix attributes and elements at will, create wrappers and nested complex properties, create space-separated values (for example,<br>OrderID attribute may have a list of order ID values), and mixed contents.<br>\u2711 The PATH mode together with the nested FOR XML query capability provides the flexibility of the EXPLICIT mode in a simpler manner.<br>References:<br>https://msdn.microsoft.com/en-us/library/ms178107.aspx",
    "votes": [],
    "comments": [
      {
        "date": "2020-12-15T09:01:00.000Z",
        "voteCount": 2,
        "content": "Correctimundo"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 60,
    "url": "https://www.examtopics.com/discussions/microsoft/view/20763-exam-70-761-topic-1-question-60-discussion/",
    "body": "Note: This question is part of a series of questions that present the same scenario. Each question in the series contains a unique solution that might meet the stated goals. Some question sets might have more than one correct solution, while others might not have a correct solution.<br>After you answer a question in this section. You will NOT be able to return to it. As a result, these questions will not appear in the review screen.<br>A database has two tables as shown in the following database diagram:<br><img src=\"/assets/media/exam-media/02675/0014600003.png\" class=\"in-exam-image\"><br>You need to list all provinces that have at least two large cities. A large city is defined as having a population of at least one million residents. The query must return the following columns:<br>\u2711 tblProvince.ProvinceId<br>\u2711 tblProvince.ProvinceName<br>\u2711 a derived column named LargeCityCount that presents the total count of large cities for the province<br>Solution: You run the following Transact-SQL statement:<br><img src=\"/assets/media/exam-media/02675/0014700004.png\" class=\"in-exam-image\"><br>Does the solution meet the goal?<br>",
    "options": [
      "<span class=\"multi-choice-letter\" data-choice-letter=\"A\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tYes",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"B\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tB.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tNo"
    ],
    "answer": "B",
    "answerDescription": "We need to list all provinces that have at least two large cities. There is no reference to this in the code.",
    "votes": [],
    "comments": [
      {
        "date": "2020-12-23T13:34:00.000Z",
        "voteCount": 1,
        "content": "OOPs sorry I was looking at the wrong question number\nthis one is missing the filter in the WHERE clause\n'WHERE CitySummary.LargeCity &gt;= 2'  \nTherefore ANSWER B is right."
      },
      {
        "date": "2020-12-23T13:19:00.000Z",
        "voteCount": 1,
        "content": "I think answer A is correct. OUTER APPLY is semantically\nthe same as LEFT OUTER JOIN and the code does list all\nprovinces that have at least two large cities."
      },
      {
        "date": "2020-12-15T09:01:00.000Z",
        "voteCount": 1,
        "content": "Correctimundo"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 61,
    "url": "https://www.examtopics.com/discussions/microsoft/view/8076-exam-70-761-topic-1-question-61-discussion/",
    "body": "Note: This question is part of a series of questions that present the same scenario. Each question in the series contains a unique solution that might meet the stated goals. Some question sets might have more than one correct solution, while others might not have a correct solution.<br>After you answer a question in this section. You will NOT be able to return to it. As a result, these questions will not appear in the review screen.<br>A database has two tables as shown in the following database diagram:<br><img src=\"/assets/media/exam-media/02675/0014800001.png\" class=\"in-exam-image\"><br>You need to list all provinces that have at least two large cities. A large city is defined as having a population of at least one million residents. The query must return the following columns:<br>\u2711 tblProvince.ProvinceId<br>\u2711 tblProvince.ProvinceName<br>\u2711 a derived column named LargeCityCount that presents the total count of large cities for the province<br>Solution: You run the following Transact-SQL statement:<br><img src=\"/assets/media/exam-media/02675/0014800005.png\" class=\"in-exam-image\"><br>Does the solution meet the goal?<br>",
    "options": [
      "<span class=\"multi-choice-letter\" data-choice-letter=\"A\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tYes",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"B\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tB.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tNo"
    ],
    "answer": "B",
    "answerDescription": "The SQL CROSS JOIN produces a result set which is the number of rowsin the first table multiplied by the number of rows in the second table if no WHERE clause is used along with CROSS JOIN. This kind of result is called as Cartesian Product.<br>This is not what is required in this scenario.<br>References:<br>https://technet.microsoft.com/en-us/library/ms190690(v=sql.105).aspx",
    "votes": [],
    "comments": [
      {
        "date": "2020-06-27T07:14:00.000Z",
        "voteCount": 2,
        "content": "B. because the check for ProvinceID is missing. The explanation about CROSS APPLY confuses it with CROSS JOIN"
      },
      {
        "date": "2020-05-17T08:28:00.000Z",
        "voteCount": 1,
        "content": "NO - its not Cross JOIN"
      },
      {
        "date": "2019-11-13T05:38:00.000Z",
        "voteCount": 3,
        "content": "But there is a where clause"
      },
      {
        "date": "2020-01-13T16:31:00.000Z",
        "voteCount": 2,
        "content": "This is not what is required in this scenario."
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 62,
    "url": "https://www.examtopics.com/discussions/microsoft/view/18352-exam-70-761-topic-1-question-62-discussion/",
    "body": "Note: This question is part of a series of questions that present the same scenario. Each question in the series contains a unique solution that might meet the stated goals. Some question sets might have more than one correct solution, while others might not have a correct solution.<br>After you answer a question in this section. You will NOT be able to return to it. As a result, these questions will not appear in the review screen.<br>A database has two tables as shown in the following database diagram:<br><img src=\"/assets/media/exam-media/02675/0014900001.png\" class=\"in-exam-image\"><br>You need to list all provinces that have at least two large cities. A large city is defined as having a population of at least one million residents. The query must return the following columns:<br>\u2711 tblProvince.ProvinceId<br>\u2711 tblProvince.ProvinceName<br>\u2711 a derived column named LargeCityCount that presents the total count of large cities for the province<br>Solution: You run the following Transact-SQL statement:<br><img src=\"/assets/media/exam-media/02675/0015000004.png\" class=\"in-exam-image\"><br>Does the solution meet the goal?<br>",
    "options": [
      "<span class=\"multi-choice-letter\" data-choice-letter=\"A\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tYes",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"B\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tB.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tNo"
    ],
    "answer": "A",
    "answerDescription": "The requirement to list all provinces that have at least two large cities is meet by the WHERE CitySummary.LargeCityCount &gt;=2 clause.<br>CROSS APPLY willwork fine here.<br>Note:<br>The APPLY operator allows you to invoke a table-valued function for each row returned by an outer table expression of a query. The table-valued function acts as the right input and the outer table expression acts as the left input. The right input is evaluated for each row from the left input and the rows produced are combined for the final output. The list of columns produced by the APPLY operator is the set of columns in the left input followed by the list of columns returned by the right input.<br>There are two forms of APPLY: CROSS APPLY and OUTER APPLY. CROSS APPLY returns only rows from the outer table that produce a result set from the table-valued function. OUTER APPLY returns both rows that produce a result set, and rows that do not, with NULL values in the columns produced by the table- valued function.<br>References:<br>https://technet.microsoft.com/en-us/library/ms175156(v=sql.105).aspx",
    "votes": [],
    "comments": [
      {
        "date": "2020-05-17T08:30:00.000Z",
        "voteCount": 7,
        "content": "It is Right"
      },
      {
        "date": "2020-10-30T06:31:00.000Z",
        "voteCount": 2,
        "content": "The requirement to list all provinces that have at least two large cities is meet by the WHERE\nCitySummary.LargeCityCount &gt;=2 clause.\nCROSS APPLY will work fine here."
      },
      {
        "date": "2020-07-09T08:50:00.000Z",
        "voteCount": 3,
        "content": "cross join with a where clause is like an inner join"
      },
      {
        "date": "2020-09-17T13:39:00.000Z",
        "voteCount": 2,
        "content": "its cross apply not cross join"
      },
      {
        "date": "2020-11-25T02:49:00.000Z",
        "voteCount": 1,
        "content": "Sorry, perhaps You meant 'Cross Apply'"
      },
      {
        "date": "2020-04-13T08:46:00.000Z",
        "voteCount": 1,
        "content": "Answer is B, the where citysummary.largecitycount &gt;= 2 is wrong"
      },
      {
        "date": "2020-04-17T03:07:00.000Z",
        "voteCount": 16,
        "content": "no. Answer is A. the answer is right."
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 63,
    "url": "https://www.examtopics.com/discussions/microsoft/view/14744-exam-70-761-topic-1-question-63-discussion/",
    "body": "Note: This question is part of a series of questions that present the same scenario. Each question in the series contains a unique solution that might meet the stated goals. Some question sets might have more than one correct solution, while others might not have a correct solution.<br>After you answer a question in this section. you will NOT be able to return to it. As a result, these questions will not appear in the review screen.<br>You have a database that tracks orders and deliveries for customers in North America. The database contains the following tables:<br><br>Sales.Customers -<br><img src=\"/assets/media/exam-media/02675/0015100001.png\" class=\"in-exam-image\"><br><br>Application.Cities -<br><img src=\"/assets/media/exam-media/02675/0015100002.png\" class=\"in-exam-image\"><br><br>Sales.CustomerCategories -<br><img src=\"/assets/media/exam-media/02675/0015200001.png\" class=\"in-exam-image\"><br>The company's development team is designing a customer directory application. The application must list customers by the area code of their phone number. The area code is defined as the first three characters of the phone number.<br>The main page of the application will be based on an indexed view that contains the area and phone number for all customers.<br>You need to return the area code from the PhoneNumber field.<br>Solution: You run the following Transact-SQL statement:<br><img src=\"/assets/media/exam-media/02675/0015200002.jpg\" class=\"in-exam-image\"><br>Does the solution meet the goal?<br>",
    "options": [
      "<span class=\"multi-choice-letter\" data-choice-letter=\"A\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tYes",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"B\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tB.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tNo"
    ],
    "answer": "A",
    "answerDescription": "The following indicates a correct solution:<br>\u2711 The function returns a nvarchar(10) value.<br>\u2711 Schemabinding is used.<br>\u2711 SELECT TOP 1 \"\u00a6 gives a single value<br>Note: nvarchar(max) is correct statement.<br>nvarchar [ ( n | max ) ]<br>Variable-length Unicode string data. n defines the string length and can be a value from 1 through 4,000. max indicates that the maximum storage size is 2^31-1 bytes (2 GB).<br>References:<br>https://docs.microsoft.com/en-us/sql/t-sql/data-types/nchar-and-nvarchar-transact-sql https://sqlstudies.com/2014/08/06/schemabinding-what-why/",
    "votes": [],
    "comments": [
      {
        "date": "2021-01-06T23:24:00.000Z",
        "voteCount": 1,
        "content": "it is correct"
      },
      {
        "date": "2021-01-01T11:00:00.000Z",
        "voteCount": 1,
        "content": "This is correct. The phone number is explicity defined to have the format ###-###-####. TOP 1 of STRING_SPLIT will return the first portion which is the area code"
      },
      {
        "date": "2020-11-17T17:57:00.000Z",
        "voteCount": 2,
        "content": "I think that, STRING_SPLIT won't return the 3 rows in any particular order, so with this query how can you ensure it's gonna be the first 3 characters?"
      },
      {
        "date": "2020-02-23T10:56:00.000Z",
        "voteCount": 3,
        "content": "But there are can be more than 3 symbols, in requierements says:\nThe area code is defined as the first three characters of the phone number.\nSo, this is UNCORRECT"
      },
      {
        "date": "2020-09-14T04:08:00.000Z",
        "voteCount": 1,
        "content": "Agree. It doesn't meet the requirement."
      },
      {
        "date": "2020-09-17T13:42:00.000Z",
        "voteCount": 1,
        "content": "no matter how many symbols they are we need the first value only which will be given by top 1"
      },
      {
        "date": "2020-09-23T13:40:00.000Z",
        "voteCount": 4,
        "content": "In table definition it says that phone number is formated as 425-555-0187, so starts with 3 symbols."
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 64,
    "url": "https://www.examtopics.com/discussions/microsoft/view/3031-exam-70-761-topic-1-question-64-discussion/",
    "body": "Note: This question is part of a series of questions that present the same scenario. Each question in the series contains a unique solution that might meet the stated goals. Some question sets might have more than one correct solution, while others might not have a correct solution.<br>After you answer a question in this section. You will NOT be able to return to it. As a result, these questions will not appear in the review screen.<br>You have a database that includes the tables shown in the exhibit (Click the Exhibit button.)<br><img src=\"/assets/media/exam-media/02675/0015400001.png\" class=\"in-exam-image\"><br>You need to create a Transact-SQL query that returns the following information:<br>\u2711 the customer number<br>\u2711 the customer contact name<br>\u2711 the date the order was placed, with a name of DateofOrder<br>\u2711 a column named Salesperson, formatted with the employee first name, a space, and the employee last name<br>\u2711 orders for customers where the employee identifier equals 4<br>The output must be sorted by order date, with the newest orders first.<br>The solution must return only the most recent order for each customer.<br>Solution: You run the following Transact-SQL statement:<br><img src=\"/assets/media/exam-media/02675/0015500001.png\" class=\"in-exam-image\"><br>Does the solution meet the goal?<br>",
    "options": [
      "<span class=\"multi-choice-letter\" data-choice-letter=\"A\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tYes",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"B\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tB.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tNo"
    ],
    "answer": "B",
    "answerDescription": "We should use a WHERE clause, not a HAVING clause. The HAVING clause would refer to aggregate data.",
    "votes": [],
    "comments": [
      {
        "date": "2020-07-22T12:17:00.000Z",
        "voteCount": 6,
        "content": "I tested it and it works good so the answer is A. Yes.\n\n------------------------------------------------------------------\n\nCREATE TABLE #cust\n(\ncustid int\n,contactname varchar(100)\n)\nINSERT INTO #cust\nVALUES\n(1, 'A')\n,(2, 'B')\n,(3, 'C')\nCREATE TABLE #orders\n(\ncustid int\n,orderid int\n,orderdate date\n,empid int\n)\nINSERT INTO #orders\nVALUES\n(1,991,getdate(),4)\n,(1,992,getdate(),4)\n,(3,993,getdate(),4)\nCREATE TABLE #employees\n(\nempid int\n,firstname varchar(100)\n,lastname varchar(100)\n)\nINSERT INTO #employees\nVALUES\n(4, 'AB', 'CD')\n,(5, 'AA', 'BB')\nSELECT c.custid, contactname, MAX(orderdate) AS DateOfOrder, e.firstname + ' ' + e.lastname as Salesperson\nFROM #cust AS c\nINNER JOIN #orders AS o ON c.custid = o.custid\nINNER JOIN #employees AS e ON o.empid = e.empid\nGROUP BY c.custid, contactname, firstname, lastname, o.empid\nHAVING o.empid = 4\nORDER BY DateofOrder DESC"
      },
      {
        "date": "2021-01-26T07:47:00.000Z",
        "voteCount": 1,
        "content": "the o.empid in the group by is not in the select.................."
      },
      {
        "date": "2021-01-01T11:10:00.000Z",
        "voteCount": 2,
        "content": "Absolutely A. HAVING filters after the aggregation occurs but can be applied to any column. It may be less efficient than WHERE when applied to a non-aggregated column (because you included data to later filter it out) but returns the same result"
      },
      {
        "date": "2020-12-23T14:14:00.000Z",
        "voteCount": 2,
        "content": "I tested it on the TSQLV4 database, all the tables and columns are from this database. The code works fine and the answer is 100% A."
      },
      {
        "date": "2020-11-25T03:54:00.000Z",
        "voteCount": 1,
        "content": "Using empid   either in WHERE  or HAVING clause gives the same result set I checked it on the Sample database for these queries were created.  As far as it is  mentioned in requirements that 'Some question sets might have more than one correct solution'  and nothing said about performance requirements for  the query  I can suggest that both are valid solutions ."
      },
      {
        "date": "2020-10-21T14:45:00.000Z",
        "voteCount": 1,
        "content": "The format of full name is not the correct, there is not a blank space between first and last name, so even if the having clause works, this statement does not meet the speficiations."
      },
      {
        "date": "2020-09-05T15:26:00.000Z",
        "voteCount": 1,
        "content": "Let me clarify here- The Tsql mentioned meets the solution however its not an optimal solution.\nThe reason to this is when you use having clause, the sql server has already performed all the operation like joining then grouping, then the filtering is done. This is looked with a performance point of view it hurts. But on the other hand if where is used before Grouping by then already the rows get filtered and then grouping is done- this is any time better than first option.\nSo the answer is not about the solution its about optimal Solution."
      },
      {
        "date": "2020-12-04T11:54:00.000Z",
        "voteCount": 2,
        "content": "But where does it asks if it is an optimal solution?"
      },
      {
        "date": "2020-07-19T07:02:00.000Z",
        "voteCount": 2,
        "content": "The answer should be B\n\nThe problem is not with HAVING\nThe problem is with ORDER BY because it references column DateofOrder which is not included in GROUP BY"
      },
      {
        "date": "2020-08-01T10:08:00.000Z",
        "voteCount": 2,
        "content": "My wrong, DateofOrder is not a column, it is aggregate function around a column so the column does not have to be part of GROUP BY. In other words, both HAVING and ORDER BY are good, so the answer is A"
      },
      {
        "date": "2020-06-22T16:41:00.000Z",
        "voteCount": 2,
        "content": "It's NO bc at the level of GROUP BY, they added o.empid."
      },
      {
        "date": "2020-05-20T05:22:00.000Z",
        "voteCount": 1,
        "content": "It doe not have to do with Where or Having clause. But the SalesPerson is not being fetched as first name space last name. SO THE ANSWER IS NOO"
      },
      {
        "date": "2020-05-20T05:24:00.000Z",
        "voteCount": 1,
        "content": "or better the space is not displayed"
      },
      {
        "date": "2020-05-14T11:17:00.000Z",
        "voteCount": 2,
        "content": "I wonder if the space within the string concatenation is considered a space...  In SSMS it doesn't look like it."
      },
      {
        "date": "2020-04-23T15:07:00.000Z",
        "voteCount": 2,
        "content": "\"The solution must return only the most recent order for each customer.\", so why there is a empid in the group by?"
      },
      {
        "date": "2020-01-02T00:02:00.000Z",
        "voteCount": 3,
        "content": "The answer is yes, having is applied on aggregate data (means after grouping data) and can be apply on group by column"
      },
      {
        "date": "2020-03-08T04:02:00.000Z",
        "voteCount": 2,
        "content": "Where is more efficient than having... having only for agrupate clause.. for example count, sum... --&gt; having count(balls)&gt;5, having sum(balls)&gt;300$. I think"
      },
      {
        "date": "2020-03-19T13:38:00.000Z",
        "voteCount": 2,
        "content": "I think the clause where is should be applied instead of having because the performance of where is better than the other one. so it just retrieve a fewer data"
      },
      {
        "date": "2021-01-06T23:31:00.000Z",
        "voteCount": 1,
        "content": "agreed"
      },
      {
        "date": "2019-11-11T06:28:00.000Z",
        "voteCount": 4,
        "content": "YES, because you can use empid in Having if it is in the Group by clause i. e. having can contain aggregates and columns being used in Group by"
      },
      {
        "date": "2019-09-04T17:24:00.000Z",
        "voteCount": 1,
        "content": "Alias name DateOfOrder cannot be used for order clause"
      },
      {
        "date": "2019-09-06T03:12:00.000Z",
        "voteCount": 5,
        "content": "Why not ? Try..."
      },
      {
        "date": "2019-10-09T01:09:00.000Z",
        "voteCount": 2,
        "content": "Order by is the only section that can use aliases defined in the SELECT part, as of all 6 parts, SELECT is processed 5th and ORDER by 6th and last"
      },
      {
        "date": "2019-10-10T01:45:00.000Z",
        "voteCount": 2,
        "content": "ORDDER BY clause is logically executed after SELECT clause which has ALIAS."
      },
      {
        "date": "2020-11-25T03:07:00.000Z",
        "voteCount": 2,
        "content": "ORDER BY execution logically comes after SELECT so alias can be used in there"
      },
      {
        "date": "2019-07-30T13:01:00.000Z",
        "voteCount": 1,
        "content": "Why is it an issue that HAVING refers to aggregate data? Wouldn't it still accomplish the goal?"
      },
      {
        "date": "2019-08-24T01:07:00.000Z",
        "voteCount": 1,
        "content": "Yes. The HAVING clause here is equivalent to WHERE as a filter."
      },
      {
        "date": "2019-09-06T03:14:00.000Z",
        "voteCount": 6,
        "content": "WHERE clause is evaluated before the GROUP BY, consequently is more efficient and logical correct than the HAVING"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 65,
    "url": "https://www.examtopics.com/discussions/microsoft/view/20059-exam-70-761-topic-1-question-65-discussion/",
    "body": "Note: This question is part of a series of questions that present the same scenario. Each question in the series contains a unique solution that might meet the stated goals. Some question sets might have more than one correct solution, while others might not have a correct solution.<br>After you answer a question in this section. You will NOT be able to return to it. As a result, these questions will not appear in the review screen.<br>You have a database that includes the tables shown in the exhibit (Click the Exhibit button.)<br><img src=\"/assets/media/exam-media/02675/0015600001.png\" class=\"in-exam-image\"><br>You need to create a Transact-SQL query that returns the following information:<br>\u2711 the customer number<br>\u2711 the customer contact name<br>\u2711 the date the order was placed, with a name of DateofOrder<br>\u2711 a column named Salesperson, formatted with the employee first name, a space, and the employee last name<br>\u2711 orders for customers where the employee identifier equals 4<br>The output must be sorted by order date, with the newest orders first.<br>The solution must return only the most recent order for each customer.<br>Solution: You run the following Transact-SQL statement:<br><img src=\"/assets/media/exam-media/02675/0015700001.png\" class=\"in-exam-image\"><br>Does the solution meet the goal?<br>",
    "options": [
      "<span class=\"multi-choice-letter\" data-choice-letter=\"A\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tYes",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"B\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tB.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tNo"
    ],
    "answer": "A",
    "answerDescription": "The MAX(orderdate) in the SELECT statement makes sure we return only the most recent order.<br>AWHERE o.empiD =4 clause is correctly used.<br>GROUP BY is also required.",
    "votes": [],
    "comments": [
      {
        "date": "2021-01-23T05:08:00.000Z",
        "voteCount": 1,
        "content": "Can't create a group by including the having statement. \"o.empid\""
      },
      {
        "date": "2021-01-06T23:35:00.000Z",
        "voteCount": 1,
        "content": "it is A! it works guys"
      },
      {
        "date": "2021-01-01T11:21:00.000Z",
        "voteCount": 1,
        "content": "This works. You have to use firstname, lastname in GROUP BY clause because it is processed before the SELECT statement so the full name hasn't been produced yet so you can't group by it. We've already down-selected based on empid so duplicate names isn't an issue. Not optimally written but correct"
      },
      {
        "date": "2020-12-12T06:01:00.000Z",
        "voteCount": 1,
        "content": "Looks like A . But  I have doubts about  if the form of first name, last name that is used in GROUP BY clause is correct."
      },
      {
        "date": "2020-11-18T23:31:00.000Z",
        "voteCount": 1,
        "content": "\u2711 the date the order was placed, with a name of DateofOrder it\u00b4s\n\u2711 orders for customers where the employee identifier equals 4\n\n\u00bfSo it\u00b4s should return all the orders id linked with the employee?\n\nI think this query don\u00b4t return this."
      },
      {
        "date": "2020-12-02T21:20:00.000Z",
        "voteCount": 1,
        "content": "\"The solution must return only the most recent order for each customer.\""
      },
      {
        "date": "2020-09-17T12:16:00.000Z",
        "voteCount": 1,
        "content": "Likely A. Some of the questions are obviously wrong on a technicality but stick with the elements from the question - they aren't trying to \"trick\" you."
      },
      {
        "date": "2020-09-17T12:18:00.000Z",
        "voteCount": 1,
        "content": "Then again, maybe they are - missed the part where they implicitly want ALL orders, not the most recent."
      },
      {
        "date": "2020-09-01T00:08:00.000Z",
        "voteCount": 2,
        "content": "I Think the answer is B. there is no requirement to return Maximum date, all we have to return is most recent order data for emp_id =4 so, only order by clause\n can give the correct data."
      },
      {
        "date": "2020-12-02T21:21:00.000Z",
        "voteCount": 3,
        "content": "The solution must return only the most recent order for each customer. So we have to use MAX(OrderDate)"
      },
      {
        "date": "2020-12-12T05:33:00.000Z",
        "voteCount": 2,
        "content": "There is  the requirement -Latest order."
      },
      {
        "date": "2020-07-09T08:54:00.000Z",
        "voteCount": 2,
        "content": "good point , but these questions don't always go to that depth"
      },
      {
        "date": "2020-05-08T12:40:00.000Z",
        "voteCount": 2,
        "content": "I think B is the right answer because salepernon fullname should be produced by concat function as we don't know anything about nullability in the columns so it would be more safe.."
      },
      {
        "date": "2020-08-16T10:35:00.000Z",
        "voteCount": 1,
        "content": "the columns might be not null, but i still think that is B because dont have a space between the names..."
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 66,
    "url": "https://www.examtopics.com/discussions/microsoft/view/40083-exam-70-761-topic-1-question-66-discussion/",
    "body": "Note: This question is part of a series of questions that present the same scenario. Each question in the series contains a unique solution that might meet the stated goals. Some question sets might have more than one correct solution, while others might not have a correct solution.<br>After you answer a question in this section. You will NOT be able to return to it. As a result, these questions will not appear in the review screen.<br>You have a database that includes the tables shown in the exhibit (Click the Exhibit button.)<br><img src=\"/assets/media/exam-media/02675/0015800001.png\" class=\"in-exam-image\"><br>You need to create a Transact-SQL query that returns the following information:<br>\u2711 the customer number<br>\u2711 the customer contact name<br>\u2711 the date the order was placed, with a name of DateofOrder<br>\u2711 a column named Salesperson, formatted with the employee first name, a space, and the employee last name<br>\u2711 orders for customers where the employee identifier equals 4<br>The output must be sorted by order date, with the newest orders first.<br>The solution must return only the most recent order for each customer.<br>Solution: You run the following Transact-SQL statement:<br><img src=\"/assets/media/exam-media/02675/0015900001.png\" class=\"in-exam-image\"><br>Does the solution meet the goal?<br>",
    "options": [
      "<span class=\"multi-choice-letter\" data-choice-letter=\"A\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tYes",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"B\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tB.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tNo"
    ],
    "answer": "B",
    "answerDescription": "We need a GROUP BY statement as we want to return an order for each customer.",
    "votes": [],
    "comments": [
      {
        "date": "2020-12-16T11:54:00.000Z",
        "voteCount": 2,
        "content": "Correctimundo"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 67,
    "url": "https://www.examtopics.com/discussions/microsoft/view/16271-exam-70-761-topic-1-question-67-discussion/",
    "body": "DRAG DROP -<br>You have two tables named UserLogin and Employee respectively.<br>You need to create a Transact-SQL script that meets the following requirements:<br>\u2711 The script must update the value of the IsDeleted column for the UserLogin table to 1 if the value of the Id column for the UserLogin table is equal to 1.<br>\u2711 The script must update the value of the IsDeleted column of the Employee table to 1 if the value of the Id column is equal to 1 for the Employee table when an update to the UserLogin table throws an error.<br>\u2711 The error message \"No tables updated!\" must be produced when an update to the Employee table throws an error.<br>Which five Transact-SQL segments should you use to develop the solution? To answer, move the appropriate Transact-SQL segments from the list of Transact-<br>SQL segments to the answer area and arrange them in the correct order.<br>Select and Place:<br><img src=\"/assets/media/exam-media/02675/0016000001.png\" class=\"in-exam-image\"><br>",
    "options": [],
    "answer": "<img src=\"/assets/media/exam-media/02675/0016100001.png\" class=\"in-exam-image\">",
    "answerDescription": "",
    "votes": [],
    "comments": [
      {
        "date": "2020-05-19T10:38:00.000Z",
        "voteCount": 8,
        "content": "CREATE TABLE #UserLogin \n(\n\tId int not null,\n\tIsDeleted int not null,\n);\n\nCREATE TABLE #Employee\n(\n\tId int not null,\n\tIsDeleted int not null,\n);\n\ninsert into #UserLogin values (1, 0)\ninsert into #Employee values (1, 0)\n\n\nBEGIN TRY\n\tUPDATE #UserLogin\n\tSET IsDeleted = 1\n\tWHERE Id = 0\nEND TRY\n\nBEGIN CATCH\n\n\n\nBEGIN TRY\n\tUPDATE #Employee\n\tSET IsDeleted = 'a'\n\tWHERE Id = 1\nEND TRY\n\nBEGIN CATCH\nRAISERROR('No tables updated!', 16, 1)\nEND CATCH\nEND CATCH\n\nselect * from #UserLogin\nselect * from #Employee"
      },
      {
        "date": "2020-04-26T06:47:00.000Z",
        "voteCount": 5,
        "content": "Correct answer is the bellow, if you put a catch inside another catch won't throw any error. \n\n BEGIN TRY\n\tUPDATE #UserLogin\n\tSET IsDeleted  = 1\n\tWHERE Id = 1\nEND TRY\n\nBEGIN CATCH\n\nEND CATCH\n\nBEGIN TRY\n\tUPDATE #Employee\n\tSET IsDeleted = 1\n\tWHERE Id = 1\nEND TRY\n\nBEGIN CATCH\n\tRAISERROR('No tables updated!', 16, 1) \nEND CATCH"
      },
      {
        "date": "2020-06-26T16:41:00.000Z",
        "voteCount": 6,
        "content": "The above code is incorrect because according to the question, you are only to attempt an INSERT into Employee table *when an update to the UserLogin table throws an error*, whereas the above INSERTs into Employee regardless of whether UserLogin throws an error."
      },
      {
        "date": "2020-12-12T06:08:00.000Z",
        "voteCount": 1,
        "content": "Answer's correct"
      },
      {
        "date": "2020-11-24T08:05:00.000Z",
        "voteCount": 1,
        "content": "The same as Q19"
      },
      {
        "date": "2020-08-21T00:46:00.000Z",
        "voteCount": 2,
        "content": "in short, the answer is correct"
      },
      {
        "date": "2020-03-11T09:39:00.000Z",
        "voteCount": 1,
        "content": "- 2 Begin catch\n- 3 update\n- 4 begin catch raiserror...\n- 5 end catch"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 68,
    "url": "https://www.examtopics.com/discussions/microsoft/view/4796-exam-70-761-topic-1-question-68-discussion/",
    "body": "You need to create a table named MiscellaneousPayment that meets the following requirements:<br><img src=\"/assets/media/exam-media/02675/0016200001.png\" class=\"in-exam-image\"><br>Which Transact-SQL statement should you run?<br><img src=\"/assets/media/exam-media/02675/0016200002.png\" class=\"in-exam-image\"><br>A.<br><img src=\"/assets/media/exam-media/02675/0016200003.png\" class=\"in-exam-image\"><br>B.<br><img src=\"/assets/media/exam-media/02675/0016200004.png\" class=\"in-exam-image\"><br>C.<br><img src=\"/assets/media/exam-media/02675/0016200005.png\" class=\"in-exam-image\"><br>D.<br><img src=\"/assets/media/exam-media/02675/0016300001.png\" class=\"in-exam-image\"><br>E.<br><img src=\"/assets/media/exam-media/02675/0016300002.png\" class=\"in-exam-image\"><br>F.<br>",
    "options": [],
    "answer": "D",
    "answerDescription": "Incorrect Answers:<br>A: For column Reason we must use nvarchar, not varchar, as multilingual values must be supported. NEWSEQUENTIALID cannot be referenced in queries. In addition, the money datatype uses rounding and will result in rounding errors.<br>B: We cannot use INT for the Id column as new values must be automatically generated.<br>C: For column Reason we must use nvarchar, not varchar, as multilingual values must be supported.<br>E: NEWSEQUENTIALID cannot be referenced in queries.<br>F: The money datatype uses rounding and will result in rounding errors. We should use decimal instead.<br>Note: Nvarchar stores UNICODE data. If you have requirements to store UNICODE or multilingual data, nvarchar is the choice. Varchar stores ASCII data and should be your data type of choice for normal use.<br>References:<br>https://docs.microsoft.com/en-us/sql/t-sql/data-types/nchar-and-nvarchar-transact-sql",
    "votes": [],
    "comments": [
      {
        "date": "2021-01-01T11:39:00.000Z",
        "voteCount": 1,
        "content": "Both D and E fit the criteria. Nothing about performance and the comment about NEWSEQUENTIAL ID in a SQL statement doesn't apply and wasn't even part of the criteria"
      },
      {
        "date": "2020-12-12T06:40:00.000Z",
        "voteCount": 1,
        "content": "Actually, both D and E work"
      },
      {
        "date": "2020-12-12T06:37:00.000Z",
        "voteCount": 1,
        "content": "CREATE TABLE MiscellaneosPayment\n(\nID uniqueidentifier  DEFAULT NEWSEQUENTIALID() PRIMARY KEY ,\nReason nvarchar(500),\nAmount decimal(19,4)\n)\n\nINSERT INTO MiscellaneosPayment(Reason,Amount)\nVALUES ('Because', 100.4107), ('Due to', 30.2074)\n\nSELECT * FROM MiscellaneosPayment;\nIt works"
      },
      {
        "date": "2020-12-12T06:29:00.000Z",
        "voteCount": 1,
        "content": "And what does it mean that NEWSEQUENTIALID cannot be referenced in queries for explanation that  E isn't correct. You won't refer this column in INSERT statement it is default"
      },
      {
        "date": "2020-12-12T06:14:00.000Z",
        "voteCount": 1,
        "content": "E is  the correct answer"
      },
      {
        "date": "2020-12-10T16:35:00.000Z",
        "voteCount": 1,
        "content": "Firstly, don't use the MONEY type.\nSecondly, NEWSEQUENTIALID() can be used as a column default. But the requirement is that the ID be \"globally unique\". This means using the NEWID() function over the NEWSEQUENTIALID() function. NEWID() is slower and will likely cause more index fragmentation if it's on the Primary Key. But to meet the requirement, you need to use NEWID()"
      },
      {
        "date": "2020-12-09T09:47:00.000Z",
        "voteCount": 1,
        "content": "newsequentialid is better for insert operations"
      },
      {
        "date": "2020-12-10T16:32:00.000Z",
        "voteCount": 1,
        "content": "You have to explain why"
      },
      {
        "date": "2020-09-06T03:40:00.000Z",
        "voteCount": 3,
        "content": "Guys the correct answer is E\nLet me explain how:\none of the requirements for ID column says the value must be (Concentrate on must be) automatcially generated for insert opertaions. You can achieve this by both newid() as well as newsequentialID(), however newid() gives you the liberty of inserting values through an insert statement if you wish to and on the other hand in newsequentialID you cannot do that. The ID must be (again MUST be) generated automatyically no matter what."
      },
      {
        "date": "2020-12-12T19:18:00.000Z",
        "voteCount": 1,
        "content": "I think both newid() and newsquentialid() allow to insert values through an insert statement \nif you want to. My guess is we should choose newsquentialid() for it is better to have a squential primary key rather than a random(newid) primary key."
      },
      {
        "date": "2020-12-12T19:20:00.000Z",
        "voteCount": 1,
        "content": "also NEWSEQUENTIALID is faster to generate and also fills up a complete page due to fill factor."
      },
      {
        "date": "2020-08-11T01:09:00.000Z",
        "voteCount": 1,
        "content": "The answer should be \"B\""
      },
      {
        "date": "2020-09-02T19:33:00.000Z",
        "voteCount": 1,
        "content": "sorry, answer should be D"
      },
      {
        "date": "2020-07-13T19:10:00.000Z",
        "voteCount": 1,
        "content": "If you do not need a true random number I suggest you use the NEWSEQUENTIALID as it is faster to generate and also fills up a complete page due to fill factor."
      },
      {
        "date": "2020-11-18T14:36:00.000Z",
        "voteCount": 1,
        "content": "The performance will depend on what you're mainly doing. For reads it is faster they are sequential, but for inserts from different sessions it is better they are randomly generated."
      },
      {
        "date": "2020-05-23T13:55:00.000Z",
        "voteCount": 3,
        "content": "it seems like both D and E are correct :/"
      },
      {
        "date": "2020-06-02T10:46:00.000Z",
        "voteCount": 4,
        "content": "Anyway since we have to save data for MiscellaneousPayment for security reason maybe NEWID fits well as it is more secure, as the GUID is randomly generated, and harder to guess."
      },
      {
        "date": "2020-04-26T06:54:00.000Z",
        "voteCount": 4,
        "content": "B generates unique values too"
      },
      {
        "date": "2020-04-13T09:44:00.000Z",
        "voteCount": 2,
        "content": "C, E has the same syntax. newID doesn't generate sequential number tho."
      },
      {
        "date": "2020-06-02T10:43:00.000Z",
        "voteCount": 1,
        "content": "yes but data type for \"Reason\" differs. And it is used nvarchar for multilingual"
      },
      {
        "date": "2020-11-18T14:33:00.000Z",
        "voteCount": 1,
        "content": "I gave a thumb up when I meant to reply. @Everyone, but where does it specify the ID has to be sequential in the request?"
      },
      {
        "date": "2020-03-28T18:28:00.000Z",
        "voteCount": 1,
        "content": "Why we cannot use Int as identity datatype?\nhttps://docs.microsoft.com/en-us/sql/t-sql/statements/create-table-transact-sql-identity-property?view=sql-server-ver15"
      },
      {
        "date": "2020-04-14T05:26:00.000Z",
        "voteCount": 3,
        "content": "as int identity is only unique to that column"
      },
      {
        "date": "2019-11-22T08:42:00.000Z",
        "voteCount": 3,
        "content": "E could be a correct answer as well. OK, we can read that NEWSEQUENTIALID cannot be referenced in queries. For example at page https://docs.microsoft.com/en-us/sql/t-sql/functions/newsequentialid-transact-sql?view=sql-server-ver15. But it is for a query like: \nSELECT NEWSEQUENTIALID();\n\nWe can also read \"NEWSEQUENTIALID() can only be used with DEFAULT constraints on table columns of type uniqueidentifier\". It is what I have done in a database. And the query\nSELECT [Id],[Reason],[Amount]\nFROM [dbo].[MiscellaneousPayment]\nworks perfectly."
      },
      {
        "date": "2019-09-06T03:31:00.000Z",
        "voteCount": 2,
        "content": "E is the correct answer because newsequentialid is more faster that newid.\nhttps://docs.microsoft.com/en-US/sql/t-sql/functions/newsequentialid-transact-sql?view=sql-server-2017"
      },
      {
        "date": "2019-09-09T06:28:00.000Z",
        "voteCount": 7,
        "content": "Its no about performance. Its about generating unique key for primary key of table. Newid() is generationg unique surrogate keys and newsequentialid() is generationg nonsequentialid surrogate keys"
      },
      {
        "date": "2019-09-09T06:28:00.000Z",
        "voteCount": 8,
        "content": "So correct is still answer D :)"
      },
      {
        "date": "2020-10-12T22:28:00.000Z",
        "voteCount": 1,
        "content": "it is the opposite, Newid() is generating nonsequential id,\nand newsequentialid() is generating sequential. For the Primary Key column we want sequential. So the correct answer is E"
      },
      {
        "date": "2020-12-14T18:28:00.000Z",
        "voteCount": 1,
        "content": "NEWSEQUENTIALID \nIf privacy is a concern, do not use this function. It is possible to guess the value of the next generated GUID and, therefore, access data associated with that GUID."
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 69,
    "url": "https://www.examtopics.com/discussions/microsoft/view/3794-exam-70-761-topic-1-question-69-discussion/",
    "body": "SIMULATION -<br>You have a database that contains the following tables.<br><img src=\"/assets/media/exam-media/02675/0016400001.jpg\" class=\"in-exam-image\"><br>You need to create a query that returns each complaint, the names of the employees handling the complaint, and the notes on each interaction. The Complaint field must be displayed first, followed by the employee's name and the notes. Complaints must be returned even if no interaction has occurred.<br>Construct the query using the following guidelines:<br>\u2711 Use two-part column names.<br>\u2711 Use one-part table names.<br>\u2711 Use the first letter of the table name as its alias.<br>\u2711 Do not Transact-SQL functions.<br>\u2711 Do not use implicit joins.<br>\u2711 Do not surround object names with square brackets.<br>Part of the correct Transact-SQL has been provided in the answer area below. Enter the code in the answer area that resolves the problem and meets the stated goals or requirements. You can add code within the code that has been provided as well as below it.<br><img src=\"/assets/media/exam-media/02675/0016500001.png\" class=\"in-exam-image\"><br>1 SELECT c.Complaint, e.Name, i.Notes<br>2 FROM Complaints c<br>3 JOIN __________________<br>4 JOIN __________________<br><img src=\"/assets/media/exam-media/02675/0016600001.png\" class=\"in-exam-image\"><br>",
    "options": [],
    "answer": "Please see explanation",
    "answerDescription": "1 SELECT c.Complaint, e.Name, i.Notes<br>2 FROM Complaints c<br>3 JOIN Interactions i ON c.ComplaintID = i.ComplaintID<br>4 JOIN Employees e ON i.EmployeeID = E.EmployeeID",
    "votes": [],
    "comments": [
      {
        "date": "2020-03-03T04:56:00.000Z",
        "voteCount": 15,
        "content": "SELECT c.Complaint, e.Name, i.Notes\nFROM Complaints c\nLEFT OUTER JOIN Interactions i ON c.ComplaintID = i.ComplaintID\nLEFT OUTER JOIN Employees e ON i.EmployeeID = e.EmployeeID"
      },
      {
        "date": "2019-08-19T06:10:00.000Z",
        "voteCount": 14,
        "content": "first JOIN =&gt; LEFT OUTER JOIN (\"show all complaints...\")\nsecond JOIN =&gt; INNER JOIN"
      },
      {
        "date": "2019-11-11T06:37:00.000Z",
        "voteCount": 21,
        "content": "no, if you use first left join, then inner join, you will not fulfill the requirements. you need to use two left joins or one left join with a subquery"
      },
      {
        "date": "2020-06-26T17:07:00.000Z",
        "voteCount": 4,
        "content": "avramov is correct, because you can only use two INNER JOINs if *all* ComplaintIDs in Complaints table have a corresponding entry in the Interactions table, and all those corresponding entries in the Interactions table have a corresponding entry in the Employees table."
      },
      {
        "date": "2020-12-12T06:53:00.000Z",
        "voteCount": 1,
        "content": "Using inner join you exclude complaints that have assigned employees"
      },
      {
        "date": "2020-12-12T06:54:00.000Z",
        "voteCount": 1,
        "content": "Sorry I meant, inner join excludes complaints that have no assigned employees."
      },
      {
        "date": "2021-01-02T07:28:00.000Z",
        "voteCount": 1,
        "content": "if we see 'all' keyword we should use left ?! are you serious? we don't memorize here we use logic . join keys are not null so we use inner join. period"
      },
      {
        "date": "2021-01-13T11:22:00.000Z",
        "voteCount": 1,
        "content": "the thing about referential integrity is that a foreign key cannot exist without a corresponding primary key in the table it references. The keys have not been checked 'Allow null' so this means for every compliantid and employeeid, no matter FK or PK there is a value. So no need to left join."
      },
      {
        "date": "2021-01-02T07:25:00.000Z",
        "voteCount": 1,
        "content": "FKs are not null . so inner join is the right answer. There is no complaint who has no employee"
      },
      {
        "date": "2021-01-01T11:51:00.000Z",
        "voteCount": 2,
        "content": "2 left joins OR\nInteractions INNER JOIN Employees RIGHT JOIN Complaints\nboth ensure that we get all complaints."
      },
      {
        "date": "2020-09-12T14:17:00.000Z",
        "voteCount": 1,
        "content": "Tested both left joins."
      },
      {
        "date": "2020-09-01T20:12:00.000Z",
        "voteCount": 1,
        "content": "it should not be join coz only join means INNER JOIN so, if we use INNER JOIN it will only return the data which have corresponding entries in all 3 tables but we have to return all the complaints so, there might be the case when we have data in complaint table but not in interaction so, we have to return that data also. we have to use LEFT JOIN for this.\nSo, Correct Join would be LEFT JOIN"
      },
      {
        "date": "2020-05-23T11:18:00.000Z",
        "voteCount": 2,
        "content": "If I read the question correctly, this is a database to handle complaints. Sometimes, complains are entered with no one yet assigned to handle a complaint. So, complains could exist with no assigned employees or interactions. The question states that we need to show all complaints regardless if someone is assigned to handle them or not. Interactions are entered by employees, so if there is no employee assigned, there will be no interactions. What if there was no employee assigned to handle the complaints yet? With INNER JOIN (JOIN alone is an INNER JOIN) the rows with no employee assigned or interactions wont show if I understand the logic correctly! Thus, I am actually tempted to go with LEFT JOIN."
      },
      {
        "date": "2020-05-23T11:21:00.000Z",
        "voteCount": 1,
        "content": "LEFT JOIN for both joins the first and the second."
      },
      {
        "date": "2020-04-28T10:06:00.000Z",
        "voteCount": 3,
        "content": "The given answer is correct, you could make it a little more explicit by adding inner join like below.\n\nSelect c.complaint, e.name, i.notes\nFrom Complaints C\nInner Join Interactions i\non c.complaintID = i.complaintID\nInner Join employees e\non i.employeeID = e.employeeID\n\nThe reason you do not need to put a left outer join anywhere is because the joining colums do not allow nulls so there is no chance of leaving any data out if you use an inner join, therefore the given answer is correct although using a left o uter join will still give the same result as an inner join in this scenario."
      },
      {
        "date": "2020-06-26T17:05:00.000Z",
        "voteCount": 1,
        "content": "This is incorrect. It doesn't matter whether the joining columns allow NULLs.\n\nYou can only use two INNER JOINs if *all* ComplaintIDs in Complaints table have a corresponding entry in the Interactions table, and all those corresponding entries in the Interactions table have a corresponding entry in the Employees table."
      },
      {
        "date": "2020-11-18T14:13:00.000Z",
        "voteCount": 1,
        "content": "Olayemi87, your statement is incorrect. Due to the Complains Table do not have an Employee ID column on it, so there will be complains without Employees assigned to it."
      },
      {
        "date": "2020-01-02T00:22:00.000Z",
        "voteCount": 10,
        "content": "select  c.complaint,e.name,i.notes\nfrom\tcompliants as c\n\t\tleft outer join interactions as i on(c.compliantId = i.complaintId)\n\t\tleft out join employees as e on (i.employeeid = e.employeeId)"
      },
      {
        "date": "2020-06-26T17:07:00.000Z",
        "voteCount": 1,
        "content": "This is correct because you can only use two INNER JOINs if *all* ComplaintIDs in Complaints table have a corresponding entry in the Interactions table, and all those corresponding entries in the Interactions table have a corresponding entry in the Employees table."
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 70,
    "url": "https://www.examtopics.com/discussions/microsoft/view/3797-exam-70-761-topic-1-question-70-discussion/",
    "body": "SIMULATION -<br>You create a table named Products.Sales by running the following Transact-SQL statement:<br><img src=\"/assets/media/exam-media/02675/0016600002.png\" class=\"in-exam-image\"><br>You add the following data to the table.<br><img src=\"/assets/media/exam-media/02675/0016700001.png\" class=\"in-exam-image\"><br>You are developing a report to display monthly sales data.<br>You need to create a Transact-SQL query to meet the following requirements:<br>\u2711 Retrieve a column for the year followed by a column for each month from January through December.<br>\u2711 Include the total sales amount for each month.<br>Aggregate columns by year, month, and then amount.<br><img src=\"/assets/media/exam-media/02675/0016700004.png\" class=\"in-exam-image\"><br>Construct the query using the following guidelines:<br>\u2711 Use the MONTH keyword as the interval when using the DATANAME function.<br>\u2711 Do not modify the provided IN clause.<br>\u2711 Do not surround object names with square brackets.<br>\u2711 Do not use implicit joins.<br>\u2711 Do not use the DATEPART function.<br>Part of the correct Transact-SQL has been provided in the answer area below. Enter the code in the answer area that resolves the problem and meets the stated goals or requirements. You can add code within the code that has been provided as well as below it.<br>1. SELECT * FROM<br>2. (SELECT YEAR(SalesData)) AS Year, DATENAME (MONTH, SalesDate) AS Month, SalesAmount AS Amount<br>3.<br>4. ) AS MonthlySalesData<br>5.<br>6. FOR Month IN (January, February, March, April, May, June, July, August, September, October, November, December))<br><br>AS MonthNamePivot -<br><img src=\"/assets/media/exam-media/02675/0016800006.png\" class=\"in-exam-image\"><br>",
    "options": [],
    "answer": "Please see explanation",
    "answerDescription": "1 SELECT * FROM<br>2 (SELECT YEAR(SalesData)) AS Year, DATENAME (MONTH, SalesDate) AS Month, SUM(SalesAmount) AS Amount<br>3 FROM Products.Sales GROUP BY Year, Month<br>4 ) AS MonthlySalesData<br>5 PIVOT SUM(Amount)<br>6 FOR Month IN (January, February, March, April, May, June, July, August, September, October, November, December))<br><br>AS MonthNamePivot -<br>Note:<br>Line 2: Add SUM( ) around SalesAmount<br>Line 3: Add: FROM Products.Sales GROUP BY Year, Month<br>Line 5: Add: PIVOT SUM(Amount)",
    "votes": [],
    "comments": [
      {
        "date": "2019-09-28T06:13:00.000Z",
        "voteCount": 37,
        "content": "SELECT * FROM\n(SELECT YEAR(SalesDate) AS Year, DATENAME(MONTH, SalesDate) AS Month,\nSalesAmount AS Amount\nfrom Products.sales\n) AS MonthlySalesData\nPIVOT (Sum(Amount)\nFOR Month IN (January, February, March, April, May, June, July, August,\nSeptember, October, November, December))\nAS MonthNamePivot"
      },
      {
        "date": "2020-06-23T01:24:00.000Z",
        "voteCount": 2,
        "content": "Tazul number one"
      },
      {
        "date": "2021-01-01T11:57:00.000Z",
        "voteCount": 1,
        "content": "Tazul has it right"
      },
      {
        "date": "2019-08-19T06:16:00.000Z",
        "voteCount": 8,
        "content": "GROUP BY Year, Month =&gt; will not work since GROUP BY is executed before Select statement  =&gt; syntax erro. better: GROUP BY Year(SalesDate), Month(SalesDate)"
      },
      {
        "date": "2019-08-24T01:31:00.000Z",
        "voteCount": 3,
        "content": "Good point."
      },
      {
        "date": "2019-09-06T03:46:00.000Z",
        "voteCount": 1,
        "content": "Better use DATENAME same function of SELECT.\nGROUP BY YEAR(SalesData), DATENAME(MONTH, SalesDate)"
      },
      {
        "date": "2020-12-12T07:07:00.000Z",
        "voteCount": 1,
        "content": "Why do we need GROUP BY in derived table at all?"
      },
      {
        "date": "2020-09-14T04:30:00.000Z",
        "voteCount": 2,
        "content": "I don't think we need the sum in the SUM(SalesAmount). The pivot query will sum anyway"
      },
      {
        "date": "2020-02-24T01:30:00.000Z",
        "voteCount": 1,
        "content": "Everyone forgive about Total?\n SELECT * FROM \n  (SELECT YEAR(salesDate) AS Year, DATENAME (MONTH, SalesDate) AS Month, SalesAmount AS Amount\n\tFrom sales\n\tUNION ALL\n\tselect 'Total',DATENAME (MONTH, SalesDate) AS Month, SalesAmount AS Amount \n\tFrom sales\n  ) AS MonthlySalesData\n PIVOT ( SUM(Amount)\n  FOR Month IN (January, February, March, April, May, June, July, August, September, October, November, December))\n  as MonthNamePivot"
      },
      {
        "date": "2020-04-14T05:54:00.000Z",
        "voteCount": 1,
        "content": "you already calculate the total (sum) for each month using the pivottable. no need to additionally calculate this."
      },
      {
        "date": "2020-01-03T02:49:00.000Z",
        "voteCount": 1,
        "content": "SELECT * FROM\n (SELECT YEAR(SalesData)) AS Year, DATENAME (MONTH, SalesDate) AS Month, SalesAmount AS Amount\n from Products.Sales) AS MonthlySalesData\n pivot (sum(Amount)  FOR Month IN (January, February, March, April, May, June, July, August, September, October, November, December)) AS MonthNamePivot"
      },
      {
        "date": "2020-01-02T00:35:00.000Z",
        "voteCount": 8,
        "content": "SELECT * FROM\n(SELECT YEAR(SalesData)) AS Year, DATENAME (MONTH, SalesDate) AS Month, SalesAmount AS Amount\nFROM Products.Sales) AS MonthlySalesData\nPIVOT (SUM(Amount) FOR Month IN (January, February, March, April, May, June, July, August, September, October, November, December))  as AS PivotMonthlySalesData"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 71,
    "url": "https://www.examtopics.com/discussions/microsoft/view/8942-exam-70-761-topic-1-question-71-discussion/",
    "body": "Note: This question is part of a series of questions that use the same or similar answer choices. An answer choice may be correct for more than one question in the series. Each question is independent of the other questions in this series. Information and details provided in a question apply only to that question.<br>Multiple processes use the data from a table named Sales and place it in other databases across the organization. Some of the processes are not completely aware of the data types in the Sales table. This leads to data type conversion errors.<br>You need to implement a method that returns a NULL value id data conversion fails instead of throwing an error.<br>What should you implement?<br>",
    "options": [
      "<span class=\"multi-choice-letter\" data-choice-letter=\"A\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tthe COALESCE function",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"B\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tB.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\ta view",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"C\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tC.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\ta table-valued function",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"D\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tD.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tthe TRY_PARSE function",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"E\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tE.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\ta stored procedure",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"F\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tF.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tthe ISNULL function",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"G\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tG.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\ta scalar function",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"H\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tH.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tthe TRY_CONVERT function"
    ],
    "answer": "H",
    "answerDescription": "TRY_CONVERT returns a value cast to the specified data type if the cast succeeds; otherwise, returns null.<br>References:<br>https://docs.microsoft.com/en-us/sql/t-sql/functions/try-convert-transact-sql",
    "votes": [],
    "comments": [
      {
        "date": "2019-11-23T03:22:00.000Z",
        "voteCount": 15,
        "content": "Answer D with the TRY_PARSE function could not fit in this question. For example at page https://docs.microsoft.com/en-us/sql/t-sql/functions/try-parse-transact-sql?view=sql-server-ver15, we can read:\n\"Use TRY_PARSE only for converting from string to date/time and number types.\"\n\nAs the data types are not always known, the only possible answer is the one with the TRY_CONVERT function, which is H."
      },
      {
        "date": "2020-06-26T17:57:00.000Z",
        "voteCount": 3,
        "content": "Great explanation, thanks!"
      },
      {
        "date": "2021-01-06T23:48:00.000Z",
        "voteCount": 1,
        "content": "use TRY_CONVERT() for general data types"
      },
      {
        "date": "2020-07-06T13:00:00.000Z",
        "voteCount": 2,
        "content": "remember the stated problem: \"This leads to data type conversion errors\".\nCONVERSION errors solved by TRY_CONVERT"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 72,
    "url": "https://www.examtopics.com/discussions/microsoft/view/24920-exam-70-761-topic-1-question-72-discussion/",
    "body": "You have a database that contains the following tables:<br><img src=\"/assets/media/exam-media/02675/0017000001.jpg\" class=\"in-exam-image\"><br>You need to write a query that returns a list of all customers who have not placed orders.<br>Which Transact-SQL statement should you run?<br>",
    "options": [
      "<span class=\"multi-choice-letter\" data-choice-letter=\"A\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tSELECT c.custid FROM Sales.Customers c INNER JOIN Sales.Order o ON c.custid = o.custid",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"B\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tB.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tSELECT custid FROM Sales.Customers INTERSECT SELECT custid FROM Sales.Orders",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"C\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tC.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tSELECT c.custid FROM Sales.Customers c LEFT OUTER Sales.Order o ON c.custid = o.custid",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"D\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tD.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tSELECT c.custid FROM Sales.Customers c LEFT OUTER JOIN Sales.Order o ON c.custid = o.custid WHERE orderid IS NULL",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"E\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tE.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tSELECT custid FROM Sales.Customers UNION ALL SELECT custid FROM Sales.Orders",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"F\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tF.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tSELECT custid FROM Sales.Customers UNION SELECT custid FROM Sales.Orders",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"G\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tG.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tSELECT c.custid FROM Sales.Customers c RIGHT OUTER JOIN Sales.Orders o ON c.custid = o.custid"
    ],
    "answer": "D",
    "answerDescription": "Inner joins return rows only when there is at least one row from both tables that matches the join condition. Inner joins eliminate the rows that do not match with a row from the other table. Outer joins, however, return all rows from at least one of the tables or views mentioned in the FROM clause, as long as those rows meet any WHERE or HAVING search conditions. All rows are retrieved from the left table referenced with a left outer join, and all rows from the right table referenced in a right outer join. All rows from both tables are returned in a full outer join.<br>References:<br>https://technet.microsoft.com/en-us/library/ms187518(v=sql.105).aspx",
    "votes": [],
    "comments": [
      {
        "date": "2020-07-06T13:03:00.000Z",
        "voteCount": 6,
        "content": "when question contains \" HAVE NOT \", think EXCEPT or IS NULL.\nwhen question contains \" HAVE \", think INTERSECT or IS NOT NULL"
      },
      {
        "date": "2020-07-11T12:07:00.000Z",
        "voteCount": 1,
        "content": "Thanks :)"
      },
      {
        "date": "2020-10-13T09:01:00.000Z",
        "voteCount": 2,
        "content": "D is correct, although I wouldn't write it that way, I would write:\nselect CustID from Customers as C where not exists ( select 1 from Orders as O where O.CustID = C.CustID)"
      },
      {
        "date": "2020-08-12T08:22:00.000Z",
        "voteCount": 1,
        "content": "G looks good too."
      },
      {
        "date": "2020-08-17T06:33:00.000Z",
        "voteCount": 1,
        "content": "My bad, G returns all orders and customers that have orders. Sry."
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 73,
    "url": "https://www.examtopics.com/discussions/microsoft/view/2875-exam-70-761-topic-1-question-73-discussion/",
    "body": "DRAG DROP -<br>You have a database that contains the following tables:<br><img src=\"/assets/media/exam-media/02675/0017200001.png\" class=\"in-exam-image\"><br>A delivery person enters an incorrect value for the CustomerID column in the Invoices table and enters the following text in the ConfirmedReceivedBy column:<br>\"Package signed for by the owner Tim.\"<br>You need to find the records in the Invoices table that contain the word Tim in the CustomerName field along with the incorrectly entered row from the<br>Sales.Invoice table.<br>How should you complete the Transact-SQL statement? To answer, drag the appropriate Transact-SQL segments to the correct locations. Each Transact-SQL segment may be used once, more than once, or not at all. You may need to drag the split bar between panes or scroll to view content.<br>NOTE: Each correct selection is worth one point.<br>Select and Place:<br><img src=\"/assets/media/exam-media/02675/0017300001.png\" class=\"in-exam-image\"><br>",
    "options": [],
    "answer": "<img src=\"/assets/media/exam-media/02675/0017400001.png\" class=\"in-exam-image\">",
    "answerDescription": "Box 1:SELECT CustomerID FROM Sales.Invoices<br>Box 2:INNER JOIN Sales.Customers.CustomerID = Sales.Invoices.CustomerID<br>Box 3:WHERE CustomerName LIKE '%tim%'<br>Box 4:WHERE ConfirmedReceiveBy IN (SELECT CustomerName FROM Sales.Customers)",
    "votes": [],
    "comments": [
      {
        "date": "2019-09-06T05:23:00.000Z",
        "voteCount": 45,
        "content": "Read carefully the question: \n\n\"You need to find the records in the __Invoices__ (__I think Customers__)  table that contain the word Tim in the CustomerName field along with the incorrectly entered row from the\nSales.Invoice table.\" \n\nNo answer fill all box with JOIN, the only winning move is\n\nselect customerid from sales.customers\nwhere customername like '%tim%'\nunion\nselect customerid from sales.invoices\nwhere confirmedreceivedby like '%tim%'\n\nNo-Sense but this is the only answer"
      },
      {
        "date": "2019-09-10T01:54:00.000Z",
        "voteCount": 1,
        "content": "agree with You in 100%"
      },
      {
        "date": "2019-09-10T01:55:00.000Z",
        "voteCount": 1,
        "content": "Btw. Its difficult exercise"
      },
      {
        "date": "2019-12-18T09:07:00.000Z",
        "voteCount": 2,
        "content": "why union all can't be an option too? (e.g. if we want to see duplicates)"
      },
      {
        "date": "2020-02-24T02:21:00.000Z",
        "voteCount": 6,
        "content": "I think this Union because we need to see only incorrect customers from sales.Invoices,\nSo, if  there are more then one rows with \"tim\", it will shows it, if we make union  and remove all duplicates its be easy to find what happens."
      },
      {
        "date": "2020-03-19T20:56:00.000Z",
        "voteCount": 1,
        "content": "I think so, but the examtopics's answers say the against, but i think the same of your answer"
      },
      {
        "date": "2020-02-26T08:54:00.000Z",
        "voteCount": 1,
        "content": "This is correct."
      },
      {
        "date": "2019-07-25T07:13:00.000Z",
        "voteCount": 19,
        "content": "A SELECT with three WHERE? Since when sql accepts that syntax?"
      },
      {
        "date": "2021-01-13T11:57:00.000Z",
        "voteCount": 1,
        "content": "\"You need to find the records in the Invoices table that contain the word Tim in the CustomerName\"\nThis suggests you need to combine both tables because customername is not in the invoice table."
      },
      {
        "date": "2021-01-01T12:12:00.000Z",
        "voteCount": 1,
        "content": "Agree need UNION because we are seeking two different data sets. However, the second statement should SELECT CustomerID WHERE  confirmedreceivedby = ''Package signed for by the owner Tim.' because the instructions say to also return that one SINGLE record"
      },
      {
        "date": "2020-10-13T10:05:00.000Z",
        "voteCount": 2,
        "content": "SELECT CustomerID FROM Sales.Customers\nWHERE CustomerName LIKE '%tim%'\nUNION\nSELECT CustomerID FROM Sales.Invoices\nWHERE ConfirmedReceivedBy LIKE '%tim%';"
      },
      {
        "date": "2020-10-19T11:02:00.000Z",
        "voteCount": 1,
        "content": "agreed that is the correct solution"
      },
      {
        "date": "2020-03-03T05:22:00.000Z",
        "voteCount": 2,
        "content": ":-) M4X is the right one.     multiple where clause. Might be the exam accepts such syntax LoL"
      },
      {
        "date": "2019-11-16T12:21:00.000Z",
        "voteCount": 1,
        "content": "That solution provided is absolutely incorrect! M4X solution is the correct answer!"
      },
      {
        "date": "2019-11-05T23:42:00.000Z",
        "voteCount": 2,
        "content": "This should be full outer join. Customer Name condition will not work as customer can be different person but package signed will be different.\n\nWe need to add where condition as\" where confirmedreceivedby like '%tim%' and sales.invoices.customerId is not null and sales.customers.customerId is null"
      },
      {
        "date": "2019-09-21T07:26:00.000Z",
        "voteCount": 1,
        "content": "select Invoices.customerID\nfrom Invoices\n\nInner join customers\non customers.customerID = Invoices.customerID\n\nwhere CustomerName like \u2018%tim%\u2019"
      },
      {
        "date": "2019-11-12T01:50:00.000Z",
        "voteCount": 3,
        "content": "It cannot be join by CustomerId field, because in the question it says: \"A delivery person enters an incorrect value for the CustomerID column in the Invoices table\""
      },
      {
        "date": "2019-07-30T14:13:00.000Z",
        "voteCount": 3,
        "content": "The join needs to be a full outer join because the ID was entered incorrectly. It may not have a match between tables."
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 74,
    "url": "https://www.examtopics.com/discussions/microsoft/view/4721-exam-70-761-topic-1-question-74-discussion/",
    "body": "DRAG DROP -<br>Note: This question is part of a series of questions that use the same scenario. For your convenience, the scenario is repeated in each question. Each question presents a different goal and answer choices, but the text of the scenario is exactly the same in each question in this series.<br><br>Start of repeated scenario -<br>You have a database that contains the tables shown in the exhibit. (Click the Exhibit button.)<br><img src=\"/assets/media/exam-media/02675/0017500001.png\" class=\"in-exam-image\"><br>You review the Employee table and make the following observations:<br>\u2711 Every record has a value in the ManagerID except for the Chief Executive Officer (CEO).<br>\u2711 The FirstName and MiddleName columns contain null values for some records.<br>\u2711 The valid values for the Title column are Sales Representative manager, and CEO.<br>You review the SalesSummary table and make the following observations:<br>\u2711 The ProductCode column contains two parts: The first five digits represent a product code, and the last seven digits represent the unit price. The unit price uses the following pattern: ####.##.<br>\u2711 You observe that for many records, the unit price portion of the ProductCode column contains values.<br>\u2711 The RegionCode column contains NULL for some records.<br>\u2711 Sales data is only recorded for sales representatives.<br>You are developing a series of reports and procedures to support the business. Details for each report or procedure follow.<br>Sales Summary report: This report aggregates data by year and quarter. The report must resemble the following table.<br><img src=\"/assets/media/exam-media/02675/0017600001.png\" class=\"in-exam-image\"><br>Sales Manager report: This report lists each sales manager and the total sales amount for all employees that report to the sales manager.<br>Sales by Region report: This report lists the total sales amount by employee and by region. The report must include the following columns: EmployeeCode,<br>MiddleName, LastName, RegionCode, and SalesAmount. If MiddleName is NULL, FirstName must be displayed. If both FirstName and MiddleName have null values, the world Unknown must be displayed/ If RegionCode is NULL, the word Unknown must be displayed.<br>Report1: This report joins data from SalesSummary with the Employee table and other tables. You plan to create an object to support Report1. The object has the following requirements:<br>\u2711 be joinable with the SELECT statement that supplies data for the report<br>\u2711 can be used multiple times with the SELECT statement for the report<br>\u2711 be usable only with the SELECT statement for the report<br>\u2711 not be saved as a permanent object<br>Report2: This report joins data from SalesSummary with the Employee table and other tables.<br>You plan to create an object to support Report1. The object has the following requirements: be joinable with the SELECT statement that supplies data for the report<br>\u2711 can be used multiple times for this report and other reports<br>\u2711 accept parameters<br>\u2711 be saved as a permanent object<br>Sales Hierarchy report: This report aggregates rows, creates subtotal rows, and super-aggregates rows over the SalesAmount column in a single result-set. The report uses SaleYear, SaleQuarter, and SaleMonth as a hierarchy. The result set must not contain a grand total or cross-tabulation aggregate rows.<br>Current Price Stored Procedure: This stored procedure must return the unit price for a product when a product code is supplied. The unit price must include a dollar sign at the beginning. In addition, the unit price must contain a comma every three digits to the left of the decimal point, and must display two digits to the left of the decimal point. The stored procedure must not throw errors, even if the product code contains invalid data.<br><br>End of Repeated Scenario -<br>You need to create a query to return the data for the Sales Summary report.<br>Which three Transact-SQL segments should you use to develop the solution? To answer, move the appropriate Transact-SQL segments from the list of Transact-<br>SQL segments to the answer area and arrange them in the correct order.<br>Select and Place:<br><img src=\"/assets/media/exam-media/02675/0017800001.jpg\" class=\"in-exam-image\"><br>",
    "options": [],
    "answer": "<img src=\"/assets/media/exam-media/02675/0017900001.png\" class=\"in-exam-image\">",
    "answerDescription": "Use two CTE expressions, one for salesYear and one for SalesQuarter, and combine them with a SELECT statement.<br>Note: A common table expression (CTE) can be thought of as a temporary result set that is defined within the execution scope of a single SELECT, INSERT,<br>UPDATE, DELETE, or CREATE VIEW statement. A CTE is similar to a derived table in that it is not stored as an object and lasts only for the duration of the query.<br>References:<br>https://technet.microsoft.com/en-us/library/ms190766(v=sql.105).aspx",
    "votes": [],
    "comments": [
      {
        "date": "2020-01-31T04:44:00.000Z",
        "voteCount": 12,
        "content": "WITH SalesYear_cte(salesYear,YearSalesAmount)\nAS(\nSELECT Salesyear, Sum(salesAmount) YearSalesAmount\nFROM #SalesSummary\nGROUP BY salesyear\n),\nthis should be chosen, tested on sql server"
      },
      {
        "date": "2020-05-24T16:43:00.000Z",
        "voteCount": 1,
        "content": "yes, But the result for year 2016 is not done the sum of 2015. So the result is 1500 instead of 3500 as it is shown in the report"
      },
      {
        "date": "2019-09-04T20:38:00.000Z",
        "voteCount": 11,
        "content": "I believe salesyear_Cte should have only Group By SalesYear"
      },
      {
        "date": "2019-09-06T06:12:00.000Z",
        "voteCount": 1,
        "content": "Correct. Test on my SQL Server."
      },
      {
        "date": "2019-09-06T06:14:00.000Z",
        "voteCount": 2,
        "content": "Sorry, my answer is ambiguous. The @Abhilash_KK solution is correct the salesyear_Cte Group By SalesYear"
      },
      {
        "date": "2021-01-01T12:23:00.000Z",
        "voteCount": 1,
        "content": "Correct solution - extra 0 is a red herring - doesn't affect GROUP BY since it is a constant"
      },
      {
        "date": "2020-03-19T21:58:00.000Z",
        "voteCount": 1,
        "content": "1.- with SalesYear_cte(\n2.-SalesQuarter_cte(SalesYear,SalesQuarter\n3.- select y.SalesYear,q.SalesQuarter,y.YearSalesAmount,q.QuarterSalesAmount"
      },
      {
        "date": "2019-12-09T04:39:00.000Z",
        "voteCount": 2,
        "content": "QuarterSalesAmount is not in the GROUP BY clause, so it is invalid in the SELECT of the first CTE."
      },
      {
        "date": "2020-02-24T05:48:00.000Z",
        "voteCount": 2,
        "content": "in this case this a only alias for 0 constant, so its available for  this cte."
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 75,
    "url": "https://www.examtopics.com/discussions/microsoft/view/17026-exam-70-761-topic-1-question-75-discussion/",
    "body": "HOTSPOT -<br>Note: This question is part of a series of questions that use the same scenario. For your convenience, the scenario is repeated in each question. Each question presents a different goal and answer choices, but the text of the scenario is exactly the same in each question in this series.<br><br>Start of repeated scenario -<br>You have a database that contains the tables shown in the exhibit. (Click the Exhibit button.)<br><img src=\"/assets/media/exam-media/02675/0018000001.png\" class=\"in-exam-image\"><br>You review the Employee table and make the following observations:<br>\u2711 Every record has a value in the ManagerID except for the Chief Executive Officer (CEO).<br>\u2711 The FirstName and MiddleName columns contain null values for some records.<br>\u2711 The valid values for the Title column are Sales Representative manager, and CEO.<br>You review the SalesSummary table and make the following observations:<br>\u2711 The ProductCode column contains two parts: The first five digits represent a product code, and the last seven digits represent the unit price. The unit price uses the following pattern: ####.##.<br>\u2711 You observe that for many records, the unit price portion of the ProductCode column contains values.<br>\u2711 The RegionCode column contains NULL for some records.<br>\u2711 Sales data is only recorded for sales representatives.<br>You are developing a series of reports and procedures to support the business. Details for each report or procedure follow.<br>Sales Summary report: This report aggregates data by year and quarter. The report must resemble the following table.<br><img src=\"/assets/media/exam-media/02675/0018100008.png\" class=\"in-exam-image\"><br>Sales Manager report: This report lists each sales manager and the total sales amount for all employees that report to the sales manager.<br>Sales by Region report: This report lists the total sales amount by employee and by region. The report must include the following columns: EmployeeCode,<br>MiddleName, LastName, RegionCode, and SalesAmount. If MiddleName is NULL, FirstName must be displayed. If both FirstName and MiddleName have null values, the world Unknown must be displayed/ If RegionCode is NULL, the word Unknown must be displayed.<br>Report1: This report joins data from SalesSummary with the Employee table and other tables. You plan to create an object to support Report1. The object has the following requirements:<br>\u2711 be joinable with the SELECT statement that supplies data for the report<br>\u2711 can be used multiple times with the SELECT statement for the report<br>\u2711 be usable only with the SELECT statement for the report<br>\u2711 not be saved as a permanent object<br>Report2: This report joins data from SalesSummary with the Employee table and other tables.<br>You plan to create an object to support Report1. The object has the following requirements:<br>\u2711 be joinable with the SELECT statement that supplies data for the report<br>\u2711 can be used multiple times for this report and other reports<br>\u2711 accept parameters<br>\u2711 be saved as a permanent object<br>Sales Hierarchy report: This report aggregates rows, creates subtotal rows, and super-aggregates rows over the SalesAmount column in a single result-set. The report uses SaleYear, SaleQuarter, and SaleMonth as a hierarchy. The result set must not contain a grand total or cross-tabulation aggregate rows.<br>Current Price Stored Procedure: This stored procedure must return the unit price for a product when a product code is supplied. The unit price must include a dollar sign at the beginning. In addition, the unit price must contain a comma every three digits to the left of the decimal point, and must display two digits to the left of the decimal point. The stored procedure must not throw errors, even if the product code contains invalid data.<br><br>End of Repeated Scenario -<br>You need to create the query for the Sales by Region report.<br>Which function should you apply to each column? To answer, select the appropriate options in the answer area.<br>Hot Area:<br><img src=\"/assets/media/exam-media/02675/0018200005.png\" class=\"in-exam-image\"><br>",
    "options": [],
    "answer": "<img src=\"/assets/media/exam-media/02675/0018300001.png\" class=\"in-exam-image\">",
    "answerDescription": "Box 1: COALESCE -<br>COALESCE evaluates the arguments in order and returns the current value of the first expression that initially does not evaluate to NULL.<br>If MiddleName is NULL, FirstName must be displayed. If both FirstName and MiddleName have null values, the world Unknown must be displayed.<br>The following example shows how COALESCE selects the data from the first column that has a nonnull value.<br>SELECT Name, Class, Color, ProductNumber,<br>COALESCE(Class, Color, ProductNumber) AS FirstNotNull<br>FROM Production.Product;<br>Not NULLIF: NULLIF returns the first expression if the two expressions are not equal. If the expressions are equal, NULLIF returns a null value of the type of the first expression.<br><br>Box 2: COALESCE -<br>If RegionCodeis NULL, the word Unknown must be displayed.<br>References:<br>https://docs.microsoft.com/en-us/sql/t-sql/language-elements/coalesce-transact-sql",
    "votes": [],
    "comments": [
      {
        "date": "2020-10-09T15:02:00.000Z",
        "voteCount": 1,
        "content": "The RegionCode must return 'Unknown' when null\nSo the answer must be ISNULL"
      },
      {
        "date": "2020-10-28T05:23:00.000Z",
        "voteCount": 3,
        "content": "there isnt isnull, so both coalesce"
      },
      {
        "date": "2020-03-19T22:05:00.000Z",
        "voteCount": 4,
        "content": "both cases area coalesce"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 76,
    "url": "https://www.examtopics.com/discussions/microsoft/view/3541-exam-70-761-topic-1-question-76-discussion/",
    "body": "DRAG DROP -<br>Note: This question is part of a series of questions that use the same scenario. For your convenience, the scenario is repeated in each question. Each question presents a different goal and answer choices, but the text of the scenario is exactly the same in each question in this series.<br><br>Start of repeated scenario -<br>You have a database that contains the tables shown in the exhibit. (Click the Exhibit button.)<br><img src=\"/assets/media/exam-media/02675/0018400001.png\" class=\"in-exam-image\"><br>You review the Employee table and make the following observations:<br>\u2711 Every record has a value in the ManagerID except for the Chief Executive Officer (CEO).<br>\u2711 The FirstName and MiddleName columns contain null values for some records.<br>\u2711 The valid values for the Title column are Sales Representative manager, and CEO.<br>You review the SalesSummary table and make the following observations:<br>\u2711 The ProductCode column contains two parts: The first five digits represent a product code, and the last seven digits represent the unit price. The unit price uses the following pattern: ####.##.<br>\u2711 You observe that for many records, the unit price portion of the ProductCode column contains values.<br>The RegionCode column contains NULL for some records.<br><img src=\"/assets/media/exam-media/02675/0018400007.png\" class=\"in-exam-image\"><br>\u2711 Sales data is only recorded for sales representatives.<br>You are developing a series of reports and procedures to support the business. Details for each report or procedure follow.<br>Sales Summary report: This report aggregates data by year and quarter. The report must resemble the following table.<br><img src=\"/assets/media/exam-media/02675/0018500002.png\" class=\"in-exam-image\"><br>Sales Manager report: This report lists each sales manager and the total sales amount for all employees that report to the sales manager.<br>Sales by Region report: This report lists the total sales amount by employee and by region. The report must include the following columns: EmployeeCode,<br>MiddleName, LastName, RegionCode, and SalesAmount. If MiddleName is NULL, FirstName must be displayed. If both FirstName and MiddleName have null values, the world Unknown must be displayed/ If RegionCode is NULL, the word Unknown must be displayed.<br>Report1: This report joins data from SalesSummary with the Employee table and other tables. You plan to create an object to support Report1. The object has the following requirements:<br>\u2711 be joinable with the SELECT statement that supplies data for the report<br>\u2711 can be used multiple times with the SELECT statement for the report<br>\u2711 be usable only with the SELECT statement for the report<br>\u2711 not be saved as a permanent object<br>Report2: This report joins data from SalesSummary with the Employee table and other tables.<br>You plan to create an object to support Report1. The object has the following requirements:<br>\u2711 be joinable with the SELECT statement that supplies data for the report<br>\u2711 can be used multiple times for this report and other reports<br>\u2711 accept parameters<br>\u2711 be saved as a permanent object<br>Sales Hierarchy report: This report aggregates rows, creates subtotal rows, and super-aggregates rows over the SalesAmount column in a single result-set. The report uses SaleYear, SaleQuarter, and SaleMonth as a hierarchy. The result set must not contain a grand total or cross-tabulation aggregate rows.<br>Current Price Stored Procedure: This stored procedure must return the unit price for a product when a product code is supplied. The unit price must include a dollar sign at the beginning. In addition, the unit price must contain a comma every three digits to the left of the decimal point, and must display two digits to the left of the decimal point. The stored procedure must not throw errors, even if the product code contains invalid data.<br><br>End of Repeated Scenario -<br>You are creating the queries for Report1 and Report2.<br>You need to create the objects necessary to support the queries.<br>Which object should you use to join the SalesSummary table with the other tables that each report uses? To answer, drag the appropriate objects to the correct reports. each object may be used once, more than once, or not at all. You may need to drag the split bar between panes or scroll to view content.<br>Select and Place:<br><img src=\"/assets/media/exam-media/02675/0018600001.png\" class=\"in-exam-image\"><br>",
    "options": [],
    "answer": "<img src=\"/assets/media/exam-media/02675/0018700001.png\" class=\"in-exam-image\">",
    "answerDescription": "Box 1: common table expression (CTE)<br>A common tableexpression (CTE) can be thought of as a temporary result set that is defined within the execution scope of a single SELECT, INSERT, UPDATE,<br>DELETE, or CREATE VIEW statement. A CTE is similar to a derived table in that it is not stored as an object and lasts only for the duration of the query. Unlike a derived table, a CTE can be self-referencing and can be referenced multiple times in the same query.<br>A CTE can be used to:<br>\u2711 Create a recursive query. For more information, see Recursive Queries Using CommonTable Expressions.<br>\u2711 Substitute for a view when the general use of a view is not required; that is, you do not have to store the definition in metadata.<br>\u2711 Enable grouping by a column that is derived from a scalar subselect, or a function that is either not deterministic or has external access.<br>\u2711 Reference the resulting table multiple times in the same statement.<br>From Scenario: Report1: This report joins data from SalesSummary with the Employee table and other tables. You plan to create an object to support Report1.<br>The object has the following requirements:<br>\u2711 be joinable with the SELECT statement that supplies data for the report can be used multiple times with the SELECT statement for the report<br><img src=\"/assets/media/exam-media/02675/0018700007.png\" class=\"in-exam-image\"><br>\u2711 be usable only with the SELECT statement for the report<br>\u2711 not be savedas a permanent object<br><br>Box 2: view -<br>From scenario: Report2: This report joins data from SalesSummary with the Employee table and other tables.<br>You plan to create an object to support Report1. The object has the following requirements:<br>\u2711 be joinable with theSELECT statement that supplies data for the report<br>\u2711 can be used multiple times for this report and other reports<br>\u2711 accept parameters<br>\u2711 be saved as a permanent object<br>References:<br>https://technet.microsoft.com/en-us/library/ms190766(v=sql.105).aspx",
    "votes": [],
    "comments": [
      {
        "date": "2019-08-13T05:34:00.000Z",
        "voteCount": 42,
        "content": "I think the second object should be a \"Table Valued Function\" because it is stored permanently in the database and can be used with other queries as well as it can accept parameters. The answer given chose \"View\" which is wrong because \"Views\" can not accept parameters."
      },
      {
        "date": "2021-01-14T12:28:00.000Z",
        "voteCount": 1,
        "content": "that's right. see \nhttps://www.mssqltips.com/sqlservertip/5147/limitations-when-working-with-sql-server-views/"
      },
      {
        "date": "2019-09-22T13:20:00.000Z",
        "voteCount": 7,
        "content": "Yeah, Second option should be 'Table Valued Function'"
      },
      {
        "date": "2020-09-01T22:03:00.000Z",
        "voteCount": 1,
        "content": "First one is CTE and second one should be Table valued functions not view Because view does not accept parameters but TVF does."
      },
      {
        "date": "2020-05-24T17:26:00.000Z",
        "voteCount": 1,
        "content": "Also first is wrong. It must be temporary table - its the only one not to be saved permanent"
      },
      {
        "date": "2020-05-24T17:47:00.000Z",
        "voteCount": 3,
        "content": "Sorry, even CTE is temp and can be used multiple times with the select statement. Its CTE"
      },
      {
        "date": "2020-02-12T08:55:00.000Z",
        "voteCount": 1,
        "content": "CTE cannot be used with multiple select statement, only one select right after CTE declaration"
      },
      {
        "date": "2020-02-12T08:56:00.000Z",
        "voteCount": 2,
        "content": "and to be honest, I think first one should be temp table"
      },
      {
        "date": "2020-02-24T05:55:00.000Z",
        "voteCount": 6,
        "content": "Question about multiple usage in one SELECT statement, cte able to do it.\nalso, its not be saved as tempora object."
      },
      {
        "date": "2020-01-08T06:51:00.000Z",
        "voteCount": 1,
        "content": "For the 1st object, isn't it a subquery/derived table? As per the requirement, the object can be used only with the select statement (not with miltiple statements). The CTE can be used with multiple select statements."
      },
      {
        "date": "2020-02-24T05:55:00.000Z",
        "voteCount": 1,
        "content": "t be clear - it can be used in one select statement and in subqueries"
      },
      {
        "date": "2019-11-16T12:58:00.000Z",
        "voteCount": 5,
        "content": "A view does not accept parameters but a TVF does!"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 77,
    "url": "https://www.examtopics.com/discussions/microsoft/view/3995-exam-70-761-topic-1-question-77-discussion/",
    "body": "DRAG DROP -<br>Note: This question is part of a series of questions that use the same scenario. For your convenience, the scenario is repeated in each question. Each question presents a different goal and answer choices, but the text of the scenario is exactly the same in each question in this series.<br><br>Start of repeated scenario -<br>You have a database that contains the tables shown in the exhibit. (Click the Exhibit button.)<br><img src=\"/assets/media/exam-media/02675/0018800007.png\" class=\"in-exam-image\"><br>You review the Employee table and make the following observations:<br>\u2711 Every record has a value in the ManagerID except for the Chief Executive Officer (CEO).<br>\u2711 The FirstName and MiddleName columns contain null values for some records.<br>\u2711 The valid values for the Title column are Sales Representative manager, and CEO.<br>You review the SalesSummary table and make the following observations:<br>\u2711 The ProductCode column contains two parts: The first five digits represent a product code, and the last seven digits represent the unit price. The unit price uses the following pattern: ####.##.<br>\u2711 You observe that for many records, the unit price portion of the ProductCode column contains values.<br>\u2711 The RegionCode column contains NULL for some records.<br>\u2711 Sales data is only recorded for sales representatives.<br>You are developing a series of reports and procedures to support the business. Details for each report or procedure follow.<br>Sales Summary report: This report aggregates data by year and quarter. The report must resemble the following table.<br><img src=\"/assets/media/exam-media/02675/0018900008.png\" class=\"in-exam-image\"><br>Sales Manager report: This report lists each sales manager and the total sales amount for all employees that report to the sales manager.<br>Sales by Region report: This report lists the total sales amount by employee and by region. The report must include the following columns: EmployeeCode,<br>MiddleName, LastName, RegionCode, and SalesAmount. If MiddleName is NULL, FirstName must be displayed. If both FirstName and MiddleName have null values, the world Unknown must be displayed/ If RegionCode is NULL, the word Unknown must be displayed.<br>Report1: This report joins data from SalesSummary with the Employee table and other tables. You plan to create an object to support Report1. The object has the following requirements:<br>\u2711 be joinable with the SELECT statement that supplies data for the report<br>\u2711 can be used multiple times with the SELECT statement for the report<br>\u2711 be usable only with the SELECT statement for the report<br>not be saved as a permanent object<br><img src=\"/assets/media/exam-media/02675/0018900012.png\" class=\"in-exam-image\"><br>Report2: This report joins data from SalesSummary with the Employee table and other tables.<br>You plan to create an object to support Report1. The object has the following requirements:<br>\u2711 be joinable with the SELECT statement that supplies data for the report<br>\u2711 can be used multiple times for this report and other reports<br>\u2711 accept parameters<br>\u2711 be saved as a permanent object<br>Sales Hierarchy report: This report aggregates rows, creates subtotal rows, and super-aggregates rows over the SalesAmount column in a single result-set. The report uses SaleYear, SaleQuarter, and SaleMonth as a hierarchy. The result set must not contain a grand total or cross-tabulation aggregate rows.<br>Current Price Stored Procedure: This stored procedure must return the unit price for a product when a product code is supplied. The unit price must include a dollar sign at the beginning. In addition, the unit price must contain a comma every three digits to the left of the decimal point, and must display two digits to the left of the decimal point. The stored procedure must not throw errors, even if the product code contains invalid data.<br><br>End of Repeated Scenario -<br>You need to create the query for the Sales Managers report.<br>Which four Transact-SQL segments should you use to develop the solution? To answer, move the appropriate Transact-SQL segments from the list of Transact-<br>SQL segments to the answer area and arrange them in the correct order.<br>Select and Place:<br><img src=\"/assets/media/exam-media/02675/0019100001.png\" class=\"in-exam-image\"><br>",
    "options": [],
    "answer": "<img src=\"/assets/media/exam-media/02675/0019200001.png\" class=\"in-exam-image\">",
    "answerDescription": "From scenario: Sales Manager report: This report lists each sales manager and the total sales amount for all employees that report to the sales manager.<br>Box 1:..WHERE Title='Sales representative'<br>The valid values for the Title column are Sales Representative manager, and CEO.<br>First we define the CTE expression.<br>Note: A common table expression (CTE) can be thought of as a temporary result set that is defined within the execution scope of a single SELECT, INSERT,<br>UPDATE, DELETE, or CREATE VIEW statement. A CTE is similar to a derived table in that it is not stored as an object and lasts only for the duration of the query.<br>Unlike a derived table, a CTE can be self-referencing and can be referenced multiple times in the same query.<br>Box 2:<br>Use the CTE expression one time.<br><br>Box 3: UNION -<br>Box 4:<br>Use the CTE expression a second time.<br>References:<br>https://technet.microsoft.com/en-us/library/ms190766(v=sql.105).aspx",
    "votes": [],
    "comments": [
      {
        "date": "2019-08-24T01:41:00.000Z",
        "voteCount": 14,
        "content": "My solution:\nWITH cte (ManagerID, EmployeeID, EmployeeCode, Title, SalesAmount) AS\n(\nSELECT e.ManagerID, e.EmployeeID, e.EmployeeCode, e.Title, ss.SalesAmount\nFROM dbo.Employee e\nINNER JOIN dbo.SalesSummary ss\nON e.EmployeeCode = ss.EmployeeCode\nWHERE ManagerID IS NULL\n\nUNION ALL\n\nSELECT e.ManagerID, e.EmployeeID, e.EmployeeCode, e.Title, cte.SalesAmount\nFROM dbo.Employee e\nINNER JOIN cte\nON e.ManagerID = cte.EmployeeID\n)\nSELECT ManagerID, EmployeeID, EmployeeCode, Title, SUM(SalesAmount)\nFROM cte\nGROUP BY ManagerID, EmployeeID, EmployeeCode, Title"
      },
      {
        "date": "2019-09-11T23:22:00.000Z",
        "voteCount": 2,
        "content": "its wrong, returning SUM() as 0. see sample code\n\n\nCREATE TABLE #EMPLOYEES (\nEMPLOYEEID INT, EMPLOYEECODE INT, FIRSTNAME VARCHAR(20),TITLE VARCHAR(140), MANAGERID INT)\n\nCREATE TABLE #SALESSUMMARY (EMPLOYEECODE INT, SALESAMOUNT DECIMAL(18,2))\n\nINSERT INTO #EMPLOYEES VALUES (1,11,'BARTEK', 'SALES REPRESENTATIVE', 3), \t\t\t\t\t\n\t\t\t\t\t\t(2,13,'TOMEK','SALES REPRESENTATIVE',3),\n\t\t\t\t\t\t(3,12,'KASIA','SALES REPRESENTATIVE',4),\n\t\t\t\t\t\t(4,14,'WIKTOR','CTO',NULL)\n\nINSERT INTO #SALESSUMMARY VALUES (11,100),(12,200),(13,300),(14,0)\n\n\n;WITH cte AS\n(\nSELECT e.ManagerID, e.EmployeeID, e.EmployeeCode, e.Title, ss.SalesAmount\nFROM #EmployeeS e\nINNER JOIN #SalesSummary ss\nON e.EmployeeCode = ss.EmployeeCode\nWHERE ManagerID IS NULL\n\nUNION ALL\n\nSELECT e.ManagerID, e.EmployeeID, e.EmployeeCode, e.Title, cte.SalesAmount\nFROM #EmployeeS e\nINNER JOIN cte\nON e.ManagerID = cte.EmployeeID\n)\nSELECT ManagerID, EmployeeID, EmployeeCode, Title, SUM(SalesAmount)\nFROM cte\nGROUP BY ManagerID, EmployeeID, EmployeeCode, Title"
      },
      {
        "date": "2019-09-06T07:04:00.000Z",
        "voteCount": 3,
        "content": "Agree (and tested). The solution use Where Title = 'Sales Representative' and specs says that field value can be: The valid values for the Title column are Sales Representative manager, and CEO."
      },
      {
        "date": "2019-09-06T07:06:00.000Z",
        "voteCount": 1,
        "content": "Also missing the employees"
      },
      {
        "date": "2020-09-20T04:02:00.000Z",
        "voteCount": 2,
        "content": "M4x is correct because for managerID null - description above is:\n\" Every record has a value in the ManagerID except for the Chief Executive Officer (CEO).\"\nSo first select wrongly will bring CEO sales."
      },
      {
        "date": "2020-02-06T07:06:00.000Z",
        "voteCount": 7,
        "content": "If we use \"WHERE ManagerID IS NULL\", the report will show not only sales managers but CEO too. Isn't it?"
      },
      {
        "date": "2020-08-12T16:15:00.000Z",
        "voteCount": 1,
        "content": "CEOs are managers."
      },
      {
        "date": "2020-12-14T21:41:00.000Z",
        "voteCount": 1,
        "content": "The CEO takes final responsibility and ownership for the direction of the business, while a manager commonly only oversees a segment of the business and answers to a more senior person."
      },
      {
        "date": "2021-01-25T07:05:00.000Z",
        "voteCount": 1,
        "content": "AshleyLiang has got the correct solution. \nThe anchor should have : where managerid is null"
      },
      {
        "date": "2019-09-11T23:24:00.000Z",
        "voteCount": 2,
        "content": "Do not know that result (from hide bar) is fine becouse it produces duplicates throught UNION clause.\nIn my opinion something like that :\n\nwith cte as (\nselect e.managerid, e.employeeid, e.employeecode,e.title, ss.salesamount\nfrom #employees e \njoin #salessummary ss\non e.employeecode = ss.employeecode\nwhere title = 'sales representative'\n)\nselect managerid, employeeid,employeecode,title,sum(salesamount) as salesamount\nfrom cte \ngroup by managerid, employeeid, employeecode, title\n\nshould be fine"
      },
      {
        "date": "2019-09-12T01:16:00.000Z",
        "voteCount": 4,
        "content": "Complete solution :\n\n\n\nCREATE TABLE #EMPLOYEES (\nEMPLOYEEID INT, EMPLOYEECODE INT, FIRSTNAME VARCHAR(20),TITLE VARCHAR(140), MANAGERID INT)\n\nCREATE TABLE #SALESSUMMARY (EMPLOYEECODE INT, SALESAMOUNT DECIMAL(18,2))\n\nINSERT INTO #EMPLOYEES VALUES (1,11,'BARTEK', 'SALES REPRESENTATIVE', 3), \t\t\t\t\t\n\t\t\t\t\t\t(2,13,'TOMEK','SALES REPRESENTATIVE',3),\n\t\t\t\t\t\t(3,12,'KASIA','SALES REPRESENTATIVE',4),\n\t\t\t\t\t\t(4,14,'WIKTOR','CTO',NULL)\n\nINSERT INTO #SALESSUMMARY VALUES (11,100),(12,200),(13,300),(14,0)\n\n\n;WITH cte AS\n(\nSELECT e.ManagerID, e.EmployeeID, e.EmployeeCode, e.Title, ss.SalesAmount\nFROM #EmployeeS e\nINNER JOIN #SalesSummary ss\nON e.EmployeeCode = ss.EmployeeCode\nwhere title = 'sales representative'\n\nUNION ALL\n\nSELECT e.ManagerID, e.EmployeeID, e.EmployeeCode, e.Title, cte.SalesAmount\nFROM #EmployeeS e\nINNER JOIN cte\nON e.ManagerID = e.EmployeeID\n)\nSELECT ManagerID, EmployeeID, EmployeeCode, Title, SUM(SalesAmount)\nFROM cte\nGROUP BY ManagerID, EmployeeID, EmployeeCode, Title"
      },
      {
        "date": "2020-02-24T06:11:00.000Z",
        "voteCount": 3,
        "content": "agree wth Bartek soluton, we need sales representative.\nbut in \nINNER JOIN cte\nON e.ManagerID = e.EmployeeID\nneed change to cte.EmployeeeId"
      },
      {
        "date": "2020-09-20T04:29:00.000Z",
        "voteCount": 2,
        "content": "why not \" ON cte.ManagerID = e.EmployeeID\" ??\nin the CTE will bring sales representatives and need to join their column managerID with table again to bring details about managers. correct?"
      },
      {
        "date": "2020-11-18T17:32:00.000Z",
        "voteCount": 1,
        "content": "It works! Bartek solution.\nbut after UNION ALL join columns are:\nINNER JOIN cte\nON cte.ManagerID = e.EmployeeID"
      },
      {
        "date": "2020-08-03T05:00:00.000Z",
        "voteCount": 1,
        "content": "i agree that we need the 'Sales Representative' filter.\ntested both your solution and the solution from the 'Reveal Solution'. \nboth shows same results."
      },
      {
        "date": "2020-08-21T01:54:00.000Z",
        "voteCount": 1,
        "content": "agree on Bartek's solution. missed that the given solution is only using 'union'"
      },
      {
        "date": "2020-09-08T05:54:00.000Z",
        "voteCount": 1,
        "content": "also, \"total sales amount for all employees that report to the sales manager\" so it means the employees need to have managerID"
      },
      {
        "date": "2020-08-12T16:15:00.000Z",
        "voteCount": 1,
        "content": "It's a recursive CTE. See this link\nhttps://www.sqlservertutorial.net/sql-server-basics/sql-server-recursive-cte/"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 78,
    "url": "https://www.examtopics.com/discussions/microsoft/view/40085-exam-70-761-topic-1-question-78-discussion/",
    "body": "HOTSPOT -<br>You have a database that contains the following tables: tblRoles, tblUsers, and tblUsersInRoles.<br>The table tblRoles is defined as follows.<br><img src=\"/assets/media/exam-media/02675/0019300001.png\" class=\"in-exam-image\"><br>You have a function named ufnGetRoleActiveUsers that was created by running the following Transact-SQL statement:<br><img src=\"/assets/media/exam-media/02675/0019400001.png\" class=\"in-exam-image\"><br>You need to list all roles and their corresponding active users. The query must return the RoleId, RoleName, and UserName columns. If a role has no active users, a NULL value should be returned as the UserName for that role.<br>How should you complete the Transact-SQL statement? To answer, select the appropriate Transact-SQL segments in the answer area.<br>Hot Area:<br><img src=\"/assets/media/exam-media/02675/0019400002.png\" class=\"in-exam-image\"><br>",
    "options": [],
    "answer": "<img src=\"/assets/media/exam-media/02675/0019500001.png\" class=\"in-exam-image\">",
    "answerDescription": "",
    "votes": [],
    "comments": [
      {
        "date": "2020-12-16T12:11:00.000Z",
        "voteCount": 1,
        "content": "Correctimundo"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 79,
    "url": "https://www.examtopics.com/discussions/microsoft/view/3566-exam-70-761-topic-1-question-79-discussion/",
    "body": "You have a database named MyDb. You run the following Transact-SQL statements:<br><img src=\"/assets/media/exam-media/02675/0019500002.jpg\" class=\"in-exam-image\"><br>A value of 1 in the IsActive column indicates that a user is active.<br>You need to create a count for active users in each role. If a role has no active users. You must display a zero as the active users count.<br>Which Transact-SQL statement should you run?<br><img src=\"/assets/media/exam-media/02675/0019600001.png\" class=\"in-exam-image\"><br>A.<br><img src=\"/assets/media/exam-media/02675/0019600002.png\" class=\"in-exam-image\"><br>B.<br><img src=\"/assets/media/exam-media/02675/0019600003.png\" class=\"in-exam-image\"><br>C.<br><img src=\"/assets/media/exam-media/02675/0019600004.png\" class=\"in-exam-image\"><br>D.<br>",
    "options": [],
    "answer": "B",
    "answerDescription": "",
    "votes": [],
    "comments": [
      {
        "date": "2019-11-07T03:29:00.000Z",
        "voteCount": 16,
        "content": "Answer B is wrong because the COUNT(*) returns 1, it should be COUNT(U.UserId)"
      },
      {
        "date": "2019-11-12T08:37:00.000Z",
        "voteCount": 15,
        "content": "Actually, none of the answers works... (I checked).\nD answer needs a join that doesn't have\nB answer should be COUNT(U.UserID) otherwise COUNT(*) even without active users always returns the value 1"
      },
      {
        "date": "2021-01-21T01:50:00.000Z",
        "voteCount": 1,
        "content": "None of the options are correct:\nThe correct answer is option A from question 43.\n \nselect R.RoleID, count (u.UserID)\nby #tblRole R LEFT JOIN (\nSELECT j.UserID, j.RoleID FROM #tblUsers j\nwhere j.IsActive = 1\n) u in r.RoleID = u.RoleID\nGROUP BY r.RoleID\n\nWhat the subquery does is take only the users that are active, that is, only the IsActive = 1 but as in the outside query they are compared to be the same and since it is a LEFT JOIN, obviously those with IsActive = 0 will be then since it is a LEFT JOIN, I know if they are going to show but they are NULL, the count () sends it to 0, COUNT (*) should not be used because if it returns 1 since COUNT (*) even counts the nulls."
      },
      {
        "date": "2020-05-27T13:30:00.000Z",
        "voteCount": 7,
        "content": "This question is the same with Q43 in these questions and Answer is:\n\nSELECT R.RoleName, COUNT(UserId) AS ActiveUserCount\nFROM tblRoles R\nLEFT JOIN (SELECT UserID, RoleID FROM tblUsers WHERE IsActive = 1) U\nON U.RoleId = R.RoleId\nGROUP BY R.RoleId, R.RoleName \n\n(TESTED)"
      },
      {
        "date": "2020-05-27T13:33:00.000Z",
        "voteCount": 1,
        "content": "So, it is correct  C"
      },
      {
        "date": "2020-05-27T13:34:00.000Z",
        "voteCount": 2,
        "content": "Sorry B (Count(UserId) = Count(*))"
      },
      {
        "date": "2020-05-27T13:44:00.000Z",
        "voteCount": 4,
        "content": "Anyway Count* = 1 when there is no active users :/"
      },
      {
        "date": "2020-02-24T06:19:00.000Z",
        "voteCount": 4,
        "content": "I think is just cropped a part of answer D, and it should be correct"
      },
      {
        "date": "2020-09-20T04:48:00.000Z",
        "voteCount": 1,
        "content": "agree with you - seems that the have miss something on crop. here is a similar questions with answers:\nhttps://www.briefmenow.org/microsoft/which-transact-sql-statement-should-you-run-10/"
      },
      {
        "date": "2019-11-16T11:43:00.000Z",
        "voteCount": 5,
        "content": "I agree with Scooter123: SELECT R.RoleName, COUNT(UserId) AS ActiveUserCount\nFROM tb1Roles R\nLEFT JOIN (SELECT UserID, RoleID FROM tb1Users WHERE IsActive = 1) U\nON U.RoleId = R.RoleId\nGROUP BY R.RoleId, R.RoleName  I have simulated this as well"
      },
      {
        "date": "2019-08-14T00:02:00.000Z",
        "voteCount": 11,
        "content": "Hallo,\n\nI think the correct answer should be D, because there is a condition in the question \"If a role has no active users, you must disply a zero as the active users count\". To satisfy this condition the correct answer should be query D, where ISNULL (U.activeUseCount,0) is used to satify the above condition.\n\nhttps://docs.microsoft.com/en-us/sql/t-sql/functions/isnull-transact-sql?view=sql-server-2017"
      },
      {
        "date": "2019-09-12T10:46:00.000Z",
        "voteCount": 13,
        "content": "Answer B is fine. \nAnswer D even do not have \"ON\" clause after \"JOIN\" clause"
      },
      {
        "date": "2020-11-19T13:15:00.000Z",
        "voteCount": 1,
        "content": "Yes, the best option including at the end the ON clause like so: \nON R.RoleID = U.RoleID"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 80,
    "url": "https://www.examtopics.com/discussions/microsoft/view/24780-exam-70-761-topic-1-question-80-discussion/",
    "body": "Note: This question is part of a series of questions that use the same or similar answer choices. An answer choice may be correct for more than one question in the series. Each question is independent of the other questions in this series. Information and details provided in a question apply to that question.<br>You have a database for a banking system. The database has two tables named tblDepositAcct and tblLoanAcct that store deposit and loan accounts, respectively. Both tables contain the following columns:<br><img src=\"/assets/media/exam-media/02675/0019700001.png\" class=\"in-exam-image\"><br>You need to determine the total number of customers who have either deposit accounts or loan accounts, but not both types of accounts.<br>Which Transact-SQL statement should you run?<br><img src=\"/assets/media/exam-media/02675/0019700002.png\" class=\"in-exam-image\"><br>A.<br><img src=\"/assets/media/exam-media/02675/0019800001.png\" class=\"in-exam-image\"><br>B.<br><img src=\"/assets/media/exam-media/02675/0019800002.png\" class=\"in-exam-image\"><br>C.<br><img src=\"/assets/media/exam-media/02675/0019800003.png\" class=\"in-exam-image\"><br>D.<br><img src=\"/assets/media/exam-media/02675/0019800004.png\" class=\"in-exam-image\"><br>E.<br><img src=\"/assets/media/exam-media/02675/0019800005.png\" class=\"in-exam-image\"><br>F.<br><img src=\"/assets/media/exam-media/02675/0019900001.png\" class=\"in-exam-image\"><br>G.<br><img src=\"/assets/media/exam-media/02675/0019900002.png\" class=\"in-exam-image\"><br>H.<br>",
    "options": [],
    "answer": "G",
    "answerDescription": "SQL Server provides the full outer join operator, FULL OUTER JOIN, which includes all rows from both tables, regardless of whether or not the other table has a matching value.<br>Consider a join of the Product table and the SalesOrderDetail table on their ProductID columns. The results show only the Products that have sales orders on them. The ISO FULL OUTER JOIN operator indicates that all rows from both tables are to be included in the results, regardless of whether there is matching data in the tables.<br>You can include a WHERE clause with a full outer join to return only the rows where there is no matching data between the tables. The following query returns only those products that have no matching sales orders, as well as those sales orders that are not matched to a product.<br>USE AdventureWorks2008R2;<br><br>GO -<br>-- The OUTER keyword following the FULL keyword is optional.<br><br>SELECT p.Name, sod.SalesOrderID -<br><br>FROM Production.Product p -<br>FULL OUTER JOIN Sales.SalesOrderDetail sod<br><br>ON p.ProductID = sod.ProductID -<br><br>WHERE p.ProductID IS NULL -<br><br>OR sod.ProductID IS NULL -<br><br>ORDER BY p.Name -<br>References:<br>https://technet.microsoft.com/en-us/library/ms187518(v=sql.105).aspx",
    "votes": [],
    "comments": [
      {
        "date": "2020-07-22T13:16:00.000Z",
        "voteCount": 10,
        "content": "correct answer is G, tested it. D returns only those clients that have both deposit and loans so its invalid."
      },
      {
        "date": "2020-12-15T07:49:00.000Z",
        "voteCount": 2,
        "content": "G its ok"
      },
      {
        "date": "2020-11-24T13:07:00.000Z",
        "voteCount": 1,
        "content": "UNION ALL\nSELECT 'F', count(*),'Total number of customers who have only deposit accounts' FROM (\n\tSELECT CustNo FROM #tblDepositAcct D\n\tEXCEPT\n\tSELECT CustNo FROM #tblLoanAcct L\n\t) R\nUNION ALL\nSELECT 'G', count(DISTINCT COALESCE(d.CustNo, l.CustNo)),'#80: Total number of customers who have either deposit accounts or loan accounts, but not both types of accounts'\nFROM #tblDepositAcct D\n\tFULL JOIN  #tblLoanAcct L ON d.CustNo=l.CustNo\nWHERE d.CustNo IS NULL OR l.CustNo IS NULL\nUNION ALL\nSELECT 'H', count(*),''\nFROM #tblDepositAcct D\n\tFULL JOIN  #tblLoanAcct L ON d.CustNo=l.CustNo"
      },
      {
        "date": "2020-11-24T13:07:00.000Z",
        "voteCount": 1,
        "content": "SELECT 'A' 'Ans', count(*) 'Count', 'The same Accounts in two tables' 'Desc' FROM (\n\tSELECT AcctNo FROM #tblDepositAcct D\n\tINTERSECT\n\tSELECT AcctNo FROM #tblLoanAcct L\n\t) R\nUNION ALL\nSELECT 'B', count(*),'Distict customers' FROM (\n\tSELECT CustNo FROM #tblDepositAcct D\n\tUNION\n\tSELECT CustNo FROM #tblLoanAcct L\n\t) R\nUNION ALL\nSELECT 'C', count(*),'Count of all Acc' FROM (\n\tSELECT CustNo FROM #tblDepositAcct D\n\tUNION ALL\n\tSELECT CustNo FROM #tblLoanAcct L\n\t) R\nUNION ALL\nSELECT 'D', COUNT (DISTINCT D.CustNo),'#82: Total number of customers who have both deposit and loan accounts'\nFROM #tblDepositAcct D, #tblLoanAcct L\nWHERE D.CustNo = L.CustNo\nUNION ALL\nSELECT 'E', COUNT (DISTINCT L.CustNo),'#81: Total number of customers who have only loan accounts'\nFROM #tblDepositAcct D\nRIGHT JOIN #tblLoanAcct L ON D.CustNo=L.CustNo\nWHERE D.CustNo IS NULL"
      },
      {
        "date": "2020-11-24T13:05:00.000Z",
        "voteCount": 1,
        "content": "DROP TABLE IF EXISTS #tblDepositAcct\n\nCREATE TABLE #tblDepositAcct (\nCustNo int,\nAcctNo int PRIMARY KEY,\nProdCode varchar(3)\n);\n\nDROP TABLE IF EXISTS #tblLoanAcct\nCREATE TABLE #tblLoanAcct (\nCustNo int,\nAcctNo int PRIMARY KEY,\nProdCode varchar(3)\n);\nINSERT INTO #tblDepositAcct VALUES \n(1,100,'a')\n,(1,200, 'b')\n,(2, 300, 'c')\n,(3, 400, 'd')\n,(3, 500, 'd')\n,(3, 600, 'd');\nINSERT INTO #tblLoanAcct VALUES \n(1,500,'g')\n,(2,600, 'h')\n,(4,700, 'c')\n,(4,800, 'i')\n,(5,900, 'j')\n,(6,1000, 'j');"
      },
      {
        "date": "2020-07-05T08:04:00.000Z",
        "voteCount": 1,
        "content": "Correct ans is D"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 81,
    "url": "https://www.examtopics.com/discussions/microsoft/view/17102-exam-70-761-topic-1-question-81-discussion/",
    "body": "Note: This question is part of a series of questions that use the same or similar answer choices. An answer choice may be correct for more than one question in the series. Each question is independent of the other questions in this series. Information and details provided in a question apply to that question.<br>You have a database for a banking system. The database has two tables named tblDepositAcct and tblLoanAcct that store deposit and loan accounts, respectively. Both tables contain the following columns:<br><img src=\"/assets/media/exam-media/02675/0020000001.png\" class=\"in-exam-image\"><br>You need to determine the total number of customers who have only loan accounts.<br>Which Transact-SQL statement should you run?<br><img src=\"/assets/media/exam-media/02675/0020000002.png\" class=\"in-exam-image\"><br>A.<br><img src=\"/assets/media/exam-media/02675/0020100001.png\" class=\"in-exam-image\"><br>B.<br><img src=\"/assets/media/exam-media/02675/0020100002.png\" class=\"in-exam-image\"><br>C.<br><img src=\"/assets/media/exam-media/02675/0020100003.png\" class=\"in-exam-image\"><br>D.<br><img src=\"/assets/media/exam-media/02675/0020100004.png\" class=\"in-exam-image\"><br>E.<br><img src=\"/assets/media/exam-media/02675/0020100005.png\" class=\"in-exam-image\"><br>F.<br><img src=\"/assets/media/exam-media/02675/0020200001.png\" class=\"in-exam-image\"><br>G.<br><img src=\"/assets/media/exam-media/02675/0020200002.png\" class=\"in-exam-image\"><br>H.<br>",
    "options": [],
    "answer": "E",
    "answerDescription": "The RIGHT JOIN keyword returns all records from the right table (table2), and the matched records from the left table (table1). The result is NULL from the left side, when there is no match.<br>References:<br>https://www.w3schools.com/sql/sql_join_right.asp",
    "votes": [],
    "comments": [
      {
        "date": "2020-11-24T13:08:00.000Z",
        "voteCount": 1,
        "content": "UNION ALL\nSELECT 'F', count(*),'Total number of customers who have only deposit accounts' FROM (\n\tSELECT CustNo FROM #tblDepositAcct D\n\tEXCEPT\n\tSELECT CustNo FROM #tblLoanAcct L\n\t) R\nUNION ALL\nSELECT 'G', count(DISTINCT COALESCE(d.CustNo, l.CustNo)),'#80: Total number of customers who have either deposit accounts or loan accounts, but not both types of accounts'\nFROM #tblDepositAcct D\n\tFULL JOIN  #tblLoanAcct L ON d.CustNo=l.CustNo\nWHERE d.CustNo IS NULL OR l.CustNo IS NULL\nUNION ALL\nSELECT 'H', count(*),''\nFROM #tblDepositAcct D\n\tFULL JOIN  #tblLoanAcct L ON d.CustNo=l.CustNo"
      },
      {
        "date": "2020-11-24T13:08:00.000Z",
        "voteCount": 2,
        "content": "SELECT 'A' 'Ans', count(*) 'Count', 'The same Accounts in two tables' 'Desc' FROM (\n\tSELECT AcctNo FROM #tblDepositAcct D\n\tINTERSECT\n\tSELECT AcctNo FROM #tblLoanAcct L\n\t) R\nUNION ALL\nSELECT 'B', count(*),'Distict customers' FROM (\n\tSELECT CustNo FROM #tblDepositAcct D\n\tUNION\n\tSELECT CustNo FROM #tblLoanAcct L\n\t) R\nUNION ALL\nSELECT 'C', count(*),'Count of all Acc' FROM (\n\tSELECT CustNo FROM #tblDepositAcct D\n\tUNION ALL\n\tSELECT CustNo FROM #tblLoanAcct L\n\t) R\nUNION ALL\nSELECT 'D', COUNT (DISTINCT D.CustNo),'#82: Total number of customers who have both deposit and loan accounts'\nFROM #tblDepositAcct D, #tblLoanAcct L\nWHERE D.CustNo = L.CustNo\nUNION ALL\nSELECT 'E', COUNT (DISTINCT L.CustNo),'#81: Total number of customers who have only loan accounts'\nFROM #tblDepositAcct D\nRIGHT JOIN #tblLoanAcct L ON D.CustNo=L.CustNo\nWHERE D.CustNo IS NULL"
      },
      {
        "date": "2020-11-24T13:05:00.000Z",
        "voteCount": 1,
        "content": "DROP TABLE IF EXISTS #tblDepositAcct\n\nCREATE TABLE #tblDepositAcct (\nCustNo int,\nAcctNo int PRIMARY KEY,\nProdCode varchar(3)\n);\n\nDROP TABLE IF EXISTS #tblLoanAcct\nCREATE TABLE #tblLoanAcct (\nCustNo int,\nAcctNo int PRIMARY KEY,\nProdCode varchar(3)\n);\nINSERT INTO #tblDepositAcct VALUES \n(1,100,'a')\n,(1,200, 'b')\n,(2, 300, 'c')\n,(3, 400, 'd')\n,(3, 500, 'd')\n,(3, 600, 'd');\nINSERT INTO #tblLoanAcct VALUES \n(1,500,'g')\n,(2,600, 'h')\n,(4,700, 'c')\n,(4,800, 'i')\n,(5,900, 'j')\n,(6,1000, 'j');"
      },
      {
        "date": "2020-11-24T12:25:00.000Z",
        "voteCount": 4,
        "content": "Answer E is corret"
      },
      {
        "date": "2020-03-21T06:32:00.000Z",
        "voteCount": 2,
        "content": "For me the option H is valid too, becasuse EXCEPT is to retrieve data that doesn't match with the others tables."
      },
      {
        "date": "2020-04-14T10:29:00.000Z",
        "voteCount": 9,
        "content": "is not valid as we only need loan accounts, and that one gives you only deposit accounts"
      },
      {
        "date": "2020-04-14T10:31:00.000Z",
        "voteCount": 2,
        "content": "nevermind that's F"
      },
      {
        "date": "2020-09-17T14:02:00.000Z",
        "voteCount": 2,
        "content": "EXCEPT clause/operator is used to combine two SELECT statements and returns rows from the first SELECT statement that are not returned by the second SELECT statement. so you will have only deposit accounts - you need only those with loan."
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 82,
    "url": "https://www.examtopics.com/discussions/microsoft/view/4648-exam-70-761-topic-1-question-82-discussion/",
    "body": "Note: This question is part of a series of questions that use the same or similar answer choices. An answer choice may be correct for more than one question in the series. Each question is independent of the other questions in this series. Information and details provided in a question apply to that question.<br>You have a database for a banking system. The database has two tables named tblDepositAcct and tblLoanAcct that store deposit and loan accounts, respectively. Both tables contain the following columns:<br><img src=\"/assets/media/exam-media/02675/0020300001.png\" class=\"in-exam-image\"><br>You need to run a query to find the total number of customers who have both deposit and loan accounts.<br>Which Transact-SQL statement should you run?<br><img src=\"/assets/media/exam-media/02675/0020300002.png\" class=\"in-exam-image\"><br>A.<br><img src=\"/assets/media/exam-media/02675/0020300003.png\" class=\"in-exam-image\"><br>B.<br><img src=\"/assets/media/exam-media/02675/0020400001.png\" class=\"in-exam-image\"><br>C.<br><img src=\"/assets/media/exam-media/02675/0020400002.png\" class=\"in-exam-image\"><br>D.<br><img src=\"/assets/media/exam-media/02675/0020400003.png\" class=\"in-exam-image\"><br>E.<br><img src=\"/assets/media/exam-media/02675/0020400004.png\" class=\"in-exam-image\"><br>F.<br><img src=\"/assets/media/exam-media/02675/0020400005.png\" class=\"in-exam-image\"><br>G.<br><img src=\"/assets/media/exam-media/02675/0020400006.png\" class=\"in-exam-image\"><br>H.<br>",
    "options": [],
    "answer": "A",
    "answerDescription": "The SQL INTERSECT operator is used to return the results of 2 or more SELECT statements. However, it only returns the rows selected by all queries or data sets. If a record exists in one query and not in the other, it will be omitted from the INTERSECT results.<br>References:<br>https://www.techonthenet.com/sql/intersect.php",
    "votes": [],
    "comments": [
      {
        "date": "2020-12-17T01:00:00.000Z",
        "voteCount": 1,
        "content": "It is not INTERSECT because the \"INTERSECT operator is used to return the records that are in common between two SELECT statements or data sets. If a record exists in one query and not in the other, it will be omitted from the INTERSECT results. It is the intersection of the two SELECT statements.\" So, if a customer has a deposit account, but not a loan account (null), the record will be omitted from the result set. \nThe question asks for \"all (\"?) customers who have both deposit and loan accounts\". It is how we interpret this phrase that will decide the correct answer ?"
      },
      {
        "date": "2020-12-17T00:54:00.000Z",
        "voteCount": 1,
        "content": "UNION ALL. Please read question and description. \"all customers\" who have both loan and deposit accounts."
      },
      {
        "date": "2020-12-15T08:01:00.000Z",
        "voteCount": 1,
        "content": "A is ok , custNo and AccNo( PK ) its the same... read description of column..."
      },
      {
        "date": "2020-12-23T07:14:00.000Z",
        "voteCount": 1,
        "content": "No a PK identifies unique rows, not unique customers..."
      },
      {
        "date": "2020-11-24T13:09:00.000Z",
        "voteCount": 1,
        "content": "UNION ALL\nSELECT 'F', count(*),'Total number of customers who have only deposit accounts' FROM (\n\tSELECT CustNo FROM #tblDepositAcct D\n\tEXCEPT\n\tSELECT CustNo FROM #tblLoanAcct L\n\t) R\nUNION ALL\nSELECT 'G', count(DISTINCT COALESCE(d.CustNo, l.CustNo)),'#80: Total number of customers who have either deposit accounts or loan accounts, but not both types of accounts'\nFROM #tblDepositAcct D\n\tFULL JOIN  #tblLoanAcct L ON d.CustNo=l.CustNo\nWHERE d.CustNo IS NULL OR l.CustNo IS NULL\nUNION ALL\nSELECT 'H', count(*),''\nFROM #tblDepositAcct D\n\tFULL JOIN  #tblLoanAcct L ON d.CustNo=l.CustNo"
      },
      {
        "date": "2020-11-24T13:08:00.000Z",
        "voteCount": 1,
        "content": "SELECT 'A' 'Ans', count(*) 'Count', 'The same Accounts in two tables' 'Desc' FROM (\n\tSELECT AcctNo FROM #tblDepositAcct D\n\tINTERSECT\n\tSELECT AcctNo FROM #tblLoanAcct L\n\t) R\nUNION ALL\nSELECT 'B', count(*),'Distict customers' FROM (\n\tSELECT CustNo FROM #tblDepositAcct D\n\tUNION\n\tSELECT CustNo FROM #tblLoanAcct L\n\t) R\nUNION ALL\nSELECT 'C', count(*),'Count of all Acc' FROM (\n\tSELECT CustNo FROM #tblDepositAcct D\n\tUNION ALL\n\tSELECT CustNo FROM #tblLoanAcct L\n\t) R\nUNION ALL\nSELECT 'D', COUNT (DISTINCT D.CustNo),'#82: Total number of customers who have both deposit and loan accounts'\nFROM #tblDepositAcct D, #tblLoanAcct L\nWHERE D.CustNo = L.CustNo\nUNION ALL\nSELECT 'E', COUNT (DISTINCT L.CustNo),'#81: Total number of customers who have only loan accounts'\nFROM #tblDepositAcct D\nRIGHT JOIN #tblLoanAcct L ON D.CustNo=L.CustNo\nWHERE D.CustNo IS NULL"
      },
      {
        "date": "2020-11-24T13:05:00.000Z",
        "voteCount": 1,
        "content": "DROP TABLE IF EXISTS #tblDepositAcct\n\nCREATE TABLE #tblDepositAcct (\nCustNo int,\nAcctNo int PRIMARY KEY,\nProdCode varchar(3)\n);\n\nDROP TABLE IF EXISTS #tblLoanAcct\nCREATE TABLE #tblLoanAcct (\nCustNo int,\nAcctNo int PRIMARY KEY,\nProdCode varchar(3)\n);\nINSERT INTO #tblDepositAcct VALUES \n(1,100,'a')\n,(1,200, 'b')\n,(2, 300, 'c')\n,(3, 400, 'd')\n,(3, 500, 'd')\n,(3, 600, 'd');\nINSERT INTO #tblLoanAcct VALUES \n(1,500,'g')\n,(2,600, 'h')\n,(4,700, 'c')\n,(4,800, 'i')\n,(5,900, 'j')\n,(6,1000, 'j');"
      },
      {
        "date": "2020-11-19T14:23:00.000Z",
        "voteCount": 2,
        "content": "DROP TABLE IF EXISTS #tblDepositAcct\nCREATE TABLE #tblDepositAcct (\n\t\t\t\t\t\t\t\tCustNo int,\n\t\t\t\t\t\t\t\tAcctNo int PRIMARY KEY,\n\t\t\t\t\t\t\t\tProdCode varchar(3)\n\t\t\t\t\t\t\t\t);\nDROP TABLE IF EXISTS #tblLoanAcct\nCREATE TABLE #tblLoanAcct (\n\t\t\t\t\t\t\t\tCustNo int,\n\t\t\t\t\t\t\t\tAcctNo int PRIMARY KEY,\n\t\t\t\t\t\t\t\tProdCode varchar(3)\n\t\t\t\t\t\t\t\t);\nINSERT INTO #tblDepositAcct VALUES (1,100,'abc')\n\t\t\t\t\t\t\t\t\t,(2,200, 'def')\n\t\t\t\t\t\t\t\t\t,(3, 300, 'ghi')\n\t\t\t\t\t\t\t\t\t,(1, 400, 'jkl');\nINSERT INTO #tblLoanAcct VALUES (1,500,'mno')\n\t\t\t\t\t\t\t\t,(2,600, 'pqr');\nSELECT * FROM #tblDepositAcct;\nSELECT * FROM #tblLoanAcct;\n--D\nSELECT COUNT (DISTINCT D.CustNo)\nFROM #tblDepositAcct D, #tblLoanAcct L\nWHERE D.CustNo = L.CustNo;\n--RETURNS 2 (Correct is D)"
      },
      {
        "date": "2020-11-10T17:14:00.000Z",
        "voteCount": 1,
        "content": "Sorry, only D is correct."
      },
      {
        "date": "2020-11-10T17:11:00.000Z",
        "voteCount": 1,
        "content": "Both D &amp; G are correct"
      },
      {
        "date": "2020-08-21T05:45:00.000Z",
        "voteCount": 2,
        "content": "Tested. D is correct. the syntax in A is correct except the join. its supposed to be CustNo no AcctNo."
      },
      {
        "date": "2020-08-21T05:46:00.000Z",
        "voteCount": 1,
        "content": "*not AcctNo"
      },
      {
        "date": "2020-06-25T10:28:00.000Z",
        "voteCount": 3,
        "content": "A is incorrect, both tables use different values of AcctNo for the same customer, so INTERSECT will be empty \n\nD is correct"
      },
      {
        "date": "2020-05-28T02:15:00.000Z",
        "voteCount": 1,
        "content": "Both A and D seems to be right. \nA - counts the Account Number once in one table and D counts the customer number"
      },
      {
        "date": "2020-05-28T02:17:00.000Z",
        "voteCount": 7,
        "content": "But D is the right one :)\nTESTED"
      },
      {
        "date": "2020-06-27T06:34:00.000Z",
        "voteCount": 3,
        "content": "Correct, for the same reason mlourinho gave above: since \"A customer may have multiple accounts for the same product type\" and the question is about the number of Customers, then A is wrong."
      },
      {
        "date": "2019-09-03T11:55:00.000Z",
        "voteCount": 4,
        "content": "A is wrong - question concern customers, not accounts.\nD seems ok"
      },
      {
        "date": "2019-09-12T11:34:00.000Z",
        "voteCount": 8,
        "content": "nope, A is fine."
      },
      {
        "date": "2019-09-15T06:57:00.000Z",
        "voteCount": 2,
        "content": "Indeed A is fine. My mistake. Thank you."
      },
      {
        "date": "2019-09-29T06:08:00.000Z",
        "voteCount": 20,
        "content": "wrong because A used AcctNo, not CustNo\nD is correct"
      },
      {
        "date": "2020-02-17T11:44:00.000Z",
        "voteCount": 1,
        "content": "The FROM syntax in D is not correct, so all answers are wrong"
      },
      {
        "date": "2020-12-16T12:17:00.000Z",
        "voteCount": 1,
        "content": "It's not wrong syntax. An implicit join is being used."
      },
      {
        "date": "2020-10-26T03:57:00.000Z",
        "voteCount": 1,
        "content": "A and D both are wrong, the question is we need to count distinct customers from both the account. A and D will count only from deposit account. Here we need to use union and the correct Answer should be option B which will give distinct count from both tables."
      },
      {
        "date": "2019-11-12T08:45:00.000Z",
        "voteCount": 4,
        "content": "Since \"A customer may have multiple accounts for the same product type\" and the question is about the number of Customers, then A is wrong."
      },
      {
        "date": "2020-12-17T06:28:00.000Z",
        "voteCount": 1,
        "content": "INTERSECT IS DISTINCT"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 83,
    "url": "https://www.examtopics.com/discussions/microsoft/view/3799-exam-70-761-topic-1-question-83-discussion/",
    "body": "Note: This question is part of a series of questions that present the same scenario. Each question in the series contains a unique solution that might meet the stated goals. Some question sets might have more than one correct solution, while others might not have a correct solution.<br>After you answer a question in this section. You will NOT be able to return to it. As a result, these questions will not appear in the review screen.<br>You have a table named Products that stores information about products your company sells. The table has a column named ListPrice that stores retail pricing information for products.<br>Some products are used only internally by the company. Records for these products are maintained in the Products table for inventory purposes. The price for each of these products is $0.00. Customers are not permitted to order these products.<br>You need to increase the list price for products that cost less than $100 by 10 percent. You must only increase pricing for products that customers are permitted to order.<br>Solution: You run the following Transact-SQL statement:<br><img src=\"/assets/media/exam-media/02675/0020500001.png\" class=\"in-exam-image\"><br>Does the solution meet the goal?<br>",
    "options": [
      "<span class=\"multi-choice-letter\" data-choice-letter=\"A\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tYes",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"B\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tB.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tNo"
    ],
    "answer": "B",
    "answerDescription": "Products with a price of $0.00 would also be increased.",
    "votes": [],
    "comments": [
      {
        "date": "2019-08-19T07:09:00.000Z",
        "voteCount": 14,
        "content": "In addition, the calculation is not correct... +1.1 is not an increase by 10%"
      },
      {
        "date": "2020-04-11T08:38:00.000Z",
        "voteCount": 2,
        "content": "Dieter you are right, that will make 101.1 because is addition, to increase it with 10% should be  * 1.1"
      },
      {
        "date": "2021-01-14T13:21:00.000Z",
        "voteCount": 1,
        "content": "If there's a * instead of a +, the answer is A. 0 stays 0 when you multiply it by whichever amount. No need to exclude these products, since their prices are listed 0."
      },
      {
        "date": "2020-06-23T13:18:00.000Z",
        "voteCount": 3,
        "content": "List price = list price + (10%*list price)"
      },
      {
        "date": "2020-03-21T07:20:00.000Z",
        "voteCount": 1,
        "content": "the calculation is not correct, ti shoulb be ListPrice =ListPrice *1.1. Inaddition to this, it's missing some field that specify the state of the product, something like that and StateProduct = 1"
      },
      {
        "date": "2020-03-21T07:23:00.000Z",
        "voteCount": 1,
        "content": "in this case it would be 'AND ListPrice &lt;&gt;0.00"
      },
      {
        "date": "2020-10-05T04:45:00.000Z",
        "voteCount": 1,
        "content": "I think if you use &lt;&gt;0.00 then You will update also prices above 100"
      },
      {
        "date": "2020-01-14T02:17:00.000Z",
        "voteCount": 4,
        "content": "0 * 1.1 = 0, so it doesn't impact the 0 values. Looks correct to me (if there is * instead of +)"
      },
      {
        "date": "2019-11-17T04:56:00.000Z",
        "voteCount": 1,
        "content": "It is absolutely fine! (100%+10%=110%)=1.1"
      },
      {
        "date": "2019-12-09T08:26:00.000Z",
        "voteCount": 8,
        "content": "It must be * 1.1 then, not +"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 84,
    "url": "https://www.examtopics.com/discussions/microsoft/view/13510-exam-70-761-topic-1-question-84-discussion/",
    "body": "Note: This question is part of a series of questions that present the same scenario. Each question in the series contains a unique solution that might meet the stated goals. Some question sets might have more than one correct solution, while others might not have a correct solution.<br>After you answer a question in this section. You will NOT be able to return to it. As a result, these questions will not appear in the review screen.<br>You have a table named Products that stores information about products your company sells. The table has a column named ListPrice that stores retail pricing information for products.<br>Some products are used only internally by the company. Records for these products are maintained in the Products table for inventory purposes. The price for each of these products is $0.00. Customers are not permitted to order these products.<br>You need to increase the list price for products that cost less than $100 by 10 percent. You must only increase pricing for products that customers are permitted to order.<br>Solution: You run the following Transact-SQL statement:<br><img src=\"/assets/media/exam-media/02675/0020600001.png\" class=\"in-exam-image\"><br>Does the solution meet the goal?<br>",
    "options": [
      "<span class=\"multi-choice-letter\" data-choice-letter=\"A\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tYes",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"B\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tB.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tNo"
    ],
    "answer": "B",
    "answerDescription": "Products with a price of $0.00 would also be increased.",
    "votes": [],
    "comments": [
      {
        "date": "2020-04-16T22:55:00.000Z",
        "voteCount": 3,
        "content": "we should \"increase the list price for products that cost less than $100, while \"between and\" will include 100 as well, that's why the answer is incorrect even if it is * instead of +"
      },
      {
        "date": "2020-03-21T07:30:00.000Z",
        "voteCount": 2,
        "content": "no, because between include the products that are not allowed to order (0) it should be somthing like this: 'BETWEEN 1 TO 100'  and 'SET LISTPRICE = LISTPRICE *1.1'"
      },
      {
        "date": "2020-02-06T07:31:00.000Z",
        "voteCount": 1,
        "content": "0 * 1.1 = 0, so it doesn't impact the 0 values. Looks correct to me (if there is * instead of +)"
      },
      {
        "date": "2020-02-12T10:32:00.000Z",
        "voteCount": 3,
        "content": "The reason is not +1.1 or *1.1, main reason is for those goods whose price = 0, they are not permitted to order. The question asks us to increase price for goods which can be ordered"
      },
      {
        "date": "2021-01-14T13:24:00.000Z",
        "voteCount": 1,
        "content": "that is incorrect, as they are in the table anyway. you simply just don't touch them when you multiply by whichever amount."
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 85,
    "url": "https://www.examtopics.com/discussions/microsoft/view/3800-exam-70-761-topic-1-question-85-discussion/",
    "body": "Note: This question is part of a series of questions that present the same scenario. Each question in the series contains a unique solution that might meet the stated goals. Some question sets might have more than one correct solution, while others might not have a correct solution.<br>After you answer a question in this section. You will NOT be able to return to it. As a result, these questions will not appear in the review screen.<br>You have a table named Products that stores information about products your company sells. The table has a column named ListPrice that stores retail pricing information for products.<br>Some products are used only internally by the company. Records for these products are maintained in the Products table for inventory purposes. The price for each of these products is $0.00. Customers are not permitted to order these products.<br>You need to increase the list price for products that cost less than $100 by 10 percent. You must only increase pricing for products that customers are permitted to order.<br>Solution: You run the following Transact-SQL statement:<br><img src=\"/assets/media/exam-media/02675/0020700001.png\" class=\"in-exam-image\"><br>Does the solution meet the goal?<br>",
    "options": [
      "<span class=\"multi-choice-letter\" data-choice-letter=\"A\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tYes",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"B\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tB.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tNo"
    ],
    "answer": "B",
    "answerDescription": "Products with a price between $0.00 and $100 will be increased, while products with a price of $0.00 would not be increased.",
    "votes": [],
    "comments": [
      {
        "date": "2020-03-21T07:32:00.000Z",
        "voteCount": 7,
        "content": "I think the between is ok but the 'SET ListPrice=ListPrice +1' is wrong because it just add a 1.1  for all products"
      },
      {
        "date": "2019-08-19T07:11:00.000Z",
        "voteCount": 6,
        "content": "The calculation is not the required (+ 10%)"
      },
      {
        "date": "2021-01-14T13:38:00.000Z",
        "voteCount": 2,
        "content": "hang on. this is B because this calculation excludes prices of for instance 0.05 which is a valid customer price."
      },
      {
        "date": "2021-01-14T13:36:00.000Z",
        "voteCount": 1,
        "content": "something is wrong with the question and the answer. \nI think the core thing that they want you to do is to exclude the 0 priced articles anyway"
      },
      {
        "date": "2020-11-19T15:20:00.000Z",
        "voteCount": 2,
        "content": "The between will work, but the mathematical operation is incorrect. B is the correct answer.\n;DECLARE @numbers AS TABLE (number float)\nINSERT INTO  @numbers VALUES\n\t\t\t\t\t\t(0), (0.5), (1), (2), (3), (50), (85), (90), (99.99), (100)\nSELECT number\nFROM @numbers\nWHERE number BETWEEN 0.1 AND 99.99"
      },
      {
        "date": "2020-09-18T07:57:00.000Z",
        "voteCount": 3,
        "content": "If the + sign is just a typo then answer is A(Yes)."
      },
      {
        "date": "2020-06-29T03:30:00.000Z",
        "voteCount": 2,
        "content": "Answer B. No. ListPrice = Listprice + 1.1, Incorrect. ListPrice = ListPrice + 0.1, (0.1 = 10%) to keep + operator, ListPrice = Listprice * 1.1, keep 1.1 but change operator"
      },
      {
        "date": "2020-02-26T18:20:00.000Z",
        "voteCount": 6,
        "content": "The Listprice should be multiplied by 1.1 and should not be added I think."
      },
      {
        "date": "2019-11-06T20:57:00.000Z",
        "voteCount": 5,
        "content": "I think its meet the goal by not updating amount as $0"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 86,
    "url": "https://www.examtopics.com/discussions/microsoft/view/11957-exam-70-761-topic-1-question-86-discussion/",
    "body": "Note: This question is part of a series of questions that present the same scenario. Each question in the series contains a unique solution that might meet the stated goals. Some question sets might have more than one correct solution, while others might not have a correct solution.<br>After you answer a question in this section. You will NOT be able to return to it. As a result, these questions will not appear in the review screen.<br>You have a table that was created by running the following Transact-SQL statement:<br><img src=\"/assets/media/exam-media/02675/0020800001.png\" class=\"in-exam-image\"><br>The Products table includes the data shown in the following table:<br><img src=\"/assets/media/exam-media/02675/0020800002.png\" class=\"in-exam-image\"><br>TotalUnitPrice is calculated by using the following formula:<br>TotalUnitPrice = UnitPrice * (UnitsInStock + UnitsOnOrder)<br>You need to ensure that the value returned for TotalUnitPrice for ProductB is equal to 600.00.<br>Solution: You run the following Transact-SQL statement:<br><img src=\"/assets/media/exam-media/02675/0020800003.png\" class=\"in-exam-image\"><br>Does the solution meet the goal?<br>",
    "options": [
      "<span class=\"multi-choice-letter\" data-choice-letter=\"A\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tYes",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"B\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tB.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tNo"
    ],
    "answer": "A",
    "answerDescription": "ISNULL ( check_expression , replacement_value )<br>Arguments:<br>check_expression<br>Is the expression to be checked for NULL. check_expression can be of any type. replacement_value<br>Is the expression to be returned if check_expression is NULL. replacement_value must be of a type that is implicitly convertible to the type of check_expresssion.<br>References:<br>https://docs.microsoft.com/en-us/sql/t-sql/functions/isnull-transact-sql",
    "votes": [],
    "comments": [
      {
        "date": "2020-10-12T08:13:00.000Z",
        "voteCount": 2,
        "content": "The NULL value in the UnitsOnOrder field would cause a runtime error.\nCorrect Answer Is B"
      },
      {
        "date": "2020-11-19T15:42:00.000Z",
        "voteCount": 1,
        "content": "I gave a thumb up when I meant to reply. Answer is correct A. ISNULL function is going to replace that NULL for a 0. ( some number + 0 = some number), so no error."
      },
      {
        "date": "2020-07-28T15:36:00.000Z",
        "voteCount": 1,
        "content": "You need to ensure that the value returned for TotalUnitPrice for ProductB is equal to 600.00   \n\nPRODUCTB IS EQUAL TO 600.00\n\nAnswer is A"
      },
      {
        "date": "2020-07-07T05:00:00.000Z",
        "voteCount": 3,
        "content": "that is no aggregation; it's just math"
      },
      {
        "date": "2020-03-10T01:46:00.000Z",
        "voteCount": 3,
        "content": "Why is there no group by clause when there's an aggregation?"
      },
      {
        "date": "2020-01-14T02:28:00.000Z",
        "voteCount": 2,
        "content": "But here is no any comparison with 600. It calculates the totals but doesn't check if it is equal to 600."
      },
      {
        "date": "2020-01-15T07:53:00.000Z",
        "voteCount": 7,
        "content": "It's fine they just used the second line in the table as reference"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 87,
    "url": "https://www.examtopics.com/discussions/microsoft/view/17127-exam-70-761-topic-1-question-87-discussion/",
    "body": "Note: This question is part of a series of questions that present the same scenario. Each question in the series contains a unique solution that might meet the stated goals. Some question sets might have more than one correct solution, while others might not have a correct solution.<br>After you answer a question in this section. You will NOT be able to return to it. As a result, these questions will not appear in the review screen.<br>You have a table that was created by running the following Transact-SQL statement:<br><img src=\"/assets/media/exam-media/02675/0020900001.png\" class=\"in-exam-image\"><br>The Products table includes the data shown in the following table:<br><img src=\"/assets/media/exam-media/02675/0021000001.png\" class=\"in-exam-image\"><br>TotalUnitPrice is calculated by using the following formula:<br>TotalUnitPrice = UnitPrice * (UnitsInStock + UnitsOnOrder)<br>You need to ensure that the value returned for TotalUnitPrice for ProductB is equal to 600.00.<br>Solution: You run the following Transact-SQL statement:<br><img src=\"/assets/media/exam-media/02675/0021000002.png\" class=\"in-exam-image\"><br>Does the solution meet the goal?<br>",
    "options": [
      "<span class=\"multi-choice-letter\" data-choice-letter=\"A\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tYes",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"B\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tB.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tNo"
    ],
    "answer": "A",
    "answerDescription": "COALESCE evaluates the arguments in order and returns the current value of the first expression that initially does not evaluate to NULL.<br>References:<br>https://docs.microsoft.com/en-us/sql/t-sql/language-elements/coalesce-transact-sql",
    "votes": [],
    "comments": [
      {
        "date": "2020-03-21T12:35:00.000Z",
        "voteCount": 4,
        "content": "yes, as well ISNULL as COALESCE function meet the same functionalities, but colaesce acepts, more than 2 parameteres and evaluate the first value then the second ,if the first one is NULL and so on."
      },
      {
        "date": "2020-08-26T09:22:00.000Z",
        "voteCount": 1,
        "content": "Yes, but in the exam I'd be sure to choose B because the column \"UnitsOnOnrder\" is not spelled correctly. Which leaves me very uncertain as to whether I should be ignoring such mistakes or giving them the benefit of the doubt"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 88,
    "url": "https://www.examtopics.com/discussions/microsoft/view/17128-exam-70-761-topic-1-question-88-discussion/",
    "body": "Note: This question is part of a series of questions that present the same scenario. Each question in the series contains a unique solution that might meet the stated goals. Some question sets might have more than one correct solution, while others might not have a correct solution.<br>After you answer a question in this section. You will NOT be able to return to it. As a result, these questions will not appear in the review screen.<br>You have a table that was created by running the following Transact-SQL statement:<br><img src=\"/assets/media/exam-media/02675/0021100001.png\" class=\"in-exam-image\"><br>The Products table includes the data shown in the following table:<br><img src=\"/assets/media/exam-media/02675/0021100002.png\" class=\"in-exam-image\"><br>TotalUnitPrice is calculated by using the following formula:<br>TotalUnitPrice = UnitPrice * (UnitsInStock + UnitsOnOrder)<br>You need to ensure that the value returned for TotalUnitPrice for ProductB is equal to 600.00.<br>Solution: You run the following Transact-SQL statement:<br><img src=\"/assets/media/exam-media/02675/0021100003.png\" class=\"in-exam-image\"><br>Does the solution meet the goal?<br>",
    "options": [
      "<span class=\"multi-choice-letter\" data-choice-letter=\"A\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tYes",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"B\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tB.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tNo"
    ],
    "answer": "B",
    "answerDescription": "The NULL value in the UnitsOnOrder field would cause a runtime error.",
    "votes": [],
    "comments": [
      {
        "date": "2020-03-21T12:39:00.000Z",
        "voteCount": 7,
        "content": "No, becasue NULL values cannot for for addition, subtraction, multiplication or any other type of formula, the output would give always NULL"
      },
      {
        "date": "2020-06-26T23:05:00.000Z",
        "voteCount": 4,
        "content": "That is true. It won't cause an error as it is mentioned, but you would get NULL as a result."
      },
      {
        "date": "2020-11-19T15:57:00.000Z",
        "voteCount": 1,
        "content": "SELECT 30 * (20 + NULL) AS TotalUnitPrice;\n--Result: NULL"
      },
      {
        "date": "2020-06-29T03:55:00.000Z",
        "voteCount": 2,
        "content": "B. No. TotalUnitPrice = UnitPrice * (UnitsInStock + NULL). TotalUnitPrice = UnitPrice * (NULL). TotalUnitPrice = NULL"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 89,
    "url": "https://www.examtopics.com/discussions/microsoft/view/3997-exam-70-761-topic-1-question-89-discussion/",
    "body": "You have a database that stores information about server and application errors. The database contains the following table:<br><br>Servers -<br><img src=\"/assets/media/exam-media/02675/0021200001.png\" class=\"in-exam-image\"><br><br>Errors -<br><img src=\"/assets/media/exam-media/02675/0021200002.png\" class=\"in-exam-image\"><br>You need to return all unique error log messages and the server where the error occurs most often.<br>Which Transact-SQL statement should you run?<br><img src=\"/assets/media/exam-media/02675/0021300001.png\" class=\"in-exam-image\"><br>A.<br><img src=\"/assets/media/exam-media/02675/0021300002.png\" class=\"in-exam-image\"><br>B.<br><img src=\"/assets/media/exam-media/02675/0021300003.png\" class=\"in-exam-image\"><br>C.<br><img src=\"/assets/media/exam-media/02675/0021300004.png\" class=\"in-exam-image\"><br>D.<br>",
    "options": [],
    "answer": "A",
    "answerDescription": "",
    "votes": [],
    "comments": [
      {
        "date": "2019-09-12T12:53:00.000Z",
        "voteCount": 12,
        "content": "B correct, again sample code\n\nDROP TABLE #ERRORS\nCREATE TABLE #ERRORS (\nERRORID INT PRIMARY KEY,\nSERVERID INT,\nOCCURENCES INT,\nLOGMESSAGE NVARCHAR(MAX)\n)\n\nINSERT INTO #ERRORS (ERRORID, SERVERID, OCCURENCES, LOGMESSAGE)\nVALUES \n(1, 1,3,'ERROR1'),\n(2,1,2,'ERROR2'),\n(3,1,10,'ERROR2'),\n(4,2,4,'ERROR2'),\n(5,2,14,'ERROR2'),\n(6,2,24,'ERROR1'),\n(7,3,10,'ERROR3'),\n(8,3,24,'ERROR3')\n\nSELECT DISTINCT SERVERID, LOGMESSAGE FROM #ERRORS AS E1\nWHERE OCCURENCES &gt; ALL (\nSELECT E2.OCCURENCES FROM #ERRORS AS E2\nWHERE E2.LOGMESSAGE = E1.LOGMESSAGE AND E2.SERVERID &lt;&gt; E1.SERVERID)\n\nSELECT\nDISTINCT SERVERID, LOGMESSAGE FROM #ERRORS AS E1 WHERE LOGMESSAGE IN (\nSELECT TOP 1 E2.LOGMESSAGE FROM #ERRORS AS E2 WHERE E1.LOGMESSAGE = E2.LOGMESSAGE AND E1.SERVERID &lt;&gt; E2.SERVERID\nORDER BY OCCURENCES \n)"
      },
      {
        "date": "2019-09-11T06:03:00.000Z",
        "voteCount": 8,
        "content": "I think \u0412 is correct. In A statement \"ORDER BY\" without DESC, hence TOP (1) returns min value of occurences."
      },
      {
        "date": "2021-01-01T13:44:00.000Z",
        "voteCount": 1,
        "content": "B is closest"
      },
      {
        "date": "2020-12-13T04:48:00.000Z",
        "voteCount": 1,
        "content": "In A ORDER BY sorts Occurrencies in ascending order so we'll have a log message with the MIN number of  occurrencies. In my opinion the closest one is B"
      },
      {
        "date": "2020-11-10T17:56:00.000Z",
        "voteCount": 1,
        "content": "The answer does not satisfy the requirement if there is more than one server with the same error message and the same number of occurrences."
      },
      {
        "date": "2020-03-11T11:03:00.000Z",
        "voteCount": 1,
        "content": "There is A"
      },
      {
        "date": "2020-02-12T11:01:00.000Z",
        "voteCount": 2,
        "content": "for answer B, just one thing I want to know, why dont't use '&gt;=' all(...), when using '&gt;', how could 100&gt;100?"
      },
      {
        "date": "2020-11-10T17:53:00.000Z",
        "voteCount": 1,
        "content": "because they want 'distinct' error messages. If you add the equal operand to the comparison and you have more than one server with the same highest number of occurrences, then the result would have the same error message listed for all these servers with highest occurrences..won't be distinct."
      },
      {
        "date": "2019-08-24T01:49:00.000Z",
        "voteCount": 6,
        "content": "A repeated question the closest answer should be B."
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 90,
    "url": "https://www.examtopics.com/discussions/microsoft/view/27142-exam-70-761-topic-1-question-90-discussion/",
    "body": "You have a database that includes the following tables.<br><br>HumanResources.Employee -<br><img src=\"/assets/media/exam-media/02675/0021300005.png\" class=\"in-exam-image\"><br><br>Sales.SalesPerson -<br><img src=\"/assets/media/exam-media/02675/0021400001.png\" class=\"in-exam-image\"><br>The HumanResources.Employee table has 2,500 rows, and the Sales.SalesPerson table has 2,000 rows.<br>You review the following Transact-SQL statement:<br><img src=\"/assets/media/exam-media/02675/0021400002.png\" class=\"in-exam-image\"><br>You need to determine the performance impact of the query.<br>How many times will a lookup occur on the primary key index on the Sales.SalesPerson table?<br>",
    "options": [
      "<span class=\"multi-choice-letter\" data-choice-letter=\"A\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t200",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"B\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tB.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t2,000",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"C\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tC.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t2,500",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"D\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tD.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t5,500"
    ],
    "answer": "C",
    "answerDescription": "",
    "votes": [],
    "comments": [
      {
        "date": "2020-08-02T04:25:00.000Z",
        "voteCount": 5,
        "content": "Correct"
      },
      {
        "date": "2020-09-25T16:46:00.000Z",
        "voteCount": 1,
        "content": "why is the correct answer 2500?"
      },
      {
        "date": "2020-11-10T19:10:00.000Z",
        "voteCount": 1,
        "content": "because it is a correlated query that the constant is compared to, the server will have to do the comparison for each record."
      },
      {
        "date": "2020-09-18T08:02:00.000Z",
        "voteCount": 1,
        "content": "Answer is correct but the inner query is wrong. In the inner query it should be sp.BusinessentityID=e.BusyinessentityID."
      },
      {
        "date": "2020-11-19T18:20:00.000Z",
        "voteCount": 1,
        "content": "The order of the factors do not affect the product. It's the same as:\nWHERE e.BusinessentityID=sp.BusyinessentityID"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 91,
    "url": "https://www.examtopics.com/discussions/microsoft/view/3956-exam-70-761-topic-1-question-91-discussion/",
    "body": "HOTSPOT -<br>You have a table named HumanResources.Department that was created with the query shown in the exhibit. (Click the Exhibit button.)<br><img src=\"/assets/media/exam-media/02675/0021500001.jpg\" class=\"in-exam-image\"><br>You need to query temporal data in the table.<br>In the table below, identify the Transact-SQL segments that must be used to retrieve the appropriate data.<br>NOTE: Make only one selection in each column.<br>Hot Area:<br><img src=\"/assets/media/exam-media/02675/0021600001.png\" class=\"in-exam-image\"><br>",
    "options": [],
    "answer": "<img src=\"/assets/media/exam-media/02675/0021600002.png\" class=\"in-exam-image\">",
    "answerDescription": "AS OF: Returns a table with a rows containing the values that were actual (current) at the specified point in time in the past.<br>CONTAINED IN: If you search for non-current row versions only, we recommend you to use CONTAINED IN as it works only with the history table and will yield the best query performance.<br>Incorrect Answers:<br>Not ALL: Returns the union of rows that belong to the current and the history table.<br>References:<br>https://docs.microsoft.com/en-us/sql/relational-databases/tables/querying-data-in-a-system-versioned-temporal-table",
    "votes": [],
    "comments": [
      {
        "date": "2019-09-03T12:12:00.000Z",
        "voteCount": 9,
        "content": "The answer is correct. Should be AS OF &amp; CONTAINED IN.\nCONTAINED IN:\nReturns a table with the values for all row versions that were opened and closed within the specified time range defined by the two datetime values for the CONTAINED IN argument. Rows that became active exactly on the lower boundary or ceased being active exactly on the upper boundary are included.\nSource: https://docs.microsoft.com/en-us/sql/relational-databases/tables/temporal-tables?view=sql-server-2017"
      },
      {
        "date": "2020-12-10T16:55:00.000Z",
        "voteCount": 1,
        "content": "You can still construct a query that will return the current \"live\" \nFOR SYSTEM_TIME BETWEEN '1900-01-01' AND '9999-12-31 23:59:59.99'"
      },
      {
        "date": "2021-01-02T11:24:00.000Z",
        "voteCount": 1,
        "content": "AS OF and CONTAINED IN  - Contained IN  only pulls from the history table"
      },
      {
        "date": "2019-10-17T13:21:00.000Z",
        "voteCount": 1,
        "content": "FROM / BETWEEN / CONTAINED retreive data from history and current table"
      },
      {
        "date": "2019-10-17T10:27:00.000Z",
        "voteCount": 1,
        "content": "FOR SYSTEM_TIME CONTAINED IN clause internally retrieving the data from both the Temporal Table and History Table...SEE THE EXECUTION PLAN"
      },
      {
        "date": "2020-11-19T18:50:00.000Z",
        "voteCount": 1,
        "content": "Unless you add a CHECK constrain to the table that verifies that the ValidTo column value is indeed the maximum possible value in the type. CHECK (validTO = '99991231 23:59:59.999'). Text from Book Exam Ref 70-761 Querying Data with Transact-SQL\nBook by Itzik Ben-Gan"
      },
      {
        "date": "2019-08-22T20:15:00.000Z",
        "voteCount": 1,
        "content": "If only historical rows are required, the recommendation is querying the history table directly, i.e. use FROM for the situation of the second column."
      },
      {
        "date": "2020-06-22T17:21:00.000Z",
        "voteCount": 1,
        "content": "The original answer is correct: if a row's SysStartTime in the current table is &lt; the @endtime in a query using FOR SYSTEM_TIME FROM @starttime TO @endtime, then it will still be retrieved."
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 92,
    "url": "https://www.examtopics.com/discussions/microsoft/view/21044-exam-70-761-topic-1-question-92-discussion/",
    "body": "You are building a stored procedure that will update data in a table named Table1 by using a complex query as the data source.<br>You need to ensure that the SELECT statement in the stored procedure meets the following requirements:<br>\u2711 Data being processed must be usable in several statements in the stored procedure.<br>\u2711 Data being processed must contain statistics.<br>What should you do?<br>",
    "options": [
      "<span class=\"multi-choice-letter\" data-choice-letter=\"A\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tUpdate Table1 by using a common table expression (CTE).",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"B\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tB.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tInsert the data into a temporary table, and then update Table1 from the temporary table.",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"C\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tC.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tPlace the SELECT statement in a derived table, and then update Table1 by using a JOIN to the derived table.",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"D\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tD.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tInsert the data into a table variable, and then update Table1 from the table variable."
    ],
    "answer": "B",
    "answerDescription": "Temp Tables...<br>Are real materialized tables that exist in tempdb<br>Have dedicated stats generated by the engine<br><br>Can be indexed -<br><br>Can have constraints -<br>Persist for the life of the current CONNECTION<br>Can be referenced by other queries or subproce<br>Incorrect Answers:<br>A: CTEs do not have dedicated stats. They rely on stats on the underlying objects<br>C: Unlike a derived table, a CTE can be self-referencing and can be referenced multiple times in the same query.<br>References:<br>https://technet.microsoft.com/en-us/library/ms190766(v=sql.105).aspx https://dba.stackexchange.com/questions/13112/whats-the-difference-between-a-cte-and-a-temp-table",
    "votes": [],
    "comments": [
      {
        "date": "2020-05-20T16:13:00.000Z",
        "voteCount": 1,
        "content": "Why can't you use table variable?"
      },
      {
        "date": "2020-05-20T17:09:00.000Z",
        "voteCount": 8,
        "content": "nvm, temporary table is more better with statistics"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 93,
    "url": "https://www.examtopics.com/discussions/microsoft/view/5003-exam-70-761-topic-1-question-93-discussion/",
    "body": "You have a database that includes the tables shown in the exhibit. (Click the exhibit button.)<br><img src=\"/assets/media/exam-media/02675/0021900001.jpg\" class=\"in-exam-image\"><br>You need to create a list of all customers and the date that the customer placed their last order. For customers who have not placed orders, you must substitute a zero for the order ID and 01/01/1990 for the date.<br>Which Transact-SQL statement should you run?<br><img src=\"/assets/media/exam-media/02675/0022000001.png\" class=\"in-exam-image\"><br>A.<br><img src=\"/assets/media/exam-media/02675/0022000002.png\" class=\"in-exam-image\"><br>B.<br><img src=\"/assets/media/exam-media/02675/0022000003.png\" class=\"in-exam-image\"><br>C.<br><img src=\"/assets/media/exam-media/02675/0022000004.png\" class=\"in-exam-image\"><br>D.<br>",
    "options": [],
    "answer": "A",
    "answerDescription": "COALESCE evaluates the arguments in order and returns the current value of the first expression that initially does not evaluate to NULL.<br>References:<br>https://docs.microsoft.com/en-us/sql/t-sql/language-elements/coalesce-transact-sql",
    "votes": [],
    "comments": [
      {
        "date": "2019-09-10T07:14:00.000Z",
        "voteCount": 19,
        "content": "None of the answers contain the reference to 'you must substitute a zero for the order ID'"
      },
      {
        "date": "2019-10-22T18:32:00.000Z",
        "voteCount": 1,
        "content": "ITS ORDER DATE NOT ORDER ID A IS CORRECT"
      },
      {
        "date": "2020-06-27T07:11:00.000Z",
        "voteCount": 5,
        "content": "Calm down and re-read the question. M4x's comment makes sense."
      },
      {
        "date": "2020-12-15T09:19:00.000Z",
        "voteCount": 1,
        "content": "imran CALM DOWN BRO CALM DOWN !!!!"
      },
      {
        "date": "2020-03-21T15:22:00.000Z",
        "voteCount": 9,
        "content": "the closest answer is A, although it is missing the statement  'you must substitute a zero for the order ID'"
      },
      {
        "date": "2020-12-14T11:27:00.000Z",
        "voteCount": 1,
        "content": "Probably , A is correct but the query wrongly recreated. ON the other site  for the same question they use ISNULL for orderID, orderdate in the SELECT"
      },
      {
        "date": "2020-11-19T11:11:00.000Z",
        "voteCount": 1,
        "content": "In my opinion, A is the closest as it is the closest to the requirement 'replace orderID and orderDate if no order placed'."
      },
      {
        "date": "2020-09-11T15:25:00.000Z",
        "voteCount": 1,
        "content": "Actually D is the closest. There is no OrderId used in Any other places."
      },
      {
        "date": "2020-02-25T04:39:00.000Z",
        "voteCount": 2,
        "content": "also there are 1900 in date, no a 1990"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 94,
    "url": "https://www.examtopics.com/discussions/microsoft/view/22530-exam-70-761-topic-1-question-94-discussion/",
    "body": "You have a disk-based table that contains 15 columns.<br>You query the table for the number of new rows created during the current day.<br>You need to create an index for the query. The solution must generate the smallest possible index.<br>Which type of index should you create?<br>",
    "options": [
      "<span class=\"multi-choice-letter\" data-choice-letter=\"A\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tclustered",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"B\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tB.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tfiltered nonclustered with a getdate() predicate in the WHERE statement clause",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"C\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tC.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\thash",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"D\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tD.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tnonclustered with compression enabled"
    ],
    "answer": "B",
    "answerDescription": "A filtered index is an optimized nonclustered index especially suited to cover queries that select from a well-defined subset of data. It uses a filter predicate to index a portion of rows in the table. A well-designed filtered index can improve query performance as well as reduce index maintenance and storage costs compared with full-table indexes.<br>Creating a filtered index can reduce disk storage for nonclustered indexes when a full-table index is not necessary.<br>References:<br>https://docs.microsoft.com/en-us/sql/relational-databases/indexes/create-filtered-indexes",
    "votes": [],
    "comments": [
      {
        "date": "2021-01-22T09:45:00.000Z",
        "voteCount": 1,
        "content": "B, the answer is correct."
      },
      {
        "date": "2021-01-01T14:14:00.000Z",
        "voteCount": 1,
        "content": "D; Nonclustered with compression enabled due to non-deterministic function not being able to be used in the index filter predicate"
      },
      {
        "date": "2020-12-14T11:33:00.000Z",
        "voteCount": 1,
        "content": "GETDATE() won't work it gives current datetime we need  a period of time (&gt;= &lt; OR BETWEEN AND)"
      },
      {
        "date": "2020-11-10T20:15:00.000Z",
        "voteCount": 2,
        "content": "You can't use nondeterministic functions in the filter:\nhttps://www.brentozar.com/archive/2013/11/what-you-can-and-cant-do-with-filtered-indexes/"
      },
      {
        "date": "2020-11-10T20:26:00.000Z",
        "voteCount": 2,
        "content": "https://www.red-gate.com/simple-talk/sql/performance/introduction-to-sql-server-filtered-indexes/\nFrom it: \nUsing date functions also results in an error:\n\n--add nonclustered filtered index to ModifiedDate column\nCREATE NONCLUSTERED INDEX fIX_SalesOrderDetail_ModifiedDate\nON AdventureWorks2012.Sales.SalesOrderDetail(ModifiedDate)\nWHERE ModifiedDate  = GETDATE() \nGO\n1794-5ace4e70-04df-4cfa-8036-4584c6e7294\n\nComputed, spatial, and UDT columns are also not allowed as comparison criteria. The IN clause is allowed."
      },
      {
        "date": "2020-11-20T14:54:00.000Z",
        "voteCount": 1,
        "content": "\"You query the table for the number of new rows created during the *current day*\". So guys, instead of using a date function to get today's date, we know what today's date is, so you need to put WHERE CreatedDate = '20201120' and it will work.\nCREATE NONCLUSTERED INDEX fIX_20110531\nON AdventureWorks2012.Sales.SalesOrderDetail(ModifiedDate)\nWHERE ModifiedDate = '2011-05-31 00:00:00.000'\nGO"
      },
      {
        "date": "2020-11-20T14:56:00.000Z",
        "voteCount": 1,
        "content": "Now I see the Answer B has specifically a \"using the getdate() function\"."
      },
      {
        "date": "2020-08-04T02:07:00.000Z",
        "voteCount": 1,
        "content": "b or d ?"
      },
      {
        "date": "2020-06-07T15:38:00.000Z",
        "voteCount": 1,
        "content": "I think it is D"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 95,
    "url": "https://www.examtopics.com/discussions/microsoft/view/3646-exam-70-761-topic-1-question-95-discussion/",
    "body": "Note: This question is part of a series of questions that use the same or similar answer choices. An answer choice may be correct for more than one question in the series. Each question is independent of the other questions in this series. Information and details provided in a question apply only to that question.<br>You have a database that contains several connected tables. The tables contain sales data for customers in the United States only.<br>You have the following partial query for the database. (Line numbers are included for reference only.)<br><img src=\"/assets/media/exam-media/02675/0022200001.png\" class=\"in-exam-image\"><br>You need to complete the query to generate the output shown in the following table.<br><img src=\"/assets/media/exam-media/02675/0022200002.png\" class=\"in-exam-image\"><br>Which statement clause should you add at line 3?<br>",
    "options": [
      "<span class=\"multi-choice-letter\" data-choice-letter=\"A\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tGROUP BY",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"B\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tB.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tMERGE",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"C\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tC.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tGROUP BY ROLLUP",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"D\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tD.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tLEFT JOIN",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"E\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tE.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tGROUP BY CUBE",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"F\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tF.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tCROSS JOIN",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"G\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tG.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tPIVOT",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"H\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tH.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tUNPIVOT"
    ],
    "answer": "E",
    "answerDescription": "Example of GROUP BY CUBE result set:<br>In the following example, the CUBE operator returns a result set that has one grouping for all possible combinations of columns in the CUBE list and a grand total grouping.<br><img src=\"/assets/media/exam-media/02675/0022300001.png\" class=\"in-exam-image\"><br>References:<br>https://technet.microsoft.com/en-us/library/bb522495(v=sql.105).aspx",
    "votes": [],
    "comments": [
      {
        "date": "2019-08-16T05:37:00.000Z",
        "voteCount": 45,
        "content": "Hi, My feeling is this should be a GROUP BY ROLL UP because if you notice we have the following columns.\n\nCOUNTRY, PROVINCE, CITY and in ROLL UP we will get the combinations in an hierarchy.\n\nFirst Combination : COUNTRY, PROVINCE, CITY\nSecond COmbination: COUNTRY, PROVINCE\nThird Combination: COUNTRY\nFINAL combination: ALL\n\nThis is what we see in the resultant table."
      },
      {
        "date": "2019-09-29T07:15:00.000Z",
        "voteCount": 6,
        "content": "Agreed"
      },
      {
        "date": "2019-11-17T05:50:00.000Z",
        "voteCount": 7,
        "content": "GROUP BY ROLL UP is the correct one!"
      },
      {
        "date": "2021-01-19T07:46:00.000Z",
        "voteCount": 1,
        "content": "It should be group by RollUp"
      },
      {
        "date": "2020-11-20T15:42:00.000Z",
        "voteCount": 1,
        "content": "The answer should be ROLLUP, the combination of 1 Province name and a city that does not belong to that Province simply do not make sense."
      },
      {
        "date": "2020-10-13T18:40:00.000Z",
        "voteCount": 2,
        "content": "result set looks like GROUP BY ROLLUP,  but the TotalSales in Select is missing SUM()"
      },
      {
        "date": "2020-09-18T08:17:00.000Z",
        "voteCount": 4,
        "content": "The answer should be Group by rollup however there has to be an aggregate function in the select clause."
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 96,
    "url": "https://www.examtopics.com/discussions/microsoft/view/3648-exam-70-761-topic-1-question-96-discussion/",
    "body": "Note: This question is part of a series of questions that use the same or similar answer choices. An answer choice may be correct for more than one question in the series. Each question is independent of the other questions in this series. Information and details provided in a question apply only to that question.<br>You have a database that contains several connected tables. The tables contain sales data for customers in the United States only.<br>You have the following partial query for the database. (Line numbers are included for reference only.)<br><img src=\"/assets/media/exam-media/02675/0022400001.png\" class=\"in-exam-image\"><br>You need to complete the query to generate the output shown in the following table.<br><img src=\"/assets/media/exam-media/02675/0022400002.png\" class=\"in-exam-image\"><br>Which statement clause should you add at line 3?<br>",
    "options": [
      "<span class=\"multi-choice-letter\" data-choice-letter=\"A\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tGROUP BY",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"B\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tB.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tMERGE",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"C\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tC.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tGROUP BY ROLLUP",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"D\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tD.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tLEFT JOIN",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"E\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tE.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tGROUP BY CUBE",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"F\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tF.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tCROSS JOIN",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"G\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tG.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tPIVOT",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"H\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tH.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tUNPIVOT"
    ],
    "answer": "C",
    "answerDescription": "In the result sets that are generated by the GROUP BY operators, NULL has the following uses:<br>\u2711 If a grouping column contains NULL, all null values are considered equal, and they are put into one NULL group.<br>\u2711 When a column is aggregated in a row, the value of the column is shown as NULL.<br>Example of GROUP BY ROLLUP result set:<br><img src=\"/assets/media/exam-media/02675/0022600001.png\" class=\"in-exam-image\"><br>References:<br>https://technet.microsoft.com/en-us/library/bb522495(v=sql.105).aspx",
    "votes": [],
    "comments": [
      {
        "date": "2019-08-16T05:53:00.000Z",
        "voteCount": 21,
        "content": "This should be a GROUP BY CUBE."
      },
      {
        "date": "2021-01-01T14:21:00.000Z",
        "voteCount": 1,
        "content": "GROUP BY CUBE to get NULL, NULL, NULL - assuming other combinations not shown"
      },
      {
        "date": "2020-12-23T19:31:00.000Z",
        "voteCount": 2,
        "content": "it's GROUP BY CUBE . TESTED . Sorry for typos and orphography\nCREATE TABLE Sales(\nCoutnryName varchar(50),\nStateProvinceName varchar(50),\nCityName varchar(50),\nQwt int,\nPrice decimal(16,4)\n)\n\n\nINSERT INTO Sales\nVALUES ('USA', 'Florida', 'Miami', 4,1.36),('USA', 'Washington', 'Seattle', 5, 2.67),('USA', 'Colorado', 'Denver', 4,20.6),\n('Canada', 'Ontario', 'Toronto', 6, 1.47),('Canada', 'Manitoba', 'Winnipeg', 20, 12.48),('Canada', 'Alberta', 'Edmonton', 20,38.4 ),\n('Germany', 'Bavaria','Munchen', 22, 30.48),('Germany', 'BadenWuttemberg', 'Stuttgart', 30,1.84),('Germany', 'Hessen', 'FrankfutMain', 202, 12.20)\n\nSELECT * FROM Sales\n\nSELECT CoutnryName, StateProvinceName, CityName, SUM(Qwt*Price) AS TotalSales\nFROM Sales\nGROUP BY CUBE  (CoutnryName, StateProvinceName, CityName)\nORDER BY  CoutnryName, StateProvinceName, CityName"
      },
      {
        "date": "2021-01-03T05:01:00.000Z",
        "voteCount": 1,
        "content": "yes. Agreed"
      },
      {
        "date": "2020-10-04T11:54:00.000Z",
        "voteCount": 1,
        "content": "I'd say it's GROUP BY CUBE. With an example given in docs under point E. :\n   https://docs.microsoft.com/en-us/previous-versions/sql/sql-server-2008-r2/bb522495(v=sql.105)?redirectedfrom=MSDN\nit lists all the hierarchy lowest level (or the last column in Order By) first, here it's City Name. I think the lack of aggregation on the value is yet another typo in question."
      },
      {
        "date": "2020-09-18T08:42:00.000Z",
        "voteCount": 1,
        "content": "Answer is surely not Rollup and cube because it has to have all the columns in group by in select clause, here grouping is just done on City Column. We cannot just rollup or cube with single column and have multiple columns in select clause, it will throw an error. Not sure if this even possible by the options available here. This is little complex."
      },
      {
        "date": "2020-08-20T08:05:00.000Z",
        "voteCount": 1,
        "content": "I think it is CUBE because in my opinion we could safely assume that the order of the grouping columns is equal to the input. \nBecause if it is not so there would be no chance for us to determine what group by statement was used. \n\nI tested some of them"
      },
      {
        "date": "2020-08-20T08:11:00.000Z",
        "voteCount": 2,
        "content": "Can't post the code - seems to be too much? (bad gateway error)\nBut if you build a simple table (Group1, Group2, Group3, Value)\nand insert values like \n(1,\t'A',\t'AA',\t'AAA',\t10)\n,(2,\t'A',\t'AA',\t'AAB',\t10)\n...\n,(10,\t'B',\t'BA',\t'BAA',\t12)\n...\nyou will see pretty quick that cube looks exactly like rollup if you write it like this \"group by rollup (group3, group2, group1)\nthe same thing happens with grouping sets as AK80 stated"
      },
      {
        "date": "2020-08-03T08:28:00.000Z",
        "voteCount": 3,
        "content": "I think the correct statement would be\n GROUP BY \n               GROUPING SETS ((), (Cityname))\nSo A would be the closest answer"
      },
      {
        "date": "2020-08-02T15:09:00.000Z",
        "voteCount": 1,
        "content": "IS GROUP BY, why result of column not is sum\n\nCube and rollup result null null null  is sum rows"
      },
      {
        "date": "2020-01-19T06:13:00.000Z",
        "voteCount": 3,
        "content": "i think it's rollup because there is a hierarchy formed by the imput elements"
      },
      {
        "date": "2020-06-11T10:55:00.000Z",
        "voteCount": 2,
        "content": "Agreed.. GROUP BY ROLLUP (Cityname)"
      },
      {
        "date": "2020-12-23T19:11:00.000Z",
        "voteCount": 1,
        "content": "This hierarchy could be caused by ORDER BY clause which being ASC brings all the NULLS to the top"
      },
      {
        "date": "2020-01-14T03:38:00.000Z",
        "voteCount": 2,
        "content": "Why CUBE? The CUBE gives all combinations, which is not the case in the example."
      },
      {
        "date": "2019-11-17T05:52:00.000Z",
        "voteCount": 4,
        "content": "Yeah... GROUP BY CUBE is perfect!"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 97,
    "url": "https://www.examtopics.com/discussions/microsoft/view/3998-exam-70-761-topic-1-question-97-discussion/",
    "body": "Note: This question is part of a series of questions that use the same or similar answer choices. An answer choice may be correct for more than one question in the series. Each question is independent of the other questions in this series. Information and details provided in a question apply only to that question.<br>You have a database that contains several connected tables. The tables contain sales data for customers in the United States only.<br>You have the following partial query for the database. (Line numbers are included for reference only.)<br><img src=\"/assets/media/exam-media/02675/0022700001.png\" class=\"in-exam-image\"><br>You need to complete the query to generate the output shown in the following table.<br><img src=\"/assets/media/exam-media/02675/0022700002.png\" class=\"in-exam-image\"><br>Which statement clause should you add at line 3?<br>",
    "options": [
      "<span class=\"multi-choice-letter\" data-choice-letter=\"A\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tGROUP BY",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"B\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tB.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tMERGE",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"C\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tC.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tGROUP BY ROLLUP",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"D\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tD.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tLEFT JOIN",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"E\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tE.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tGROUP BY CUBE",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"F\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tF.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tCROSS JOIN",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"G\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tG.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tPIVOT",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"H\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tH.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tUNPIVOT"
    ],
    "answer": "F",
    "answerDescription": "A cross join that does not have a WHERE clause produces the Cartesian product of the tables involved in the join. The size of a Cartesian product result set is the number of rows in the first table multiplied by the number of rows in the second table.<br>References:<br>https://technet.microsoft.com/en-us/library/ms190690(v=sql.105).aspx",
    "votes": [],
    "comments": [
      {
        "date": "2019-08-24T01:57:00.000Z",
        "voteCount": 22,
        "content": "It should go for GROUP BY ROLLUP."
      },
      {
        "date": "2019-12-20T11:00:00.000Z",
        "voteCount": 3,
        "content": "why? i think group by cube"
      },
      {
        "date": "2020-08-20T08:18:00.000Z",
        "voteCount": 1,
        "content": "last four rows of group by rollup (without order by the total line would be at the bottom)"
      },
      {
        "date": "2020-08-02T16:22:00.000Z",
        "voteCount": 1,
        "content": "BUT SUM\n7538.11\n1983745.99\n2387435981.22\n-------------\n2389427265,32"
      },
      {
        "date": "2020-08-02T15:20:00.000Z",
        "voteCount": 1,
        "content": "BUT THE SUM  OF NUL NULL NULL NOT IS CORRECT... THEN?"
      },
      {
        "date": "2020-07-09T10:08:00.000Z",
        "voteCount": 1,
        "content": "i say CUBE bc the output looks like \"subtotals for all combinations\" as in:\nCUBE is an extension of the GROUP BY clause. CUBE allows you to generate subtotals like the ROLLUP extension. In addition, the CUBE extension will generate subtotals for all combinations of grouping columns specified in the GROUP BY clause."
      },
      {
        "date": "2020-01-21T14:34:00.000Z",
        "voteCount": 2,
        "content": "C. GROUP BY ROLLUP is correct\nROLLUP  sums the Sales at three levels. First it would return the sum of Sales at Country-Province-City level. Then it would sum the sales at Country-Province level and finally on Country level. It would also provide a grand total level (4th row). Thats what is shown in the table. NULL is a placeholder in a row generated as an aggregate result.\nE. GROUP BY CUBE is incorrect: CUBE groups data in all possible combinations of columns so the sales would be summed up in following levels:\n1. Country-Province-City\n2. Province-City\n3. City\n4. Country-Province \n5. Province\n6. Country-City\n7. Country\n8. All\nF. Cross JOIN is completely incorrect as we retrieve data from one table only"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 98,
    "url": "https://www.examtopics.com/discussions/microsoft/view/39930-exam-70-761-topic-1-question-98-discussion/",
    "body": "You create a table by running the following Transact-SQL statement:<br><img src=\"/assets/media/exam-media/02675/0022800001.png\" class=\"in-exam-image\"><br>You need to view all customer data.<br>Which Transact-SQL statement should you run?<br><img src=\"/assets/media/exam-media/02675/0022800002.png\" class=\"in-exam-image\"><br>A.<br><img src=\"/assets/media/exam-media/02675/0022900001.png\" class=\"in-exam-image\"><br>B.<br><img src=\"/assets/media/exam-media/02675/0022900002.png\" class=\"in-exam-image\"><br>C.<br><img src=\"/assets/media/exam-media/02675/0022900003.png\" class=\"in-exam-image\"><br>D.<br><img src=\"/assets/media/exam-media/02675/0022900004.png\" class=\"in-exam-image\"><br>E.<br><img src=\"/assets/media/exam-media/02675/0022900005.png\" class=\"in-exam-image\"><br>F.<br><img src=\"/assets/media/exam-media/02675/0022900006.png\" class=\"in-exam-image\"><br>G.<br><img src=\"/assets/media/exam-media/02675/0022900007.png\" class=\"in-exam-image\"><br>H.<br>",
    "options": [],
    "answer": "B",
    "answerDescription": "The FOR SYSTEM_TIME ALL clause returns all the row versions from both the Temporal and History table.<br>References:<br>https://msdn.microsoft.com/en-us/library/dn935015.aspx",
    "votes": [],
    "comments": [
      {
        "date": "2021-01-06T17:15:00.000Z",
        "voteCount": 1,
        "content": "This is basically a duplicate question from Q54\n\"audit all\" vs \"view all\""
      },
      {
        "date": "2021-01-04T06:28:00.000Z",
        "voteCount": 1,
        "content": "that says FOR_SYSTE_TIME instead of FOR_SYSTEM_TIME"
      },
      {
        "date": "2020-12-15T09:57:00.000Z",
        "voteCount": 3,
        "content": "Correctimundo"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 99,
    "url": "https://www.examtopics.com/discussions/microsoft/view/4853-exam-70-761-topic-1-question-99-discussion/",
    "body": "SIMULATION -<br>You have a table named Cities that has the following two columns: CityID and CityName. The CityID column uses the int data type, and CityName uses nvarchar<br>(max).<br>You have a table named RawSurvey. Each row includes an identifier for a question and the number of persons that responded to that question from each of four cities. The table contains the following representative data:<br><img src=\"/assets/media/exam-media/02675/0023000001.png\" class=\"in-exam-image\"><br>A reporting table named SurveyReport has the following columns: CityID, QuestionID, and RawCount, where RawCount is the value from the RawSurvey table.<br>You need to write a Transact-SQL query to meet the following requirements:<br>\u2711 Retrieve data from the RawSurvey table in the format of the SurveyReport table.<br>\u2711 The CityID must contain the CityID of the city that was surveyed.<br>\u2711 The order of cities in all SELECT queries must match the order in the RawSurvey table.<br>\u2711 The order of cities in all IN statements must match the order in the RawSurvey table.<br>Construct the query using the following guidelines:<br>\u2711 Use one-part names to reference tables and columns, except where not possible.<br>ALL SELECT statements must specify columns.<br><img src=\"/assets/media/exam-media/02675/0023000007.png\" class=\"in-exam-image\"><br>\u2711 Do not use column or table aliases, except those provided.<br>Do not surround object names with square brackets.<br><img src=\"/assets/media/exam-media/02675/0023100002.png\" class=\"in-exam-image\"><br><img src=\"/assets/media/exam-media/02675/0023200001.png\" class=\"in-exam-image\"><br>Part of the correct Transact-SQL has been provided in the answer area below. Enter the code in the answer area that resolves the problem and meets the stated goals or requirements. You can add code within the code that has been provided as well as below it.<br><img src=\"/assets/media/exam-media/02675/0023300001.png\" class=\"in-exam-image\"><br>Use the Check Syntax button to verify your work. Any syntax or spelling errors will be reported by line and character position.<br>",
    "options": [],
    "answer": "Please see explanation",
    "answerDescription": "1 SELECT Rawcount<br>2 from (select cityid,questioned,rawcount) AS t1<br>3 unpivot<br>4 (rawcount for questioned in (QuestionID)) AS t2<br>5 JOIN t2<br>6. ON t1.CityName = t2.cityName<br>UNPIVOT must be used to rotate columns of the Rawsurvey table into column values.<br>References:<br>https://technet.microsoft.com/en-us/library/ms177410(v=sql.105).aspx",
    "votes": [],
    "comments": [
      {
        "date": "2019-11-12T10:33:00.000Z",
        "voteCount": 13,
        "content": "SELECT Cities.CityID, T1.QuestionID, T2.RawCount\nFROM \n(\nSELECT QuestionID, Tokyo, Boston, London, [New York] from RawSurvey\n) t1\nunpivot(\nRawCount FOR CityName (Tokyo, Boston, London, [New York])\n) t2\nINNER JOIN Cities ON T2.CityName = Cities.CityName"
      },
      {
        "date": "2020-12-14T12:38:00.000Z",
        "voteCount": 2,
        "content": "two mistakes in this code :\n1. missed IN  before cities' list in UNPIVOT\n2 there should   '.t2.QuestionID ' in SELECT  instead 't1.QuestionId'. Verified in SSMS"
      },
      {
        "date": "2019-09-10T09:17:00.000Z",
        "voteCount": 5,
        "content": "declare @RawSurvey as table\n(\n\tQuestionID char(2) not null primary key clustered,\n\tTokyo int not null,\n\tBoston int not null,\n\tLondon int not null,\n\tNewYork int not null\n)\n\ninsert into @RawSurvey\nvalues\n('Q1', 1, 42, 48, 51),\n('Q2', 22, 39, 58, 42),\n('Q3', 29, 41, 61, 33),\n('Q4', 62, 70, 60, 50)\n\n\nselect QuestionId, City, Answer\nfrom (\n\tselect QuestionId, Tokyo, Boston, London, NewYork\n\tfrom @RawSurvey\n) as t1\nunpivot (\n\tAnswer for City in ([Tokyo], [Boston], [London], [NewYork])\n) as t2"
      },
      {
        "date": "2020-05-28T16:17:00.000Z",
        "voteCount": 1,
        "content": "yes, its right\ninstead of \"Answer\" must be \"Rawcount\""
      },
      {
        "date": "2020-08-21T21:47:00.000Z",
        "voteCount": 1,
        "content": "the syntax is corrext and agreed to the answer. but the instructions state that do not use bracket."
      },
      {
        "date": "2021-01-03T06:10:00.000Z",
        "voteCount": 1,
        "content": ";with cte as (\nselect a.City, a.QuestonID,a.RawCount\nfrom RawSurvey s\nunpivot (RawCount for City in (Tokyo,Boston,London,NewYork))a) \n\nselect a.CityID, b.QuestonID,b.RawCount\nfrom Cities a \njoin cte b \non a.CityName= b.City"
      },
      {
        "date": "2020-10-13T21:22:00.000Z",
        "voteCount": 4,
        "content": "create table #RawSurvey \n(\nQuestionID char(2) not null primary key clustered,\nTokyo int not null,\nBoston int not null,\nLondon int not null,\nNewYork int not null\n)\n\ninsert into #RawSurvey\nvalues\n('Q1', 1, 42, 48, 51),\n('Q2', 22, 39, 58, 42),\n('Q3', 29, 41, 61, 33),\n('Q4', 62, 70, 60, 50)\n\n\ncreate table #Cities\n(CityID int,\nCityName varchar(20))\n\ninsert Cities values (1, 'Tokyo'), (2, 'Boston'),(3, 'London'),(4, 'NewYork') \n\nselect  CityID, QuestionId, Rawcount\nfrom (\nselect QuestionId, Tokyo, Boston, London, [NewYork]\nfrom #RawSurvey\n) as t1\nunpivot (Rawcount for CityName in ([Tokyo], [Boston], [London], [NewYork])\n) as t2\njoin #Cities on t2.CityName = #Cities.CityName"
      },
      {
        "date": "2019-09-15T08:53:00.000Z",
        "voteCount": 2,
        "content": "SELECT CITYID, QUESTIONID, RAWCOUNT\n\n\nFROM CITIES AS T1\n\nJOIN (\n\nSELECT QUESTIONID, RAWCOUNT , CITYNAME\nFROM RAVSURVEY \nUNPIVOT (RAWCOUNT FOR CITYNAME IN ('TOKYO','BOSTON')) AS PVT\n\n) AS T2\n\nON T1.CITYNAME = T2.CITYNAME"
      },
      {
        "date": "2019-09-10T08:46:00.000Z",
        "voteCount": 2,
        "content": "The purple text is the question, and the black text is the answer"
      },
      {
        "date": "2019-09-07T05:30:00.000Z",
        "voteCount": 1,
        "content": "Something is wrong with this question. \nI see only one  solution:\nSELECT CityID, QuestionID, RawCount from RawSurvey\n       UNPIVOT (CityName FOR ('Tokio', 'Boston', 'London', 'New York')) AS t1\n       PIVOT (sum(RawCount) for questionid in (QestionID)) as t2 \n       INNER JOIN Cities on t1.CityName = Cities.CityName"
      },
      {
        "date": "2019-09-10T09:16:00.000Z",
        "voteCount": 2,
        "content": "You must enclose the cityname between [ and ]"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 100,
    "url": "https://www.examtopics.com/discussions/microsoft/view/4854-exam-70-761-topic-1-question-100-discussion/",
    "body": "SIMULATION -<br>You create a table named Sales.Categories by running the following Transact-SQL statement:<br><img src=\"/assets/media/exam-media/02675/0023400001.png\" class=\"in-exam-image\"><br>You add the following data to the table.<br><img src=\"/assets/media/exam-media/02675/0023400002.png\" class=\"in-exam-image\"><br>You need to create a query that uses a common table expression (CTE) to show the parent category of each category. The query must meet the following requirements:<br>\u2711 Return all columns from the Categories table in the order shown.<br>\u2711 Exclude all categories that do not have a parent category.<br>Construct the query using the following guidelines:<br>\u2711 Name the expression ParentCategories.<br>\u2711 Use PC as the alias for the expression.<br>\u2711 Use C as the alias for the Categories table.<br>Use the AS keyword for all table aliases.<br><img src=\"/assets/media/exam-media/02675/0023400008.png\" class=\"in-exam-image\"><br>\u2711 Use individual column names for each column that the query returns.<br>\u2711 Do not use a prefix for any column name.<br>\u2711 Do not use implicit joins.<br>Do not surround object names with square brackets.<br><img src=\"/assets/media/exam-media/02675/0023500004.png\" class=\"in-exam-image\"><br><img src=\"/assets/media/exam-media/02675/0023600001.png\" class=\"in-exam-image\"><br>Part of the correct Transact-SQL has been provided in the answer area below. Enter the code in the answer area that resolves the problem and meets the stated goals or requirements. You can add code within the code that has been provided as well as below it.<br><img src=\"/assets/media/exam-media/02675/0023700001.png\" class=\"in-exam-image\"><br>Use the Check Syntax button to verify your work. Any syntax or spelling errors will be reported by line and character position. You may check syntax as many times as needed.<br>",
    "options": [],
    "answer": "Please see explanation",
    "answerDescription": "1 WITH ParentCategories pc (CategoryID, Name, PatentCategoryID) AS (SELECT c.categoryID,c.name,c.parentcategoryid<br>2 FROM sales.categories c<br>3 WHERE parentcategoryid is not null<br>4 )<br>5 SELECT * FROM parentcategories<br>Note: On Line 1 replace c with WITH ParentCategories pc (CategoryID, Name, PatentCategoryID) AS<br>Note: The basic syntax structure for a CTE is:<br>WITH expression_name [ ( column_name [,...n] ) ]<br><br>AS -<br>( CTE_query_definition )<br>References:<br>https://technet.microsoft.com/en-us/library/ms190766(v=sql.105).aspx",
    "votes": [],
    "comments": [
      {
        "date": "2019-09-07T05:45:00.000Z",
        "voteCount": 16,
        "content": "with parentcategories AS\n  (Select c.categoryid, c.name, c.parentcategoryid\n   from sales.categories c\n   where parentcategory is not null\n  )\n  select * from parentcategories pc"
      },
      {
        "date": "2019-09-10T09:27:00.000Z",
        "voteCount": 4,
        "content": "For best pratice avoid use of *.\n\ndeclare @Categories as table\n(\n\tCategoryId smallint not null primary key,\n\tName nvarchar(50) not null,\n\tParentCategoryID int null\n)\n\ninsert into @Categories\nvalues\n(1, 'Electronics', null),\n(2, 'Cameras and photo', 1),\n(3, 'Computers and tables', 1),\n(4, 'Cell phones and accessories', 1),\n(5, 'TV and audio', 1),\n(6, 'Digital Cameras', 2),\n(9, 'Laptops', 3),\n(13, 'Household goods', null),\n(14, 'Bathroom items', 13),\n(15, 'Shower curtains', 14)\n\n;\n\nwith ParentCategories \n(CategoryId, Name, ParentCategoryId)\nas\n(\n\tSELECT c.categoryID,c.name,c.parentcategoryid\n\tFROM @Categories c\n\tWHERE parentcategoryid is not null\n)\n\nselect CategoryId, Name, ParentCategoryId\nfrom ParentCategories pc"
      },
      {
        "date": "2019-10-22T18:04:00.000Z",
        "voteCount": 4,
        "content": "WHERE IS THE NAME OF THE PARENT CATEGORY\nYOU SHOULD JOIN PC CTE  WITH TABLE TO GET THAT"
      },
      {
        "date": "2019-10-22T18:15:00.000Z",
        "voteCount": 3,
        "content": "THIS MIGHT BE CORRECT\nCREATE TABLE CATEGORIES\n(\nCategoryId smallint not null primary key,\nName nvarchar(50) not null,\nParentCategoryID int null\n)\n\ninsert into CATEGORIES\nvalues\n(1, 'Electronics', null),\n(2, 'Cameras and photo', 1),\n(3, 'Computers and tables', 1),\n(4, 'Cell phones and accessories', 1),\n(5, 'TV and audio', 1),\n(6, 'Digital Cameras', 2),\n(9, 'Laptops', 3),\n(13, 'Household goods', null),\n(14, 'Bathroom items', 13),\n(15, 'Shower curtains', 14)\n\n;\n\nwith ParentCategories\n(CategoryId, Name, ParentCategoryId)\nas\n(\nSELECT c.categoryID,c.name,c.parentcategoryid\nFROM CATEGORIES c\n--WHERE parentcategoryid\n)\n\nselect C.CategoryId, C.Name, C.ParentCategoryID,ParentCategories.Name\nfrom CATEGORIES C JOIN ParentCategories ON ParentCategories.CategoryId = C.ParentCategoryID"
      },
      {
        "date": "2019-09-13T01:22:00.000Z",
        "voteCount": 3,
        "content": "'use the AS keyword for all table aliases' - i think correctly 'AS c', 'AS pc'"
      },
      {
        "date": "2019-10-22T18:02:00.000Z",
        "voteCount": 1,
        "content": "WHERE IS THE NAME OF THE PARENT CATEGORY?"
      },
      {
        "date": "2021-01-01T14:47:00.000Z",
        "voteCount": 1,
        "content": "Lots of discussion. Agree with this:\nWith ParentCategories as\n( SELECT c.CategoryID, c.Name, c.parentcategoryid\nFROM sales.categories as c\nWHERE parentcategoryid is not null -- Exclude all categories not having a parent category\n)\nSELECT pc.CategoryID, pc.Name , --category info\npc.parentcategoryid , c.Name --parent info\nFROM ParentCategories as pc --for each category\nINNER JOIN Sales.Categories as c -- join to get parent\nON pc.Parentcategoryid = c.CategoryID"
      },
      {
        "date": "2020-11-08T07:35:00.000Z",
        "voteCount": 1,
        "content": "Question says \"Categories table in the order shown\" means Order By Clause needs to be add for ParentCategoryID"
      },
      {
        "date": "2020-12-15T19:10:00.000Z",
        "voteCount": 1,
        "content": "This is not correct. NO Order By clause required. \n\"all columns from the Categories table in the order shown\"  means the order of the columns returned in the query"
      },
      {
        "date": "2020-10-13T22:39:00.000Z",
        "voteCount": 1,
        "content": "create table #Categories \n(CategoryId smallint not null primary key,\nName nvarchar(50) not null,\nParentCategoryID int null)\n\ninsert into #Categories\nvalues\n(1, 'Electronics', null),\n(2, 'Cameras and photo', 1),\n(3, 'Computers and tables', 1),\n(4, 'Cell phones and accessories', 1),\n(5, 'TV and audio', 1),\n(6, 'Digital Cameras', 2),\n(9, 'Laptops', 3),\n(13, 'Household goods', null),\n(14, 'Bathroom items', 13),\n(15, 'Shower curtains', 14)\n\nwith ParentCategories as\n(Select CategoryID, Name \nfrom #Categories )\nselect C.CategoryID, C.Name, C.ParentCategoryID, PC.Name\nfrom #Categories as C join ParentCategories as PC on C.ParentCategoryID = PC.CategoryID"
      },
      {
        "date": "2020-12-15T19:07:00.000Z",
        "voteCount": 1,
        "content": "Or you can do this way:\nWith ParentCategories as\n(\tSELECT c.CategoryID, c.Name, c.parentcategoryid \nFROM sales.categories as c\nWHERE parentcategoryid is not null\t-- Exclude all categories not having a parent category\n) \nSELECT pc.CategoryID, pc.Name , \t--category info\npc.parentcategoryid , c.Name \t\t--parent info\nFROM ParentCategories as pc \t\t--for each category\nINNER JOIN Sales.Categories as c -- join to get parent \nON pc.Parentcategoryid = c.CategoryID"
      },
      {
        "date": "2020-08-06T05:51:00.000Z",
        "voteCount": 2,
        "content": "DONT WE NEED TO ADD THE NAME OF THE PARENT CATEGORY?\n\nDECLARE @CATEGORIES TABLE(CategoryId INT, Name nvarchar(50), ParentCategoryID int)\ninsert into @CATEGORIES\nvalues\n(1, 'Electronics', null),\n(2, 'Cameras and photo', 1),\n(3, 'Computers and tables', 1),\n(4, 'Cell phones and accessories', 1),\n(5, 'TV and audio', 1),\n(6, 'Digital Cameras', 2),\n(9, 'Laptops', 3),\n(13, 'Household goods', null),\n(14, 'Bathroom items', 13),\n(15, 'Shower curtains', 14);\n\nWITH ParentCategories (CategoryId, Name)\nAS(SELECT CategoryId, Name FROM @CATEGORIES)\n\nSELECT C.CategoryId, C.Name, PC.CategoryId, PC.Name\nFROM @CATEGORIES C\nJOIN ParentCategories PC ON PC.CategoryId = C.ParentCategoryID"
      },
      {
        "date": "2020-07-08T14:59:00.000Z",
        "voteCount": 3,
        "content": ";WITH ParentCategories \nAS (select CategoryId, Name, ParentCategoryID FROM @Categories where ParentCategoryID IS NULL\nUNION ALL\nSELECT C.CategoryId,c.Name,c.ParentCategoryID\nFROM @Categories AS C\nINNER JOIN ParentCategories as PC on c.ParentCategoryID=PC.CategoryID)\nselect * from ParentCategories where ParentCategoryID is not null"
      },
      {
        "date": "2020-05-29T03:29:00.000Z",
        "voteCount": 2,
        "content": "in thee type of questions there might be many correct answers. I am not sure how is calculated the right answer. I tested all the answers here and there are many of them correct. I agree to go with this:\n\nwith ParentCategories\nas \n(\nSELECT c.categoryID,c.name,c.parentcategoryid\nFROM categories c\nWHERE c.parentcategoryid is not null\n)\nselect * from parentcategories pc"
      },
      {
        "date": "2020-04-10T00:59:00.000Z",
        "voteCount": 1,
        "content": "After reviewing it, I think this is the best answer, agreed with moehijawe\n\nwith ParentCategories as (\nselect categoryid, name, parentcategoryid\nfrom Sales.Categories as c\nwhere parentcategoryid is null\nunion all\nselect c.categoryid, c.name, c.parentcategoryid\nfrom ParentCategories as pc\njoin Sales.Categories as c on pc.parentcategoryid = c.categoryid\n)\nselect categoryid, name, parentcategoryid\nfrom Sales.Categories\nwhere parentcategoryid is not null\n\n\nExample: http://www.besttechtools.com/articles/article/cte-recursive-query-for-data-hierarchy"
      },
      {
        "date": "2020-04-07T04:06:00.000Z",
        "voteCount": 1,
        "content": "with pc\n(CategoryID,Name,ParentCategory)\nas\n(\nselect top(10) c1.CategoryID,c1.Name, c2.Name as ParentCategory\nfrom categories c1\ninner join categories c2 on c1.ParentCategoryId=c2.CategoryID\nwhere c1.ParentCategoryId is not null\norder by c1.CategoryID\n)\nselect * from pc"
      },
      {
        "date": "2020-03-19T02:09:00.000Z",
        "voteCount": 1,
        "content": "Sorry, last comment is wrong, its implicit and no explicit, so join its permitted, but i think that it is not necessary... I think, its the correct answer:\n\nwith parentcategories AS\n(Select c.categoryid, c.name, c.parentcategoryid\nfrom sales.categories c\nwhere c.parentcategory is not null\n)\nselect pc.categoryid, pc.name,pc.parentcategoryid from parentcategories pc"
      },
      {
        "date": "2020-03-19T01:58:00.000Z",
        "voteCount": 1,
        "content": "So its more simple:\n\n\nwith parentcategories AS\n(Select c.categoryid, c.name, c.parentcategoryid\nfrom sales.categories c\nwhere parentcategory is not null\n)\nselect pc.categoryid, pc.name,pc.parentcategoryid from parentcategories pc"
      },
      {
        "date": "2020-03-19T01:55:00.000Z",
        "voteCount": 1,
        "content": "Its say:    \u2711 Do not use implicit joins."
      },
      {
        "date": "2020-01-03T07:03:00.000Z",
        "voteCount": 3,
        "content": "with ParentCategories as (\nselect categoryid, name, parentcategoryid\nfrom    Sales.Categories as c\nwhere  parentcategoryid is null\nunion all\nselect  c.categoryid, c.name, c.parentcategoryid\nfrom    ParentCategories as pc \n\t\tjoin Sales.Categories as c on (pc.parentcategoryid = c.categoryid)\n)\nselect categoryid, name, parentcategoryid\nfrom   Sales.Categories\nwhere  parentcategoryid is not null"
      },
      {
        "date": "2019-11-12T10:43:00.000Z",
        "voteCount": 2,
        "content": ";WITH ParentCategories AS (\nSELECT CategoryID AS ParentCategoryID, Name AS ParentCategoryName\nFROM Sales.Categories\nWHERE ParentCategoryID IS NULL\n)\nSELECT PC.ParentCategoryID, PC.ParentCategoryName, C.CategoryID, C.Name\nFROM SalesCategories C\n            INNER JOIN ParentCategories PC ON C.ParentCategoryID = PC.ParentCategoryID\nWHEER C.ParentCategoryID IS NOT NULL"
      },
      {
        "date": "2019-12-15T07:28:00.000Z",
        "voteCount": 1,
        "content": "You don't need to use 'IS NULL' and 'IS NOT NULL' statement because it removes the middle stage of groups' hierarchy. Laptops and dig. cameras also have parent category. This code works:\n\nwith ParentCategories as (\nselect * from Categories c\n)\nselect c.categoryid, c.name, c.parentcategoryid, pc.name AS ParentCategoryName\nfrom ParentCategories pc join Categories c\non pc.categoryid=c.parentcategoryid\n;"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 101,
    "url": "https://www.examtopics.com/discussions/microsoft/view/15997-exam-70-761-topic-1-question-101-discussion/",
    "body": "SIMULATION -<br>You have a database that includes the following tables. All of the tables are in the Production schema.<br><img src=\"/assets/media/exam-media/02675/0023800001.jpg\" class=\"in-exam-image\"><br>You need to create a query that returns a list of product names for all products in the Beverages category.<br>Construct the query using the following guidelines:<br>\u2711 Use the first letter of the table name as the table alias.<br>\u2711 Use two-part column names.<br>\u2711 Do not surround object names with square brackets.<br>\u2711 Do not use implicit joins.<br>\u2711 Do not use variables.<br>\u2711 Use single quotes to surround literal values.<br>Part of the correct Transact-SQL has been provided in the answer area below. Enter the code in the answer area that resolves the problem and meets the stated goals or requirements. You can add code within the code that has been provided as well as below it.<br><img src=\"/assets/media/exam-media/02675/0023800008.png\" class=\"in-exam-image\"><br>Use the Check Syntax button to verify your work. Any syntax or spelling errors will be reported by line and character position. You may check syntax as many times as needed.<br>",
    "options": [],
    "answer": "Please see explanation",
    "answerDescription": "1 SELECT p.productname<br>2 FROM Production.categories AS c<br>3 inner join production.products as p on c.categoryid=p.categoryid<br>4 WHERE c.categoryname = 'Beverages'<br>Note: On line 3 change * to =",
    "votes": [],
    "comments": [
      {
        "date": "2020-11-22T09:29:00.000Z",
        "voteCount": 1,
        "content": "DROP TABLE IF EXISTS #Categories\nCREATE TABLE #Categories\n(CategoryID tinyint Primary KEY, CategoryName varchar(50), Descripcion varchar(max));\n\nINSERT INTO #Categories VALUES (1, 'Dairy', 'abcdefg'), (2, 'Vegetables', 'Fresh veggies'), (3, 'Beverages', 'alcoholic included');\n\nDROP TABLE IF EXISTS #Products;\nCREATE TABLE #Products \n(ProductID tinyint PRIMARY KEY, \nProductName varchar(50), \nsupplierID Int,\nCategoryID TinyInt --CONSTRAINT ProdCatToCategory FOREIGN KEY REFERENCES #Categories(CategoryID)\n);\n\nINSERT INTO #Products VALUES (10, 'Milk', 100, 1)\n\t\t\t\t\t\t\t,(20, 'Celery', 200, 2)\n\t\t\t\t\t\t\t,(30, 'Water', 100, 3)\n\t\t\t\t\t\t\t,(40, 'Soda', 100, 3)\n\t\t\t\t\t\t\t,(50, 'Yogurt', 300,1);\n\nSELECT * FROM #Categories;\nSELECT * FROM #Products;\n\nSELECT ProductName \nFROM #Products\nWHERE CategoryID = (SELECT CategoryID FROM #Categories\n\t\t\t\t\tWHERE CategoryName = 'Beverages');"
      },
      {
        "date": "2020-11-08T08:15:00.000Z",
        "voteCount": 1,
        "content": "Wrong\n\u2711 Do not use implicit joins.\nInner join is an implicit joins"
      },
      {
        "date": "2020-11-25T09:07:00.000Z",
        "voteCount": 5,
        "content": "Explicit join:\nSELECT x.col1, y.col2 FROM x\nJOIN y ON x.id = y.x_id\n\nImplicit join:\nSELECT x.col1, y.col2 FROM x, y\nWHERE x.id = y.x_id"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 102,
    "url": "https://www.examtopics.com/discussions/microsoft/view/3755-exam-70-761-topic-1-question-102-discussion/",
    "body": "SIMULATION -<br>You work for an organization that monitors seismic activity around volcanos. You have a table named GroundSensors. The table stored data collected from seismic sensors. It includes the columns describes in the following table:<br><img src=\"/assets/media/exam-media/02675/0023900001.png\" class=\"in-exam-image\"><br>The database also contains a scalar value function named NearestMountain that accepts a parameter of type geography and returns the name of the mountain that is nearest to the sensor.<br>You need to create a query that shows the average of the normalized readings from the sensors for each mountain. The query must meet the following requirements:<br>\u2711 Return the average normalized readings named AverageReading.<br>\u2711 Return the nearest mountain name named Mountain.<br>\u2711 Do not return any other columns.<br>\u2711 Exclude sensors for which no normalized reading exists.<br>Construct the query using the following guidelines:<br>\u2711 Use one part names to reference tables, columns and functions.<br>\u2711 Do not use parentheses unless required.<br>Define column headings using the AS keyword.<br><img src=\"/assets/media/exam-media/02675/0023900008.png\" class=\"in-exam-image\"><br>Do not surround object names with square brackets.<br><img src=\"/assets/media/exam-media/02675/0024000001.png\" class=\"in-exam-image\"><br><img src=\"/assets/media/exam-media/02675/0024100001.png\" class=\"in-exam-image\"><br>Part of the correct Transact-SQL has been provided in the answer area below. Enter the code in the answer area that resolves the problem and meets the stated goals or requirements. You can add code within the code that has been provided as well as below it.<br><img src=\"/assets/media/exam-media/02675/0024200001.png\" class=\"in-exam-image\"><br>Use the Check Syntax button to verify your work. Any syntax or spelling errors will be reported by line and character position.<br>",
    "options": [],
    "answer": "Please see explanation",
    "answerDescription": "1 SELECT avg (normalizedreading) as AverageReading, location as Mountain<br>2 FROM GroundSensors<br>3 WHERE normalizedreading is not null<br>Note: On line 1 change to AverageReading and change to Mountain.",
    "votes": [],
    "comments": [
      {
        "date": "2020-05-20T19:54:00.000Z",
        "voteCount": 15,
        "content": "SELECT AVG(normalizedreading) as AverageReading, Nearestmountain(location) AS Mountain\nFROM GroundSensors\nWHERE normalizedreading is not NULL\nGROUP BY Nearestmountain(location)"
      },
      {
        "date": "2019-08-19T00:11:00.000Z",
        "voteCount": 14,
        "content": "Hi,\n\nI believe the correct answer should be.\n\nSELECT avg(normalizedreading) as AverageReading, Nearestmountain(location) as mountain\nFROM GroundSensors\nWHERE normalizedreading is not NULL\nGROUP BY location\n\nNote: Since \"AVG\" is an aggregation based on location, therefore we need GROUP BY based on location. Also we will not display location but the mountain in the location using the scalar function nearest mountain."
      },
      {
        "date": "2019-08-19T07:47:00.000Z",
        "voteCount": 8,
        "content": "Make sure that the GROUP BY clause contains also the \"Nearestmountain\" function"
      },
      {
        "date": "2019-08-22T21:27:00.000Z",
        "voteCount": 1,
        "content": "Or simply: GROUP BY Mountain as the alias specified."
      },
      {
        "date": "2019-10-22T18:22:00.000Z",
        "voteCount": 19,
        "content": "YOU CANT USE ALIAS IN GROUP BY CLAUSE"
      },
      {
        "date": "2020-02-13T06:20:00.000Z",
        "voteCount": 5,
        "content": "it doesn't matter, same location will get same result after function, so using group by location is fine too"
      },
      {
        "date": "2020-05-29T08:32:00.000Z",
        "voteCount": 6,
        "content": "group by location is not allowed. Type 'geography' is not comparable. TESTED"
      },
      {
        "date": "2020-04-13T02:59:00.000Z",
        "voteCount": 5,
        "content": "GROUP BY location doesn't work,  The type \"geography\" is not comparable. It cannot be used in the GROUP BY clause."
      },
      {
        "date": "2020-05-29T08:27:00.000Z",
        "voteCount": 1,
        "content": "Yes, its true, so it cannot be this solution"
      },
      {
        "date": "2021-01-01T15:24:00.000Z",
        "voteCount": 4,
        "content": "Answer is \nSELECT AVG(NormalizedReading) as averagereading, dbo.NearestMountain(Location) as Mountain\nFROM #GroundSensors\nWHERE NormalizedReading IS NOT NULL\nGROUP BY dbo.NearestMountain(Location)\n\nFull test\n--------\nCREATE FUNCTION dbo.NearestMountain(@geo GEOGRAPHY)\nRETURNS CHAR(20)\nAS\nBEGIN\nDECLARE @text CHAR(20) = 'MtTest'\nRETURN @text\nEND\nGO\n\nCREATE TABLE #GroundSensors(\nSensorID INT PRIMARY KEY,\nLocation GEOGRAPHY NOT NULL,\nTremor INT NOT NULL,\nNormalizedReading FLOAT NULL)\n\nINSERT INTO #GroundSensors\nVALUES(1,geography::STGeomFromText('LINESTRING(-122.360 47.656, -122.343 47.656 )', 4326),1,123.33),\n(2,geography::STGeomFromText('LINESTRING(-122.360 47.656, -122.343 47.656 )', 4326),1,343.2)\nGO\n\nSELECT AVG(NormalizedReading) as averagereading, dbo.NearestMountain(Location) as Mountain\nFROM #GroundSensors\nWHERE NormalizedReading IS NOT NULL\nGROUP BY dbo.NearestMountain(Location)\n\nDROP TABLE #GroundSensors\nDROP FUNCTION dbo.NearestMountain"
      },
      {
        "date": "2020-12-23T05:12:00.000Z",
        "voteCount": 1,
        "content": "SELECT AVG(NormalizedReading) AS AverageReading, NearestMountain(SensorID) AS Mountain\nFROM GroundSensors\nWHERE Tremor &lt;&gt;0 AND NormalizedReading IS NOT NULL\nGROUPBY NearestMountain(SensorID);\nGROUP by NearestMountain(SensorID)"
      },
      {
        "date": "2020-10-14T11:23:00.000Z",
        "voteCount": 1,
        "content": "Group by has to be using function, for the  case several Locations pointing to same Mountain :\nselect AVG( NormalizedReading) as AverageReading, dbo.NearestMountain(Location) as Mountain\nfrom GroundSensors\nwhere NormalizedReading is not null\ngroup by dbo.NearestMountain(Location)"
      },
      {
        "date": "2020-07-29T15:53:00.000Z",
        "voteCount": 1,
        "content": "SELECT AVG(NormalizedReading), NearestMountain(SensorID)\nFROM GroundSensors\nWHERE NormalizedReading IS NOT NULL\nGROUP BY NearestMountain(SensorID)"
      },
      {
        "date": "2020-08-28T13:31:00.000Z",
        "voteCount": 1,
        "content": "Nearest mountain only accepts parameter type geography, not int."
      },
      {
        "date": "2020-06-23T23:39:00.000Z",
        "voteCount": 2,
        "content": "SELECT avg(normalizedreading) as AverageReading, Nearestmountain(location) as Mountain\nFROM GroundSensors\nGroup by Nearestmountain\nHaving normalizedreading not NULL"
      },
      {
        "date": "2020-05-11T19:44:00.000Z",
        "voteCount": 3,
        "content": "SELECT AVG(NormalizedReading) AS AverageReading, Mountain\nFROM\n      (SELECT NnormalizedReading,  NearestMountain(location) as Mountain\n       FROM GroundSensors\n       WHERE NormalizedReading is not NULL) AS t\nGROUP BY Mountain;"
      },
      {
        "date": "2019-11-13T02:16:00.000Z",
        "voteCount": 1,
        "content": "SELECT dbo.NearestMountain(g.Location) as Mountain\n, avg(g.NormalizedReading) as AverageReading\nFROM GroundSensor g\nwhere g.NormalizedReading is not null\ngroup by g.Location"
      },
      {
        "date": "2019-09-11T02:09:00.000Z",
        "voteCount": 7,
        "content": "select NearestMountain(Location) AS Mountain, AVG(Tremor) AS AverageReading\nfrom GroundSensors\nwhere NormalizedReading is not null\ngroup by NearestMountain(Location)"
      },
      {
        "date": "2020-02-10T08:20:00.000Z",
        "voteCount": 4,
        "content": "Why AVG(Tremor) instead of avg(normalizedreading)?"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 103,
    "url": "https://www.examtopics.com/discussions/microsoft/view/21592-exam-70-761-topic-1-question-103-discussion/",
    "body": "SIMULATION -<br>You create a table named Sales.Orders by running the following Transact-SQL statement:<br><img src=\"/assets/media/exam-media/02675/0024200002.png\" class=\"in-exam-image\"><br>You need to write a query that removes orders from the table that have a Status of Canceled.<br>Construct the query using the following guidelines:<br>use one-part column names and two-part table names<br><img src=\"/assets/media/exam-media/02675/0024200003.png\" class=\"in-exam-image\"><br>\u2711 use single quotes around literal values<br>\u2711 do not use functions<br>\u2711 do not surround object names with square brackets<br>\u2711 do not use variables<br>do not use aliases for column names and table names<br><img src=\"/assets/media/exam-media/02675/0024300005.png\" class=\"in-exam-image\"><br><img src=\"/assets/media/exam-media/02675/0024400001.png\" class=\"in-exam-image\"><br>Part of the correct Transact-SQL has been provided in the answer area below. Enter the code in the answer area that resolves the problem and meets the stated goals or requirements. You can add code within the code that has been provided as well as below it.<br><img src=\"/assets/media/exam-media/02675/0024500001.png\" class=\"in-exam-image\"><br>Use the Check Syntax button to verify your work. Any syntax or spelling errors will be reported by line and character position.<br>",
    "options": [],
    "answer": "Please see explanation",
    "answerDescription": "1. DELETE from sales.orders where status='Canceled'<br>Note: On line 1 change calceled to Canceled<br>Example: Using the WHERE clause to delete a set of rows<br>The following example deletes all rows from the ProductCostHistory table in the AdventureWorks2012 database in which the value in the StandardCost column is more than 1000.00.<br>DELETE FROM Production.ProductCostHistory<br>WHERE StandardCost &gt; 1000.00;<br>References:<br>https://docs.microsoft.com/en-us/sql/t-sql/statements/delete-transact-sql",
    "votes": [],
    "comments": [
      {
        "date": "2020-11-11T11:56:00.000Z",
        "voteCount": 1,
        "content": "SQL Server is case insensitive by default\nhttps://stackoverflow.com/questions/1224364/sql-server-ignore-case-in-a-where-expression/12686470"
      },
      {
        "date": "2020-06-30T02:53:00.000Z",
        "voteCount": 3,
        "content": "So, what SQL skill is this question testing?"
      },
      {
        "date": "2020-08-17T03:36:00.000Z",
        "voteCount": 4,
        "content": "Orthography )))"
      },
      {
        "date": "2020-11-22T10:03:00.000Z",
        "voteCount": 1,
        "content": "Observation, I felt for it &gt;.&gt;"
      },
      {
        "date": "2020-05-29T08:57:00.000Z",
        "voteCount": 1,
        "content": "But, is it case sensitive? I Don't think so. The given code seems to be ok :/"
      },
      {
        "date": "2020-05-29T08:58:00.000Z",
        "voteCount": 3,
        "content": "Ah its calceled :D"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 104,
    "url": "https://www.examtopics.com/discussions/microsoft/view/5379-exam-70-761-topic-1-question-104-discussion/",
    "body": "SIMULATION -<br>You have a database that contains the following tables.<br><img src=\"/assets/media/exam-media/02675/0024600001.jpg\" class=\"in-exam-image\"><br>You need to create a query that lists the highest-performing salespersons based on the current year-to-date sales period. The query must meet the following requirements:<br>\u2711 Return the LastName and SalesYTD for the three salespersons with the highest year-to-date sales values.<br>\u2711 Exclude salespersons that have no value for TerritoryID.<br>Construct the query using the following guidelines:<br>\u2711 Use the first letter of a table name as the table alias.<br>\u2711 Use two-part column names.<br>\u2711 Do not surround object names with square brackets.<br>\u2711 Do not use implicit joins.<br>\u2711 Use only single quotes for literal text.<br>Use aliases only if required.<br><img src=\"/assets/media/exam-media/02675/0024600009.png\" class=\"in-exam-image\"><br><img src=\"/assets/media/exam-media/02675/0024700001.png\" class=\"in-exam-image\"><br>Part of the correct Transact-SQL has been provided in the answer area below. Enter the code in the answer area that resolves the problem and meets the stated goals or requirements. You can add code within the code that has been provided as well as below it.<br>1 SELECT top 3 lastname,salesYTD<br>2 FROM Person AS p INNER JOIN SalesPerson AS s<br>3 ON p.PersonID = s.SalesPersonID<br>4 WHERE territoryid is null<br>5 order by salesytd dsec<br>Use the Check Syntax button to verify your work. Any syntax or spelling errors will be reported by line and character position.<br>",
    "options": [],
    "answer": "Please see explanation",
    "answerDescription": "1 SELECT top 3 lastname,salesYTD<br>2 FROM Person AS p INNER JOIN SalesPerson AS s<br>3 ON p.PersonID = s.SalesPersonID<br>4 WHERE territoryid is not null<br>5 order by salesytd desc<br>Note:<br>On line 4 add a not before null.<br>On line 5 change dsec to desc.",
    "votes": [],
    "comments": [
      {
        "date": "2020-06-05T09:45:00.000Z",
        "voteCount": 7,
        "content": "SELECT TOP(3) \n\tp.LastName, \n\ts.SalesYTD\nFROM Person AS p\nINNER JOIN SalesPerson AS s\nON p.PersonId = s.PersonId\nWHERE S.TerritoryID IS NOT NULL\nORDER BY S.SalesYTD DESC;"
      },
      {
        "date": "2019-11-17T16:05:00.000Z",
        "voteCount": 6,
        "content": "SELECT top(3) p.lastname, s.salesYTD\n*use two part column naming"
      },
      {
        "date": "2020-02-10T08:44:00.000Z",
        "voteCount": 2,
        "content": "But *Use aliases only if required. Quite an ambiguous question."
      },
      {
        "date": "2020-12-20T05:22:00.000Z",
        "voteCount": 2,
        "content": "Actually  , the need to use them only where they are required . And the only place we can't omit them is ON clause."
      },
      {
        "date": "2021-01-01T15:30:00.000Z",
        "voteCount": 2,
        "content": "SELECT TOP(3) p.LastName, s.SalesYTD\nFROM SalesPerson as s\nINNER JOIN Person as p\nON s.personid = p.personid\nWHERE s.territoryid IS NOT NULL\nORDER BY s.salesYTD DESC"
      },
      {
        "date": "2020-03-19T03:51:00.000Z",
        "voteCount": 4,
        "content": "select top 3 person.lastname, salesperson.salesYTD\nfrom person join salesperson \non person.personid=salesperson.personid\nwhere territoryid is not null\norder by salesYTD desc"
      },
      {
        "date": "2019-10-19T00:46:00.000Z",
        "voteCount": 5,
        "content": "Exclude salespersons that have no value for TerritoryID.\n\n\"WHERE TerritoryID IS NOT NULL\""
      },
      {
        "date": "2020-02-13T06:38:00.000Z",
        "voteCount": 2,
        "content": "that's why we say SQL database engine is smart. if column is only shows on specific table, we can use it without using two named convension"
      },
      {
        "date": "2019-09-18T05:04:00.000Z",
        "voteCount": 1,
        "content": "Should not be s.PersonId = p.PersonId. nevertheless\n PersonId in SalesPerson table  looks like foreign key to Person table..."
      },
      {
        "date": "2020-12-14T13:05:00.000Z",
        "voteCount": 1,
        "content": "Wrong !  MUST BE ON ps.PersonID = p.PersonID"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 105,
    "url": "https://www.examtopics.com/discussions/microsoft/view/5565-exam-70-761-topic-1-question-105-discussion/",
    "body": "Note: This question is part of a series of questions that use the same or similar answer choices. An answer choice may be correct for more than one question in the series. Each question is independent of the other questions in this series. Information and details provided in a question apply to that question.<br>You have a database for a banking system. The database has two tables named tblDepositAcct and tblLoanAcct that store deposit and loan accounts, respectively. Both tables contain the following columns:<br><img src=\"/assets/media/exam-media/02675/0024900001.png\" class=\"in-exam-image\"><br>You need to determine the total number of deposit and loan accounts.<br>Which Transact-SQL statement should you run?<br><img src=\"/assets/media/exam-media/02675/0024900002.png\" class=\"in-exam-image\"><br>A.<br><img src=\"/assets/media/exam-media/02675/0024900003.png\" class=\"in-exam-image\"><br>B.<br><img src=\"/assets/media/exam-media/02675/0025000001.png\" class=\"in-exam-image\"><br>C.<br><img src=\"/assets/media/exam-media/02675/0025000002.png\" class=\"in-exam-image\"><br>D.<br><img src=\"/assets/media/exam-media/02675/0025000003.png\" class=\"in-exam-image\"><br>E.<br><img src=\"/assets/media/exam-media/02675/0025000004.png\" class=\"in-exam-image\"><br>F.<br><img src=\"/assets/media/exam-media/02675/0025000005.png\" class=\"in-exam-image\"><br>G.<br><img src=\"/assets/media/exam-media/02675/0025000006.png\" class=\"in-exam-image\"><br>H.<br>",
    "options": [],
    "answer": "C",
    "answerDescription": "Would list the customers with duplicates, which would equal the number of accounts.<br>Incorrect Answers:<br>A: INTERSECT returns distinct rows that are output by both the left and right input queries operator.<br>B: Would list the customers without duplicates.<br>D: Number of customers.<br>F: EXCEPT returns distinct rows from the left input query that aren't output by the right input query.<br>References:<br>https://msdn.microsoft.com/en-us/library/ms180026.aspx",
    "votes": [],
    "comments": [
      {
        "date": "2019-10-19T00:55:00.000Z",
        "voteCount": 20,
        "content": "\" total number of deposit and loan accounts\" is correct answer C (UNION ALL)"
      },
      {
        "date": "2020-02-20T03:30:00.000Z",
        "voteCount": 6,
        "content": "if a customer has 3 deposit accounts then the query &lt;select custno from deposit &gt; returns this custno 3 times, that means, you count the total number of records. I think, answer C) with union all statement is ok"
      },
      {
        "date": "2021-01-01T15:32:00.000Z",
        "voteCount": 1,
        "content": "C is absolutely correct"
      },
      {
        "date": "2020-12-14T13:15:00.000Z",
        "voteCount": 1,
        "content": "C is correct . custno and acctno are unique in both tables so we don't have to exclude distinct values for custno. that means we must use UNION ALL. Then we count rows in result set  of Union All"
      },
      {
        "date": "2020-11-11T12:35:00.000Z",
        "voteCount": 1,
        "content": "None of them is correct."
      },
      {
        "date": "2020-10-14T12:11:00.000Z",
        "voteCount": 1,
        "content": "select count(AcctNo) as TotalAccounts from tblDepositAcct\nUNION\nselect count(AcctNo) as TotalAccounts from tblLoanAcct"
      },
      {
        "date": "2020-09-18T09:48:00.000Z",
        "voteCount": 2,
        "content": "We need total deposit and loan accounts.A single person can have multiple accounts.\nSo in deposit table if Customer1 has 3 accounts, then all these accounts are going to be unique, the same accounts cannot exist in Loan table so option A is wrong it will return zero records.\n\nComing to B again if Customer1 has 3 accounts in deposit table and 2 accounts in Loan table, for customer1 itself there are total 5 accounts but if you do Union on Custno you will get only 2 as the result which is wrong if we need total account numbers.\n\nComing to C again if Customer1 has 3 accounts in Deposit table and 2 accounts in loan table that means in Deposit table there are 3 entries of Customer1 in deposit and 2 in Loan so union all will display all 5 because union all displays everything including dupes.\n\nRest options are not relevant here.\nSo the correct answer is C"
      },
      {
        "date": "2020-06-25T10:41:00.000Z",
        "voteCount": 1,
        "content": "C is correct, it counts all rows in tblDepositAcct and all rows in tblLoanAcct, each row has unique AcctNo\n\nCustNo is irrelavant because the question asks for unique AcctNo even some may belong to the same CustNo"
      },
      {
        "date": "2020-05-29T09:18:00.000Z",
        "voteCount": 1,
        "content": "its C for Sure. Tested"
      },
      {
        "date": "2020-05-29T09:24:00.000Z",
        "voteCount": 1,
        "content": "BUT if there is case when loan acc no is the same with deposit acc no then the answer is G. But as I know loan and deposit acc numbers are different in banks for one customer number."
      },
      {
        "date": "2020-05-29T09:25:00.000Z",
        "voteCount": 1,
        "content": "Sorry H** instead of G :)"
      },
      {
        "date": "2020-02-25T07:05:00.000Z",
        "voteCount": 1,
        "content": "So, there are C and H answers are correct, agree with mattia_88 and Andi64\nboth are rights, and both query will return equivalent answers"
      },
      {
        "date": "2020-05-29T09:28:00.000Z",
        "voteCount": 1,
        "content": "What if by chance loan account number is the same with deposit account number, what happens? It counts only once in H and twice (correct) in C, so the anwer is C in my opinion"
      },
      {
        "date": "2020-01-14T05:40:00.000Z",
        "voteCount": 2,
        "content": "A doesn't count accounts which present only in one table, C counts users, if we want to count all accounts (not only intersection), the correct answer might be H."
      },
      {
        "date": "2020-01-29T05:15:00.000Z",
        "voteCount": 6,
        "content": "we need to count all accounts, so that means count all rows in both tables (one user can have more accounts). Therefore we need to use UNION ALL, so C seems as right answer to me.\nTested as:\n\ndeclare @Dep as table\n(\ncust smallint not null primary key,\nacc smallint null\n)\ninsert into @Dep \nvalues\n(1,45),(2,47),(3,78)\ndeclare @Loan as table\n(\ncust smallint not null primary key,\nacc smallint null\n)\ninsert into @Loan \nvalues\n(1,33),(3,35)\n\n\nselect * from @Dep\nselect * from @Loan\n\nselect count(*) from(\nselect d.cust\nfrom @Dep as d \nunion all \nselect l.cust\nfrom @Loan as l\n) as R"
      },
      {
        "date": "2020-02-09T09:22:00.000Z",
        "voteCount": 4,
        "content": "But, your query selects cust, not acct. If each cust has only one acct then it looks correct. If a cust has more than one acct, then it looks like it counts a wrong columns."
      },
      {
        "date": "2021-01-26T13:36:00.000Z",
        "voteCount": 1,
        "content": "The only answer that uses acct (A) is wrong. Out of available answers, only C is correct as - even though you use cust instead of acct, UNION ALL is used (which doesn't exclude duplicates). COUNT also doesn't exclude duplicates, so even if you're calculating on (non-unique) cust column, you still end up with a correct answer."
      },
      {
        "date": "2020-12-06T21:13:00.000Z",
        "voteCount": 1,
        "content": "Thank you, I tested it and worked."
      },
      {
        "date": "2019-11-13T02:36:00.000Z",
        "voteCount": 1,
        "content": "\u00bb deposit and loan accounts, meaning ACCOUNTS that are in the table deposit and the table accounts. Also, the question demands  ACCOUNTS not Customers. So yes, A is the correct answer."
      },
      {
        "date": "2019-09-22T01:55:00.000Z",
        "voteCount": 1,
        "content": "A is correct answer."
      },
      {
        "date": "2019-09-22T01:59:00.000Z",
        "voteCount": 2,
        "content": "Sorry it is ok. \"total number of deposit and loan accounts\" not both"
      },
      {
        "date": "2019-10-22T17:22:00.000Z",
        "voteCount": 4,
        "content": "cant be A FOR SURE"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 106,
    "url": "https://www.examtopics.com/discussions/microsoft/view/6456-exam-70-761-topic-1-question-106-discussion/",
    "body": "HOTSPOT -<br>You need to develop a Transact-SQL statement that meets the following requirements:<br>\u2711 The statement must return a custom error when there are problems updating a table.<br>\u2711 The error number must be the value 50555.<br>\u2711 The error severity level must be 14.<br>\u2711 A Microsoft SQL Server alert must be triggered when the error condition occurs.<br>Which Transact-SQL segment should you use for each requirement? To answer, select the appropriate Transact-SQL segments in the answer area.<br>Hot Area:<br><img src=\"/assets/media/exam-media/02675/0025200001.png\" class=\"in-exam-image\"><br>",
    "options": [],
    "answer": "<img src=\"/assets/media/exam-media/02675/0025200002.png\" class=\"in-exam-image\">",
    "answerDescription": "RAISERROR generates an error message and initiates error processing for the session. RAISERROR can either reference a user-defined message stored in the sys.messages catalog view or build a message dynamically. The message is returned as a server error message to the calling application or to an associated<br>CATCH block of a TRY\"\u00a6CATCH construct. New applications should use THROW instead.<br>Note: RAISERROR syntax:<br>RAISERROR( { msg_id | msg_str | @local_variable }<br>{ ,severity ,state }<br>[ ,argument [ ,...n ] ] )<br>[ WITH option [ ,...n ] ]<br>The LOG option logs the error in the error log and the application log for the instance of the Microsoft SQL Server Database Engine.<br>References:<br>https://msdn.microsoft.com/en-us/library/ms178592.aspx",
    "votes": [],
    "comments": [
      {
        "date": "2021-01-24T20:17:00.000Z",
        "voteCount": 1,
        "content": "The answer is correct:\nLOG: Logs the error in the error log and the application log for the instance of the Microsoft SQL Server Database Engine.\nhttps://docs.microsoft.com/en-us/sql/t-sql/language-elements/raiserror-transact-sql?view=sql-server-2016"
      },
      {
        "date": "2021-01-01T15:35:00.000Z",
        "voteCount": 1,
        "content": "The answer to the 2nd part is correct, assuming the error number added to sys.messages with  sp_addmessage. The first option is interchangeable though - no requirements on that"
      },
      {
        "date": "2020-11-11T12:53:00.000Z",
        "voteCount": 2,
        "content": "Answer: The syntax used for raiserror is wrong.\nFrom Microsoft doc: https://docs.microsoft.com/en-us/sql/t-sql/language-elements/raiserror-transact-sql?view=sql-server-2017\nWhen msg_str is specified, RAISERROR raises an error message with an error number of 50000.\nSeverity levels from 0 through 18 can be specified by any user. \nSeverity levels from 19 through 25: \nWITH LOG option is required.\nOnly member of sysadmin fixed server role or user with ALTER TRACE permissions can specify WITH LOG.\nSyntax: RAISERROR ( { msg_id | msg_str | @local_variable }  \n    { ,severity ,state }[ ,argument [ ,...n ] ] )[ WITH option [ ,...n ] ]\nEx. RAISERROR (N'This is message %s %d.', -- Message text.  \n           10, -- Severity,  \n           1, -- State,  \n           N'number', -- First argument.  \n           5); -- Second argument.  \n-- The message text returned is: This is message number 5."
      },
      {
        "date": "2019-10-19T01:02:00.000Z",
        "voteCount": 2,
        "content": "is correct if before is added the message with code 50555\nEXEC sp_addmessage 50555, 14,  N'%s';"
      },
      {
        "date": "2019-10-11T04:50:00.000Z",
        "voteCount": 1,
        "content": "Its strange that we can use both error id and message in RAISERROR.\nIn addition RAISERROR cannot see eerror id &gt; 50000 if there is not permanently written to sys.messages\nhttps://sqlhints.com/tag/raiserror-vs-throw/"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 107,
    "url": "https://www.examtopics.com/discussions/microsoft/view/39931-exam-70-761-topic-1-question-107-discussion/",
    "body": "HOTSPOT -<br>You have two tables as shown in the following image:<br><img src=\"/assets/media/exam-media/02675/0025300001.png\" class=\"in-exam-image\"><br>You need to analyze the following query. (Line numbers are included for reference only.)<br><img src=\"/assets/media/exam-media/02675/0025400001.jpg\" class=\"in-exam-image\"><br>Use the drop-down menus to select the answer choice that completes each statement based on the information presented in the graphic.<br>NOTE: Each correct selection is worth one point.<br>Hot Area:<br><img src=\"/assets/media/exam-media/02675/0025500001.png\" class=\"in-exam-image\"><br>",
    "options": [],
    "answer": "<img src=\"/assets/media/exam-media/02675/0025500002.jpg\" class=\"in-exam-image\">",
    "answerDescription": "To compare char(5) and nchar(5) an implicit conversion has to take place.<br>Explicit conversions use the CAST or CONVERT functions, as in line number 6.<br>References:<br>https://docs.microsoft.com/en-us/sql/t-sql/data-types/data-type-conversion-database-engine#implicit-and-explicit-conversion",
    "votes": [],
    "comments": [
      {
        "date": "2020-12-15T10:13:00.000Z",
        "voteCount": 1,
        "content": "Correctimundo"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 108,
    "url": "https://www.examtopics.com/discussions/microsoft/view/39933-exam-70-761-topic-1-question-108-discussion/",
    "body": "Note: This question is part of a series of questions that present the same scenario. Each question in the series contains a unique solution that might meet the stated goals. Some question sets might have more than one correct solution, while others might not have a correct solution.<br>After you answer a question in this section. You will NOT be able to return to it. As a result, these questions will not appear in the review screen.<br>You have a database that tracks orders and deliveries for customers in North America. The database contains the following tables:<br><br>Sales.Customers -<br><img src=\"/assets/media/exam-media/02675/0025600001.png\" class=\"in-exam-image\"><br><br>Application.Cities -<br><img src=\"/assets/media/exam-media/02675/0025700001.png\" class=\"in-exam-image\"><br><br>Sales.CustomerCategories -<br><img src=\"/assets/media/exam-media/02675/0025700002.png\" class=\"in-exam-image\"><br>Your company is developing a new social application that connects customers to each other based on the distance between their delivery locations.<br>You need to write a query that returns the nearest customer.<br>Solution: You run the following Transact-SQL statement:<br><img src=\"/assets/media/exam-media/02675/0025700003.png\" class=\"in-exam-image\"><br>The variable @custID is set to a valid customer.<br>Does the solution meet the goal?<br>",
    "options": [
      "<span class=\"multi-choice-letter\" data-choice-letter=\"A\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tYes",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"B\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tB.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tNo"
    ],
    "answer": "A",
    "answerDescription": "ShortestLineTo (geometry Data Type) Returns a LineString instance with two points that represent the shortest distance between the two geometry instances. The length of the LineString instance returned is the distance between the two geometry instances.<br>STLength (geometry Data Type) returns the total length of the elements in a geometry instance.<br>References:<br>https://docs.microsoft.com/en-us/sql/t-sql/spatial-geometry/shortestlineto-geometry-data-type",
    "votes": [],
    "comments": [
      {
        "date": "2021-01-01T15:42:00.000Z",
        "voteCount": 1,
        "content": "Yes, should use STDistance() and ORDER BY Dist DESC both"
      },
      {
        "date": "2021-01-01T15:44:00.000Z",
        "voteCount": 1,
        "content": "STLength is around a geographic shape whereas STDistance gives distance between points A and B"
      },
      {
        "date": "2021-01-01T15:55:00.000Z",
        "voteCount": 1,
        "content": "But they both work so OK - it is correct:\nDECLARE @g GEOGRAPHY=GEOGRAPHY::Point(47,123, 4326), @h GEOGRAPHY=GEOGRAPHY::Point(48,125, 4326)\nSELECT @g.ShortestLineTo(@h).STLength()\nSELECT @g.STDistance(@h)"
      },
      {
        "date": "2020-12-29T01:51:00.000Z",
        "voteCount": 1,
        "content": "NO: ORDER BY Dist DESC"
      },
      {
        "date": "2020-12-29T01:52:00.000Z",
        "voteCount": 1,
        "content": "My mistake ignore"
      },
      {
        "date": "2020-12-20T05:33:00.000Z",
        "voteCount": 1,
        "content": "Shouldn't we use STDistance() here instead of STLength()?"
      },
      {
        "date": "2020-12-15T10:15:00.000Z",
        "voteCount": 1,
        "content": "Correctimundo"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 109,
    "url": "https://www.examtopics.com/discussions/microsoft/view/6483-exam-70-761-topic-1-question-109-discussion/",
    "body": "Note: This question is part of a series of questions that present the same scenario. Each question in the series contains a unique solution that might meet the stated goals. Some question sets might have more than one correct solution, while others might not have a correct solution.<br>After you answer a question in this section. You will NOT be able to return to it. As a result, these questions will not appear in the review screen.<br>You have a database that tracks orders and deliveries for customers in North America. The database contains the following tables:<br><br>Sales.Customers -<br><img src=\"/assets/media/exam-media/02675/0025900001.png\" class=\"in-exam-image\"><br><br>Application.Cities -<br><img src=\"/assets/media/exam-media/02675/0025900002.png\" class=\"in-exam-image\"><br><br>Sales.CustomerCategories -<br><img src=\"/assets/media/exam-media/02675/0025900003.png\" class=\"in-exam-image\"><br>Your company is developing a new social application that connects customers to each other based on the distance between their delivery locations.<br>You need to write a query that returns the nearest customer.<br>Solution: You run the following Transact-SQL statement:<br><img src=\"/assets/media/exam-media/02675/0026000001.png\" class=\"in-exam-image\"><br>The variable @custID is set to a valid customer.<br>Does the solution meet the goal?<br>",
    "options": [
      "<span class=\"multi-choice-letter\" data-choice-letter=\"A\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tYes",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"B\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tB.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tNo"
    ],
    "answer": "B",
    "answerDescription": "",
    "votes": [],
    "comments": [
      {
        "date": "2020-01-03T07:26:00.000Z",
        "voteCount": 6,
        "content": "there is no order in the query so no guarantee what returned record is in top so answer is no"
      },
      {
        "date": "2020-01-04T07:50:00.000Z",
        "voteCount": 5,
        "content": "Plus it inner join"
      },
      {
        "date": "2020-12-15T04:00:00.000Z",
        "voteCount": 2,
        "content": "We depend on the shortest distance not on the same city. Answer should B"
      },
      {
        "date": "2020-07-07T05:14:00.000Z",
        "voteCount": 1,
        "content": "the ^ symbol being used here is just wrong...i thought answer to question was No as soon as i saw the ^ symbol"
      },
      {
        "date": "2020-09-21T13:50:00.000Z",
        "voteCount": 1,
        "content": "Today on the exams was  the same symbol there... i choosed no"
      },
      {
        "date": "2020-06-13T06:10:00.000Z",
        "voteCount": 2,
        "content": "Can anybody illuminate on the role of operator ^ used in this question. ^ is used as exclusive OR but it is used on bitmasks like integer type values. It does not have any meaning on geography type variables"
      },
      {
        "date": "2019-10-11T14:49:00.000Z",
        "voteCount": 3,
        "content": "I think there should be YES. Example:\n\n\n\ndrop table [TSQLV4].[HR].[customers] \ncreate table [TSQLV4].[HR].[customers] (\ncustomerid int identity (1,1),\nDeliverylocation geography\n)\nset identity_insert [TSQLV4].[HR].[customers] on\ninsert into [TSQLV4].[HR].[customers] (customerid) values \n(1),(2),(3)\nUPDATE [TSQLV4].[HR].[customers]  \nSET Deliverylocation = geography::Point( 40.854078, -73.869043 ,4326 ) where customerid  =1 -- bronx zoo, closest to wsq, far to airport\nUPDATE [TSQLV4].[HR].[customers]  \nSET Deliverylocation = geography::Point( 40.730581, -73.997732 ,4326 ) where customerid  =2 --washigton square park closest to airport\nUPDATE [TSQLV4].[HR].[customers]  \nSET Deliverylocation = geography::Point( 40.657440, -73.776462,4326 ) where customerid  =3 -- airport jfk\n\n\ndeclare @id int = 3\nselect top 1 b.customerid, a.Deliverylocation.STDistance(b.deliverylocation)\nas dist\nfrom [TSQLV4].[HR].[customers] as a\ncross join [TSQLV4].[HR].[customers] as b\nwhere a.customerid = @id and a.customerid &lt;&gt; b.customerid\norder by dist"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 110,
    "url": "https://www.examtopics.com/discussions/microsoft/view/7825-exam-70-761-topic-1-question-110-discussion/",
    "body": "Note: This question is part of a series of questions that present the same scenario. Each question in the series contains a unique solution that might meet the stated goals. Some question sets might have more than one correct solution, while others might not have a correct solution.<br>After you answer a question in this section. You will NOT be able to return to it. As a result, these questions will not appear in the review screen.<br>You have a database that tracks orders and deliveries for customers in North America. The database contains the following tables:<br><br>Sales.Customers -<br><img src=\"/assets/media/exam-media/02675/0026100001.png\" class=\"in-exam-image\"><br><br>Application.Cities -<br><img src=\"/assets/media/exam-media/02675/0026100002.png\" class=\"in-exam-image\"><br><br>Sales.CustomerCategories -<br><img src=\"/assets/media/exam-media/02675/0026100003.png\" class=\"in-exam-image\"><br>Your company is developing a new social application that connects customers to each other based on the distance between their delivery locations.<br>You need to write a query that returns the nearest customer.<br>Solution: You run the following Transact-SQL statement:<br><img src=\"/assets/media/exam-media/02675/0026200001.png\" class=\"in-exam-image\"><br>The variable @custID is set to a valid customer.<br>Does the solution meet the goal?<br>",
    "options": [
      "<span class=\"multi-choice-letter\" data-choice-letter=\"A\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tYes",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"B\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tB.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tNo"
    ],
    "answer": "B",
    "answerDescription": "",
    "votes": [],
    "comments": [
      {
        "date": "2019-11-19T02:41:00.000Z",
        "voteCount": 20,
        "content": "The right answer is A.\n\nIF OBJECT_ID ('TEMPDB..#Customer') IS NOT NULL  DROP TABLE #Customer;  \nGO  \n  \nCREATE TABLE #Customer( \n\tCustomerID\t\t\t\tINT IDENTITY (1,1)  \n    , DeliveryLocation\t\tGEOGRAPHY  \n\t, LocationName\t\t\tVARCHAR(150)\n);  \nGO  \n\nINSERT INTO #Customer(DeliveryLocation, LocationName)\nVALUES\t(geography::Point(38.7071, -9.13549, 4326), 'Lisboa')\n\t\t, (geography::Point(41.15, -8.61024, 4326), 'Porto')\n\t\t, (geography::Point(40.4165000, -3.7025600, 4326), 'Madrid')\n\t\t, (geography::Point(41.3887901, 2.1589899, 4326), 'Barcelona')\n\t\t\n-- SELECT * FROM #Customer\n\nDECLARE @CustID INT = 4\n\nSELECT\tTOP 1 \n\t\tA.CustomerID, A.LocationName\n\t\t, A.DeliveryLocation.STDistance(B.DeliveryLocation) AS Distancia\n\t\t, B.CustomerID, B.LocationName\nFROM\t#Customer A\n\t\tCROSS JOIN #Customer B\nWHERE\tA.CustomerID = @CustID AND A.CustomerID &lt;&gt; B.CustomerID\nORDER BY Distancia"
      },
      {
        "date": "2019-12-19T12:36:00.000Z",
        "voteCount": 4,
        "content": "B is correct answer. Name \"Dist\" can't be used on 'order by' clause cause it isn't a table's column name or function applied to it"
      },
      {
        "date": "2020-02-08T07:37:00.000Z",
        "voteCount": 5,
        "content": "Wrong. Logical order:\n1 FROM;\n2 WHERE\n3 GROUP BY\n4 HAVING\n6 ORDER BY. So you can order by select alias."
      },
      {
        "date": "2020-02-08T07:38:00.000Z",
        "voteCount": 3,
        "content": "i forgot 5. SELECT"
      },
      {
        "date": "2020-01-14T06:52:00.000Z",
        "voteCount": 11,
        "content": "It can't be used with GROUP by, but can be used with ORDER by."
      },
      {
        "date": "2020-08-08T06:02:00.000Z",
        "voteCount": 3,
        "content": "This is correct. TESTED. Alias can be used in the ORDER BY."
      },
      {
        "date": "2021-01-18T02:02:00.000Z",
        "voteCount": 1,
        "content": "The answer should be A. Not only aliasses of aggregations can be place in an order by, also plain aliasses from colums can. See below\n\nselect Department, employeenumber as emp_number\n from tblemployee\n order by emp_number\n\n select department, count(employeenumber) as number_of_emps_per_dep\n from tblemployee\n group by department\n order by number_of_emps_per_dep"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 111,
    "url": "https://www.examtopics.com/discussions/microsoft/view/7826-exam-70-761-topic-1-question-111-discussion/",
    "body": "Note: This question is part of a series of questions that present the same scenario. Each question in the series contains a unique solution that might meet the stated goals. Some question sets might have more than one correct solution, while others might not have a correct solution.<br>After you answer a question in this section. You will NOT be able to return to it. As a result, these questions will not appear in the review screen.<br>You have a database that tracks orders and deliveries for customers in North America. The database contains the following tables:<br><br>Sales.Customers -<br><img src=\"/assets/media/exam-media/02675/0026300001.png\" class=\"in-exam-image\"><br><br>Application.Cities -<br><img src=\"/assets/media/exam-media/02675/0026300002.png\" class=\"in-exam-image\"><br><br>Sales.CustomerCategories -<br><img src=\"/assets/media/exam-media/02675/0026300003.png\" class=\"in-exam-image\"><br>Your company is developing a new social application that connects customers to each other based on the distance between their delivery locations.<br>You need to write a query that returns the nearest customer.<br>Solution: You run the following Transact-SQL statement:<br>SELECT TOP 1 B.CustomerID, A.DeliveryLocation.STDistance(B.DeliveryLocation) AS Dist<br><br>FROM Sales.Customers AS A -<br><br>CROSS JOIN Sales.Customers AS B -<br>WHERE A.CustomerID = @custID AND A.CustomerID &lt;&gt; B.CustomerID<br><br>ORDER BY Dist -<br>The variable @custID is set to a valid customer.<br>Does the solution meet the goal?<br>",
    "options": [
      "<span class=\"multi-choice-letter\" data-choice-letter=\"A\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tYes",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"B\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tB.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tNo"
    ],
    "answer": "B",
    "answerDescription": "",
    "votes": [],
    "comments": [
      {
        "date": "2019-11-08T05:39:00.000Z",
        "voteCount": 11,
        "content": "It seems working"
      },
      {
        "date": "2020-02-13T07:41:00.000Z",
        "voteCount": 10,
        "content": "it is just same to the previous one, both answer should be A"
      },
      {
        "date": "2021-01-18T02:06:00.000Z",
        "voteCount": 1,
        "content": "Same as the previous question. this runs perfectly."
      },
      {
        "date": "2020-10-14T14:07:00.000Z",
        "voteCount": 1,
        "content": "looks the same as Question #100"
      },
      {
        "date": "2020-08-19T14:07:00.000Z",
        "voteCount": 2,
        "content": "A (YES) is correct"
      },
      {
        "date": "2020-07-07T05:50:00.000Z",
        "voteCount": 1,
        "content": "mlourinho's code runs..."
      },
      {
        "date": "2020-06-01T13:21:00.000Z",
        "voteCount": 1,
        "content": "STDistance gives shortest path between 2 geographies, where in the asking 2 points in two different geographies. Example STDistance will give shortest distance between 2 continents\nwhere as ShortestLinto will give shortest path two different cities within the geopgraphy"
      },
      {
        "date": "2020-06-01T13:20:00.000Z",
        "voteCount": 1,
        "content": "STDistance gives shortest path between 2 geographies, where in the asking 2 points in two different geographies. Example STDistance will give shortest distance between 2 continents"
      },
      {
        "date": "2019-11-19T02:45:00.000Z",
        "voteCount": 4,
        "content": "IF OBJECT_ID ('TEMPDB..#Customer') IS NOT NULL  DROP TABLE #Customer;  \nGO  \n  \nCREATE TABLE #Customer( \n\tCustomerID\t\t\t\tINT IDENTITY (1,1)  \n    , DeliveryLocation\t\tGEOGRAPHY  \n\t, LocationName\t\t\tVARCHAR(150)\n);  \nGO  \n\nINSERT INTO #Customer(DeliveryLocation, LocationName)\nVALUES\t(geography::Point(38.7071, -9.13549, 4326), 'Lisboa')\n\t\t, (geography::Point(41.15, -8.61024, 4326), 'Porto')\n\t\t, (geography::Point(40.4165000, -3.7025600, 4326), 'Madrid')\n\t\t, (geography::Point(41.3887901, 2.1589899, 4326), 'Barcelona')\n\t\t\n-- SELECT * FROM #Customer\n\nDECLARE @CustID INT = 4\n\nSELECT\tTOP 1 \n\t\tA.CustomerID, A.LocationName\n\t\t, A.DeliveryLocation.STDistance(B.DeliveryLocation) AS Distancia\n\t\t, B.CustomerID, B.LocationName\nFROM\t#Customer A\n\t\tCROSS JOIN #Customer B\nWHERE\tA.CustomerID = @CustID AND A.CustomerID &lt;&gt; B.CustomerID\nORDER BY Distancia"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 112,
    "url": "https://www.examtopics.com/discussions/microsoft/view/21093-exam-70-761-topic-1-question-112-discussion/",
    "body": "DRAG DROP -<br>You have a database containing the following tables:<br><br>Servers -<br><img src=\"/assets/media/exam-media/02675/0026400001.png\" class=\"in-exam-image\"><br><br>Errors -<br><img src=\"/assets/media/exam-media/02675/0026400002.png\" class=\"in-exam-image\"><br>You have a user-defined, scalar function named IPLookup that takes a DNS name as a parameter and returns the IP address of the server. You have an additional user-defined, scalar function named DNSLookup, that takes an IP address as a parameter and returns a DNS name.<br>You create a view named vwErrors by running the following Transact-SQL statement:<br><img src=\"/assets/media/exam-media/02675/0026500001.png\" class=\"in-exam-image\"><br>You need to insert data by using the view.<br>How should you complete the Transact-SQL statement? To answer, drag the appropriate Transact-SQL segments to the correct location. Each Transact-SQL segments may be used once, more than once, or not at all. You may need to drag the split bar between panes or scroll to view content.<br>Select and Place:<br><img src=\"/assets/media/exam-media/02675/0026500002.png\" class=\"in-exam-image\"><br>",
    "options": [],
    "answer": "<img src=\"/assets/media/exam-media/02675/0026600001.png\" class=\"in-exam-image\">",
    "answerDescription": "References:<br>https://docs.microsoft.com/en-us/sql/t-sql/queries/output-clause-transact-sql",
    "votes": [],
    "comments": [
      {
        "date": "2021-01-18T02:53:00.000Z",
        "voteCount": 1,
        "content": "\"you need to insert data by using the view\". This means that the trigger needs to fire when this happens. I would say AFTER INSERT, as the view is used to insert in an (unknown) table. But this is unclear from the question."
      },
      {
        "date": "2021-01-01T16:19:00.000Z",
        "voteCount": 2,
        "content": "Correct - INSTEAD OF because we are trying to log errors and can't do that with AFTER TRIGGER because it won't fire"
      },
      {
        "date": "2020-12-15T14:43:00.000Z",
        "voteCount": 4,
        "content": "answer correct"
      },
      {
        "date": "2020-12-15T11:47:00.000Z",
        "voteCount": 2,
        "content": "For anyone that was confused by the \"FROM inserted\" part of the trigger - check out \"virtual tables\". This talks briefly about them: https://www.sqlservertutorial.net/sql-server-triggers/sql-server-create-trigger/"
      },
      {
        "date": "2020-11-26T20:01:00.000Z",
        "voteCount": 1,
        "content": "Why use INSTEAD OF ? A think correct block [after insert]. Share with your opinions."
      },
      {
        "date": "2020-12-15T11:46:00.000Z",
        "voteCount": 1,
        "content": "My understanding is that since we're actually only inserting into one true table, we'd want an \"instead of\" trigger. If we wanted to update a true table, and have a trigger then update another table as well (such as an audit table), then we'd want to use an After Insert.\n\nIn this case, I think it makes sense to use an instead of trigger - since we're not actually trying to insert into the view, but rather insert into the underlying table. I think this was helpful: https://www.sqlservertutorial.net/sql-server-triggers/sql-server-create-trigger/"
      },
      {
        "date": "2021-01-18T02:56:00.000Z",
        "voteCount": 1,
        "content": "No , but the view is 'used' to insert it says. Meaning that BEFORE firing the trigger the view IS used to insert ino an (unknown) table. INSTEAD OF makes no sense."
      },
      {
        "date": "2021-01-25T14:46:00.000Z",
        "voteCount": 1,
        "content": "Because instead of inserting a table directly, what is done is inserting the default values of the temporary table INSERTED"
      },
      {
        "date": "2020-08-18T08:38:00.000Z",
        "voteCount": 2,
        "content": "This question doesn't make any sense"
      },
      {
        "date": "2020-06-07T12:31:00.000Z",
        "voteCount": 1,
        "content": "Something is wrong here in the question:\nIPLookup takes a DNS name as a parameter and returns the IP address of the server While in the code IPLookup  is taking IP and returning DNS bohh"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 113,
    "url": "https://www.examtopics.com/discussions/microsoft/view/5410-exam-70-761-topic-1-question-113-discussion/",
    "body": "You need to create a table named Sales that meets the following requirements:<br><img src=\"/assets/media/exam-media/02675/0026600002.png\" class=\"in-exam-image\"><br>Which Transact-SQL statement should you run?<br><img src=\"/assets/media/exam-media/02675/0026700001.png\" class=\"in-exam-image\"><br>A.<br><img src=\"/assets/media/exam-media/02675/0026700002.png\" class=\"in-exam-image\"><br>B.<br><img src=\"/assets/media/exam-media/02675/0026700003.png\" class=\"in-exam-image\"><br>C.<br><img src=\"/assets/media/exam-media/02675/0026700004.png\" class=\"in-exam-image\"><br>D.<br><img src=\"/assets/media/exam-media/02675/0026700005.png\" class=\"in-exam-image\"><br>E.<br>",
    "options": [],
    "answer": "D",
    "answerDescription": "datetime2 Defines a date that is combined with a time of day that is based on 24-hour clock. datetime2 can be considered as an extension of the existing datetime type that has a larger date range, a larger default fractional precision, and optional user-specified precision.<br>Incorrect Answers:<br>B, C, E: NEWQSEQUENTIALID creates a GUID that is greater than any GUID previously generated by this function on a specified computer since Windows was started. A GUID uses more space then IDENTITY value.<br>References:<br>https://docs.microsoft.com/en-us/sql/t-sql/data-types/datetime2-transact-sql https://docs.microsoft.com/en-us/sql/t-sql/functions/newsequentialid-transact-sql",
    "votes": [],
    "comments": [
      {
        "date": "2020-05-09T00:53:00.000Z",
        "voteCount": 5,
        "content": "Correct is D"
      },
      {
        "date": "2020-05-29T12:55:00.000Z",
        "voteCount": 2,
        "content": "correct, its int for 4 bytes (least amount of storage) and it has the primary key doing the identifying uniquely the row data."
      },
      {
        "date": "2020-09-14T10:51:00.000Z",
        "voteCount": 3,
        "content": "The correct is D. Besides the fact Datetime2 is standard, you have to set primary key to ensure uniqueness:\nText from (https://docs.microsoft.com/en-us/sql/t-sql/statements/create-table-transact-sql-identity-property?view=sql-server-ver15):\nUniqueness of the value - Uniqueness must be enforced by using a PRIMARY KEY or UNIQUE constraint or UNIQUE index"
      },
      {
        "date": "2020-07-29T16:18:00.000Z",
        "voteCount": 1,
        "content": "E  UNIQUEIdentify"
      },
      {
        "date": "2019-10-19T01:44:00.000Z",
        "voteCount": 2,
        "content": "datetime2 is STANDARD SQL"
      },
      {
        "date": "2019-09-18T12:42:00.000Z",
        "voteCount": 1,
        "content": "I think there should be answer A better :\n\nhttps://www.ibm.com/support/knowledgecenter/SSGU8G_12.1.0/com.ibm.esqlc.doc/ids_esqlc_0190.htm"
      },
      {
        "date": "2019-10-11T15:11:00.000Z",
        "voteCount": 3,
        "content": "I was wrong https://database.guide/datetime-vs-datetime2-in-sql-server-whats-the-difference/"
      },
      {
        "date": "2019-10-21T20:22:00.000Z",
        "voteCount": 1,
        "content": "THERE IS NO PRIMARY KEY DEFINED WHICH UNIQUELY IDENTIFY THE COLUMN"
      },
      {
        "date": "2021-01-18T03:00:00.000Z",
        "voteCount": 1,
        "content": "identity property does that"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 114,
    "url": "https://www.examtopics.com/discussions/microsoft/view/34513-exam-70-761-topic-1-question-114-discussion/",
    "body": "You have a database named DB1 that contains two tables named Sales.Customers and Sales.CustomerTransaction. Sales.CustomerTransactions has a foreign key relationship to column named CustomerID in Sales.Customers.<br>You need to recommend a query that returns the number of customers who never completed a transaction.<br>Which query should you recommend?<br><img src=\"/assets/media/exam-media/02675/0026800001.png\" class=\"in-exam-image\"><br>A.<br><img src=\"/assets/media/exam-media/02675/0026900001.png\" class=\"in-exam-image\"><br>B.<br><img src=\"/assets/media/exam-media/02675/0026900002.png\" class=\"in-exam-image\"><br>C.<br><img src=\"/assets/media/exam-media/02675/0026900003.png\" class=\"in-exam-image\"><br>D.<br>",
    "options": [],
    "answer": "A",
    "answerDescription": "Incorrect Answers:<br>B: The count should be on the Cust instance of Sales.Customers as it is to the right side of the join.<br>C: Need a WHERE statement with an IS NULL clause.<br>D: Must use a LEFT JOIN to obtain the NULL values.<br>References:<br>https://technet.microsoft.com/en-us/library/ms190014(v=sql.105).aspx",
    "votes": [],
    "comments": [
      {
        "date": "2020-12-14T08:31:00.000Z",
        "voteCount": 2,
        "content": "B is wrong.\nYou have to precise the table alias : COUNT(Cust.CustomerID) \nIndeed, the field CustomerID is present in both tables"
      },
      {
        "date": "2020-12-15T11:25:00.000Z",
        "voteCount": 1,
        "content": "Hi Landraille is the update you are doing part of the recent exam"
      },
      {
        "date": "2020-10-14T17:10:00.000Z",
        "voteCount": 1,
        "content": "Typo error here. All the answers are the same"
      },
      {
        "date": "2020-11-23T19:11:00.000Z",
        "voteCount": 2,
        "content": "Only A and B are the exact same answers, the others are different."
      },
      {
        "date": "2020-12-15T07:08:00.000Z",
        "voteCount": 3,
        "content": "Nope. All are different. A and B have different SELECT . No table aliases in B so it's wrong cause there is CustomerID in both tables and if you're using aliases you get error ambigious column name. Must be  Select Count(Cust.CustomerID)"
      },
      {
        "date": "2020-12-15T07:09:00.000Z",
        "voteCount": 1,
        "content": "*   Sorry. .... if you're not using aliases ...."
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 115,
    "url": "https://www.examtopics.com/discussions/microsoft/view/3802-exam-70-761-topic-1-question-115-discussion/",
    "body": "HOTSPOT -<br>Note: This question is part of a series of questions that use the same scenario. For your convenience, the scenario is repeated in each question. Each question presents a different goal and answer choices, but the text of the scenario is exactly the same in each question in this series.<br>You query a database that includes two tables: Project and Task. The Project table includes the following columns:<br><img src=\"/assets/media/exam-media/02675/0027000001.png\" class=\"in-exam-image\"><br>The Task table includes the following columns:<br><img src=\"/assets/media/exam-media/02675/0027000002.png\" class=\"in-exam-image\"><br>Users report performance issues when they run the following query:<br><img src=\"/assets/media/exam-media/02675/0027100001.png\" class=\"in-exam-image\"><br>You need to improve query performance and limit results to projects that specify an end date.<br>How should you complete the Transact-SQL statement? To answer, select the appropriate Transact-SQL segments in the answer area.<br>Hot Area:<br><img src=\"/assets/media/exam-media/02675/0027100002.png\" class=\"in-exam-image\"><br>",
    "options": [],
    "answer": "<img src=\"/assets/media/exam-media/02675/0027200001.png\" class=\"in-exam-image\">",
    "answerDescription": "Wildcard character %: Any string of zero or more characters.<br>For example: If the LIKE '5%' symbol is specified, the Database Engine searches for the number 5 followed by any string of zero or more characters.<br>References:<br>https://docs.microsoft.com/en-us/sql/t-sql/language-elements/like-transact-sql",
    "votes": [],
    "comments": [
      {
        "date": "2021-01-01T16:30:00.000Z",
        "voteCount": 1,
        "content": "Poor performance on search when the side of the predicate with the column being searched has a function - that's the reference to SARG (search argument)"
      },
      {
        "date": "2020-12-15T15:00:00.000Z",
        "voteCount": 2,
        "content": "Answer correct, sargable improve perfomance"
      },
      {
        "date": "2020-11-25T03:45:00.000Z",
        "voteCount": 1,
        "content": "Hello. Correct answer in second block : Where T.name LIKE 'TEST%'."
      },
      {
        "date": "2020-09-02T08:34:00.000Z",
        "voteCount": 2,
        "content": "We have to provide solution for performance issue. \nLeft() is a function and Like is not so, in comparison to LEFT()Funtion, LIKE is more preferable to use."
      },
      {
        "date": "2020-07-05T14:06:00.000Z",
        "voteCount": 1,
        "content": "I think the correct answer is LEFT(expression, length)=TEST, as in the question substring is matching with TEST and TEST% can return any string which starts with TEST."
      },
      {
        "date": "2020-08-19T21:22:00.000Z",
        "voteCount": 1,
        "content": "LEFT modifies the column. If you want to improve performance, you can't modifies the column."
      },
      {
        "date": "2020-03-03T07:24:00.000Z",
        "voteCount": 3,
        "content": "I think the predicate should be T.TaskName like '%TEST%'"
      },
      {
        "date": "2020-04-15T00:58:00.000Z",
        "voteCount": 7,
        "content": "no, string index starts at 1 in sql, and as seen in example you want 1-4 to be like test. no need for wildcard before that as you do not want anything actually in front of TEST"
      },
      {
        "date": "2020-05-29T13:10:00.000Z",
        "voteCount": 1,
        "content": "Correct"
      },
      {
        "date": "2020-07-14T12:45:00.000Z",
        "voteCount": 1,
        "content": "Will T.TaskName like 'TEST' work if the TaskName  starts as  'TESTING'."
      },
      {
        "date": "2020-01-22T03:18:00.000Z",
        "voteCount": 3,
        "content": "About comment avramov:\nTask is to improve the first query with an alternative query that is more performant. The SUBSTRING clause in the original query clearly shows that every Taskname starts with the four letters TASK\n -&gt; solution is correct"
      },
      {
        "date": "2019-11-11T01:16:00.000Z",
        "voteCount": 1,
        "content": "isnt it the second box 'Test' because the Substring states starting from the 1st symbol and continuing to the 4th? i. e. lenght of 4"
      },
      {
        "date": "2020-05-29T13:09:00.000Z",
        "voteCount": 1,
        "content": "if you substring any string first 4 characters its the same as you compare with LIKE (4 characters) %, where % stand for no matter what. So its the second Box"
      },
      {
        "date": "2019-08-19T08:05:00.000Z",
        "voteCount": 2,
        "content": "Is a wild card comparison actually better in performance issues compared to \"LEFT(expression, length) LIKE 'TEST'\"? in opinion it is not. any hints?"
      },
      {
        "date": "2020-11-23T19:21:00.000Z",
        "voteCount": 1,
        "content": "Yes, it is better, because what you don't want to do is apply functions to the column of the table in the WHERE clause, the one you're using to compare, rather have the functions in right side on the word you're comparing your column table to."
      },
      {
        "date": "2019-08-22T23:28:00.000Z",
        "voteCount": 12,
        "content": "Yes. This is related a terminology named Sargable:\nhttps://www.sqlshack.com/how-to-use-sargable-expressions-in-t-sql-queries-performance-advantages-and-examples/"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 116,
    "url": "https://www.examtopics.com/discussions/microsoft/view/3853-exam-70-761-topic-1-question-116-discussion/",
    "body": "Note: This question is part of a series of questions that use the same or similar answer choices. An answer choice may be correct for more than one question in the series. Each question is independent of the other questions in this series. Information and details provided in a question apply only to that question.<br>You have a database that contains tables named Customer_CRMSystem and Customer_HRSystem. Both tables use the following structure:<br><img src=\"/assets/media/exam-media/02675/0027300001.png\" class=\"in-exam-image\"><br>The following records exist in the tables:<br><br>Customer_CRMSystem -<br><img src=\"/assets/media/exam-media/02675/0027300002.png\" class=\"in-exam-image\"><br><br>Customer_HRSystem -<br><img src=\"/assets/media/exam-media/02675/0027300003.png\" class=\"in-exam-image\"><br>Records that contain null values for CustomerCode can be uniquely identified by CustomerName.<br>You need to display distinct customers that appear in both tables.<br>Which Transact-SQL statement should you run?<br><img src=\"/assets/media/exam-media/02675/0027400001.png\" class=\"in-exam-image\"><br>A.<br><img src=\"/assets/media/exam-media/02675/0027400002.png\" class=\"in-exam-image\"><br>B.<br><img src=\"/assets/media/exam-media/02675/0027400003.png\" class=\"in-exam-image\"><br>C.<br><img src=\"/assets/media/exam-media/02675/0027400004.png\" class=\"in-exam-image\"><br>D.<br><img src=\"/assets/media/exam-media/02675/0027400005.png\" class=\"in-exam-image\"><br>E.<br><img src=\"/assets/media/exam-media/02675/0027500001.png\" class=\"in-exam-image\"><br>F.<br><img src=\"/assets/media/exam-media/02675/0027500002.png\" class=\"in-exam-image\"><br>G.<br><img src=\"/assets/media/exam-media/02675/0027500003.png\" class=\"in-exam-image\"><br>H.<br>",
    "options": [],
    "answer": "H",
    "answerDescription": "To retain the nonmatching information by including nonmatching rows in the results of a join, use a full outer join. SQL Server provides the full outer join operator,<br>FULL OUTER JOIN, which includes all rows from both tables, regardless of whether or not the other table has a matching value.<br>Incorrect Answers:<br>A: Inner joins return rows only when there is at least one row from both tables that matches the join condition. Inner joins eliminate the rows that do not match with a row from the other table.<br>B: INTERSECT returns distinct rows that are output by both the left and right input queries operator.<br>D: EXCEPT returns distinct rows from the left input query that aren't output by the right input query.<br>E: UNION specifies that multiple result sets are to be combined and returned as a single result set, but this will not work here as the CustomerID column values do not match.<br>F: UNION ALL incorporates all rows into the results. This includes duplicates. If not specified, duplicate rows are removed.<br>G: A cross join would produce the Cartesian product of the two tables.<br>References:<br>https://technet.microsoft.com/en-us/library/ms187518(v=sql.105).aspx",
    "votes": [],
    "comments": [
      {
        "date": "2019-08-20T05:45:00.000Z",
        "voteCount": 25,
        "content": "In my opinion the correct answer is to use INTERSECT since we only want to see the distinct customers which are in both tables. or do I misunderstand?"
      },
      {
        "date": "2019-08-22T23:33:00.000Z",
        "voteCount": 5,
        "content": "Agree. The JOINs don't match NULLs but set operators do."
      },
      {
        "date": "2019-10-22T16:48:00.000Z",
        "voteCount": 4,
        "content": "INTERSECT WILL ONLY GIVE YOU 3 ROW WHICH ARE COMMON IN BOTH TABLES.\nHOWEVER YOU SHOULD USE UNION TO BRING ALL THE DISTINCT VALUES FROM BOTH TABLE\nUSING UNION WILL GIV YOU 6 ROWS WHICH IS CORREECT ANSWER. THANKS"
      },
      {
        "date": "2020-01-30T02:14:00.000Z",
        "voteCount": 4,
        "content": "I think it depends how u understood the question, which is according my opinion a little bit confusing. I believe they ask for distinct customers across both tables not for each table."
      },
      {
        "date": "2021-01-26T08:08:00.000Z",
        "voteCount": 1,
        "content": "The question asked for names that appear in both tables... (Intersect)"
      },
      {
        "date": "2020-02-05T03:08:00.000Z",
        "voteCount": 1,
        "content": "the answer is correct. Intersect will miss CUS9 YOSSI"
      },
      {
        "date": "2020-07-20T23:32:00.000Z",
        "voteCount": 3,
        "content": "No, INTERSECT will return only 3 rows that appear in both tables: \nNULL Jane\nCUS1 Roya\nCUS9 Yossi\n\nCorrect answer is E using UNION, it will return 6 distinct rows. Answer H with full outer join return 7 rows, as it doubles NULL JANE twice, therefore its not distinct"
      },
      {
        "date": "2020-03-02T06:30:00.000Z",
        "voteCount": 6,
        "content": "INTERSECT is correct, try it yourself:\n\nCREATE TABLE Customer_CRMSystem\n(\n    CustomerID INT NOT NULL PRIMARY KEY NONCLUSTERED,\n    CustomerCode char(4) NULL,\n    CustomerName varchar(50) NOT Null\n)\n\n\nCREATE TABLE Customer_HRSystem\n(\n    CustomerID INT NOT NULL PRIMARY KEY NONCLUSTERED,\n    CustomerCode char(4) NULL,\n    CustomerName varchar(50) NOT Null\n)\n\nSELECT c.CustomerCode, c.CustomerName, h.CustomerCode, h.Customername\nFROM Customer_CRMSystem c\nLEFT JOIN Customer_HRSystem h \nON c.CustomerCode = h.CustomerCode AND c.CustomerName = h.CustomerName\n\nSELECT CustomerCode, CustomerName\nFROM Customer_CRMSystem \nINTERSECT\nSELECT CustomerCode, CustomerName\nFROM Customer_HRSystem"
      },
      {
        "date": "2021-01-18T04:32:00.000Z",
        "voteCount": 1,
        "content": "I'd say intersect has been invented for this to give the distinct values across multiple tables."
      },
      {
        "date": "2021-01-01T16:37:00.000Z",
        "voteCount": 1,
        "content": "INTERSECT is the only option that returns all 4 matching records"
      },
      {
        "date": "2020-12-15T15:08:00.000Z",
        "voteCount": 1,
        "content": "you need customer that appears IN BOTH TABLE if in one table customer not appear YOU DONT NEED HIM.\nCorrect answer is intercept"
      },
      {
        "date": "2020-12-15T07:23:00.000Z",
        "voteCount": 1,
        "content": "The correct is one with INTERSECT .only this gives distinct entities that are presented in both tables."
      },
      {
        "date": "2020-12-14T20:13:00.000Z",
        "voteCount": 1,
        "content": "Hello,\nThe question is asking for DISTINCT customers that appear in both tables,\nand records that contain NULL values for customerCode are uniquely identified by\nCustomerName.\nJust looking at the tables Jane, Roya and Yossi are the three distinct\ncustomers that appear in both. INTERSECT does give distinct cutomers."
      },
      {
        "date": "2020-12-14T20:11:00.000Z",
        "voteCount": 1,
        "content": "Hello,\nThe question is asking for DISTINCT customers that appear in both tables,\nand records that contain NULL values for customer are uniquely identified by\nCustomerName.\nJust looking at the tables Jane, Roya and Yossi are the three distinct\ncustomers that appear in both. INTERSECT does give distinct customers."
      },
      {
        "date": "2020-11-24T14:22:00.000Z",
        "voteCount": 1,
        "content": "I understood using UNION.\nDROP TABLE IF EXISTS Customer_CRMSystem;\nCREATE TABLE Customer_CRMSystem (CustomerID tinyint, CustomerCode char(4), CustomerName varchar(50));\nINSERT INTO Customer_CRMSystem VALUES (\n\t\t\t\t\t\t\t\t\t\t1, 'CUS1', 'Roya')\n\t\t\t\t\t\t\t\t\t\t,(2, 'CUS9', 'Yossi')\n\t\t\t\t\t\t\t\t\t\t,(3, 'CUS4', 'Jack')\n\t\t\t\t\t\t\t\t\t\t,(4, NULL, 'Jane')\n\t\t\t\t\t\t\t\t\t\t,(5, NULL, 'Francisco');\nDROP TABLE IF EXISTS Customer_HRSystem;\nCREATE TABLE Customer_HRSystem (CustomerID tinyint, CustomerCode char(4), CustomerName varchar(50));\nINSERT INTO Customer_HRSystem VALUES (\n\t\t\t\t\t\t\t\t\t\t1, 'CUS1', 'Roya')\n\t\t\t\t\t\t\t\t\t\t,(2, 'CUS2', 'Jose')\n\t\t\t\t\t\t\t\t\t\t,(3, 'CUS9', 'Yossi')\n\t\t\t\t\t\t\t\t\t\t,(4, NULL, 'Jane');\nSELECT CustomerCode, CustomerName\nFROM Customer_CRMSystem\nUNION\nSELECT CustomerCode, CustomerName\nFROM Customer_HRSystem;"
      },
      {
        "date": "2020-08-08T05:57:00.000Z",
        "voteCount": 4,
        "content": "\"You need to display distinct customers that appear in both tables.\"\nINTERSECT is the right answer for this as the 3 customers (Jane, Roya, Yossie) appeared in both tables.\nUNION will return the all distinct customers for each table combined. (All 6 customers)"
      },
      {
        "date": "2020-06-12T16:33:00.000Z",
        "voteCount": 2,
        "content": "the question is too vague, \n\ndeclare @CRMSystem table\n(\nCustomerID INT,\nCustomerCode char(4) NULL,\nCustomerName varchar(50) NOT Null\n)\n\ndeclare @HRSystem table\n(\nCustomerID INT NOT NULL PRIMARY KEY NONCLUSTERED,\nCustomerCode char(4) NULL,\nCustomerName varchar(50) NOT Null\n)\n\nINSERT INTO @CRMSystem(CustomerID, CustomerCode, CustomerName )\nVALUES (1, 'cus1', 'Roya')\n, (2, 'cus9', 'Yossi')\n, (3, 'cus4', 'Jack')\n, (4, null, 'Jane')\n, (5, null, 'Francisco')\n\nINSERT INTO @HRSystem(CustomerID, CustomerCode, CustomerName )\nVALUES (1, 'cus1', 'Roya')\n, (2, 'cus2', 'Jose')\n, (3, 'cus9', 'Yossi')\n, (4, null, 'Jane')\n\n\nSELECT c.CustomerCode, c.CustomerName, h.CustomerCode, h.Customername\nFROM @CRMSystem c\nfull outer JOIN @HRSystem h\nON c.CustomerCode = h.CustomerCode AND c.CustomerName = h.CustomerName\n\nSELECT CustomerCode, CustomerName\nFROM @CRMSystem\nINTERSECT\nSELECT CustomerCode, CustomerName\nFROM @HRSystem"
      },
      {
        "date": "2020-05-29T13:32:00.000Z",
        "voteCount": 2,
        "content": "Correct answer is INTERSECT (B). Tested"
      },
      {
        "date": "2020-02-14T09:43:00.000Z",
        "voteCount": 2,
        "content": "INTERSECT will return values that's distinct from both queries however FULL OUTER JOIN will return customerID=5 which is not in the HR system with NULL so the answer is B."
      },
      {
        "date": "2019-11-19T11:20:00.000Z",
        "voteCount": 5,
        "content": "INTERESCT is the correct answer not sure why this site has mostly incorrect answers.  I've tested this and intersect returns distinct customers that appear in both tables :/"
      },
      {
        "date": "2020-02-08T08:51:00.000Z",
        "voteCount": 12,
        "content": "No,  intersect gives:\nNULL\tJane\nCUS1\tRoya\nCUS9\tYossi\n\nUNION gives:\nNULL\tFrancisco\nNULL\tJane\nCUS1\tRoya\nCUS2\tJose\nCUS4\tJack\nCUS9\tYossi\n\nFor me correct anwser is UNION"
      },
      {
        "date": "2020-07-20T23:27:00.000Z",
        "voteCount": 3,
        "content": "I tested it and confirm, correct answer is E using UNION"
      },
      {
        "date": "2019-11-19T06:54:00.000Z",
        "voteCount": 2,
        "content": "\"distinct customers that appear in both tables\" can have 2 meanings: \n1. distinct customers that appear in both tables\n2. distinct customers for each table\nIn this case, I think they asked \"distinct customers for each table\".."
      },
      {
        "date": "2019-11-19T07:14:00.000Z",
        "voteCount": 3,
        "content": "I was wrong: the question demands \"distinct customers\", and with the FULL OUTER JOIN you don't have that. \n\nSo the right answer is INTERSECT. \n\nAlso INTERSECT also consider the Null Values, and in this case the FULL OUTER JOIN will not consider those values to connect records (and it should)."
      },
      {
        "date": "2019-09-22T02:18:00.000Z",
        "voteCount": 2,
        "content": "I think B"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 117,
    "url": "https://www.examtopics.com/discussions/microsoft/view/5060-exam-70-761-topic-1-question-117-discussion/",
    "body": "DRAG DROP -<br>Note: This question is part of a series of questions that use the same scenario. For your convenience, the scenario is repeated in each question. Each question presents a different goal and answer choices, but the text of the scenario is exactly the same in each question in this series.<br>You query a database that includes two tables: Project and Task. The Project table includes the following columns:<br><img src=\"/assets/media/exam-media/02675/0027600001.png\" class=\"in-exam-image\"><br>The Task table includes the following columns:<br><img src=\"/assets/media/exam-media/02675/0027600002.png\" class=\"in-exam-image\"><br>You need to find all projects that have at least one task that took more than 50 hours to complete. You must also determine the average duration of the tasks that took more that took more than 50 hours to complete for each project.<br>How should you complete the Transact-SQL statement? To answer, drag the appropriate Transact-SQL segments to the correct locations. Each Transact-SQL segment may be used once, more than once or not at all. You may need to drag the split bar between panes or scroll to view content.<br>Select and Place:<br><img src=\"/assets/media/exam-media/02675/0027700001.png\" class=\"in-exam-image\"><br>",
    "options": [],
    "answer": "<img src=\"/assets/media/exam-media/02675/0027800001.png\" class=\"in-exam-image\">",
    "answerDescription": "",
    "votes": [],
    "comments": [
      {
        "date": "2019-09-11T06:59:00.000Z",
        "voteCount": 16,
        "content": "I think the where should be: datediff(hh, t.starttime, t.endtime) &gt; 50"
      },
      {
        "date": "2019-09-19T02:25:00.000Z",
        "voteCount": 1,
        "content": "I think it can be both.\n1. datediff(hh, t.starttime, t.endtime) &gt; 50 is right answer becouse datediff is returning value as INT and INT can be compared with \"&gt;50\"\n2. dateadd(hh, 50, StartTime) &gt; EndTime : logic is right and syntax is quite good too becouse dateadd function returns datetime value and EndTime is datetime value too"
      },
      {
        "date": "2020-07-14T13:01:00.000Z",
        "voteCount": 1,
        "content": "may be the extra bracket at the end in the option is throwing it off. datediff(hh, t.starttime, t.endtime)) &gt; 50"
      },
      {
        "date": "2020-10-24T01:11:00.000Z",
        "voteCount": 5,
        "content": "I do not think the second option is valid. if the task took for instance 70 hours then adding 50 to the begin task will not make it greater than end time."
      },
      {
        "date": "2019-10-19T02:18:00.000Z",
        "voteCount": 3,
        "content": "No! \"t.endtime\" could be null if the task not yet finished."
      },
      {
        "date": "2019-10-19T02:26:00.000Z",
        "voteCount": 2,
        "content": "sorry. is correct datediff(hh, t.starttime, t.endtime) &gt; 50"
      },
      {
        "date": "2020-05-29T13:58:00.000Z",
        "voteCount": 1,
        "content": "And with one bracket :)"
      },
      {
        "date": "2019-09-25T10:10:00.000Z",
        "voteCount": 11,
        "content": "I would say that the correct answer is: datediff(hh, t.starttime, t.endtime) &gt; 50. And it is AVG.. never heard about AVR in SQL server."
      },
      {
        "date": "2020-04-16T03:44:00.000Z",
        "voteCount": 1,
        "content": "Lol, indeed. Didn't even notice."
      },
      {
        "date": "2020-05-29T13:42:00.000Z",
        "voteCount": 1,
        "content": "yes its correct. And tested AVR is not a built-in function. For Average in SQL Server it is AVG function :)"
      },
      {
        "date": "2020-12-15T07:28:00.000Z",
        "voteCount": 1,
        "content": "first of all AVG instead of AVR))... Second  of all it's as M4x said."
      },
      {
        "date": "2020-09-14T22:37:00.000Z",
        "voteCount": 3,
        "content": "The correct answer is datediff(hh, t.starttime, t.endtime &gt; 50 \n\nI did the test bellow and worked:\n\nselect *\ninto #testdif\nfrom (values ( '2020-01-01 1:00' , '2020-01-01 2:00' ),\n( '2020-01-01 1:00' , '2020-02-01 2:00' ),\n( '2020-01-01 1:00' , '2020-01-01 20:00' ),\n( '2020-01-01 1:00' , null ),\n( '2020-01-01 1:00' , '2020-01-01 3:00' )\n) as d (a,b)\n\nselect * from #testdif\nwhere datediff( hh, a,b  ) &gt; 50\n\nTo produce the same result, the operator in the dateadd needs to be \"&lt;\" instead or \"&gt;\", as the example bellow (tested):\n\nselect * from #testdif\nwhere dateadd( hh, 50, a  ) &lt; b"
      },
      {
        "date": "2020-05-21T08:47:00.000Z",
        "voteCount": 1,
        "content": "Nvm, you can do without GROUP BY for one single column of values"
      },
      {
        "date": "2020-05-21T08:31:00.000Z",
        "voteCount": 1,
        "content": "How can you use AVG() if there is no GROUP BY? This question is weird."
      },
      {
        "date": "2019-09-22T20:52:00.000Z",
        "voteCount": 8,
        "content": "I think  datediff(hh, t.starttime, t.endtime) &gt; 50 is correct answer. \n'dateadd(hh, 50, StartTime) &gt; EndTime' doesnt solve the purpose because if task starts for ex- at 23 Sep 2019 13:00 pm  and took 10 hours to complete (which means finished at 23 Sep 2019 23:00 PM). Above logic interpret it something like this - '25 Sep 2019 15:00 pm &gt; 23 Sep 2019 23:00 PM'  which is not correct in this case."
      },
      {
        "date": "2020-02-05T04:03:00.000Z",
        "voteCount": 1,
        "content": "NO. IF the EndTime is NULL, you will get NULL for datediff."
      },
      {
        "date": "2020-03-29T17:40:00.000Z",
        "voteCount": 1,
        "content": "But we cannot even use &gt; to compare NULL value, in this case, dateadd is also wrong."
      },
      {
        "date": "2020-04-16T03:45:00.000Z",
        "voteCount": 1,
        "content": "But the WHERE clause filters for 'IS NOT NULL'. I still think Datediff is the correct answer tho."
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 118,
    "url": "https://www.examtopics.com/discussions/microsoft/view/13271-exam-70-761-topic-1-question-118-discussion/",
    "body": "You have a database named DB1 that contains a temporal table named Sales.Customers.<br>You need to create a query that returns the credit limit that was available to each customer in DB1 at the beginning of 2017.<br>Which query should you execute?<br><img src=\"/assets/media/exam-media/02675/0027900001.png\" class=\"in-exam-image\"><br>A.<br><img src=\"/assets/media/exam-media/02675/0027900002.png\" class=\"in-exam-image\"><br>B.<br><img src=\"/assets/media/exam-media/02675/0027900003.png\" class=\"in-exam-image\"><br>C.<br><img src=\"/assets/media/exam-media/02675/0028000001.png\" class=\"in-exam-image\"><br>D.<br>",
    "options": [],
    "answer": "C",
    "answerDescription": "AS OF: Returns a table with a rows containing the values that were actual (current) at the specified point in time in the past.<br>Incorrect Answers:<br>A, B: CONTAINED IN has two parameters: CONTAINED IN (&lt;start_date_time&gt; , &lt;end_date_time&gt;)<br>References:<br>https://docs.microsoft.com/en-us/sql/relational-databases/tables/querying-data-in-a-system-versioned-temporal-table",
    "votes": [],
    "comments": [
      {
        "date": "2020-02-02T04:48:00.000Z",
        "voteCount": 7,
        "content": "sorry C is correct i didn't look at it properly"
      },
      {
        "date": "2021-01-01T16:45:00.000Z",
        "voteCount": 1,
        "content": "AS OF works. CONTAINED IN also operates only against the history table so if transaction is still the most current, you won't get it (BETWEEN would be better if we had a range)."
      },
      {
        "date": "2021-01-01T16:49:00.000Z",
        "voteCount": 1,
        "content": "Implicit conversion happens on 2017-01-01 to turn that into datetime"
      },
      {
        "date": "2020-12-14T22:39:00.000Z",
        "voteCount": 1,
        "content": "I think C is correct."
      },
      {
        "date": "2020-11-24T16:26:00.000Z",
        "voteCount": 1,
        "content": "None of them work. CONTAINED needs two parameters; AS OF needs exact datetime value not just date part, it won't run. Tested. And ALL is not what we are looking for."
      },
      {
        "date": "2020-12-15T15:18:00.000Z",
        "voteCount": 1,
        "content": "answer is correct"
      },
      {
        "date": "2020-02-02T04:47:00.000Z",
        "voteCount": 1,
        "content": "there as to be a specified year c is wrong"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 119,
    "url": "https://www.examtopics.com/discussions/microsoft/view/39935-exam-70-761-topic-1-question-119-discussion/",
    "body": "DRAG DROP -<br>You have a table named HumanResources.Employee. You configure the table to use a default history table that contains 10 years of data.<br>You need to write a query that retrieves the values of the BusinessEntityID and JobTitle fields. You must retrieve all historical data up to January 1, 2017 where the value of the BusinessEntityID column equals 4.<br>Which four Transact-SQL segments should you use to develop the solution? To answer, move the appropriate Transact-SQL segments to the answer area and arrange them in the correct order.<br>Select and Place:<br><img src=\"/assets/media/exam-media/02675/0028100001.png\" class=\"in-exam-image\"><br>",
    "options": [],
    "answer": "<img src=\"/assets/media/exam-media/02675/0028200001.png\" class=\"in-exam-image\">",
    "answerDescription": "References:<br>https://docs.microsoft.com/en-us/sql/relational-databases/tables/querying-data-in-a-system-versioned-temporal-table",
    "votes": [],
    "comments": [
      {
        "date": "2020-12-15T10:27:00.000Z",
        "voteCount": 1,
        "content": "Correctimundo"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 120,
    "url": "https://www.examtopics.com/discussions/microsoft/view/21599-exam-70-761-topic-1-question-120-discussion/",
    "body": "You need to create a database object that meets the following requirements:<br>\u2711 accepts a product identifies as input<br>calculates the total quantity of a specific product, including quantity on hand and quantity on order<br><img src=\"/assets/media/exam-media/02675/0028200003.png\" class=\"in-exam-image\"><br>\u2711 caches and reuses execution plan<br>\u2711 returns a value<br>\u2711 can be called from within a SELECT statement<br>\u2711 can be used in a JOIN clause<br>What should you create?<br>",
    "options": [
      "<span class=\"multi-choice-letter\" data-choice-letter=\"A\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\ta temporary table that has a columnstore index",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"B\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tB.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\ta user-defined table-valued function",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"C\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tC.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\ta memory-optimized table that has updated statistics",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"D\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tD.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\ta natively-complied stored procedure that has an OUTPUT parameter"
    ],
    "answer": "B",
    "answerDescription": "A table-valued user-defined function can also replace stored procedures that return a single result set. The table returned by a user-defined function can be referenced in the FROM clause of a Transact-SQL statement, but stored procedures that return result sets cannot.<br>References:<br>https://technet.microsoft.com/en-us/library/ms191165(v=sql.105).aspx",
    "votes": [],
    "comments": [
      {
        "date": "2020-08-17T18:19:00.000Z",
        "voteCount": 7,
        "content": "seems more like \"a user-defined scalar function\""
      },
      {
        "date": "2020-12-15T08:02:00.000Z",
        "voteCount": 2,
        "content": "But how would you use scalar function in joins? You can't join a table with a single value."
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 121,
    "url": "https://www.examtopics.com/discussions/microsoft/view/5370-exam-70-761-topic-1-question-121-discussion/",
    "body": "Note: This question is part of a series of questions that present the same scenario. Each question in the series contains a unique solution that might meet the stated goals. Some question sets might have more than one correct solution, while others might not have a correct solution.<br>After you answer a question in this section. You will NOT be able to return to it. As a result, these questions will not appear in the review screen.<br>You create a table named Products by running the following Transact-SQL statement:<br><img src=\"/assets/media/exam-media/02675/0028400001.png\" class=\"in-exam-image\"><br>You have the following stored procedure:<br><img src=\"/assets/media/exam-media/02675/0028400002.png\" class=\"in-exam-image\"><br>You need to modify the stored procedure to meet the following new requirements:<br>\u2711 Insert product records as a single unit of work.<br>\u2711 Return error number 51000 when a product fails to insert into the database.<br>\u2711 If a product record insert operation fails, the product information must not be permanently written to the database.<br>Solution: You run the following Transact-SQL statement:<br><img src=\"/assets/media/exam-media/02675/0028500004.png\" class=\"in-exam-image\"><br>Does the solution meet the goal?<br>",
    "options": [
      "<span class=\"multi-choice-letter\" data-choice-letter=\"A\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tYes",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"B\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tB.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tNo"
    ],
    "answer": "B",
    "answerDescription": "",
    "votes": [],
    "comments": [
      {
        "date": "2019-09-18T02:47:00.000Z",
        "voteCount": 13,
        "content": "If after ROLLBACK TRANSACTION put a semicolon then A is correctly"
      },
      {
        "date": "2019-09-19T11:24:00.000Z",
        "voteCount": 4,
        "content": "No. Becouse Xact_Abort is set to \"ON\" at the begining and when somethink II go wrong then error information II not skip to Catch block"
      },
      {
        "date": "2019-09-19T12:08:00.000Z",
        "voteCount": 3,
        "content": "XACT_ABORT behaves differently when used in a TRY block. Instead of terminating the transaction\nas it does in unstructured error handling, XACT_ABORT transfers control to the CATCH\nblock, and as expected, any error is fatal."
      },
      {
        "date": "2020-02-26T05:51:00.000Z",
        "voteCount": 8,
        "content": "I'm not sure, if this question is maybe really about the semicolon. In the book to this course exactly this scenario won't work because of the missing semicolon. SQL Server would try to rollback a transaction named \"THROW\", which obviously doesn't exist. So if being exact the correct answer would really be \"No\" even if the rest works fine in my eyes."
      },
      {
        "date": "2019-11-19T09:34:00.000Z",
        "voteCount": 10,
        "content": "The answer A with the semicolon works fine.\n\nIF OBJECT_ID('DISTRICTS') IS NOT NULL DROP TABLE DISTRICTS;\n\nCREATE TABLE DISTRICTS(\n\tID_District INT IDENTITY\n\t, DistrictName VARCHAR(255) NOT NULL\n\t, City VARCHAR(2)\n);\n\nINSERT INTO DISTRICTS(DistrictName) VALUES('London')\n-- SELECT * FROM DISTRICTS\n\n\nIF EXISTS(SELECT 1 FROM SYSOBJECTS WHERE NAME = 'InsertDistrict') DROP PROCEDURE InsertDistrict\nGO\n\nCREATE PROCEDURE InsertDistrict\n\t@DistrictName VARCHAR(255)\n\t, @City VARCHAR(255)\nAS\nBEGIN\n\n\tSET XACT_ABORT ON \n\n\tBEGIN TRY\n\n\t\tBEGIN TRANSACTION\n\n\t\tINSERT INTO DISTRICTS(DistrictName, City)\n\t\tVALUES( @DistrictName, @City )\n\n\t\tCOMMIT TRANSACTION\n\n\tEND TRY\n\tBEGIN CATCH\n\n\t\tIF XACT_STATE() &lt;&gt; 0 ROLLBACK TRANSACTION;\n\n\t\tTHROW 51000, 'O registo is wrong.', 1;  \n\n\tEND CATCH\n\t\nEND\nGO\n\nEXEC InsertDistrict 'London', 'Reading'"
      },
      {
        "date": "2019-11-19T09:35:00.000Z",
        "voteCount": 2,
        "content": "XACT_STATE\nIs a scalar function that reports the user transaction state of a current running request.\nIF (XACT_STATE()) = -1  -- If -1, the transaction is uncommittable and should be rolled back.  \nIF (XACT_STATE()) = 1\t-- If 1, the transaction is committable.  \nIF (XACT_STATE()) = 0\t-- XACT_STATE = 0 means there is no transaction and a commit or rollback operation would generate an error."
      },
      {
        "date": "2021-01-18T05:57:00.000Z",
        "voteCount": 1,
        "content": "correct, all requirements would have been met if that semicolon would have been there. Type of mistake plays a big role. compile errors will leave the batch right away. no jumping to catch block.\n\ndrop table #test\ncreate table #test \n(\ncustid varchar(5) not null\n,income money\n)\n\nif object_ID('abort_test','P') IS NOT NULL\ndrop proc abort_test\ngo\ncreate proc abort_test as\nbegin\n\tSET NOCOUNT ON\n\tbegin try\n\t\t\tbegin tran\n\t\t\tinsert into #test (custid, income) values ('A5666', 20000)\n\t\t\tinsert into #test (custid, income) values ('A56666', 20000)\n\t\t\t--select roses from garden\n\t\t\t--select esx , bladiebla from ex dije\n\t\t\tcommit tran\n\tend try\n\tbegin catch\n\t\tprint 'rolling back the tran';\n\t\tif @@trancount &gt; 0 rollback tran;\n\t\tthrow 51000, 'Quite a big mistake', 1;\n\tend catch;\n\tend\n\n\tset xact_abort ON;\n\texec abort_test \n\n\tselect * from #test"
      },
      {
        "date": "2021-01-06T21:23:00.000Z",
        "voteCount": 1,
        "content": "This question is basically a duplicate of question 1"
      },
      {
        "date": "2021-01-08T02:22:00.000Z",
        "voteCount": 1,
        "content": "yes but that's not the answer to the question. so stop adding extra comments which are not needed"
      },
      {
        "date": "2020-12-15T08:15:00.000Z",
        "voteCount": 1,
        "content": "*rollback"
      },
      {
        "date": "2020-12-15T08:15:00.000Z",
        "voteCount": 1,
        "content": "it's not about semicolon . it 's about can we use xact_abort on together with try___catch block. I hear an opinion that exact_abort follback transaction and there is exact_state() that gives zero in catch block so no error mesage is thrown."
      },
      {
        "date": "2020-12-01T07:43:00.000Z",
        "voteCount": 1,
        "content": "if xact_state() &lt;&gt; 0 rollback tans, means its 1 which is commitable or -1 uncommitable. in both cases it will roll back which is not the desired output. we need to rollback if it is -1 or commit if it is 1."
      },
      {
        "date": "2020-09-14T09:55:00.000Z",
        "voteCount": 1,
        "content": "I think the possible reason for no is - you are throwing an user defined error message 'Product cannot be created' which is not asked in the question . \nThe question just says throw 5100."
      },
      {
        "date": "2020-05-21T09:29:00.000Z",
        "voteCount": 2,
        "content": "You can refer to Querying Data with Transact SQL Exam Ref 70-761 page 305"
      },
      {
        "date": "2020-05-21T09:25:00.000Z",
        "voteCount": 1,
        "content": "The correct answer is Yes. You can use XACT_ABORT with TRY-CATCH. When XACT_ABORT is on inside TRY-CATCH, you need to check if @@TRANSCOUNT &gt; 0 or XACT_STATE &lt;&gt; 0. Even if you don't ROLL BACK TRANS, the THROW command will."
      },
      {
        "date": "2020-04-18T23:32:00.000Z",
        "voteCount": 2,
        "content": "Without a semicolon after rollback transaction, that code even doesn't compile."
      },
      {
        "date": "2020-03-26T18:49:00.000Z",
        "voteCount": 3,
        "content": "yes, with the semicolon after rollback tranaction work perfectly"
      },
      {
        "date": "2020-06-03T15:28:00.000Z",
        "voteCount": 1,
        "content": "what if it is NO because of that semicolon? In the end it is wrong"
      },
      {
        "date": "2019-11-11T00:33:00.000Z",
        "voteCount": 1,
        "content": "i think NO, because if there is an error, because xact_abort is on, the tran is already rolled back because of this option ON. there is no need to roll back it again"
      },
      {
        "date": "2020-02-13T11:20:00.000Z",
        "voteCount": 3,
        "content": "xact_abort in try_catch block works different, if there is somethign wrong in try block, and we set xact_abort to ON, then we need to rollback manually, if don't use try_catch, it can be rollback automatically"
      },
      {
        "date": "2019-11-08T07:48:00.000Z",
        "voteCount": 3,
        "content": "I think it met the goal like llray said, tested OK by my side, the XACT_STATE() is -1, so there is a rollbackable transaction, the ROLLBACK transaction works fine."
      },
      {
        "date": "2020-05-29T16:08:00.000Z",
        "voteCount": 1,
        "content": "I tested it too. Even if the IF statement wasn't it will work perfectly."
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 122,
    "url": "https://www.examtopics.com/discussions/microsoft/view/5475-exam-70-761-topic-1-question-122-discussion/",
    "body": "Note: This question is part of a series of questions that present the same scenario. Each question in the series contains a unique solution that might meet the stated goals. Some question sets might have more than one correct solution, while others might not have a correct solution.<br>After you answer a question in this section. You will NOT be able to return to it. As a result, these questions will not appear in the review screen.<br>You create a table named Products by running the following Transact-SQL statement:<br><img src=\"/assets/media/exam-media/02675/0028600001.png\" class=\"in-exam-image\"><br>You have the following stored procedure:<br><img src=\"/assets/media/exam-media/02675/0028700001.png\" class=\"in-exam-image\"><br>You need to modify the stored procedure to meet the following new requirements:<br>\u2711 Insert product records as a single unit of work.<br>\u2711 Return error number 51000 when a product fails to insert into the database.<br>\u2711 If a product record insert operation fails, the product information must not be permanently written to the database.<br>Solution: You run the following Transact-SQL statement:<br><img src=\"/assets/media/exam-media/02675/0028800001.png\" class=\"in-exam-image\"><br>Does the solution meet the goal?<br>",
    "options": [
      "<span class=\"multi-choice-letter\" data-choice-letter=\"A\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tYes",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"B\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tB.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tNo"
    ],
    "answer": "B",
    "answerDescription": "",
    "votes": [],
    "comments": [
      {
        "date": "2019-10-19T04:15:00.000Z",
        "voteCount": 5,
        "content": "THE CORRECT ANSWER IS \"A\" (\"YES\").\nBUT BEFORE YOU MUST CREATED MESSAGE WITH CODE  51000 (SP_ADDMESSAGE  51000,16,'ERROR')"
      },
      {
        "date": "2021-01-18T06:13:00.000Z",
        "voteCount": 1,
        "content": "To me it remains a mystery why you have to end a throw statement like in the previous question with a semicolon and a raiserror apperently doesn't require one."
      },
      {
        "date": "2021-01-06T08:42:00.000Z",
        "voteCount": 1,
        "content": "Although the procedure works, the question is to Throw the 51000 error which has not been created with the things said to be executed. So it would be B. No. If this was created it would work. I've tried executing both and it works"
      },
      {
        "date": "2021-01-01T17:11:00.000Z",
        "voteCount": 1,
        "content": "Works as long as error message 51000 is defined by sp_addmessage"
      },
      {
        "date": "2020-12-15T08:46:00.000Z",
        "voteCount": 1,
        "content": "it works"
      },
      {
        "date": "2020-08-17T13:06:00.000Z",
        "voteCount": 1,
        "content": "I think it is A ('YES') - couldn't think of any error that would actually prevent the rollback if the insert statement was executed and failed"
      },
      {
        "date": "2020-03-10T06:15:00.000Z",
        "voteCount": 1,
        "content": "Please explain why this is B"
      },
      {
        "date": "2020-04-19T23:33:00.000Z",
        "voteCount": 3,
        "content": "XACT_ABORT is off, so if something goes wrong its not guaranteed to actually be caught by the catch block"
      },
      {
        "date": "2020-12-09T06:48:00.000Z",
        "voteCount": 2,
        "content": "Disagree with xd1. \nAnything that would cause XACT_ABORT to \"trigger\" would also be caught by a TRY/BATCH block"
      },
      {
        "date": "2020-02-13T11:56:00.000Z",
        "voteCount": 4,
        "content": "@@TRANCOUNT&gt;0 cannot make sure that all error would go to CATCH block, check the following code, I add string to int on purpose, it can't trigger catch block\nCREATE TABLE #Products(\nProductID INT IDENTITY NOT NULL PRIMARY KEY,\nproductName VARCHAR(100) NULL,\nUnitPrice DECIMAL(18,2) NOT NULL,\nUnitInStock INT NOT NULL,\nUnitsOnOrder INT NULL\n)\n\nCREATE PROC InsertProduct\n@ProductName varchar(100),\n@UnitPrice decimal(18,2),\n@UnitsInStock int,\n@UnitsOnOrder INT\nAS\nBEGIN\n\tBEGIN TRY\n\t\tBEGIN TRANSACTION\n\t\t\tINSERT INTO #Products (productName,UnitPrice,UnitInStock,UnitsOnOrder)\n\t\t\tVALUES (@ProductName,@UnitPrice,@UnitsInStock,@UnitsOnOrder)\n\t\tCOMMIT TRANSACTION\n\tEND TRY\n\tBEGIN CATCH\n\t\tIF @@TRANCOUNT&gt;0 ROLLBACK TRANSACTION\n\t\tRAISERROR(51000,16,1)\n\tEND CATCH\nEND\t\n\nEXEC InsertProduct 'Book',30,'LOL',3\nSELECT * FROM #Products"
      },
      {
        "date": "2020-05-29T16:14:00.000Z",
        "voteCount": 2,
        "content": "So, you mean the answer is NO?"
      },
      {
        "date": "2020-08-17T13:10:00.000Z",
        "voteCount": 1,
        "content": "You create an error actually before calling the sp itself so what error should the catch block catch?"
      },
      {
        "date": "2020-09-03T16:00:00.000Z",
        "voteCount": 1,
        "content": "if you invoke your stored procedure let's say \nEXEC InsertProduct 'Book',30,NULL,3\n\nit actually caught by the catch block with raise the error."
      },
      {
        "date": "2020-12-09T06:42:00.000Z",
        "voteCount": 1,
        "content": "I think this is a pointless example. The stored procedure will fail to execute, not that the insert will fail and need to be handled."
      },
      {
        "date": "2019-11-10T21:20:00.000Z",
        "voteCount": 2,
        "content": "By defaut XABORT will be OFF.\nhttps://docs.microsoft.com/en-us/sql/t-sql/statements/set-xact-abort-transact-sql?view=sql-server-ver15"
      },
      {
        "date": "2020-12-09T06:39:00.000Z",
        "voteCount": 1,
        "content": "While this statement is correct, you don't give any clue as to why you think it's relevant. \nTRY/CATCH will work regardless of the XABORT setting"
      },
      {
        "date": "2021-01-18T06:11:00.000Z",
        "voteCount": 1,
        "content": "unless you make a compile error such as selecting from a non existing table"
      },
      {
        "date": "2019-09-19T12:22:00.000Z",
        "voteCount": 4,
        "content": "do not know why this should not work. @@TRANCOUNT is equal to 1 in case of error occurs. Only thing is that the ErrorMsg is not assigned to 51000 ErrorId..."
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 123,
    "url": "https://www.examtopics.com/discussions/microsoft/view/3806-exam-70-761-topic-1-question-123-discussion/",
    "body": "You have a database that contains the following tables:<br><br>Customer -<br><img src=\"/assets/media/exam-media/02675/0028900001.png\" class=\"in-exam-image\"><br><br>CustomerAudit -<br><img src=\"/assets/media/exam-media/02675/0028900002.png\" class=\"in-exam-image\"><br>Where the value of the CustomerID column equals 3, you need to update the value of the CreditLimit column to 1000 for the customer. You must ensure that the change to the record in the Customer table is recorded on the CustomerAudit table.<br>Which Transact-SQL statement should you run?<br><img src=\"/assets/media/exam-media/02675/0029000001.png\" class=\"in-exam-image\"><br>",
    "options": [
      "<span class=\"multi-choice-letter\" data-choice-letter=\"A\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tOption A",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"B\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tB.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tOption B",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"C\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tC.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tOption C",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"D\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tD.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tOption D"
    ],
    "answer": "A",
    "answerDescription": "The OUTPUT Clause returns information from, or expressions based on, each row affected by an INSERT, UPDATE, DELETE, or MERGE statement. These results can be returned to the processing application for use in such things as confirmation messages, archiving, and other such application requirements. The results can also be inserted into a table or table variable. Additionally, you can capture the results of an OUTPUT clause in a nested INSERT, UPDATE, DELETE, or MERGE statement, and insert those results into a target table or view.<br>Note: If the column modified by the .RITE clause is referenced in an OUTPUT clause, the complete value of the column, either the before image in deleted.column_name or the after image in inserted.column_name, is returned to the specified column in the tablevariable.<br>Incorrect Answers:<br>D: The deleted.Creditlimit should be inserted in the second column, the OldCreditLimit column, not the third column.<br>References:<br>https://msdn.microsoft.com/en-us/library/ms177564.aspx",
    "votes": [],
    "comments": [
      {
        "date": "2019-08-19T08:21:00.000Z",
        "voteCount": 42,
        "content": "No, I think the correct answer is B since the OUTPUT parameters do not fit the insert into parameters. in addition, the inserted values are incorrect (deleted for both old and new credit limit)"
      },
      {
        "date": "2019-09-23T07:43:00.000Z",
        "voteCount": 8,
        "content": "B is correct"
      },
      {
        "date": "2021-01-17T03:53:00.000Z",
        "voteCount": 1,
        "content": "d is correct"
      },
      {
        "date": "2021-01-07T08:43:00.000Z",
        "voteCount": 1,
        "content": "Most correct is B."
      },
      {
        "date": "2020-12-22T15:05:00.000Z",
        "voteCount": 1,
        "content": "I did the exam today and this question was on there. However there was an option where the parameter for OldCreditLimit was deleted.CreditLimit and the parameter for NewCreditLimit was inserted.CreditLimit . I had to read the answers carefully as there was another option where both these parameters were deleted.CreditLimit"
      },
      {
        "date": "2020-07-21T00:48:00.000Z",
        "voteCount": 1,
        "content": "B. is correct. \n\nA Can't be correct because it wants to INSERT deleted.CreditLimit (old credit limit) into NewCreditLimit column, which is false. Also A will produce error since there is no value defined for \"ChangedBy\" column"
      },
      {
        "date": "2020-07-09T11:23:00.000Z",
        "voteCount": 1,
        "content": "B is correct"
      },
      {
        "date": "2020-04-15T06:50:00.000Z",
        "voteCount": 1,
        "content": "The answer is B :\nvalues for oldCreditLimit &amp; newCreditLimit must come form correct inserted/ deleted values and also  the changedBy value must be supplied... whihc it isn't in A"
      },
      {
        "date": "2020-04-13T05:58:00.000Z",
        "voteCount": 1,
        "content": "B is the correct one."
      },
      {
        "date": "2020-03-26T19:25:00.000Z",
        "voteCount": 2,
        "content": "B is correct, but it is not neccesary to put the two default parameters values, because the are created automatcally"
      },
      {
        "date": "2020-03-04T04:17:00.000Z",
        "voteCount": 2,
        "content": "B is correct and straightforward."
      },
      {
        "date": "2020-02-17T08:48:00.000Z",
        "voteCount": 2,
        "content": "B is the correct answer."
      },
      {
        "date": "2019-11-20T00:44:00.000Z",
        "voteCount": 3,
        "content": "B is correct,"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 124,
    "url": "https://www.examtopics.com/discussions/microsoft/view/13610-exam-70-761-topic-1-question-124-discussion/",
    "body": "You have a database for a banking system. The database has two tables named tblDepositAcct and tblLoanAcct that store deposit and loan accounts, respectively. Both tables contain the following columns:<br><img src=\"/assets/media/exam-media/02675/0029100001.png\" class=\"in-exam-image\"><br>You need to determine the total number of customers who have only deposit accounts.<br>Which Transact-SQL statement should you run?<br><img src=\"/assets/media/exam-media/02675/0029300001.png\" class=\"in-exam-image\"><br>",
    "options": [
      "<span class=\"multi-choice-letter\" data-choice-letter=\"A\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tOption A",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"B\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tB.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tOption B",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"C\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tC.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tOption C",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"D\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tD.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tOption D",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"E\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tE.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tOption E",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"F\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tF.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tOption F",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"G\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tG.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tOption G",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"H\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tH.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tOption H"
    ],
    "answer": "F",
    "answerDescription": "References:<br>https://docs.microsoft.com/en-us/sql/t-sql/language-elements/set-operators-except-and-intersect-transact-sql?view=sql-server-2017",
    "votes": [],
    "comments": [
      {
        "date": "2020-02-13T12:26:00.000Z",
        "voteCount": 18,
        "content": "F is \n\nSELECT COUNT(*)\nFROM (SELECT CustNo\nFROM tblDepositAcct\nEXCEPT\nSELECT CustNo\nFROM tblLoanAcct) R"
      },
      {
        "date": "2020-02-08T11:07:00.000Z",
        "voteCount": 10,
        "content": "Can't see the all answer, but if there is any with except, is the one i choose"
      },
      {
        "date": "2020-02-18T15:17:00.000Z",
        "voteCount": 1,
        "content": "None of the answers are correct. The except does not filter out duplicates in tblDepositAcct (needs distinct), so count(*) would be wrong."
      },
      {
        "date": "2020-02-25T06:31:00.000Z",
        "voteCount": 11,
        "content": "The except DOES filter out duplicates."
      },
      {
        "date": "2020-12-15T08:54:00.000Z",
        "voteCount": 2,
        "content": "it's hardly seen but something like EXCEPT in F, it's correct though."
      },
      {
        "date": "2020-07-21T00:50:00.000Z",
        "voteCount": 8,
        "content": "F. is correct.\n\nAll answers:\nA.\nSELECT COUNT(*)\nFROM (SELECT AcctNo\nFROM tblDepositAcct\nINTERSECT\nSELECT AcctNo\nFROM tblLoanAcct) R\n\nB.\nSELECT COUNT(*)\nFROM (SELECT CustNo\nFROM tblDepositAcct\nUNION\nSELECT CustNo\nFROM tblLoanAcct) R\n\nC.\nSELECT COUNT(*)\nFROM (SELECT CustNoFROM tblDepositAcct\nUNION ALL\nSELECT CustNo\nFROM tblLoanAcct) R\n\nD.\nSELECT COUNT (DISTINCT D.CustNo)\nFROM tblDepositAcctD, tblLoanAcct L\nWHERE D.CustNo = L.CustNo\n\nE.\nSELECT COUNT(DISTINCT L.CustNo)\nFROM tblDepositAcct D\nRIGHT JOIN tblLoanAcct L ON D.CustNo = L.CustNo\nWHERE D.CustNo IS NULL\n\nF.\nSELECT COUNT(*)\nFROM (SELECT CustNo\nFROM tblDepositAcct\nEXCEPT\nSELECT CustNo\nFROM tblLoanAcct) R\n\nG.\nSELECT COUNT (DISTINCT COALESCE(D.CustNo, L.CustNo))\nFROM tblDepositAcct D\nFULL JOIN tblLoanAcct L ON D.CustNo = L.CustNo\nWHERE D.CustNo IS NULL OR L.CustNo IS NULL\n\nH.\nSELECT COUNT(*)\nFROM tblDepositAcct D\nFULL JOIN tblLoanAcct L ON D.CustNo = L.CustNo"
      },
      {
        "date": "2020-06-25T11:02:00.000Z",
        "voteCount": 1,
        "content": "F is correct, EXCEPT and INTERSECT remove duplicates"
      },
      {
        "date": "2020-02-20T07:03:00.000Z",
        "voteCount": 5,
        "content": "E is wrong, because the right table is loanAcc and we are looking for DepositAcct"
      },
      {
        "date": "2020-02-17T08:58:00.000Z",
        "voteCount": 2,
        "content": "Answer: E\nExplanation:\nThe RIGHT JOIN keyword returns all records from the right table (table2), and the matched records from the left table (table1). The result is NULL from the left side, when there is no match."
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 125,
    "url": "https://www.examtopics.com/discussions/microsoft/view/13611-exam-70-761-topic-1-question-125-discussion/",
    "body": "Note: This question is part of a series of questions that present the same scenario. Each question in the series contains a unique solution that might meet the stated goals. Some question sets might have more than one correct solution, while others might not have a correct solution.<br>After you answer a question in this section. You will NOT be able to return to it. As a result, these questions will not appear in the review screen.<br>You have a table named Products that stores information about products your company sells. The table has a column named ListPrice that stores retail pricing information for products.<br>Some products are used only internally by the company. Records for these products are maintained in the Products table for inventory purposes. The price for each of these products is $0.00. Customers are not permitted to order these products.<br>You need to increase the list price for products that cost less than $100 by 10 percent. You must only increase pricing for products that customers are permitted to order.<br>Solution: You run the following Transact-SQL statement:<br><img src=\"/assets/media/exam-media/02675/0029500001.png\" class=\"in-exam-image\"><br>Does the solution meet the goal?<br>",
    "options": [
      "<span class=\"multi-choice-letter\" data-choice-letter=\"A\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tYes",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"B\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tB.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tNo"
    ],
    "answer": "B",
    "answerDescription": "Mathematical equation will only return 10 % of the value.",
    "votes": [],
    "comments": [
      {
        "date": "2021-01-01T17:19:00.000Z",
        "voteCount": 1,
        "content": "Answer is definitely A. .1 * 0 is still 0 so it won't affect internal products. It isn't elegant but works"
      },
      {
        "date": "2021-01-01T17:20:00.000Z",
        "voteCount": 1,
        "content": "How do I delete a comment - just saw that it isn't 1.1 - man, gotta pay attention!!"
      },
      {
        "date": "2020-07-21T00:56:00.000Z",
        "voteCount": 3,
        "content": "Answer is B.No.\nIt will return 10% of value. It wont't impact 0 tho. If the query would use 1.1 instead of 0.1 than it would be correct."
      },
      {
        "date": "2020-03-10T05:17:00.000Z",
        "voteCount": 1,
        "content": "Non, la r\u00e9ponse est A, car les prix \u00e0 0 ne seront pas impact\u00e9s: 0*0.01=0"
      },
      {
        "date": "2020-03-04T04:23:00.000Z",
        "voteCount": 2,
        "content": "How does this even test anything in SQL. Why are we tested in mathematics.   I see so many queries in list price increase. None is really correct. or the question is ambiguous."
      },
      {
        "date": "2020-02-13T03:41:00.000Z",
        "voteCount": 2,
        "content": "0 price products are not permitted, So their price will not get updated when we multiply. So we  have to multiply by 1.1"
      },
      {
        "date": "2020-02-11T03:19:00.000Z",
        "voteCount": 4,
        "content": "But 0*.1=0, so the price of the 0$ products will not be increased (which may meet the requirements)."
      },
      {
        "date": "2020-02-08T11:11:00.000Z",
        "voteCount": 2,
        "content": "I can't see none filter for \"You must only increase pricing for products that customers are permitted to order.\""
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 126,
    "url": "https://www.examtopics.com/discussions/microsoft/view/13137-exam-70-761-topic-1-question-126-discussion/",
    "body": "Note: This question is part of a series of questions that present the same scenario. Each question in the series contains a unique solution that might meet the stated goals. Some question sets might have more than one correct solution, while others might not have a correct solution.<br>After you answer a question in this section. You will NOT be able to return to it. As a result, these questions will not appear in the review screen.<br>You have a table that was created by running the following Transact-SQL statement:<br><img src=\"/assets/media/exam-media/02675/0029500002.png\" class=\"in-exam-image\"><br>The Products table includes the data shown in the following table:<br><img src=\"/assets/media/exam-media/02675/0029600001.png\" class=\"in-exam-image\"><br>TotalUnitPrice is calculated by using the following formula:<br>TotalUnitPrice = UnitPrice * (UnitsInStock + UnitsOnOrder)<br>You need to ensure that the value returned for TotalUnitPrice for ProductB is equal to 600.00.<br>Solution: You run the following Transact-SQL statement:<br><img src=\"/assets/media/exam-media/02675/0029600002.png\" class=\"in-exam-image\"><br>Does the solution meet the goal?<br>",
    "options": [
      "<span class=\"multi-choice-letter\" data-choice-letter=\"A\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tYes",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"B\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tB.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tNo"
    ],
    "answer": "B",
    "answerDescription": "",
    "votes": [],
    "comments": [
      {
        "date": "2020-01-30T09:40:00.000Z",
        "voteCount": 9,
        "content": "NULL should be 0"
      },
      {
        "date": "2020-03-04T04:25:00.000Z",
        "voteCount": 9,
        "content": "be careful with a similar question where NULL is replaced by 0 correctly.  Watch out carefully"
      },
      {
        "date": "2020-11-25T11:23:00.000Z",
        "voteCount": 1,
        "content": "math operations with null, it will be null and coalesce(null, null) not evaluate"
      },
      {
        "date": "2020-02-20T07:09:00.000Z",
        "voteCount": 5,
        "content": "unfortunately no. Select 20+NULL will result NULL"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 127,
    "url": "https://www.examtopics.com/discussions/microsoft/view/15962-exam-70-761-topic-1-question-127-discussion/",
    "body": "Note: This question is part of a series of questions that present the same scenario. Each question in the series contains a unique solution that might meet the stated goals. Some question sets might have more than one correct solution, while others might not have a correct solution.<br>After you answer a question in this section. You will NOT be able to return to it. As a result, these questions will not appear in the review screen.<br>You create a table named Customer by running the following Transact-SQL statement:<br><img src=\"/assets/media/exam-media/02675/0029700001.png\" class=\"in-exam-image\"><br>You must insert the following data into the Customer table:<br><img src=\"/assets/media/exam-media/02675/0029700002.png\" class=\"in-exam-image\"><br>You need to ensure that both records are inserted or neither record is inserted.<br>Solution: You run the following Transact-SQL statement:<br><img src=\"/assets/media/exam-media/02675/0029700003.png\" class=\"in-exam-image\"><br>Does the solution meet the goal?<br>",
    "options": [
      "<span class=\"multi-choice-letter\" data-choice-letter=\"A\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tYes",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"B\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tB.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tNo"
    ],
    "answer": "B",
    "answerDescription": "Reference:<br>https://docs.microsoft.com/it-it/sql/t-sql/statements/insert-transact-sql?view=sql-server-2017",
    "votes": [],
    "comments": [
      {
        "date": "2020-12-15T23:04:00.000Z",
        "voteCount": 2,
        "content": "It is true I agree with 'Hoglet' , even if you can successfully insert the given two lines, if  you want to achieve \"All or none\" insert....you must think Transactions as in BEGIN TRAN, and COMMIT or ROLLBACK. I think B is the right answer."
      },
      {
        "date": "2020-11-25T11:38:00.000Z",
        "voteCount": 1,
        "content": "the question is 'ensure that both records are inserted or neither record is inserted.'\nTested on MSSM, both are inserted, so the answer is A"
      },
      {
        "date": "2020-12-09T05:52:00.000Z",
        "voteCount": 1,
        "content": "And if the transaction log fills up and the 2nd insert won't work?\nThe question is looking for an understanding of TRANSACTIONS"
      },
      {
        "date": "2020-07-21T00:59:00.000Z",
        "voteCount": 2,
        "content": "Both insert statements are executed seperately, so failure of one won't impact another. The answer is B.No."
      },
      {
        "date": "2020-03-09T08:26:00.000Z",
        "voteCount": 2,
        "content": "because  if row 1 is true and row 2 false , row 1 ultil inserted in database"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 128,
    "url": "https://www.examtopics.com/discussions/microsoft/view/3884-exam-70-761-topic-1-question-128-discussion/",
    "body": "Note: This question is part of a series of questions that present the same scenario. Each question in the series contains a unique solution that might meet the stated goals. Some question sets might have more than one correct solution, while others might not have a correct solution.<br>After you answer a question in this section. You will NOT be able to return to it. As a result, these questions will not appear in the review screen.<br>You have a database that contains a single table named tblVehicleRegistration. The table is defined as follows:<br><img src=\"/assets/media/exam-media/02675/0029800001.png\" class=\"in-exam-image\"><br>You run the following query:<br><img src=\"/assets/media/exam-media/02675/0029800002.png\" class=\"in-exam-image\"><br>The query output window displays the following error message: \"Conversion failed when converting the varchar value \"\u02dcAB012' to data type int.\"<br>You need to resolve the error.<br>Solution: You modify the Transact-SQL statement as follows:<br><img src=\"/assets/media/exam-media/02675/0029900001.png\" class=\"in-exam-image\"><br>Does the solution meet the goal?<br>",
    "options": [
      "<span class=\"multi-choice-letter\" data-choice-letter=\"A\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tYes",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"B\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tB.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tNo"
    ],
    "answer": "B",
    "answerDescription": "https://docs.microsoft.com/en-us/sql/t-sql/functions/cast-and-convert-transact-sql?view=sql-server-2017",
    "votes": [],
    "comments": [
      {
        "date": "2019-08-21T04:48:00.000Z",
        "voteCount": 29,
        "content": "IMO the correct answer is A since the data type of the RegistrationNumber = varchar(5) and the predicate value is explicitely casted as well to varchar(5), thus no errors should occur"
      },
      {
        "date": "2019-08-23T00:09:00.000Z",
        "voteCount": 5,
        "content": "Agree."
      },
      {
        "date": "2019-09-23T10:15:00.000Z",
        "voteCount": 11,
        "content": "Agree A is correct. Tested\nDROP TABLE IF EXISTS tblVehicleRegistration\nCREATE TABLE tblVehicleRegistration\n(\n\tVehicleID\t\t\tint,\n\tRegistrationNumber\tvarchar(5), \n\tRegistrationDate\tdate, \n\tUserId\t\t\t\tint\n)\n\nINSERT INTO tblVehicleRegistration\n\tVALUES\n\t\t(1,'20012', GETDATE(),1)\n\nSELECT UserId\nFROM tblVehicleRegistration\nWHERE RegistrationNumber = CAST(20012 AS varchar(5))\nAND RegistrationDate &gt; '2016-01-01'"
      },
      {
        "date": "2021-01-21T10:35:00.000Z",
        "voteCount": 1,
        "content": "I think we should use CAST to INT, hence the error message is: \"Conversion failed when converting the varchar value \"\u02dcAB012' to data type int.\""
      },
      {
        "date": "2021-01-01T17:33:00.000Z",
        "voteCount": 1,
        "content": "correct"
      },
      {
        "date": "2020-12-15T09:12:00.000Z",
        "voteCount": 1,
        "content": "Precedence of  INT is higher than char so Explicit conversion is need . I think the answer is A"
      },
      {
        "date": "2020-09-19T07:19:00.000Z",
        "voteCount": 4,
        "content": "Answer is A - and taking your examples bellow modifying it to be more...correct example:\n\nDROP TABLE IF EXISTS tblVehicleRegistration\nCREATE TABLE tblVehicleRegistration\n(\n\tVehicleID\t\t\tint,\n\tRegistrationNumber\tvarchar(5), \n\tRegistrationDate\tdate, \n\tUserId\t\t\t\tint\n)\n\nINSERT INTO tblVehicleRegistration\n\tVALUES\n\t\t(1,'20012', GETDATE(),1),\n\t\t(2,'AB012', GETDATE(),2) -- text record added as well\n\nSELECT UserId\nFROM tblVehicleRegistration\nWHERE RegistrationNumber = CAST(20012 AS varchar(5))\nAND RegistrationDate &gt; '2016-01-01'"
      },
      {
        "date": "2020-07-21T01:09:00.000Z",
        "voteCount": 2,
        "content": "Answer is A. Yes. Tested it.\n\ncreate table tblvehicleregistration\n(vehicleid int identity(1,1)\n,registrationnumber varchar(5)\n,registrationdate date\n,userid int\n)\nselect * from tblvehicleregistration\ninsert into tblvehicleregistration\nvalues\n('20012', getdate(), '1')\nselect userid from tblvehicleregistration\nwhere registrationnumber = cast(20012 as varchar(5))\nand registrationdate &gt; '2016-01-01'"
      },
      {
        "date": "2020-06-24T08:44:00.000Z",
        "voteCount": 1,
        "content": "SELECT CONVERT(int, 25.65);\n\nSELECT CAST('2017-08-25' AS datetime);"
      },
      {
        "date": "2020-02-06T13:04:00.000Z",
        "voteCount": 4,
        "content": "Place literal quotes '12345' and it will work."
      },
      {
        "date": "2019-12-20T13:45:00.000Z",
        "voteCount": 1,
        "content": "B is correct. Despite solution fixed reg. number's problem, the date still must be converted"
      },
      {
        "date": "2020-02-26T06:43:00.000Z",
        "voteCount": 6,
        "content": "No, because '2016-01-01' will be implicitly and correctly converted to the datatype DATE. Solution tested on SQL Server 2016. Answer A is correct."
      },
      {
        "date": "2019-11-20T01:36:00.000Z",
        "voteCount": 2,
        "content": "B is correct as the from DB needs to come after the cast function"
      },
      {
        "date": "2020-03-04T04:33:00.000Z",
        "voteCount": 1,
        "content": "no. There is a FROM clause in first line.  A is correct"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 129,
    "url": "https://www.examtopics.com/discussions/microsoft/view/3885-exam-70-761-topic-1-question-129-discussion/",
    "body": "Note: This question is part of a series of questions that present the same scenario. Each question in the series contains a unique solution that might meet the stated goals. Some question sets might have more than one correct solution, while others might not have a correct solution.<br>After you answer a question in this section. You will NOT be able to return to it. As a result, these questions will not appear in the review screen.<br>You have a database that contains a single table named tblVehicleRegistration. The table is defined as follows:<br><img src=\"/assets/media/exam-media/02675/0029900002.png\" class=\"in-exam-image\"><br>You run the following query:<br><img src=\"/assets/media/exam-media/02675/0030000001.png\" class=\"in-exam-image\"><br>The query output window displays the following error message: \"Conversion failed when converting the varchar value \"\u02dcAB012' to data type int.\"<br>You need to resolve the error.<br>Solution: You modify the Transact-SQL statement as follows:<br><img src=\"/assets/media/exam-media/02675/0030000002.png\" class=\"in-exam-image\"><br>Does the solution meet the goal?<br>",
    "options": [
      "<span class=\"multi-choice-letter\" data-choice-letter=\"A\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tYes",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"B\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tB.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tNo"
    ],
    "answer": "B",
    "answerDescription": "",
    "votes": [],
    "comments": [
      {
        "date": "2019-08-21T04:50:00.000Z",
        "voteCount": 25,
        "content": "the correct answer shouuld be A since the int is implicitey casted by the ' '."
      },
      {
        "date": "2019-09-23T10:17:00.000Z",
        "voteCount": 17,
        "content": "the correct answer is A"
      },
      {
        "date": "2021-01-26T02:08:00.000Z",
        "voteCount": 1,
        "content": "The answer to these questions is confusing since the message says that it cannot convert from a varchar to an INT type, that operation is not being done at any time during the query, so the answers would be NO.\nit's confusing."
      },
      {
        "date": "2020-12-22T10:08:00.000Z",
        "voteCount": 1,
        "content": "Tested.. It's A the CORRECT answer."
      },
      {
        "date": "2020-10-10T05:27:00.000Z",
        "voteCount": 1,
        "content": "Who give answers in this web ??? \nB    -----------XD"
      },
      {
        "date": "2020-07-21T01:11:00.000Z",
        "voteCount": 2,
        "content": "Correct answer is A.Yes, tested it.\n\ncreate table tblvehicleregistration\n(vehicleid int identity(1,1)\n,registrationnumber varchar(5)\n,registrationdate date\n,userid int\n)\nselect * from tblvehicleregistration\ninsert into tblvehicleregistration\nvalues\n('20012', getdate(), '1')\nselect userid from tblvehicleregistration\nwhere registrationnumber = '20012'\nand registrationdate &gt; '2016-01-01'"
      },
      {
        "date": "2020-05-29T16:54:00.000Z",
        "voteCount": 2,
        "content": "its A. Tested"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 130,
    "url": "https://www.examtopics.com/discussions/microsoft/view/15410-exam-70-761-topic-1-question-130-discussion/",
    "body": "Note: This question is part of a series of questions that present the same scenario. Each question in the series contains a unique solution that might meet the stated goals. Some question sets might have more than one correct solution, while others might not have a correct solution.<br>After you answer a question in this section. You will NOT be able to return to it. As a result, these questions will not appear in the review screen.<br>You have a database that contains a single table named tblVehicleRegistration. The table is defined as follows:<br><img src=\"/assets/media/exam-media/02675/0030100001.png\" class=\"in-exam-image\"><br>You run the following query:<br><img src=\"/assets/media/exam-media/02675/0030100002.png\" class=\"in-exam-image\"><br>The query output window displays the following error message: \"Conversion failed when converting the varchar value \"\u02dcAB012' to data type int.\"<br>You need to resolve the error.<br>Solution: You modify the Transact-SQL statement as follows:<br><img src=\"/assets/media/exam-media/02675/0030100003.png\" class=\"in-exam-image\"><br>Does the solution meet the goal?<br>",
    "options": [
      "<span class=\"multi-choice-letter\" data-choice-letter=\"A\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tYes",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"B\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tB.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tNo"
    ],
    "answer": "B",
    "answerDescription": "",
    "votes": [],
    "comments": [
      {
        "date": "2020-03-04T04:35:00.000Z",
        "voteCount": 6,
        "content": "The conversion error happens in Registration Number which is not fixed. Registration date doesnt matter here"
      },
      {
        "date": "2020-05-29T16:58:00.000Z",
        "voteCount": 1,
        "content": "but it works when tested. Any idea?"
      },
      {
        "date": "2020-07-21T01:14:00.000Z",
        "voteCount": 6,
        "content": "Correct answer is B. No, because it will throw conversion error on line #2. If value 20012 would be quoted or convereted, query would work. Tested it.\n\nThis would work:\nselect userid from tblvehicleregistration\nwhere registrationnumber = '20012'\nand registrationdate &gt; CONVERT(DATE, '2016-01-01', 120)\n\nRegistrationNumber = 20012 throws error."
      },
      {
        "date": "2020-11-24T12:31:00.000Z",
        "voteCount": 2,
        "content": "It works even without quotes for registration no due to implicit conversion , it\u2019s A I tested"
      },
      {
        "date": "2021-01-18T07:35:00.000Z",
        "voteCount": 1,
        "content": "Answer A is just fine. Tested it."
      },
      {
        "date": "2021-01-01T17:35:00.000Z",
        "voteCount": 1,
        "content": "B is correct - @BabyBee there is no implicit conversion in the WHERE clause - look 2 questions back"
      },
      {
        "date": "2020-12-22T10:11:00.000Z",
        "voteCount": 1,
        "content": "Tested..B is CORRECT answer."
      },
      {
        "date": "2020-11-25T11:46:00.000Z",
        "voteCount": 1,
        "content": "The query runs fine as there is an implicit conversion from Int to String @ RegistrationNumber = 20012, and the date is also fine. Think answer is A."
      },
      {
        "date": "2020-11-10T20:32:00.000Z",
        "voteCount": 2,
        "content": "A is Correct"
      },
      {
        "date": "2020-05-29T16:57:00.000Z",
        "voteCount": 1,
        "content": "it seems to be OK. I tested and it is A"
      },
      {
        "date": "2020-12-15T09:33:00.000Z",
        "voteCount": 2,
        "content": "it can't  be ok . because registration number accepts only letter and numbers so it's string You can't filter string with integer because it has higher precedence level."
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 131,
    "url": "https://www.examtopics.com/discussions/microsoft/view/15411-exam-70-761-topic-1-question-131-discussion/",
    "body": "Note: This question is part of a series of questions that present the same scenario. Each question in the series contains a unique solution that might meet the stated goals. Some question sets might have more than one correct solution, while others might not have a correct solution.<br>After you answer a question in this section. You will NOT be able to return to it. As a result, these questions will not appear in the review screen.<br>You have a table named Products that stores information about products your company sells. The table has a column named ListPrice that stores retail pricing information for products.<br>Some products are used only internally by the company. Records for these products are maintained in the Products table for inventory purposes. The price for each of these products is $0.00. Customers are not permitted to order these products.<br>You need to increase the list price for products that cost less than $100 by 10 percent. You must only increase pricing for products that customers are permitted to order.<br>Solution: You run the following Transact-SQL statement:<br><img src=\"/assets/media/exam-media/02675/0030200001.png\" class=\"in-exam-image\"><br>Does the solution meet the goal?<br>",
    "options": [
      "<span class=\"multi-choice-letter\" data-choice-letter=\"A\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tYes",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"B\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tB.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tNo"
    ],
    "answer": "A",
    "answerDescription": "Reference:<br>https://docs.microsoft.com/en-us/sql/t-sql/queries/update-transact-sql?view=sql-server-2017",
    "votes": [],
    "comments": [
      {
        "date": "2021-01-18T07:37:00.000Z",
        "voteCount": 1,
        "content": "Answer is B. There could be list prices lower than 0.01 which you exclude from the raise"
      },
      {
        "date": "2021-01-06T22:52:00.000Z",
        "voteCount": 1,
        "content": "sure answer is A"
      },
      {
        "date": "2020-12-15T23:33:00.000Z",
        "voteCount": 1,
        "content": "One can ask are the customers allowed to by a product that costs .001 ?"
      },
      {
        "date": "2020-12-15T23:31:00.000Z",
        "voteCount": 1,
        "content": "Sorry I mean the numbers between 0.001 and 0.01.  Actually these would be items that cost less than a penny.  The mathematical aspect of it does make sense though!"
      },
      {
        "date": "2020-12-15T23:26:00.000Z",
        "voteCount": 1,
        "content": "The answer is B. Think about those items that cost any where b/n a penny and a dime i.e.\n(0.01 to 0.1). This numbers are logically in the $0.0 to $100.00  range.  They can't logically be neglected but the code excludes them, therefore it is not a solution. B is the correct answer."
      },
      {
        "date": "2020-09-23T03:13:00.000Z",
        "voteCount": 2,
        "content": "Imo this is highly dependent on the data type of list pice. If it is money, then the anwser is A but if it is a decimal(18,3) for example, the anwser would be B."
      },
      {
        "date": "2020-09-14T10:17:00.000Z",
        "voteCount": 2,
        "content": "what is the cost of any product is 99.9998 or what if the cost of the product is 0.001? It wouldn't be considered in the limit of .1 to 99.99. The correct way to address this would be listprice &gt;0 and listprice&lt;100."
      },
      {
        "date": "2020-09-30T18:37:00.000Z",
        "voteCount": 1,
        "content": "MONEY type decimal 2"
      },
      {
        "date": "2020-12-09T05:06:00.000Z",
        "voteCount": 1,
        "content": "MONEY goes to 4 decimal places, not 2."
      },
      {
        "date": "2020-08-21T23:23:00.000Z",
        "voteCount": 1,
        "content": "10 percent is 0.1 not 1.1"
      },
      {
        "date": "2020-09-03T12:00:00.000Z",
        "voteCount": 1,
        "content": "Sorry DacPV is correct"
      },
      {
        "date": "2020-12-09T05:04:00.000Z",
        "voteCount": 1,
        "content": "If you want to set to 10%, then listprice * 0.1, but we want to INCREASE by 10%, so listprice * 1.1"
      },
      {
        "date": "2020-07-21T01:16:00.000Z",
        "voteCount": 1,
        "content": "A. Yes is correct. It won't update listprice =0 and listprice = 100"
      },
      {
        "date": "2020-03-09T08:32:00.000Z",
        "voteCount": 3,
        "content": "list price*1.1=list price + list price*10% ==&gt;  A is correct"
      },
      {
        "date": "2020-03-04T04:36:00.000Z",
        "voteCount": 2,
        "content": "This is the only correct list price increase query. listprice=list price*1.1"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 132,
    "url": "https://www.examtopics.com/discussions/microsoft/view/15412-exam-70-761-topic-1-question-132-discussion/",
    "body": "Note: This question is part of a series of questions that present the same scenario. Each question in the series contains a unique solution that might meet the stated goals. Some question sets might have more than one correct solution, while others might not have a correct solution.<br>After you answer a question in this section. You will NOT be able to return to it. As a result, these questions will not appear in the review screen.<br>You have a table named Products that stores information about products your company sells. The table has a column named ListPrice that stores retail pricing information for products.<br>Some products are used only internally by the company. Records for these products are maintained in the Products table for inventory purposes. The price for each of these products is $0.00. Customers are not permitted to order these products.<br>You need to increase the list price for products that cost less than $100 by 10 percent. You must only increase pricing for products that customers are permitted to order.<br>Solution: You run the following Transact-SQL statement:<br><img src=\"/assets/media/exam-media/02675/0030300001.png\" class=\"in-exam-image\"><br>Does the solution meet the goal?<br>",
    "options": [
      "<span class=\"multi-choice-letter\" data-choice-letter=\"A\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tYes",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"B\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tB.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tNo"
    ],
    "answer": "B",
    "answerDescription": "",
    "votes": [],
    "comments": [
      {
        "date": "2020-03-04T04:39:00.000Z",
        "voteCount": 9,
        "content": "I reason out that Between is an inclusive operator. 100 dollar product also gets increased as against in question which is less than 100 dollar."
      },
      {
        "date": "2020-07-21T01:17:00.000Z",
        "voteCount": 3,
        "content": "B. No is correct.\nI tested it. It would update listprice = 0 and listprice = 100 values."
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 133,
    "url": "https://www.examtopics.com/discussions/microsoft/view/5063-exam-70-761-topic-1-question-133-discussion/",
    "body": "DRAG DROP -<br>You have a database that contains a table named Users. The table is defined as follows:<br><img src=\"/assets/media/exam-media/02675/0030400001.png\" class=\"in-exam-image\"><br>You have the following Comma Separated Values (CSV) file:<br><img src=\"/assets/media/exam-media/02675/0030400002.png\" class=\"in-exam-image\"><br>You need to load data from the CSV file into the Users table while meeting the following requirements:<br>\u2711 If a field value is not provided in the file, insert a NULL value for the corresponding column<br>\u2711 Load all records into the table with the correct UserId from the file<br>Which three Transact-SQL segments should you use to develop the solution? To answer, move the appropriate Transact-SQL segments from the list of Transact-<br>SQL segments to the answer area and arrange them in the correct order.<br>Select and Place:<br><img src=\"/assets/media/exam-media/02675/0030500001.png\" class=\"in-exam-image\"><br>",
    "options": [],
    "answer": "<img src=\"/assets/media/exam-media/02675/0030600001.png\" class=\"in-exam-image\">",
    "answerDescription": "Reference:<br>https://docs.microsoft.com/en-us/sql/t-sql/functions/openrowset-transact-sql?view=sql-server-2017",
    "votes": [],
    "comments": [
      {
        "date": "2019-09-11T08:02:00.000Z",
        "voteCount": 33,
        "content": "Wrong!\n\nbulk insert users\n\nfrom N'F:\\users.txt'\n\nwith (\n\tfieldterminator = ',',\n\tkeepidentity,\n\tkeepnulls\n)\n\nkeepnulls because otherwise all records with null became active (there are a default on IsActive column)"
      },
      {
        "date": "2019-09-23T11:11:00.000Z",
        "voteCount": 6,
        "content": "Agree, tested"
      },
      {
        "date": "2020-07-21T10:56:00.000Z",
        "voteCount": 1,
        "content": "This is correct based on https://docs.microsoft.com/en-us/sql/t-sql/statements/bulk-insert-transact-sql?view=sql-server-ver15"
      },
      {
        "date": "2020-10-14T23:02:00.000Z",
        "voteCount": 2,
        "content": "the only problem with text file, should remove spaces after comma, otherwise it give error for the second column:\n1,,User1\n10,1,User 10\n11,0,User 11\n2,,user2"
      },
      {
        "date": "2021-01-25T12:01:00.000Z",
        "voteCount": 1,
        "content": "M4x is right.. you can't use fieldterminator with openrowset ----&gt;\nhttps://docs.microsoft.com/en-us/sql/relational-databases/import-export/specify-field-and-row-terminators-sql-server?view=sql-server-ver15"
      },
      {
        "date": "2021-01-01T17:52:00.000Z",
        "voteCount": 1,
        "content": "Mx4 is correct - works as is - the OPENROWSET has issues"
      },
      {
        "date": "2020-07-28T01:09:00.000Z",
        "voteCount": 1,
        "content": "For the solution with OPENROWSET, we need to have a .fmt file. The content of Users.fmt is:\n\n13.0\n3\n1 SQLCHAR 0 7 \",\" 1 UserId \"SQL_Latin1_General_CP1_CI_AS\"\n2 SQLCHAR 0 1 \",\" 2 IsActive \"SQL_Latin1_General_CP1_CI_AS\"\n3 SQLCHAR 0 100 \"\\r\\n\" 3 UserName \"SQL_Latin1_General_CP1_CI_AS\"\n\nMaybe it can work using SQLINT for UserId, and SQLBIT for IsActive, but I have not succeeded in that way.\n\nAnd the Transact-SQL for the current question is:\n\nSET IDENTITY_INSERT Users ON;\nINSERT INTO Users (UserId, IsActive, UserName)\nSELECT *\nFROM OPENROWSET\n(\n\tBULK N'F:\\Users.txt',\n\tFORMATFILE = N'F:\\Users.fmt',\n\tFORMAT = 'CSV'\n) AS R\n;\nSET IDENTITY_INSERT Users OFF;\nGO"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 134,
    "url": "https://www.examtopics.com/discussions/microsoft/view/21634-exam-70-761-topic-1-question-134-discussion/",
    "body": "You have a database named DB1 that contains a temporal table named Sales.Customers.<br>You need to create a query that returns the credit limit that was available to each customer in DB1 at the beginning of 2017.<br>Which query should you execute?<br><img src=\"/assets/media/exam-media/02675/0030700001.png\" class=\"in-exam-image\"><br>A.<br><img src=\"/assets/media/exam-media/02675/0030700002.png\" class=\"in-exam-image\"><br>B.<br><img src=\"/assets/media/exam-media/02675/0030700003.png\" class=\"in-exam-image\"><br>C.<br><img src=\"/assets/media/exam-media/02675/0030800001.jpg\" class=\"in-exam-image\"><br>D.<br>",
    "options": [],
    "answer": "Answer: B",
    "answerDescription": "AS OF: Returns a table with a rows containing the values that were actual (current) at the specified point in time in the past.<br>Incorrect Answers:<br>A, B: CONTAINED IN has two parameters: CONTAINED IN (&lt;start_date_time&gt; , &lt;end_date_time&gt;)<br>References:<br>https://docs.microsoft.com/en-us/sql/relational-databases/tables/querying-data-in-a-system-versioned-temporal-table",
    "votes": [],
    "comments": [
      {
        "date": "2020-11-25T14:58:00.000Z",
        "voteCount": 1,
        "content": "The thing is when I test it, if I do not put a datetime in AS OF, it won't return anything."
      },
      {
        "date": "2020-05-30T10:27:00.000Z",
        "voteCount": 4,
        "content": "Correct, we want point in time value and it is AS OF"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 135,
    "url": "https://www.examtopics.com/discussions/microsoft/view/3809-exam-70-761-topic-1-question-135-discussion/",
    "body": "Note: This question is part of a series of questions that use the same or similar answer choices. An answer choice may be correct for more than one question in the series. Each question is independent of the other questions in this series. Information and details provided in a question apply only to that question.<br>You have a database that contains several connected tables. The tables contain sales data for customers in the United States only.<br>You need to create a query that generates sample data for a sales table in the database. The query must include every product in the inventory for each customer.<br>Which statement clause should you use?<br>",
    "options": [
      "<span class=\"multi-choice-letter\" data-choice-letter=\"A\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tGROUP BY",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"B\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tB.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tMERGE",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"C\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tC.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tGROUP BY ROLLUP",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"D\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tD.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tLEFT JOIN",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"E\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tE.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tGROUP BY CUBE",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"F\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tF.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tCROSS JOIN",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"G\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tG.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tPIVOT",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"H\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tH.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tUNPIVOT"
    ],
    "answer": "C",
    "answerDescription": "Reference:<br>https://docs.microsoft.com/en-us/sql/t-sql/queries/select-group-by-transact-sql?view=sql-server-2017",
    "votes": [],
    "comments": [
      {
        "date": "2019-08-19T08:31:00.000Z",
        "voteCount": 34,
        "content": "According to the hints \"each product for each customer\" it seems to be a Cartesian product required here. Agree?"
      },
      {
        "date": "2020-03-04T04:53:00.000Z",
        "voteCount": 5,
        "content": "Agreee. The key words every product every customer directs you to CROSS JOIN. To generate test data. Nothing to think much."
      },
      {
        "date": "2020-11-12T11:38:00.000Z",
        "voteCount": 2,
        "content": "agree, also, they want us to 'create a query that generates sample data'..that is usually Cartesian product."
      },
      {
        "date": "2019-08-19T23:13:00.000Z",
        "voteCount": 6,
        "content": "I also agree with Dieter. This seems that each product of each customer. Seems like a cartesian product and therefore a cross join."
      },
      {
        "date": "2021-01-01T17:57:00.000Z",
        "voteCount": 1,
        "content": "CROSS JOIN - you are inserting sample records, not an aggregation of data. CROSS JOIN with Products to make sure every product makes it into the sample"
      },
      {
        "date": "2020-09-11T09:02:00.000Z",
        "voteCount": 1,
        "content": "The question is worded improperly. There are only two\nsets of choices, grouping or joining. The problem with\ngrouping is that there are 3 equivalent choices for \ngrouping. Any of A,C,E, will \"include\" it. There are two\nchoices for joining, D and F. Since the question deals\nonly with one table Sales, D is unlikely. So the best answer\nis F even though it makes little sense"
      },
      {
        "date": "2020-02-13T13:54:00.000Z",
        "voteCount": 1,
        "content": "I think the answer is correct, because you don't know if there is aggregation function for Customer, only use Cross Join cannot make sure on that. but grouping rollup, even if they are unique records, still does't affect"
      },
      {
        "date": "2019-11-11T21:05:00.000Z",
        "voteCount": 2,
        "content": "I agree with Dieter."
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 136,
    "url": "https://www.examtopics.com/discussions/microsoft/view/34983-exam-70-761-topic-1-question-136-discussion/",
    "body": "Note: This question is part of a series of questions that use the same or similar answer choices. An answer choice may be correct for more than one question in the series. Each question is independent of the other questions in this series. Information and details provided in a question apply only to that question.<br>You have a database that contains several connected tables. The tables contain sales data for customers in the United States only.<br>All the sales data is stored in a table named table1. You have a table named table2 that contains city names.<br>You need to create a query that lists only the cities that have no sales.<br>Which statement clause should you add to the query?<br>",
    "options": [
      "<span class=\"multi-choice-letter\" data-choice-letter=\"A\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tGROUP BY",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"B\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tB.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tMERGE",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"C\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tC.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tGROUP BY ROLLUP",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"D\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tD.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tLEFT JOIN",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"E\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tE.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tGROUP BY CUBE",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"F\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tF.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tCROSS JOIN",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"G\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tG.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tPIVOT",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"H\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tH.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tUNPIVOT"
    ],
    "answer": "D",
    "answerDescription": "Reference:<br>https://docs.microsoft.com/en-us/sql/t-sql/queries/from-transact-sql?view=sql-server-2017",
    "votes": [],
    "comments": [
      {
        "date": "2020-12-15T10:43:00.000Z",
        "voteCount": 1,
        "content": "Correctimundo"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 137,
    "url": "https://www.examtopics.com/discussions/microsoft/view/8658-exam-70-761-topic-1-question-137-discussion/",
    "body": "Note: This question is part of a series of questions that use the same or similar answer choices. An answer choice may be correct for more than one question in the series. Each question is independent of the other questions in this series. Information and details provided in a question apply only to that question.<br>You have a database that contains several connected tables. The tables contain sales data for customers in the United States only.<br>You have the following partial query for the database. (Line numbers are included for reference only.)<br><img src=\"/assets/media/exam-media/02675/0031000001.png\" class=\"in-exam-image\"><br>You need to complete the query to generate the output shown in the following table.<br><img src=\"/assets/media/exam-media/02675/0031000002.png\" class=\"in-exam-image\"><br>Which statement clause should you add at line 3?<br>",
    "options": [
      "<span class=\"multi-choice-letter\" data-choice-letter=\"A\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tGROUP BY",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"B\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tB.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tMERGE",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"C\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tC.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tGROUP BY ROLLUP",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"D\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tD.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tLEFT JOIN",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"E\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tE.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tGROUP BY CUBE",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"F\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tF.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tCROSS JOIN",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"G\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tG.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tPIVOT",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"H\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tH.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tUNPIVOT"
    ],
    "answer": "A",
    "answerDescription": "",
    "votes": [],
    "comments": [
      {
        "date": "2020-01-22T08:34:00.000Z",
        "voteCount": 8,
        "content": "GROUP BY CityName"
      },
      {
        "date": "2020-12-15T11:48:00.000Z",
        "voteCount": 2,
        "content": "Group by everything . You must include all the columns in Group By if they aren't aggreagates"
      },
      {
        "date": "2020-12-15T16:30:00.000Z",
        "voteCount": 1,
        "content": "6\n\nGroup by can used in Two way Majorly\n1)in conjunction with SQL aggregation functions\n2)to eliminate duplicate rows from a result set"
      },
      {
        "date": "2020-11-25T17:32:00.000Z",
        "voteCount": 1,
        "content": "Everything in the SELECT list must appear in the GROUP BY Clause unless it is an aggregate function.\n-- Using TSQLV4 Database\nSELECT [shipcountry], [shipregion], [shipcity], freight + 10 AS TotalSales\nFROM [Sales].[Orders]\nGROUP BY [shipcountry], [shipregion], [shipcity], freight + 10;\n/* If we don't add the mathematical operation to the GROUP BY it returns the below error:\nMsg 8120, Level 16, State 1, Line 151\nColumn 'Sales.Orders.freight' is invalid in the select list because it is not contained in either an aggregate function or the GROUP BY clause."
      },
      {
        "date": "2020-09-24T11:18:00.000Z",
        "voteCount": 2,
        "content": "correct answer is group by cube"
      },
      {
        "date": "2020-10-13T00:25:00.000Z",
        "voteCount": 1,
        "content": "Nope. When you apply GROUP BY CUBE with all fields you'll get the dataset of all fields combinations with NULLs as well. The output shown has only 5 rows and looking at the list of fields in SELECT statement (without aggregation aplied) you have to list them all in GROUP BY clause. So answer A is correct."
      },
      {
        "date": "2020-12-15T11:49:00.000Z",
        "voteCount": 1,
        "content": "no , You can't figure it out from the this  partial data"
      },
      {
        "date": "2020-09-18T10:49:00.000Z",
        "voteCount": 1,
        "content": "The correct answer is group by, there is an error in the question. All the previous questions of this series dont have aggregate function which is nothing but an error."
      },
      {
        "date": "2020-02-07T02:49:00.000Z",
        "voteCount": 3,
        "content": "this is not an aggregate function, so should be left join"
      },
      {
        "date": "2020-02-13T14:02:00.000Z",
        "voteCount": 2,
        "content": "no, group by can be used in non-aggregation statement. and in this case, you can easily find out that CITYs are unique, so absolutely they must group by name, city, price and so on"
      },
      {
        "date": "2020-05-20T08:56:00.000Z",
        "voteCount": 2,
        "content": "I just tried grouping by a primary key without an aggregation and am getting an error...  I think the only answer that could work is LEFT JOIN with all the columns in the SELECT list being unique..."
      },
      {
        "date": "2019-11-20T02:30:00.000Z",
        "voteCount": 1,
        "content": "Would this be Group by totalsales?"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 138,
    "url": "https://www.examtopics.com/discussions/microsoft/view/8585-exam-70-761-topic-1-question-138-discussion/",
    "body": "Note: This question is part of a series of questions that use the same scenario. For your convenience, the scenario is repeated in each question. Each question presents a different goal and answer choices, but the text of the scenario is exactly the same in each question in this series.<br>You query a database that includes two tables: Project and Task. The Project table includes the following columns:<br><img src=\"/assets/media/exam-media/02675/0031100001.png\" class=\"in-exam-image\"><br>The Task table includes the following columns:<br><img src=\"/assets/media/exam-media/02675/0031100002.png\" class=\"in-exam-image\"><br>You plan to run the following query to update tasks that are not yet started:<br>UPDATE Task SET StartTime = GETDATE() WHERE StartTime IS NULL<br>You need to return the total count of tasks that are impacted by this UPDATE operation, but are not associated with a project.<br>What set of Transact-SQL statements should you run?<br><img src=\"/assets/media/exam-media/02675/0031200001.png\" class=\"in-exam-image\"><br>A.<br><img src=\"/assets/media/exam-media/02675/0031200002.png\" class=\"in-exam-image\"><br>B.<br><img src=\"/assets/media/exam-media/02675/0031200003.png\" class=\"in-exam-image\"><br>C.<br><img src=\"/assets/media/exam-media/02675/0031200004.png\" class=\"in-exam-image\"><br>D.<br><img src=\"/assets/media/exam-media/02675/0031200005.jpg\" class=\"in-exam-image\"><br>E.<br><img src=\"/assets/media/exam-media/02675/0031200006.png\" class=\"in-exam-image\"><br>F.<br>",
    "options": [],
    "answer": "B",
    "answerDescription": "",
    "votes": [],
    "comments": [
      {
        "date": "2019-11-19T10:21:00.000Z",
        "voteCount": 14,
        "content": "Actually, F is also right"
      },
      {
        "date": "2020-02-07T03:16:00.000Z",
        "voteCount": 5,
        "content": "tested on computer, both B F are right"
      },
      {
        "date": "2020-09-14T16:52:00.000Z",
        "voteCount": 2,
        "content": "F doesnt work you are not inserting the TaskId you are deleting so B is the only one correct."
      },
      {
        "date": "2020-09-30T18:51:00.000Z",
        "voteCount": 3,
        "content": "for UPDATES, inserted. and deleted. are equivalent"
      },
      {
        "date": "2020-07-21T11:25:00.000Z",
        "voteCount": 2,
        "content": "both B and F work fine, tested it. I would go with B\n\ncreate table\ntask\n(taskid int identity(1,1)\n,taskname varchar(100)\n,parenttaskid int\n,projectid int\n,starttime datetime2(7)\n,endtime datetime2(7)\n,userid int\n)\ninsert into task\nvalues\n('t1', null, null, null, null, '1')\n,('t2', null, '2', null, null, '2')\n,('t3', null, null, null, null, '3')\n,('t4', null, '4', null, null, '4')\n,('t5', null, null, null, null, '5')\n,('t6', null, '6', null, null, '6')\ndeclare @startedTasks TABLE(TaskID int, ProjectID int)\nUPDATE task SET StartTime = GETDATE() OUTPUT inserted.TaskId, deleted.projectid INTO @startedTasks\nWHERE StartTime IS NULL\nSELECT COUNT(*) FROM @startedTasks where projectid IS NULL\nselect * from @startedTasks\nselect * from task"
      },
      {
        "date": "2020-02-21T02:29:00.000Z",
        "voteCount": 1,
        "content": "A) is also working fine"
      },
      {
        "date": "2020-02-26T07:10:00.000Z",
        "voteCount": 1,
        "content": "No, because it says \"WHERE ProjectID is not null\" which is the complete opposite. \nJust B and F work fine."
      },
      {
        "date": "2020-02-13T14:07:00.000Z",
        "voteCount": 3,
        "content": "Yes, both B and F give same result, because 1 record insert, 1 record delete. But I think the author wants us to find out which records is affacted before after updating. so B is more correct"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 139,
    "url": "https://www.examtopics.com/discussions/microsoft/view/21635-exam-70-761-topic-1-question-139-discussion/",
    "body": "You have a database named DB1 that contains a temporal table named Sales.Customers.<br>You need to create a query that returns the credit limit that was available to each customer in DB1 at the beginning of 2017.<br>Which query should you execute?<br><img src=\"/assets/media/exam-media/02675/0031300001.png\" class=\"in-exam-image\"><br>A.<br><img src=\"/assets/media/exam-media/02675/0031300002.png\" class=\"in-exam-image\"><br>B.<br><img src=\"/assets/media/exam-media/02675/0031300003.png\" class=\"in-exam-image\"><br>C.<br><img src=\"/assets/media/exam-media/02675/0031400001.jpg\" class=\"in-exam-image\"><br>D.<br>",
    "options": [],
    "answer": "B",
    "answerDescription": "AS OF: Returns a table with a rows containing the values that were actual (current) at the specified point in time in the past.<br>Incorrect Answers:<br>A, B: CONTAINED IN has two parameters: CONTAINED IN (&lt;start_date_time&gt; , &lt;end_date_time&gt;)<br>References:<br>https://docs.microsoft.com/en-us/sql/relational-databases/tables/querying-data-in-a-system-versioned-temporal-table",
    "votes": [],
    "comments": [
      {
        "date": "2021-01-26T12:52:00.000Z",
        "voteCount": 1,
        "content": "B is correct"
      },
      {
        "date": "2020-12-15T10:48:00.000Z",
        "voteCount": 4,
        "content": "Correctimundo"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 140,
    "url": "https://www.examtopics.com/discussions/microsoft/view/6245-exam-70-761-topic-1-question-140-discussion/",
    "body": "Note: This question is part of a series of questions that use the same or similar answer choices. An answer choice may be correct for more than one question in the series. Each question is independent of the other questions in this series. Information and details provided in a question apply only to that question.<br>You create a table by running the following Transact-SQL statement:<br><img src=\"/assets/media/exam-media/02675/0031500001.png\" class=\"in-exam-image\"><br>You are developing a report that aggregates customer data only for the year 2014. The report requires that the data be denormalized.<br>You need to return the data for the report.<br>Which Transact-SQL statement should you run?<br><img src=\"/assets/media/exam-media/02675/0031500002.png\" class=\"in-exam-image\"><br>A.<br><img src=\"/assets/media/exam-media/02675/0031500003.png\" class=\"in-exam-image\"><br>B.<br><img src=\"/assets/media/exam-media/02675/0031500004.png\" class=\"in-exam-image\"><br>C.<br><img src=\"/assets/media/exam-media/02675/0031600001.png\" class=\"in-exam-image\"><br>D.<br><img src=\"/assets/media/exam-media/02675/0031600002.png\" class=\"in-exam-image\"><br>E.<br><img src=\"/assets/media/exam-media/02675/0031600003.png\" class=\"in-exam-image\"><br>F.<br><img src=\"/assets/media/exam-media/02675/0031600004.png\" class=\"in-exam-image\"><br>G.<br><img src=\"/assets/media/exam-media/02675/0031600005.png\" class=\"in-exam-image\"><br>H.<br>",
    "options": [],
    "answer": "G",
    "answerDescription": "",
    "votes": [],
    "comments": [
      {
        "date": "2019-10-08T00:57:00.000Z",
        "voteCount": 14,
        "content": "IMO this should be D, as denormalized results are required (Pivot) and as well aggregated results, whicha re not provided with the given answer G."
      },
      {
        "date": "2020-06-03T10:02:00.000Z",
        "voteCount": 4,
        "content": "But you don't get historical data, which also duplicates rows in main table, hence denormalized"
      },
      {
        "date": "2020-09-29T13:34:00.000Z",
        "voteCount": 1,
        "content": "cannot be D as you have &gt;=2014 whereas the question specifies with 2014"
      },
      {
        "date": "2020-12-13T05:21:00.000Z",
        "voteCount": 2,
        "content": "D doesn't say &gt;= 2014. Not sure where you got that from."
      },
      {
        "date": "2020-12-13T05:24:00.000Z",
        "voteCount": 1,
        "content": "Ah just realised you think E is D. D is the one above what you're thinking."
      },
      {
        "date": "2020-02-07T03:26:00.000Z",
        "voteCount": 6,
        "content": "the answer is CORRECT. it met the system_time period"
      },
      {
        "date": "2021-01-01T18:15:00.000Z",
        "voteCount": 1,
        "content": "D is correct - denormalized by pivot for dates that are in 2014. Question doesn't ask for inserts/updates n 2014 which is what the system times would give"
      },
      {
        "date": "2021-01-01T18:17:00.000Z",
        "voteCount": 1,
        "content": "Amended.. getting tired? Would need to use YEAR() around date - I don't see anything still on the screen that qualifies...."
      },
      {
        "date": "2020-12-15T12:07:00.000Z",
        "voteCount": 1,
        "content": "won't the query in option G be able give as some data from 2015 ? Looks like G is wrong"
      },
      {
        "date": "2020-12-15T12:13:00.000Z",
        "voteCount": 1,
        "content": "Sorry , It won't because Actually G is correct , because  Time range\t00:00:00 through 23:59:59.9999999 for datetime2. \nhttps://docs.microsoft.com/en-us/sql/t-sql/data-types/datetime2-transact-sql?view=sql-server-ver15\n\nLooks like G is correct."
      },
      {
        "date": "2020-09-24T11:23:00.000Z",
        "voteCount": 2,
        "content": "correct answer is D pivot since its only for 2014"
      },
      {
        "date": "2020-07-26T17:19:00.000Z",
        "voteCount": 3,
        "content": "You want data from 2014 not 2015 12 am. G is wrong time frame but best answer out of them all."
      },
      {
        "date": "2020-04-05T05:12:00.000Z",
        "voteCount": 5,
        "content": "I believe G is also wrong, BETWEEN is inclusive so it will include data also from 2015."
      },
      {
        "date": "2020-11-25T19:44:00.000Z",
        "voteCount": 3,
        "content": "'2015-01-01 00:00:00.0000000' won't include data from 1/1/2015 as it will end right before the day starts."
      },
      {
        "date": "2020-03-31T15:26:00.000Z",
        "voteCount": 3,
        "content": "D is wrong. We need the data for the year 2014. NOT the data created in 2014, rows created in 2013 can still be very relevant data in 2014. Hence system_time is required."
      },
      {
        "date": "2020-12-13T05:23:00.000Z",
        "voteCount": 2,
        "content": "You've just contradicted yourself. If system_time was used then data created in 2013 wouldn't be included."
      },
      {
        "date": "2020-02-04T22:15:00.000Z",
        "voteCount": 3,
        "content": "G is wrong i think D is correct"
      },
      {
        "date": "2020-03-09T08:49:00.000Z",
        "voteCount": 1,
        "content": "I think D is Wrong , because \"The report requires that the data be denormalized\""
      },
      {
        "date": "2021-01-25T12:12:00.000Z",
        "voteCount": 1,
        "content": "Exactly what a pivot does, denormalize."
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 141,
    "url": "https://www.examtopics.com/discussions/microsoft/view/5546-exam-70-761-topic-1-question-141-discussion/",
    "body": "Note: This question is part of a series of questions that use the same or similar answer choices. An answer choice may be correct for more than one question in the series. Each question is independent of the other questions in this series. Information and details provided in a question apply only to that question.<br>You create a table by running the following Transact-SQL statement:<br><img src=\"/assets/media/exam-media/02675/0031700001.png\" class=\"in-exam-image\"><br>You need to return normalized data for all customers that were added in the year 2014.<br>Which Transact-SQL statement should you run?<br><img src=\"/assets/media/exam-media/02675/0031700002.png\" class=\"in-exam-image\"><br>A.<br><img src=\"/assets/media/exam-media/02675/0031700003.png\" class=\"in-exam-image\"><br>B.<br><img src=\"/assets/media/exam-media/02675/0031800001.png\" class=\"in-exam-image\"><br>C.<br><img src=\"/assets/media/exam-media/02675/0031800002.png\" class=\"in-exam-image\"><br>D.<br><img src=\"/assets/media/exam-media/02675/0031800003.png\" class=\"in-exam-image\"><br>E.<br><img src=\"/assets/media/exam-media/02675/0031800004.png\" class=\"in-exam-image\"><br>F.<br><img src=\"/assets/media/exam-media/02675/0031800005.png\" class=\"in-exam-image\"><br>G.<br><img src=\"/assets/media/exam-media/02675/0031800006.png\" class=\"in-exam-image\"><br>H.<br>",
    "options": [],
    "answer": "G",
    "answerDescription": "",
    "votes": [],
    "comments": [
      {
        "date": "2019-12-21T10:49:00.000Z",
        "voteCount": 20,
        "content": "Answer D is returning DEnormalized data using pivot, so it's wrong. G selects all data inserted, but NOT created in 2014. The only adorable answer is H"
      },
      {
        "date": "2020-02-07T07:35:00.000Z",
        "voteCount": 1,
        "content": "NOT H. if the dateCreated is 20141231, then H will miss those.\nStill G."
      },
      {
        "date": "2020-02-20T07:14:00.000Z",
        "voteCount": 5,
        "content": "FROM/ AND would exclude them . \nBETWEEN /AND would not ."
      },
      {
        "date": "2020-02-20T07:21:00.000Z",
        "voteCount": 2,
        "content": "In addition Data in G is oviously NOT normalized"
      },
      {
        "date": "2020-02-25T07:46:00.000Z",
        "voteCount": 2,
        "content": "20141231 = 20141231 0:00. It will not exclude 20141231 0:00, but will exclude 20141231 0:01 and everything after it."
      },
      {
        "date": "2020-02-26T08:23:00.000Z",
        "voteCount": 9,
        "content": "Yes, regarding the last day in the year 2014 I'm with you, anonimdom, but the question is about the creation date, not the valid period. That's a big difference. The data could be corrected (e.g. typo in name) in 2016 but the customer was still created in 2014.\n\nAnd being completely precise: the end date in G is also not completely conform to the question because '2015-01-01 00:00:00.000000' is obviously not in 2014, right? ;-)\n\nSo I would come to the result, that H is the nearest correct answer, but also no 100% solution."
      },
      {
        "date": "2021-01-18T10:41:00.000Z",
        "voteCount": 1,
        "content": "No, answer is G. Reason is that H does not query on the history table as it does not use a  \"for system_time\" statement. Therefore H will not yield any records as it only contains actual data with records valid to 9999-12-31 23:59:59.99"
      },
      {
        "date": "2020-12-18T12:14:00.000Z",
        "voteCount": 1,
        "content": "H Is the correct answer. The BETWEEN operator selects values within a given range. The values can be numbers, text, or dates. The BETWEEN operator is inclusive: begin and end values are included.  All records with \"dateCreated\" column values BETWEEN  '20140101' AND  '20141231' are included."
      },
      {
        "date": "2021-01-01T18:28:00.000Z",
        "voteCount": 1,
        "content": "except that dateCreated leaves out 20141231 times after midnight so unless you ordered right at midnight, it wouldn't be included in BETWEEN because the datetime2 translates the date to midnight. BETWEEN '20140101' and '20150101' would be a lot closer. Tested:\nDECLARE @xdate datetime2\nSELECT @xdate='20141231 0:01'\nIF @xdate BETWEEN '20140101' AND '20141231' PRINT 'Yes'\n\nI don't think any are correct"
      },
      {
        "date": "2021-01-01T18:29:00.000Z",
        "voteCount": 1,
        "content": "also because SYSTEM_TIME would be when record was current on the system, not when it was added"
      },
      {
        "date": "2020-12-15T12:26:00.000Z",
        "voteCount": 1,
        "content": "I can't be G, because it doesn't use DateCreated G will give all the records for the 2014 , not customer added. Correct is H."
      },
      {
        "date": "2020-09-30T18:54:00.000Z",
        "voteCount": 1,
        "content": "should add extra filter on created date on top of AS OF"
      },
      {
        "date": "2020-09-10T19:46:00.000Z",
        "voteCount": 1,
        "content": "DateCreated is datetime2. so it cant be H. the closest is G"
      },
      {
        "date": "2019-09-21T07:05:00.000Z",
        "voteCount": 1,
        "content": "The closest  II be D  -- statement with Pivot"
      },
      {
        "date": "2019-10-08T00:58:00.000Z",
        "voteCount": 5,
        "content": "if you compare it to #140 you'll find that D fits rather for the previous question.\nG seems to be fitting here (normalized data, not aggregated, 2014)"
      },
      {
        "date": "2019-11-19T10:30:00.000Z",
        "voteCount": 1,
        "content": "The question explicit \"all customers that were added in the year 2014\", therefore Year(DateCreated) = 2014"
      },
      {
        "date": "2020-12-15T12:23:00.000Z",
        "voteCount": 1,
        "content": "it's not normolized if it aggregates"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 142,
    "url": "https://www.examtopics.com/discussions/microsoft/view/21104-exam-70-761-topic-1-question-142-discussion/",
    "body": "Note: This question is part of a series of questions that use the same or similar answer choices. An answer choice may be correct for more than one question in the series. Each question is independent of the other questions in this series. Information and details provided in a question apply only to that question.<br>You run the following Transact-SQL statement:<br><img src=\"/assets/media/exam-media/02675/0031900001.png\" class=\"in-exam-image\"><br>You need to return the total annual revenue for all customers, followed by a row for each customer that shows the customer's name and annual revenue.<br>Which Transact-SQL statement should you run?<br><img src=\"/assets/media/exam-media/02675/0031900002.png\" class=\"in-exam-image\"><br>A.<br><img src=\"/assets/media/exam-media/02675/0032000001.png\" class=\"in-exam-image\"><br>B.<br><img src=\"/assets/media/exam-media/02675/0032000002.png\" class=\"in-exam-image\"><br>C.<br><img src=\"/assets/media/exam-media/02675/0032000003.png\" class=\"in-exam-image\"><br>D.<br><img src=\"/assets/media/exam-media/02675/0032000004.png\" class=\"in-exam-image\"><br>E.<br><img src=\"/assets/media/exam-media/02675/0032000005.png\" class=\"in-exam-image\"><br>F.<br><img src=\"/assets/media/exam-media/02675/0032000006.png\" class=\"in-exam-image\"><br>G.<br><img src=\"/assets/media/exam-media/02675/0032100001.png\" class=\"in-exam-image\"><br>H.<br>",
    "options": [],
    "answer": "A",
    "answerDescription": "",
    "votes": [],
    "comments": [
      {
        "date": "2020-05-21T11:16:00.000Z",
        "voteCount": 1,
        "content": "Here you use PIVOT"
      },
      {
        "date": "2020-08-20T15:43:00.000Z",
        "voteCount": 3,
        "content": "They ask for a row for each customer. Pivot doesn't do that, A does."
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 143,
    "url": "https://www.examtopics.com/discussions/microsoft/view/14415-exam-70-761-topic-1-question-143-discussion/",
    "body": "Note: This question is part of a series of questions that use the same or similar answer choices. An answer choice may be correct for more than one question in the series. Each question is independent of the other questions in this series. Information and details provided in a question apply only to that question.<br>You create a table by running the following Transact-SQL statement:<br><img src=\"/assets/media/exam-media/02675/0032100002.png\" class=\"in-exam-image\"><br>You need to develop a query that meets the following requirements:<br>\u2711 Output data by using a tree-like structure.<br>Allow mixed content types.<br><img src=\"/assets/media/exam-media/02675/0032100004.png\" class=\"in-exam-image\"><br>\u2711 Use custom metadata attributes.<br>Which Transact-SQL statement should you run?<br><img src=\"/assets/media/exam-media/02675/0032200002.png\" class=\"in-exam-image\"><br>A.<br><img src=\"/assets/media/exam-media/02675/0032200003.png\" class=\"in-exam-image\"><br>B.<br><img src=\"/assets/media/exam-media/02675/0032200004.png\" class=\"in-exam-image\"><br>C.<br><img src=\"/assets/media/exam-media/02675/0032200005.png\" class=\"in-exam-image\"><br>D.<br><img src=\"/assets/media/exam-media/02675/0032200006.png\" class=\"in-exam-image\"><br>E.<br><img src=\"/assets/media/exam-media/02675/0032200007.png\" class=\"in-exam-image\"><br>F.<br><img src=\"/assets/media/exam-media/02675/0032300001.png\" class=\"in-exam-image\"><br>G.<br><img src=\"/assets/media/exam-media/02675/0032300002.png\" class=\"in-exam-image\"><br>H.<br>",
    "options": [],
    "answer": "F",
    "answerDescription": "",
    "votes": [],
    "comments": [
      {
        "date": "2020-02-18T13:24:00.000Z",
        "voteCount": 3,
        "content": "This question needs more context. Both XML and JSON are tree-like structures."
      },
      {
        "date": "2020-02-25T07:52:00.000Z",
        "voteCount": 5,
        "content": "But what about: Allow mixed content types.\n\u2711 Use custom metadata attributes?"
      },
      {
        "date": "2020-05-30T12:35:00.000Z",
        "voteCount": 2,
        "content": "But XML is exactly tree-structure, and allows mixed data as well as uses custom metadata attributes"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 144,
    "url": "https://www.examtopics.com/discussions/microsoft/view/4650-exam-70-761-topic-1-question-144-discussion/",
    "body": "You need to create a database object that meets the following requirements:<br>\u2711 accepts a product identifies as input<br>\u2711 calculates the total quantity of a specific product, including quantity on hand and quantity on order<br>\u2711 caches and reuses execution plan<br>\u2711 returns a value<br>\u2711 can be called from within a SELECT statement<br>\u2711 can be used in a JOIN clause<br>What should you create?<br>",
    "options": [
      "<span class=\"multi-choice-letter\" data-choice-letter=\"A\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tan extended stored procedure",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"B\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tB.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\ta user-defined table-valued function",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"C\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tC.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\ta user-defined stored procedure that has an OUTPUT parameter",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"D\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tD.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\ta memory-optimized table that has updated statistics"
    ],
    "answer": "B",
    "answerDescription": "References:<br>https://www.techrepublic.com/blog/the-enterprise-cloud/understand-when-to-use-user-defined-functions-in-sql-server/",
    "votes": [],
    "comments": [
      {
        "date": "2020-05-30T12:36:00.000Z",
        "voteCount": 3,
        "content": "Answer is B. And this question is the same with Q14 and Q120 as well"
      },
      {
        "date": "2020-05-27T06:07:00.000Z",
        "voteCount": 1,
        "content": "Shouldn't this be C? Can return a value with an OUTPUT parameter too."
      },
      {
        "date": "2020-07-02T06:34:00.000Z",
        "voteCount": 3,
        "content": "No cause stored procedures cant be called in select"
      },
      {
        "date": "2019-09-03T13:22:00.000Z",
        "voteCount": 4,
        "content": "Probably typo in text. The correct answer to this question:\n a user-defined scalar function"
      },
      {
        "date": "2019-09-21T07:10:00.000Z",
        "voteCount": 13,
        "content": "No. \"..can be used in a JOIN clause..\"\nScalar UDF cannot be used in Join"
      },
      {
        "date": "2020-09-30T21:59:00.000Z",
        "voteCount": 1,
        "content": "total quantity AND quantity on hand, two outputs"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 145,
    "url": "https://www.examtopics.com/discussions/microsoft/view/4746-exam-70-761-topic-1-question-145-discussion/",
    "body": "Note: This question is part of a series of questions that present the same scenario. Each question in the series contains a unique solution that might meet the stated goals. Some question sets might have more than one correct solution, while others might not have a correct solution.<br>After you answer a question in this section, you will NOT be able to return to it. As a result, these questions will not appear in the review screen.<br>You are building a stored procedure that will be used by hundreds of users concurrently.<br>You need to store rows that will be processed later by the stored procedure. The object that stores the rows must meet the following requirements:<br>\u2711 Be indexable<br>\u2711 Contain up-to-date statistics<br>\u2711 Be able to scale between 10 and 100,000 rows<br>The solution must prevent users from accessing one another's data.<br>Solution: You create a global temporary table in the stored procedure.<br>Does this meet the goal?<br>",
    "options": [
      "<span class=\"multi-choice-letter\" data-choice-letter=\"A\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tYes",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"B\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tB.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tNo"
    ],
    "answer": "A",
    "answerDescription": "",
    "votes": [],
    "comments": [
      {
        "date": "2019-09-05T05:08:00.000Z",
        "voteCount": 13,
        "content": "it is mentioned \"The solution must prevent users from accessing one another\u00e2\u20ac\u2122s data.\".\nSo should it be local temporary table?"
      },
      {
        "date": "2020-02-14T07:42:00.000Z",
        "voteCount": 1,
        "content": "I think global temp table can still make it. don't forget you are using it in SP, user can only exec sp, they don't know what inside the SP, and maybe they'll check permernent tables or views, but when you close the session where you create global temp table, the global temp table will gone."
      },
      {
        "date": "2020-01-04T03:36:00.000Z",
        "voteCount": 7,
        "content": "There are two types of temporary tables: local and global. Local temporary tables are visible only to their creators during the same connection to an instance of SQL Server as when the tables were first created or referenced. Local temporary tables are deleted after the user disconnects from the instance of SQL Server. Global temporary tables are visible to any user and any connection after they are created, and are deleted when all users that are referencing the table disconnect from the instance of SQL Server."
      },
      {
        "date": "2020-05-30T13:01:00.000Z",
        "voteCount": 1,
        "content": "Does this mean that users can access one other's data/ So the answer is NO? I understand that they have their own session and do not have to do with the others session. Any hit in this?"
      },
      {
        "date": "2020-06-07T02:29:00.000Z",
        "voteCount": 2,
        "content": "Yes, the correct answer is \"No\", because global temporary tables allow the access to the data for everyone."
      },
      {
        "date": "2021-01-26T11:01:00.000Z",
        "voteCount": 1,
        "content": "check this discussion :\nhttps://www.sqlservercentral.com/forums/topic/global-temptable-how-do-permissions-work"
      },
      {
        "date": "2021-01-18T10:54:00.000Z",
        "voteCount": 1,
        "content": "The SP will be used by hundreds of users concurrently, so I would say global temporary table. If local you wouldn't be able to access the table through the SP."
      },
      {
        "date": "2021-01-04T14:27:00.000Z",
        "voteCount": 1,
        "content": "answer is B ; tested  \ncreate global temp table from a session and add rows to it from an other session and it will work :D"
      },
      {
        "date": "2021-01-01T18:46:00.000Z",
        "voteCount": 2,
        "content": "B is correct because it is global and other users can access it. Change it to local and it would work"
      },
      {
        "date": "2020-11-26T14:53:00.000Z",
        "voteCount": 1,
        "content": "This is confusing as how will other users be able to see the local temp table if only the connection that created it can see it?. Answer should be correct, Yes.\n\"In SQL Server, local temporary tables are visible only in the current session. So if you create a local temporary table in one session, you cannot access it in other sessions.\"\nhttp://www.sqlines.com/articles/sql-server/local_and_global_temporary_tables"
      },
      {
        "date": "2020-12-15T18:05:00.000Z",
        "voteCount": 1,
        "content": "Solution: You create a GLOBAL temporary table in the stored procedure.\nDoes this meet the goal?"
      },
      {
        "date": "2020-07-21T18:50:00.000Z",
        "voteCount": 2,
        "content": "Answer is B .\n https://blog.sqlauthority.com/2018/03/16/sql-server-creating-temporary-global-temporary-stored-procedures/"
      },
      {
        "date": "2021-01-25T12:34:00.000Z",
        "voteCount": 1,
        "content": "If you need to access your Temporary Stored Procedures from a different session, you can also consider Global Temporary stored procedures. For this example, you will have to create a stored procedure name by prefixing with two # signs (##) instead of one # sign."
      },
      {
        "date": "2019-11-20T07:50:00.000Z",
        "voteCount": 1,
        "content": "True users would be able to access each other data with a global temp table.  Is there a better explanation?"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 146,
    "url": "https://www.examtopics.com/discussions/microsoft/view/4747-exam-70-761-topic-1-question-146-discussion/",
    "body": "Note: This question is part of a series of questions that present the same scenario. Each question in the series contains a unique solution that might meet the stated goals. Some question sets might have more than one correct solution, while others might not have a correct solution.<br>After you answer a question in this section, you will NOT be able to return to it. As a result, these questions will not appear in the review screen.<br>You are building a stored procedure that will be used by hundreds of users concurrently.<br>You need to store rows that will be processed later by the stored procedure. The object that stores the rows must meet the following requirements:<br>\u2711 Be indexable<br>\u2711 Contain up-to-date statistics<br>\u2711 Be able to scale between 10 and 100,000 rows<br>The solution must prevent users from accessing one another's data.<br>Solution: You create a local temporary table in the stored procedure.<br>Does this meet the goal?<br>",
    "options": [
      "<span class=\"multi-choice-letter\" data-choice-letter=\"A\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tYes",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"B\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tB.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tNo"
    ],
    "answer": "B",
    "answerDescription": "",
    "votes": [],
    "comments": [
      {
        "date": "2019-09-05T05:11:00.000Z",
        "voteCount": 17,
        "content": "it is mentioned \"The solution must prevent users from accessing one another\u00e2\u20ac\u2122s data.\".\nSo should it be local temporary table?"
      },
      {
        "date": "2019-10-19T05:15:00.000Z",
        "voteCount": 5,
        "content": "YES, no global temporary table"
      },
      {
        "date": "2020-04-13T10:00:00.000Z",
        "voteCount": 9,
        "content": "correct answer is A and the previews question should be B."
      },
      {
        "date": "2021-01-18T10:57:00.000Z",
        "voteCount": 1,
        "content": "\"You are building a stored procedure that will be used by hundreds of users concurrently.\" You will not be able to access the local temp table if you choose for A. Answer is B."
      },
      {
        "date": "2021-01-04T14:29:00.000Z",
        "voteCount": 1,
        "content": "Answer is A . tested"
      },
      {
        "date": "2021-01-01T18:47:00.000Z",
        "voteCount": 1,
        "content": "A, Final answer :-)"
      },
      {
        "date": "2020-10-21T05:08:00.000Z",
        "voteCount": 1,
        "content": "I think there is confusion in understanding this and the previous question. They don't ask about an object CREATED by this stored procedure, but rather about the object USED by this SP.  Whatever would be the output of the SP, it depends on parameters and perhaps the logics inside of it, thus the data access will be regulated; but all the users would be able to use the preselected data set - global temp table - which is faster than each of them accessing the underlying tables."
      },
      {
        "date": "2020-07-27T17:34:00.000Z",
        "voteCount": 2,
        "content": "Local table people, how can another user access it? B is right."
      },
      {
        "date": "2020-07-27T18:22:00.000Z",
        "voteCount": 4,
        "content": "Meant A is correct."
      },
      {
        "date": "2020-01-16T01:23:00.000Z",
        "voteCount": 2,
        "content": "I think it's NO, hint 'contain up to date statistics'"
      },
      {
        "date": "2020-02-27T01:01:00.000Z",
        "voteCount": 3,
        "content": "But temporary temp tables can have indexes and statistics like any other table."
      },
      {
        "date": "2020-01-04T03:35:00.000Z",
        "voteCount": 1,
        "content": "There are two types of temporary tables: local and global. Local temporary tables are visible only to their creators during the same connection to an instance of SQL Server as when the tables were first created or referenced. Local temporary tables are deleted after the user disconnects from the instance of SQL Server. Global temporary tables are visible to any user and any connection after they are created, and are deleted when all users that are referencing the table disconnect from the instance of SQL Server."
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 147,
    "url": "https://www.examtopics.com/discussions/microsoft/view/18056-exam-70-761-topic-1-question-147-discussion/",
    "body": "Note: This question is part of a series of questions that present the same scenario. Each question in the series contains a unique solution that might meet the stated goals. Some question sets might have more than one correct solution, while others might not have a correct solution.<br>After you answer a question in this section, you will NOT be able to return to it. As a result, these questions will not appear in the review screen.<br>You are building a stored procedure that will be used by hundreds of users concurrently.<br>You need to store rows that will be processed later by the stored procedure. The object that stores the rows must meet the following requirements:<br>\u2711 Be indexable<br>\u2711 Contain up-to-date statistics<br>\u2711 Be able to scale between 10 and 100,000 rows<br>The solution must prevent users from accessing one another's data.<br>Solution: You create a table variable in the stored procedure.<br>Does this meet the goal?<br>",
    "options": [
      "<span class=\"multi-choice-letter\" data-choice-letter=\"A\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tYes",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"B\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tB.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tNo"
    ],
    "answer": "B",
    "answerDescription": "",
    "votes": [],
    "comments": [
      {
        "date": "2020-07-27T17:36:00.000Z",
        "voteCount": 1,
        "content": "B is correct cannot be accessed by other users."
      },
      {
        "date": "2020-04-07T23:50:00.000Z",
        "voteCount": 2,
        "content": "SQL Server doesn\u2019t maintain statistics for table variables."
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 148,
    "url": "https://www.examtopics.com/discussions/microsoft/view/32283-exam-70-761-topic-1-question-148-discussion/",
    "body": "Note: This question is part of a series of questions that present the same scenario. Each question in the series contains a unique solution that might meet the stated goals. Some question sets might have more than one correct solution, while others might not have a correct solution.<br>After you answer a question in this section, you will NOT be able to return to it. As a result, these questions will not appear in the review screen.<br>You are creating indexes in a data warehouse.<br>You have a dimension table named Table1 that has 10,000 rows. The rows are used to generate several reports.<br>The reports join a column that is the primary key.<br>The execution plan contains bookmark lookups for Table1.<br>You discover that the reports run slower than expected.<br>You need to reduce the amount of time it takes to run the reports.<br>Solution: You create a hash index on the primary key column.<br>Does this meet the goal?<br>",
    "options": [
      "<span class=\"multi-choice-letter\" data-choice-letter=\"A\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tYes",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"B\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tB.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tNo"
    ],
    "answer": "B",
    "answerDescription": "Reference:<br>https://msdn.microsoft.com/en-us/library/dn133190.aspx",
    "votes": [],
    "comments": [
      {
        "date": "2021-01-25T12:52:00.000Z",
        "voteCount": 1,
        "content": "A bookmark lookup is the process of finding the actual data in the SQL table, based on an entry found in a non-clustered index.\n\nWhen you search for a value in a non-clustered index, and your query needs more fields than are part of the index leaf node (all the index fields, plus any possible INCLUDE columns), then SQL Server needs to go retrieve the actual data page(s) - that's what's called a bookmark lookup.\n\nIn some cases, that's really the only way to go - only if your query would require just one more field (not a whole bunch of 'em), it might be a good idea to INCLUDE that field in the non-clustered index. In that case, the leaf-level node of the non-clustered index would contain all fields needed to satisfy your query (a \"covering\" index), and thus a bookmark lookup wouldn't be necessary anymore."
      },
      {
        "date": "2020-09-23T05:17:00.000Z",
        "voteCount": 1,
        "content": "How is it supposed to work? If the execution plan  contains bookmark lookups then it is\nnot a Memory-optimized table. Then \"You create a hash index on the primary key column\" but a hash index can be created only on a Memory-optimized table. Catch-22\n\nThe question has to give a  hint that you take some steps to convert the table to a Memory-optimized table in the first place. Once you create a primary key on it you get an index automatically, by default it is non-hash but it will be enough to prevent any bookmark lookups. You do not need a hash index"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 149,
    "url": "https://www.examtopics.com/discussions/microsoft/view/8054-exam-70-761-topic-1-question-149-discussion/",
    "body": "Note: This question is part of a series of questions that present the same scenario. Each question in the series contains a unique solution that might meet the stated goals. Some question sets might have more than one correct solution, while others might not have a correct solution.<br>After you answer a question in this section, you will NOT be able to return to it. As a result, these questions will not appear in the review screen.<br>You are creating indexes in a data warehouse.<br>You have a dimension table named Table1 that has 10,000 rows. The rows are used to generate several reports.<br>The reports join a column that is the primary key.<br>The execution plan contains bookmark lookups for Table1.<br>You discover that the reports run slower than expected.<br>You need to reduce the amount of time it takes to run the reports.<br>Solution: You create a clustered index on the primary key column.<br>Does this meet the goal?<br>",
    "options": [
      "<span class=\"multi-choice-letter\" data-choice-letter=\"A\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tYes",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"B\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tB.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tNo"
    ],
    "answer": "A",
    "answerDescription": "",
    "votes": [],
    "comments": [
      {
        "date": "2019-11-12T20:23:00.000Z",
        "voteCount": 12,
        "content": "If primary key is created, then clustered index is already created. if report is running slow while joining with primary key. How does performance improve when index is recreated."
      },
      {
        "date": "2020-05-30T13:18:00.000Z",
        "voteCount": 13,
        "content": "A primary key is a logical concept - it's the unique identifier for a row in a table. As such, it has a bunch of attributes - it may not be null, and it must be unique. Of course, as you're likely to be searching for records by their unique identifier a lot, it would be good to have an index on the primary key.\nA clustered index is a physical concept - it's an index that affects the order in which records are stored on disk. This makes it a very fast index when accessing data, though it may slow down writes if your primary key is not a sequential number.\nYes, you can have a primary key without a clustered index - and sometimes, you may want to (for instance when your primary key is a combination of foreign keys on a joining table, and you don't want to incur the disk shuffle overhead when writing).\nYes, you can create a clustered index on columns that aren't a primary key.\nSo. I think the answer is YES (A)."
      },
      {
        "date": "2020-12-15T12:46:00.000Z",
        "voteCount": 2,
        "content": "Primary can be nonclustered"
      },
      {
        "date": "2021-01-10T09:50:00.000Z",
        "voteCount": 2,
        "content": "I think they want you to realize that the bookmark lookup indicates a need for a non-clustered index with some INCLUDE columns. A primary key column automatically has a clustered index already, rebuilding it wouldn't change the current (too slow) performance. So i think B (no)."
      },
      {
        "date": "2020-04-20T20:30:00.000Z",
        "voteCount": 2,
        "content": "in this case covering index would be useful. hence answer is B."
      },
      {
        "date": "2019-11-20T10:04:00.000Z",
        "voteCount": 1,
        "content": "Needs to be nonclustered"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 150,
    "url": "https://www.examtopics.com/discussions/microsoft/view/13621-exam-70-761-topic-1-question-150-discussion/",
    "body": "Note: This question is part of a series of questions that present the same scenario. Each question in the series contains a unique solution that might meet the stated goals. Some question sets might have more than one correct solution, while others might not have a correct solution.<br>After you answer a question in this section, you will NOT be able to return to it. As a result, these questions will not appear in the review screen.<br>You are creating indexes in a data warehouse.<br>You have a dimension table named Table1 that has 10,000 rows. The rows are used to generate several reports.<br>The reports join a column that is the primary key.<br>The execution plan contains bookmark lookups for Table1.<br>You discover that the reports run slower than expected.<br>You need to reduce the amount of time it takes to run the reports.<br>Solution: You create a nonclustered index on the primary key column that includes the bookmark lookup columns.<br>Does this meet the goal?<br>",
    "options": [
      "<span class=\"multi-choice-letter\" data-choice-letter=\"A\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tYes",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"B\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tB.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tNo"
    ],
    "answer": "B",
    "answerDescription": "",
    "votes": [],
    "comments": [
      {
        "date": "2020-02-08T14:13:00.000Z",
        "voteCount": 14,
        "content": "Why can't? I think that should be A. Yes."
      },
      {
        "date": "2020-03-04T05:35:00.000Z",
        "voteCount": 7,
        "content": "yes. this is A. Yes   the answer for previous would be NO. The data comes directly from the Index"
      },
      {
        "date": "2020-05-30T13:24:00.000Z",
        "voteCount": 5,
        "content": "Server Query Optimizer decides to use the clustered index to retrieve the requested data, as it is more efficient, much faster and fewer resources consumer than scanning the whole table, in addition to having the data sorted in the index pages.\nThis is NO, and previous is YES"
      },
      {
        "date": "2021-01-01T18:55:00.000Z",
        "voteCount": 2,
        "content": "A - with a nonclustered index including the key lookup fields, you have a covering index which is faster"
      },
      {
        "date": "2020-08-15T09:40:00.000Z",
        "voteCount": 1,
        "content": "I think it is yes and the previous also yes since the join criteria is the primary key and therefor the clustered index useful as additional lookups aren't necessary anymore"
      },
      {
        "date": "2020-02-27T02:26:00.000Z",
        "voteCount": 3,
        "content": "I'd also say that it should at least be faster than before because the query doesn't have to read data from the table itself but just from the index. As far as there are not so many columns to include this could be a possible option to gain performance."
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 151,
    "url": "https://www.examtopics.com/discussions/microsoft/view/8055-exam-70-761-topic-1-question-151-discussion/",
    "body": "Note: This question is part of a series of questions that present the same scenario. Each question in the series contains a unique solution that might meet the stated goals. Some question sets might have more than one correct solution, while others might not have a correct solution.<br>After you answer a question in this section, you will NOT be able to return to it. As a result, these questions will not appear in the review screen.<br>You have a database named DB1 that contains two tables named Sales.Customers and Sales.Orders. Sales.Customers has a foreign key relationship to a column named CustomerID in SalesOrders.<br>You need to recommend a query that returns all the customers. The query must also return the number of orders that each customer placed in 2016.<br>Solution: You recommend the following query:<br><img src=\"/assets/media/exam-media/02675/0032900001.png\" class=\"in-exam-image\"><br>Does this meet the goal?<br>",
    "options": [
      "<span class=\"multi-choice-letter\" data-choice-letter=\"A\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tYes",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"B\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tB.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tNo"
    ],
    "answer": "B",
    "answerDescription": "Reference:<br>https://docs.microsoft.com/en-us/sql/t-sql/functions/count-transact-sql?view=sql-server-2017",
    "votes": [],
    "comments": [
      {
        "date": "2020-12-15T12:52:00.000Z",
        "voteCount": 1,
        "content": "First of all it use CustomerName for Group by . But CustomerName may be not UNIQUE and we can group different persons in one group. CustomerId is unique and should be used in GROUP BY"
      },
      {
        "date": "2020-07-09T13:40:00.000Z",
        "voteCount": 1,
        "content": "no. at least bc no ref to 2016 in query"
      },
      {
        "date": "2020-04-08T00:55:00.000Z",
        "voteCount": 2,
        "content": "It would be correct if it was like this:\nselect c.CusName, NumOfOrders=count(OrderId)\nfrom #Customer c \nleft join #Orders o on o.Cusid=c.CusId\ngroup by c.CusName"
      },
      {
        "date": "2020-04-08T00:57:00.000Z",
        "voteCount": 3,
        "content": "plus if it was there a predicate about year 2016"
      },
      {
        "date": "2019-11-12T20:29:00.000Z",
        "voteCount": 1,
        "content": "Can select query contains = symbol?"
      },
      {
        "date": "2020-02-18T01:30:00.000Z",
        "voteCount": 2,
        "content": "yes it can"
      },
      {
        "date": "2020-11-26T17:23:00.000Z",
        "voteCount": 1,
        "content": "Yes, it is another way to assign an alias. Equivalent to: COUNT(OrderID) AS NumOfOrders."
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 152,
    "url": "https://www.examtopics.com/discussions/microsoft/view/3854-exam-70-761-topic-1-question-152-discussion/",
    "body": "Note: This question is part of a series of questions that present the same scenario. Each question in the series contains a unique solution that might meet the stated goals. Some question sets might have more than one correct solution, while others might not have a correct solution.<br>After you answer a question in this section, you will NOT be able to return to it. As a result, these questions will not appear in the review screen.<br>You have a database named DB1 that contains two tables named Sales.Customers and Sales.Orders. Sales.Customers has a foreign key relationship to a column named CustomerID in Sales.Orders.<br>You need to recommend a query that returns all the customers. The query must also return the number of orders that each customer placed in 2016.<br>Solution: You recommend the following query:<br><img src=\"/assets/media/exam-media/02675/0033000001.png\" class=\"in-exam-image\"><br>Does this meet the goal?<br>",
    "options": [
      "<span class=\"multi-choice-letter\" data-choice-letter=\"A\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tYes",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"B\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tB.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tNo"
    ],
    "answer": "A",
    "answerDescription": "",
    "votes": [],
    "comments": [
      {
        "date": "2019-08-20T05:49:00.000Z",
        "voteCount": 18,
        "content": "Is this correct? It does not fullfill the requirement \"The query must also return the number of orders that each customer placed in 2016.\" =&gt; where is the filter to 2016?"
      },
      {
        "date": "2019-08-21T05:07:00.000Z",
        "voteCount": 7,
        "content": "Additionally, the ON clause is not correct comparing customerid and orderid"
      },
      {
        "date": "2019-12-12T01:32:00.000Z",
        "voteCount": 4,
        "content": "Additionally, for customers with no orders, there will be a count of 1 because of the left join"
      },
      {
        "date": "2021-01-18T13:49:00.000Z",
        "voteCount": 1,
        "content": "So  you need the number of orders and you're counting the customerid's.....very strange and wrong"
      },
      {
        "date": "2020-06-25T08:30:00.000Z",
        "voteCount": 1,
        "content": "Missing the HAVING Clause, I think"
      },
      {
        "date": "2020-05-30T13:32:00.000Z",
        "voteCount": 2,
        "content": "Wrong. Many reasons as everyone mentioned"
      },
      {
        "date": "2020-03-05T05:53:00.000Z",
        "voteCount": 6,
        "content": "The answer is No. \nThe right query is:\nSELECT Cust.CustName, NumberOfOrder = COUNT(ORD.CUSTOMERID)\nFROM Sales.Customers Cust\nLEFT JOIN (SELECT * FROM Sales.Orders WHERE YEAR(orderdate)=2016) Ord\nON Cust.CustomerID=Ord.CustomerID\nGROUP BY Cust.CustomerName;"
      },
      {
        "date": "2021-01-18T13:49:00.000Z",
        "voteCount": 1,
        "content": "still wrong. you count customerids whereas number of orders is needed"
      },
      {
        "date": "2020-02-04T22:21:00.000Z",
        "voteCount": 2,
        "content": "this is wrong it must comply with the year"
      },
      {
        "date": "2019-11-19T10:46:00.000Z",
        "voteCount": 3,
        "content": "We can read in the question \"Sales.Customers has a foreign key relationship to a column named CustomerID in Sales.Orders.\".\nSo it cannot be \"ON Cust.CustomerID = Ord.OrderID\""
      },
      {
        "date": "2019-09-22T02:43:00.000Z",
        "voteCount": 5,
        "content": "Answer is No"
      },
      {
        "date": "2019-08-23T00:26:00.000Z",
        "voteCount": 4,
        "content": "Agree. However, it seems the topic concerned here is the difference between COUNT(*) and COUNT(CustomerID)."
      },
      {
        "date": "2019-08-21T05:13:00.000Z",
        "voteCount": 1,
        "content": "Also what I see wrong is that the \"join\" predicate is comparing with the wrong column i.e. \"order id\" and not \"customer_id\""
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 153,
    "url": "https://www.examtopics.com/discussions/microsoft/view/7947-exam-70-761-topic-1-question-153-discussion/",
    "body": "Note: This question is part of a series of questions that present the same scenario. Each question in the series contains a unique solution that might meet the stated goals. Some question sets might have more than one correct solution, while others might not have a correct solution.<br>After you answer a question in this section, you will NOT be able to return to it. As a result, these questions will not appear in the review screen.<br>You have a database named DB1 that contains two tables named Sales.Customers and Sales.Orders. Sales.Customers has a foreign key relationship to a column named CustomerID in Sales.Orders.<br>You need to recommend a query that returns all the customers. The query must also return the number of orders that each customer placed in 2016.<br>Solution: You recommend the following query:<br><img src=\"/assets/media/exam-media/02675/0033100001.png\" class=\"in-exam-image\"><br>Does this meet the goal?<br>",
    "options": [
      "<span class=\"multi-choice-letter\" data-choice-letter=\"A\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tYes",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"B\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tB.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tNo"
    ],
    "answer": "B",
    "answerDescription": "",
    "votes": [],
    "comments": [
      {
        "date": "2019-11-10T22:02:00.000Z",
        "voteCount": 4,
        "content": "wrong answer, the query counts corectly, the only suspicious thing is the ON clause with c. cust=o. ord. id. Should be c. custid=o. custid"
      },
      {
        "date": "2019-11-20T01:46:00.000Z",
        "voteCount": 12,
        "content": "The question demands: \"orders that each customer placed in 2016\"."
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 154,
    "url": "https://www.examtopics.com/discussions/microsoft/view/3886-exam-70-761-topic-1-question-154-discussion/",
    "body": "Note: This question is part of a series of questions that present the same scenario. Each question in the series contains a unique solution that might meet the stated goals. Some question sets might have more than one correct solution, while others might not have a correct solution.<br>After you answer a question in this section. You will NOT be able to return to it. As a result, these questions will not appear in the review screen.<br>You have a database that contains a single table named tblVehicleRegistration. The table is defined as follows:<br><img src=\"/assets/media/exam-media/02675/0033200001.png\" class=\"in-exam-image\"><br>You run the following query:<br><img src=\"/assets/media/exam-media/02675/0033200002.png\" class=\"in-exam-image\"><br>The query output window displays the following error message: \"Conversion failed when converting the varchar value \"\u02dcAB012' to data type int.\"<br>You need to resolve the error.<br>Solution: You modify the Transact-SQL statement as follows:<br><img src=\"/assets/media/exam-media/02675/0033200003.png\" class=\"in-exam-image\"><br>Does the solution meet the goal?<br>",
    "options": [
      "<span class=\"multi-choice-letter\" data-choice-letter=\"A\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tYes",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"B\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tB.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tNo"
    ],
    "answer": "A",
    "answerDescription": "",
    "votes": [],
    "comments": [
      {
        "date": "2019-08-21T05:09:00.000Z",
        "voteCount": 22,
        "content": "IMO is the correct answer B since it can occur taht the RegistrationNumber holds alphanumerical data (due to that it holds the data type varchar(5))"
      },
      {
        "date": "2019-11-10T22:18:00.000Z",
        "voteCount": 1,
        "content": "but in this paticular case they ask us to cast 20012 and this is just a number"
      },
      {
        "date": "2019-11-20T01:53:00.000Z",
        "voteCount": 7,
        "content": "IF OBJECT_ID('TEMPDB..#tblVehicleRegistration') IS NOT NULL DROP TABLE #tblVehicleRegistration\nGO\n\nCREATE TABLE #tblVehicleRegistration\n(\n\tVehicleID\t\t\t\tINT PRIMARY KEY IDENTITY\n\t, RegistrationNumber\tVARCHAR(5)\n\t, RegistrationDate\t\tDATE\n\t, UserID\t\t\t\tINT\n)\nGO\n\nINSERT INTO #tblVehicleRegistration(RegistrationNumber, RegistrationDate, UserID)\nVALUES\t('XBP01', GETDATE(), 1)\n\t\t, ('ABC45', GETDATE(), 2)\n\n\nSELECT\tUserID\nFROM\t#tblVehicleRegistration\nWHERE\tCAST(RegistrationNumber AS INT) = 20012\n\tAND RegistrationDate &gt; '2016-01-01'"
      },
      {
        "date": "2020-12-06T02:09:00.000Z",
        "voteCount": 1,
        "content": "sql server trying to cast RegistrationNumber to int because of int data type precedence is higher then char's"
      },
      {
        "date": "2019-08-21T05:35:00.000Z",
        "voteCount": 22,
        "content": "It will not work because CAST tries to do the same implicit conversion explicitly which was failing and it will fail again because there are 'letters' inside the RegistrationNumber column which can not be converted to an int type. So the correct answer is no."
      },
      {
        "date": "2021-01-18T21:34:00.000Z",
        "voteCount": 1,
        "content": "Correct. Answer = B. You just cannot convert character values. If ALL the registration numbers would have been 20012 though it would have worked."
      },
      {
        "date": "2020-12-15T13:06:00.000Z",
        "voteCount": 1,
        "content": "Cast doesnt work here"
      },
      {
        "date": "2020-07-07T06:23:00.000Z",
        "voteCount": 1,
        "content": "\"You need to resolve the error.\" Answer A) does resolve the error in this case. Maybe we'll find out on the exam!"
      },
      {
        "date": "2020-06-13T06:04:00.000Z",
        "voteCount": 4,
        "content": "This cast works only if RegistrationNumber holds a string\nwith integer value, it will fail if it has any non digits, \nso the correct answer is B\n\n--------------------------------------\nDECLARE @RegistrationNumber1 varchar(5) ='20012' \nDECLARE @RegistrationNumber2 varchar(5) ='AB012'\nPRINT CAST(@RegistrationNumber1 AS int)\nPRINT CAST(@RegistrationNumber2 AS int)\n\n// Output\n20012\nMsg 245, Level 16, State 1, Line 4\nConversion failed when converting the varchar value 'AB012' to data type int."
      },
      {
        "date": "2020-05-30T13:39:00.000Z",
        "voteCount": 1,
        "content": "It seems strange because registration number is varchar type but in fact it works. Tested, Correct (A)"
      },
      {
        "date": "2020-06-04T10:15:00.000Z",
        "voteCount": 1,
        "content": "But if registration number contains letter it fails to convert. So its NO"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 155,
    "url": "https://www.examtopics.com/discussions/microsoft/view/15425-exam-70-761-topic-1-question-155-discussion/",
    "body": "You have a database that includes the tables shown in the exhibit. (Click the exhibit button.)<br><img src=\"/assets/media/exam-media/02675/0033300001.jpg\" class=\"in-exam-image\"><br>You need to create a list of all customers and the date that the customer placed their last order. For customers who have not placed orders, you must substitute<br>01/01/1990 for the date.<br>Which Transact-SQL statement should you run?<br><img src=\"/assets/media/exam-media/02675/0033400001.png\" class=\"in-exam-image\"><br>A.<br><img src=\"/assets/media/exam-media/02675/0033400002.png\" class=\"in-exam-image\"><br>B.<br><img src=\"/assets/media/exam-media/02675/0033400003.png\" class=\"in-exam-image\"><br>C.<br><img src=\"/assets/media/exam-media/02675/0033400004.png\" class=\"in-exam-image\"><br>D.<br>",
    "options": [],
    "answer": "A",
    "answerDescription": "",
    "votes": [],
    "comments": [
      {
        "date": "2020-03-04T06:17:00.000Z",
        "voteCount": 9,
        "content": "A is correct if the date in 19900101"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 156,
    "url": "https://www.examtopics.com/discussions/microsoft/view/3811-exam-70-761-topic-1-question-156-discussion/",
    "body": "HOTSPOT -<br>You need to develop a function that returns a list of courses grouped by the total number of students in a course.<br>The function must list only courses that have more than a specific number of students. The specific number of students is defined as an input variable for the function.<br>How should you complete the function? To answer, select the appropriate Transact-SQL segments in the answer area.<br>NOTE: Each correct selection is worth one point.<br>Hot Area:<br><img src=\"/assets/media/exam-media/02675/0033600001.png\" class=\"in-exam-image\"><br>",
    "options": [],
    "answer": "<img src=\"/assets/media/exam-media/02675/0033700001.png\" class=\"in-exam-image\">",
    "answerDescription": "",
    "votes": [],
    "comments": [
      {
        "date": "2019-08-21T05:11:00.000Z",
        "voteCount": 27,
        "content": "Update: in addition, answer of Box 3 must be HAVING, since where does not allow aggregate functions"
      },
      {
        "date": "2020-05-30T14:36:00.000Z",
        "voteCount": 21,
        "content": "it is:\n1. Table \n2. SUM(cp.NumStudents) AS NumStudents\n3. Having"
      },
      {
        "date": "2021-01-18T21:52:00.000Z",
        "voteCount": 1,
        "content": "you can only do this using group by and having. An alias after the sum is even permitted.\n\nselect A.EMPLOYEENUMBER, sum(B.AMOUNT) AS TOTALSUM\nfrom TBLEMPLOYEES\nINNER JOIN\nTBLTRANSACTIES B\nON A.EMPLOYEENUMBER = B.EMPLOYEENUMBER\nGROUP BY A.EMPLOYEENUMBER\nHAVING SUM(B.AMOUNT) &gt; 0"
      },
      {
        "date": "2021-01-01T19:13:00.000Z",
        "voteCount": 1,
        "content": "Need alias and then move on"
      },
      {
        "date": "2020-12-19T05:18:00.000Z",
        "voteCount": 1,
        "content": "2) The result set must include only one score for each employee for each course.\nIf you want to solve this part of the question:\n\n;with Evals_CTE (courseId, EmployeeId, EvalScore)\nAS\n\t(\n\tselect CourseID, EmployeeID, EvalScore\n\tfrom Evaluations\n\t)\nselect EmployeeId, courseId, AVG(EvalScore) AvgScore\nfrom Evals_CTE\ngroup by  EmployeeId, courseId\n\nAll that said and done the question is asking two different things that can only be answered with \ntwo different approaches. I think we got two\nfor one here. let's move on to the next question :)"
      },
      {
        "date": "2020-12-19T05:17:00.000Z",
        "voteCount": 1,
        "content": "The question has two parts:\n1)You must create a report that returns course identifiers and the average evaluation score for each course\nOk \nIf you want to solve this part use:\n\n;with Evals_CTE (courseId, EmployeeId, EvalScore)\nAS\n\t(\n\tselect CourseID, EmployeeID, EvalScore\n\tfrom Evaluations\n\t)\nselect  courseId, AVG(EvalScore) AvgScore\nfrom Evals_CTE\ngroup by   courseId"
      },
      {
        "date": "2020-12-19T05:16:00.000Z",
        "voteCount": 1,
        "content": "You are welcome to use this sample date below:\nuse test3\ngo\ncreate table Evaluations(\nEvaluationID int not null,\nEmployeeID int not null,\nCourseId int null,\nEvalScore int null\n)\n\ninsert into Evaluations values\n(1, 11, 2000, 89),\n(1, 11, 2000, 91),\n(2, 11, 3000, 90),\n(2, 11, 3000, 80),\n(3, 11, 4000, 78),\n(3, 11, 4000, 88),\n(4, 22, 2000, 90),\n(4, 22, 2000, 60),\n(5, 22, 3000, 70),\n(5, 22, 3000, 90),\n(6, 22, 4000, 88),\n(6, 22, 4000, 98),\n(7, 33, 2000, 80),\n(7, 33, 2000, 90),\n(8, 33, 3000, 80),\n(8, 33, 3000, 90),\n(9, 33, 4000, 86),\n(9, 33, 4000, 86),\n(10,44, 2000, 70),\n(10,44, 2000, 90),\n(10,44, 3000, 70),\n(10,44, 3000, 60),\n(10,44, 4000, 70),\n(10,44, 4000, 90)"
      },
      {
        "date": "2020-12-19T03:41:00.000Z",
        "voteCount": 1,
        "content": "That is right the Group by Clause is missing here. The example given above has the Group By\nthat is why it works. Question needs some corrections."
      },
      {
        "date": "2020-12-15T13:14:00.000Z",
        "voteCount": 1,
        "content": "is it only me who doesn't see GROUP BY clause?"
      },
      {
        "date": "2020-11-13T10:16:00.000Z",
        "voteCount": 2,
        "content": "You have to provide a name for every column in a table...including the table returned by the function, so the 2nd choice should be the one with a name.\nCheck something similar:\nhttps://stackoverflow.com/questions/20251911/column-alias-error-with-sql-server-udf\n\nTested:\ncreate table employees(ID int, orderAmount INT);\nGO\ninsert into employees values(1, 5),(2,5),(3,5),(4,4),(5,1);\nGO\n\nCREATE function MyF(@var int)\nreturns table\nas \nReturn\nselect ID, sum(orderAmount) as S\nfrom employees\ngroup by ID\nhaving sum(orderAmount) &gt; @var;\nGO\n\nSelect * from MyF(4);"
      },
      {
        "date": "2020-09-06T11:38:00.000Z",
        "voteCount": 3,
        "content": "Need a Group By C.Course and it has to be Having Sum(cp.NumStudents) &gt; @totalStudents"
      },
      {
        "date": "2020-07-07T06:52:00.000Z",
        "voteCount": 4,
        "content": "having wont work without a group by"
      },
      {
        "date": "2020-10-24T09:50:00.000Z",
        "voteCount": 3,
        "content": "actually it does work. When GROUP BY is not used, there is an implicit single, aggregated group. \nhttps://docs.microsoft.com/en-us/sql/t-sql/queries/select-having-transact-sql?view=sql-server-ver15"
      },
      {
        "date": "2020-03-10T19:34:00.000Z",
        "voteCount": 8,
        "content": "You must provide alias for column, otherwise you will get compilation error when creating function.\n\nGroup by is another thing which is missing here but let's suppose that is not part of this question."
      },
      {
        "date": "2020-02-04T22:24:00.000Z",
        "voteCount": 3,
        "content": "having is correct"
      },
      {
        "date": "2019-11-20T10:24:00.000Z",
        "voteCount": 3,
        "content": "Missing alias as well"
      },
      {
        "date": "2019-11-20T10:23:00.000Z",
        "voteCount": 3,
        "content": "I agree where cannot be used.  Should be having"
      },
      {
        "date": "2019-09-22T21:56:00.000Z",
        "voteCount": 17,
        "content": "'Group by' is missing as well."
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 157,
    "url": "https://www.examtopics.com/discussions/microsoft/view/24940-exam-70-761-topic-1-question-157-discussion/",
    "body": "HOTSPOT -<br>You develop and deploy a project management application. The application uses a Microsoft SQL Server database to store data. You are developing a software bug tracking add-on for the application.<br>The add-on must meet the following requirements:<br>\u2711 Allow case sensitive searches for product.<br>\u2711 Filter search results based on exact text in the description.<br>\u2711 Support multibyte Unicode characters.<br>You run the following Transact-SQL statement:<br><img src=\"/assets/media/exam-media/02675/0033800004.png\" class=\"in-exam-image\"><br>Users report that searches for the product Salt also return results for the product salt.<br>You need to ensure that the query returns the correct results.<br>How should you complete the Transact-SQL statement? To answer, select the appropriate Transact-SQL segments in the answer area.<br>NOTE: Each correct selection is worth one point.<br>Hot Area:<br><img src=\"/assets/media/exam-media/02675/0033900001.png\" class=\"in-exam-image\"><br>",
    "options": [],
    "answer": "<img src=\"/assets/media/exam-media/02675/0034000001.png\" class=\"in-exam-image\">",
    "answerDescription": "References:<br>https://stackoverflow.com/questions/1831105/how-to-do-a-case-sensitive-search-in-where-clause-im-using-sql-server",
    "votes": [],
    "comments": [
      {
        "date": "2020-07-06T14:08:00.000Z",
        "voteCount": 1,
        "content": "I think the question is wrong as one of the requirement is \"Filter search results based on exact text in the description\" , hence Description field should be used in where not the product."
      },
      {
        "date": "2020-11-27T15:38:00.000Z",
        "voteCount": 2,
        "content": "A little confusing yes, but I think the answer is here: \"Users report that searches for the product Salt also return results for the product salt.\". It seems they are having issues in the Product column."
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 158,
    "url": "https://www.examtopics.com/discussions/microsoft/view/5135-exam-70-761-topic-1-question-158-discussion/",
    "body": "HOTSPOT -<br>You are developing a training management application. You run the following Transact-SQL statement:<br><img src=\"/assets/media/exam-media/02675/0034100001.png\" class=\"in-exam-image\"><br>You must create a report that returns course identifiers and the average evaluation score for each course. The result set must include only one score for each employee for each course.<br>How should you complete the Transact-SQL statement? To answer, select the appropriate Transact-SQL segments in the answer area.<br>NOTE: Each correct selection is worth one point.<br>Hot Area:<br><img src=\"/assets/media/exam-media/02675/0034100002.png\" class=\"in-exam-image\"><br>",
    "options": [],
    "answer": "<img src=\"/assets/media/exam-media/02675/0034200001.png\" class=\"in-exam-image\">",
    "answerDescription": "",
    "votes": [],
    "comments": [
      {
        "date": "2019-09-13T02:13:00.000Z",
        "voteCount": 14,
        "content": "The first box should be DISTINCT CourseId, EmployeeId, EvalScore"
      },
      {
        "date": "2020-02-11T05:49:00.000Z",
        "voteCount": 3,
        "content": "But, if there are duplicates like (1,1,1),(1,1,1) the avg value will be 1 anyway. So it looks like the result with and without distinct will be the same because we calculate avg (not sum) values."
      },
      {
        "date": "2020-02-26T06:28:00.000Z",
        "voteCount": 5,
        "content": "no, since AVG(1, 1, 1, 2) =/= AVG(1, 2)"
      },
      {
        "date": "2020-06-05T07:42:00.000Z",
        "voteCount": 2,
        "content": "yes, but it means without distinct"
      },
      {
        "date": "2019-11-20T02:19:00.000Z",
        "voteCount": 6,
        "content": "I think to meet the condition: \"The result set must include only one score for each employee for each course\", EmployeeId must also be included in the group by clause. Now you only get one score for each course."
      },
      {
        "date": "2020-02-14T08:46:00.000Z",
        "voteCount": 2,
        "content": "I agree, otherwise we will only get courseID and AvgCourseScore, which score is for all employe"
      },
      {
        "date": "2020-06-05T08:45:00.000Z",
        "voteCount": 1,
        "content": "Totally agree"
      },
      {
        "date": "2020-07-24T07:55:00.000Z",
        "voteCount": 1,
        "content": "I just came across that as well. Even before looking at the CTE, I saw that we were only grouping by courseid so there had to be a flaw in the question. As it stands, an aggregate function perform is based on all individuals who have taken the course"
      },
      {
        "date": "2020-11-27T15:51:00.000Z",
        "voteCount": 2,
        "content": "What the question asks to return in your report is only: \"You must create a report that returns course identifiers and the average evaluation score for each course.\" Nowhere it is asking to return avg evaluation score by course id and by employee. And you need to previously select 1 score for 1 course for 1 employee."
      },
      {
        "date": "2021-01-18T22:36:00.000Z",
        "voteCount": 1,
        "content": "drop table evaluations\ncreate table evaluations\n( \nevaluationID int not null,\nemployeeID int null,\ncourseID int null,\nevalScore int null\n)\n\ninsert into evaluations values\n(1, 123, 222, 18),\n(2, 124, 222, 12),\n(3, 125, 223, 20),\n(4, 126, 224, 21),\n(5, 126, 223, 35)\n\nselect * from evaluations\nselect courseid, employeeid, evalscore from evaluations\n;\nwith evals_CTE (courseID, employeeid, evalscore)\nas\n(select courseid, employeeid, evalscore from evaluations)\nselect courseID, avg(distinct(evalscore)) from  evals_cte group by courseid"
      },
      {
        "date": "2021-01-01T19:25:00.000Z",
        "voteCount": 1,
        "content": "No correct answer. Even with DISTINCT(CourseID, EmployeeID, EvalScore) you would get multiple rows for the course/employee if the eval scores were different."
      },
      {
        "date": "2020-10-21T05:55:00.000Z",
        "voteCount": 1,
        "content": "To include one score for each employee for each course the DISTINCT clause is not enough; this would need a ranking function."
      },
      {
        "date": "2020-09-06T15:37:00.000Z",
        "voteCount": 1,
        "content": "This portion is correct:  SELECTCourseID, EmployeeID, EvalScore FROM Evaluations will bring in all the Course and their EvalScore. \n\nWhen you group by CourseID and get the AVG(EvalScore) you will get average score by course but not by employee so you need to group by employeeID and CourseID and also add EmployeeID to the select in order for the result set to be correct. If you want to see the employeeID per course you should show it."
      },
      {
        "date": "2020-07-07T08:08:00.000Z",
        "voteCount": 1,
        "content": "this req: \"The result set must include only one score for each employee for each course.\"\nseems like it would need a distinct courseid, empid, evalscore"
      },
      {
        "date": "2020-06-09T08:47:00.000Z",
        "voteCount": 1,
        "content": "so which is the correct answer for the first box?"
      },
      {
        "date": "2020-05-30T15:04:00.000Z",
        "voteCount": 1,
        "content": "how about select courseid, avg(distinct evalscore) in second box?"
      },
      {
        "date": "2020-06-05T08:41:00.000Z",
        "voteCount": 2,
        "content": "Sorry, not. Box 2 is just courseid, avg(evalscore). While first course is without distinct. The answer of this question is right. Try to test with the same evalscore for the same courseid fro different employeeid. The right result is not with Distinct in first box but WITHOUT distinct."
      },
      {
        "date": "2020-06-05T09:49:00.000Z",
        "voteCount": 1,
        "content": "I regret, first box is distinct and second just avg. The problem here is with groub by employeeid, which must be included"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 159,
    "url": "https://www.examtopics.com/discussions/microsoft/view/26377-exam-70-761-topic-1-question-159-discussion/",
    "body": "SIMULATION -<br>You have a database that contains a table named Products in the Sales schema. The table was created by running the following Transact-SQL statement:<br><img src=\"/assets/media/exam-media/02675/0034300001.png\" class=\"in-exam-image\"><br>The table includes the data shown below:<br><img src=\"/assets/media/exam-media/02675/0034300002.png\" class=\"in-exam-image\"><br>You are developing a report that displays the following values and column headers in the order listed below:<br>\u2711 average price of a product named Average<br>\u2711 the smallest number of products in stock named LowestNumber<br>\u2711 the highest product price named HighestPrice<br>You need to write a query to return the results for the report. The query must meet the following requirements:<br>\u2711 Use built-in, aggregate and mathematical functions.<br>\u2711 Use two-part names and tables.<br>\u2711 Use the table alias to qualify column names.<br>\u2711 Define the alias for all fields by using the AS keyword.<br>\u2711 Use the first letter of the table name as the table alias.<br>\u2711 Do not use the ROW_NUMBER function.<br>\u2711 Do not surround object names with square brackets.<br>\u2711 Do not use variables.<br>Part of the correct Transact-SQL has been provided in the answer area below. Enter the code in the answer area that resolves the problem and meets the stated goals or requirements. You can add code within the code that has been provided as well as below it.<br><img src=\"/assets/media/exam-media/02675/0034400001.png\" class=\"in-exam-image\"><br>1. SELECT<br>2. FROM Sales.Products AS P<br>Use the Check Syntax button to verify your work. Any syntax or spelling errors will be reported by line and character position. You may check syntax as many times as needed.<br>",
    "options": [],
    "answer": "See explanation below",
    "answerDescription": "1. SELECT avg(P.ProductPrice) AS Average, min(P.ProductsInStock) AS LowestNumber, max(P.ProductPrice) AS HighestPrice<br>2. FROM Sales.Products AS P<br><br>Make the additions to line 1.<br>References:<br>https://www.mssqltips.com/sqlservertip/4424/max-min-and-avg-sql-server-functions/",
    "votes": [],
    "comments": [
      {
        "date": "2020-07-21T21:19:00.000Z",
        "voteCount": 5,
        "content": "Group by is not necessary.\nAnswer is correct, you can test yourself:\n\nCREATE TABLE Prod\n(\n ProductID bigint NOT NULL PRIMARY KEY\n,ProductName nvarchar(100) NOT NULL\n,ProductPrice decimal(18,2) NOT NULL\n,ProductsInStock int NOT NULL\n,ProductsOnOrder int NOT NULL\n)\n\nINSERT INTO Prod\nVALUES\n(1, 'ProductA', 10.00, 10, 15)\n,(2, 'ProductB', 30.00, 20, 0)\n,(3, 'ProductC', 15.00, 5, 20)\n\nSELECT AVG(p.ProductPrice) AS Average, MIN(P.ProductsInStock) AS LowestNumber, MAX(P.ProductPrice) AS HighestPrice\nFROM Prod AS p"
      },
      {
        "date": "2020-12-15T19:38:00.000Z",
        "voteCount": 1,
        "content": "use two part names for tables . this is the Sales schema. =&gt; FROM Sales.Product"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 160,
    "url": "https://www.examtopics.com/discussions/microsoft/view/39937-exam-70-761-topic-1-question-160-discussion/",
    "body": "You are developing a mobile app to manage meetups. The app allows for users to view the 25 closest people with similar interests. You have a table that contains records for approximately two million people. You create the table by running the following Transact-SQL statement:<br><img src=\"/assets/media/exam-media/02675/0034500001.png\" class=\"in-exam-image\"><br>You create the following table valued function to generate lists of people:<br><img src=\"/assets/media/exam-media/02675/0034600001.png\" class=\"in-exam-image\"><br>You need to build a report that shows meetings with at least two people only.<br>What should you use?<br>",
    "options": [
      "<span class=\"multi-choice-letter\" data-choice-letter=\"A\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tOUTER APPLY",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"B\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tB.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tCROSS APPLY",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"C\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tC.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tPIVOT",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"D\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tD.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tLEFT OUTER JOIN"
    ],
    "answer": "B",
    "answerDescription": "References:<br>https://www.sqlshack.com/the-difference-between-cross-apply-and-outer-apply-in-sql-server/",
    "votes": [],
    "comments": [
      {
        "date": "2020-12-15T11:09:00.000Z",
        "voteCount": 2,
        "content": "Correctimundo"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 161,
    "url": "https://www.examtopics.com/discussions/microsoft/view/5136-exam-70-761-topic-1-question-161-discussion/",
    "body": "You develop and deploy a project management application. The application uses a Microsoft SQL Server database to store data. You are developing a software bug tracking add-on for the application.<br>The add-on must meet the following requirements:<br>\"\u00a2 Allow case sensitive searches for product.<br>\"\u00a2 Filter search results based on exact text in the description.<br>\"\u00a2 Support multibyte Unicode characters.<br>You run the following Transact-SQL statement:<br><img src=\"/assets/media/exam-media/02675/0034700001.png\" class=\"in-exam-image\"><br>You need to ensure that users can perform searches of descriptions.<br>Which Transact-SQL statement should you run?<br><img src=\"/assets/media/exam-media/02675/0034700002.png\" class=\"in-exam-image\"><br>A.<br><img src=\"/assets/media/exam-media/02675/0034700003.png\" class=\"in-exam-image\"><br>B.<br><img src=\"/assets/media/exam-media/02675/0034700004.png\" class=\"in-exam-image\"><br>C.<br><img src=\"/assets/media/exam-media/02675/0034800001.png\" class=\"in-exam-image\"><br>D.<br>",
    "options": [],
    "answer": "D",
    "answerDescription": "References:<br>https://docs.microsoft.com/en-us/sql/t-sql/queries/contains-transact-sql?view=sql-server-2017",
    "votes": [],
    "comments": [
      {
        "date": "2019-09-13T02:29:00.000Z",
        "voteCount": 10,
        "content": "Cannot use a CONTAINS or FREETEXT predicate on table or indexed view 'Test.dbo.Table_1' because it is not full-text indexed.\n\nCorrect answer A\n\nhttps://docs.microsoft.com/it-it/sql/t-sql/functions/charindex-transact-sql?view=sql-server-2017"
      },
      {
        "date": "2019-10-19T05:50:00.000Z",
        "voteCount": 1,
        "content": "is incomplete the answer A"
      },
      {
        "date": "2019-10-19T05:49:00.000Z",
        "voteCount": 8,
        "content": "\"Allow case sensitive searches for product\"\nCHARINDEX (@term,[DESCRIPTION] COLLATE Latin1_General_CS_AS)"
      },
      {
        "date": "2020-08-13T00:48:00.000Z",
        "voteCount": 6,
        "content": "CREATE TABLE Bug (\n\tId UNIQUEIDENTIFIER NOT NULL,\n\tProduct NVARCHAR(255) NOT NULL,\n\tDescription NVARCHAR(max) NOT NULL,\n\tDateCreated DATETIME NULL,\n\tReportingUser VARCHAR(5) NULL\n\t)\n\t\n\n\tINSERT INTO Bug\n\t(Id, Product, Description, DateCreated, ReportingUser)\n\tVALUES\n\t(NEWID(), N'P1', N'P1\u00a2',GETUTCDATE(), 'User1'),\n\t(NEWID(), N'P2', N'P2\u00a2',GETUTCDATE(), 'User2'),\n\t(NEWID(), N'P3', N'P3',GETUTCDATE(), 'User3');\n\n\tDECLARE @term NVARCHAR(255)\n\tSET @term = N'\u00a2'\n\t/*SELECT Id, Description \n\tFROM Bug \n\tWHERE CONTAINS(Description, @term) ;*/\n\n\tSELECT Id, Description \n\tFROM Bug \n\tWHERE CHARINDEX(@term, Description) &gt; 0;\n\nanswer is A"
      },
      {
        "date": "2019-09-22T01:25:00.000Z",
        "voteCount": 1,
        "content": "https://docs.microsoft.com/en-us/sql/t-sql/queries/contains-transact-sql?view=sql-server-2017\n\"The columns in the CONTAINS clause must come from a single table that has a full-text index. Unless language_term is specified, the language of all columns of the table must be the same.\""
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 162,
    "url": "https://www.examtopics.com/discussions/microsoft/view/39938-exam-70-761-topic-1-question-162-discussion/",
    "body": "You are building a stored procedure named SP1 that calls a stored procedure named SP2.<br>SP2 calls another stored procedure named SP3 that returns a Recordset. The Recordset is stored in a temporary table.<br>You need to ensure that SP2 returns a text value to SP1.<br>What should you do?<br>",
    "options": [
      "<span class=\"multi-choice-letter\" data-choice-letter=\"A\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tCreate a temporary table in SP2, and then insert the text value into the table.",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"B\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tB.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tReturn the text value by using the ReturnValue when SP2 is called.",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"C\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tC.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tAdd the txt value to an OUTPUT parameter of SP2.",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"D\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tD.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tCreate a table variable in SP2, and then insert the text value into the table."
    ],
    "answer": "C",
    "answerDescription": "",
    "votes": [],
    "comments": [
      {
        "date": "2020-12-15T11:11:00.000Z",
        "voteCount": 1,
        "content": "Correctimundo"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 163,
    "url": "https://www.examtopics.com/discussions/microsoft/view/5566-exam-70-761-topic-1-question-163-discussion/",
    "body": "DRAG DROP -<br>You run the following Transact-SQL statement:<br><img src=\"/assets/media/exam-media/02675/0034900001.png\" class=\"in-exam-image\"><br>You need to create a stored procedure that meets the following requirements:<br>\u2711 Inserts data into the Employees table.<br>\u2711 Processes all data changes as a single unit of work.<br>\u2711 Sets the exception severity level to 16 and an error number of 60, 000 when any error occurs.<br>\u2711 If a Transact-SQL statement raises a runtime error, terminates and reverts the entire unit of work, and indicates the line number in the statement where the error occurred.<br>\u2711 Inserts the value New Employee for the Title column if no title is provided.<br>How should you complete the Transact-SQL statement? To answer, drag the appropriate Transact-SQL segment to the correct target. Each Transact-SQL segment may be used once, more than once, or not at all. You may need to drag the split bar between panes or scroll to view content.<br>NOTE: Each correct selection is worth one point.<br>Select and Place:<br><img src=\"/assets/media/exam-media/02675/0035000001.jpg\" class=\"in-exam-image\"><br>",
    "options": [],
    "answer": "<img src=\"/assets/media/exam-media/02675/0035100001.jpg\" class=\"in-exam-image\">",
    "answerDescription": "References:<br>https://stackoverflow.com/questions/180075/executing-a-stored-procedure-inside-begin-end-transaction",
    "votes": [],
    "comments": [
      {
        "date": "2019-09-22T02:03:00.000Z",
        "voteCount": 5,
        "content": "Xact_state () tile and Throw (if there II be \";\" before it statement) II work this same as @@trancount and raiserror"
      },
      {
        "date": "2019-10-08T02:48:00.000Z",
        "voteCount": 2,
        "content": "Not with Xact_state &lt;&gt; 0 \n(compare 3 valued xact logic to @@trancount logic which UNLIKE xact state should be 0 to indicate all transactions are closed)"
      },
      {
        "date": "2019-10-19T05:59:00.000Z",
        "voteCount": 12,
        "content": "no ,because there isn't XACT_ABORT ON"
      },
      {
        "date": "2020-04-14T15:19:00.000Z",
        "voteCount": 5,
        "content": "shouldn't it be THROW? in order to return the line number of error"
      },
      {
        "date": "2020-06-01T09:24:00.000Z",
        "voteCount": 1,
        "content": "it gives error when adding  THROW instead of RAISERROR. Meanwhile, even RAISERROR gives the line number error"
      },
      {
        "date": "2021-01-18T23:31:00.000Z",
        "voteCount": 1,
        "content": "It should be RAISERROR just because rollback tran does not end with a ;\nThing with this is that when applying this error number you actually would need to register it in the sys.message.\nError message of used error message is as follows :\nbut no message with that error number was found in sys.messages"
      },
      {
        "date": "2021-01-01T19:59:00.000Z",
        "voteCount": 1,
        "content": "@@TRANCOUNT and THROW"
      },
      {
        "date": "2021-01-01T20:03:00.000Z",
        "voteCount": 1,
        "content": "A bit more research and XACT_STATE may be better but both should work... Hard to test because I can't get a difference"
      },
      {
        "date": "2021-01-01T20:08:00.000Z",
        "voteCount": 1,
        "content": "Biggest thing is THROW over RAISERROR because it reports the line number where the error occurred vs. where RAISERROR was called. Tested this."
      },
      {
        "date": "2020-11-13T14:46:00.000Z",
        "voteCount": 1,
        "content": "it needs to be THROW because one of the requirement states: 'terminates and reverts the entire unit of work'. raiserror does not do that, throw does."
      },
      {
        "date": "2020-11-13T14:48:00.000Z",
        "voteCount": 1,
        "content": "While raiserror only aborts if severity &gt;20"
      },
      {
        "date": "2020-11-13T14:54:00.000Z",
        "voteCount": 1,
        "content": "just noticed it is rolling back after if statement..."
      },
      {
        "date": "2020-08-15T06:57:00.000Z",
        "voteCount": 2,
        "content": "Without the ';' at the end of the rollback statement the use of throw would raise a syntax error. so raiserror is indeed correct."
      },
      {
        "date": "2020-06-01T09:24:00.000Z",
        "voteCount": 2,
        "content": "I think its OK. Tested"
      },
      {
        "date": "2020-05-21T12:45:00.000Z",
        "voteCount": 1,
        "content": "I can't think of why THROW cannot be used here."
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 164,
    "url": "https://www.examtopics.com/discussions/microsoft/view/5137-exam-70-761-topic-1-question-164-discussion/",
    "body": "HOTSPOT -<br>You have a database that contains the following tables: tblEmployees and tblSalesSummary. Each record contains approximately one million records.<br>You use Microsoft SQL Server Management Studio (SSMS) to run two queries. The Include Actual Execution Plan option is enabled.<br>Both queries return the same results. SSMS generates the execution plans shown in the exhibit. (Click the Exhibit button.)<br>You need to troubleshoot the queries.<br>How should you interpret the execution plans? To answer, select the appropriate options in the answer area.<br>NOTE: Each correct selection is worth one point.<br><img src=\"/assets/media/exam-media/02675/0035200001.png\" class=\"in-exam-image\"><br>Hot Area:<br><img src=\"/assets/media/exam-media/02675/0035300001.png\" class=\"in-exam-image\"><br>",
    "options": [],
    "answer": "<img src=\"/assets/media/exam-media/02675/0035300002.png\" class=\"in-exam-image\">",
    "answerDescription": "References:<br>https://docs.microsoft.com/en-us/sql/relational-databases/showplan-logical-and-physical-operators-reference?view=sql-server-2017",
    "votes": [],
    "comments": [
      {
        "date": "2019-09-13T02:55:00.000Z",
        "voteCount": 17,
        "content": "Second box is wrong. Correct answer 'The index spool operation is executed many times' Cost 97% and is the inner table\nhttps://docs.microsoft.com/en-us/sql/relational-databases/performance/joins?view=sql-server-2017#nested_loops"
      },
      {
        "date": "2020-11-13T20:13:00.000Z",
        "voteCount": 1,
        "content": "thank you, \nhere too: https://sqlperformance.com/2019/11/sql-performance/eager-index-spool-optimizer"
      },
      {
        "date": "2021-02-10T02:59:00.000Z",
        "voteCount": 1,
        "content": "In the article above: \"Eager index spools are often a sign that a useful permanent index is missing from the database schema.\" Maybe it's a missing index?"
      },
      {
        "date": "2020-12-06T03:22:00.000Z",
        "voteCount": 1,
        "content": "I think no, spool operation is executed once for transforming subselect to  join"
      },
      {
        "date": "2021-02-10T02:57:00.000Z",
        "voteCount": 1,
        "content": "Second box, answer is \"no index\". Seems there's a missing non-clustered index on FK column EmployeeID."
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 165,
    "url": "https://www.examtopics.com/discussions/microsoft/view/3814-exam-70-761-topic-1-question-165-discussion/",
    "body": "DRAG DROP -<br>You have a database named DB1 that contains a table named HR.Employees. HR.Employees contains two columns named ManagerID and EmployeeID.<br>ManagerID refers to EmployeeID.<br>You need to create a query that returns a list of all employees, the manager of each employee, and the numerical level of each employee in your organization's hierarchy.<br>Which five statements should you add to the query in sequence? To answer, move the appropriate statements from the list of statements to the answer area and arrange them in the correct order.<br>Select and Place:<br><img src=\"/assets/media/exam-media/02675/0035400001.png\" class=\"in-exam-image\"><br>",
    "options": [],
    "answer": "<img src=\"/assets/media/exam-media/02675/0035500001.png\" class=\"in-exam-image\">",
    "answerDescription": "References:<br>https://blog.sqlauthority.com/2012/04/24/sql-server-introduction-to-hierarchical-query-using-a-recursive-cte-a-primer/",
    "votes": [],
    "comments": [
      {
        "date": "2019-08-19T09:03:00.000Z",
        "voteCount": 23,
        "content": "wrong order. should start with WITH clause, then Select ...Manager IS NULL (anchor query), UNION ALL then the other select for the with clause, finally the select * from managers"
      },
      {
        "date": "2020-08-15T08:51:00.000Z",
        "voteCount": 7,
        "content": "tested and working code\n\nIF OBJECT_ID (N'tempdb..#Employees', N'U') IS NOT NULL  DROP TABLE #Employees;\n\nCREATE TABLE #Employees (\n\t[EmployeeID] int,\n\t[Name] nvarchar(50),\n\t[ManagerID] int null\n);\n\ninsert into #Employees values\n (1, 'TheBoss', null)\n,(2, 'Manager1', 1)\n,(3, 'Manager2', 1)\n,(4, 'Dev1', 2)\n,(5, 'TeamLead', 2)\n,(6, 'Dev2', 5);\n\n;WITH Managers AS\n(\n\tSELECT [EmployeeID], [Name], 0 AS [EmployeeLevel], [ManagerId]\n\tFROM #Employees\n\tWHERE [ManagerID] is null\n\tUNION ALL\n\tSELECT e.[EmployeeID], e.[Name], m.[EmployeeLevel] +1, e.[ManagerId]\n\tFrom #Employees e\n\tinner join Managers m on m.[EmployeeID] = e.[ManagerId]\n)\nSELECT * FROM Managers ORDER BY ManagerID;"
      },
      {
        "date": "2020-02-08T23:43:00.000Z",
        "voteCount": 6,
        "content": "WITH Managers AS \n(\nSELECT ManagerId, EmployeeId, 0 AS EmployeeLevel\nFROM Employees\nWHERE MAnagerId IS NULL\nUNION\nSELECT Employees.ManagerId, Employees.EmployeeId, EmployeeLevel +1\nFrom Employees\nJOIN Managers ON Employees.EmployeeId = Managers.ManagerId\n)\nSELECT * FROM Managers\nORDER BY ManagerID"
      },
      {
        "date": "2020-02-11T06:19:00.000Z",
        "voteCount": 18,
        "content": "UNION ALL"
      },
      {
        "date": "2020-02-20T08:46:00.000Z",
        "voteCount": 4,
        "content": "yup  it's the recursive form of the CTE , so UNION ALL is right"
      },
      {
        "date": "2020-06-01T10:04:00.000Z",
        "voteCount": 2,
        "content": "But only the manager in level 0 will display"
      },
      {
        "date": "2020-06-05T10:56:00.000Z",
        "voteCount": 1,
        "content": "join must be LEFT join but it is not allowed in the recursive part of a recursive common table expression"
      },
      {
        "date": "2020-10-01T00:15:00.000Z",
        "voteCount": 2,
        "content": "manager.empid"
      },
      {
        "date": "2020-01-08T07:43:00.000Z",
        "voteCount": 5,
        "content": "the join is wrong as well (the tables are switched)"
      },
      {
        "date": "2020-02-09T02:12:00.000Z",
        "voteCount": 1,
        "content": "the join is right. just try."
      },
      {
        "date": "2020-02-09T02:28:00.000Z",
        "voteCount": 2,
        "content": "Actually hgi is RIGHT. the join is wrong!"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 166,
    "url": "https://www.examtopics.com/discussions/microsoft/view/8665-exam-70-761-topic-1-question-166-discussion/",
    "body": "HOTSPOT -<br>You have the following Transact-SQL statement:<br><br>DELETE FROM Person -<br><br>WHERE PersonID = 5 -<br>You need to implement error handling.<br>How should you complete Transact-SQL statement? To answer, select the appropriate options in the answer area.<br>NOTE: Each correct selection is worth one point.<br>Hot Area:<br><img src=\"/assets/media/exam-media/02675/0035700001.png\" class=\"in-exam-image\"><br>",
    "options": [],
    "answer": "<img src=\"/assets/media/exam-media/02675/0035900001.png\" class=\"in-exam-image\">",
    "answerDescription": "References:<br>https://docs.microsoft.com/en-us/sql/t-sql/language-elements/try-catch-transact-sql?view=sql-server-2017",
    "votes": [],
    "comments": [
      {
        "date": "2020-02-01T12:00:00.000Z",
        "voteCount": 18,
        "content": "BEGIN TRY\nBEGIN TRANSACTION\nCOMMIT TRANSACTION\nEND TRY\nBEGIN CATCH\nROLLBACK TRANSACTION\nEND CATCH"
      },
      {
        "date": "2020-05-30T15:58:00.000Z",
        "voteCount": 2,
        "content": "yes, but begin transaction is before begin try in this :/"
      },
      {
        "date": "2020-02-21T07:10:00.000Z",
        "voteCount": 11,
        "content": "I think it should be:\n   Begin Try\nCommit\nEnd Try\n\nBegin Catch\n   Rollback\nEnd Catch"
      },
      {
        "date": "2021-01-19T01:35:00.000Z",
        "voteCount": 1,
        "content": "answer is wrong. This works and should be the order, at least if you want to do it this way because more common is to start with begin try and then begin transaction\n\nif object_ID('proc_test','P') IS NOT NULL\ndrop proc proc_test\ngo\ncreate proc proc_test as\nbegin tran\n\n\t\t\t\tbegin try\n\t\t\t\t\tselect @@trancount as trancount_try\n\t\t\t\t\tselect 1/1 as valid_division\n\t\t\t\t\t--select 1/0 as invalid_division\ncommit tran;\n\t\t\t\tend try\n\t\t\t\t\tbegin catch\n\t\t\t\t\tselect @@trancount as trancount_catch\n\t\tif @@trancount &gt; 0 \nrollback tran;\n\t\t\t\t\tend catch\n\t\tgo"
      },
      {
        "date": "2020-12-15T20:29:00.000Z",
        "voteCount": 1,
        "content": "I think something wrong with hot spot area some information is missing."
      },
      {
        "date": "2020-10-01T00:17:00.000Z",
        "voteCount": 1,
        "content": "only one DDL, no need of BEGIN TRAN"
      },
      {
        "date": "2020-06-14T05:15:00.000Z",
        "voteCount": 6,
        "content": "There are 5 dropdowns with the same selections. the last dropdown is cut off. There is also the line with ... where you have\nto figure out the missing statement that is not part of the dropdowns, so the correct answer is \n\n \n    // BEGIN TRANSACTION\nBEGIN TRY\n   // DELETE FROM Person\n   // WHERE PersonID = 5\nCOMMIT TRANSACTION\nEND TRY\n  ...   // assumes BEGIN CATCH\n  // IF @@TRANSCOUNT &gt; 0\nROLLBACK TRANSACTION\nEND CATCH\n\n// NOTE: the line ... is confusing \n    // BEGIN TRANSACTION\nBEGIN TRY\n   // DELETE FROM Person\n   // WHERE PersonID = 5\nCOMMIT TRANSACTION\nEND TRY\n  ...   // assumes BEGIN CATCH\n  // IF @@TRANSCOUNT &gt; 0\nROLLBACK TRANSACTION\nEND CATCH"
      },
      {
        "date": "2019-11-28T02:52:00.000Z",
        "voteCount": 6,
        "content": "I think, the rest of the code is missing. \nAnd in my opiniin the right answer should be: \nBEGIN TRY\nEND TRY\nBEGIN CATCH\nROLLBACK TRANSACTION\nEND CATCH\nCOMMIT TRANSACTION"
      },
      {
        "date": "2020-04-14T02:23:00.000Z",
        "voteCount": 7,
        "content": "Your commit transaction should be inside begin try  end try block"
      },
      {
        "date": "2020-11-13T20:27:00.000Z",
        "voteCount": 2,
        "content": "not necessarily, check out code from MS documentation where commit is after the try-catch..: https://docs.microsoft.com/en-us/sql/t-sql/language-elements/try-catch-transact-sql?view=sql-server-2017\nFrom it:\nBEGIN TRANSACTION;  \n  \nBEGIN TRY  \n    -- Generate a constraint violation error.  \n    DELETE FROM Production.Product  \n    WHERE ProductID = 980;  \nEND TRY  \nBEGIN CATCH  \n    SELECT   \n        ERROR_NUMBER() AS ErrorNumber  \n        ,ERROR_SEVERITY() AS ErrorSeverity  \n        ,ERROR_STATE() AS ErrorState  \n        ,ERROR_PROCEDURE() AS ErrorProcedure  \n        ,ERROR_LINE() AS ErrorLine  \n        ,ERROR_MESSAGE() AS ErrorMessage;  \n  \n    IF @@TRANCOUNT &gt; 0  \n        ROLLBACK TRANSACTION;  \nEND CATCH;  \n  \nIF @@TRANCOUNT &gt; 0  \n    COMMIT TRANSACTION;  \nGO"
      },
      {
        "date": "2020-05-30T16:02:00.000Z",
        "voteCount": 1,
        "content": "this is exactly what i think too. There are some problems anyway. Begin transaction must have been inside try block and commit also but... :/. Also, come part of code are missing :("
      },
      {
        "date": "2019-11-20T03:21:00.000Z",
        "voteCount": 3,
        "content": "Well, I think the right answers are:\n \u00bb Begin Try\n \u00bb Commit Transaction\n \u00bb End Try\n \u00bb RollBack Transaction"
      },
      {
        "date": "2020-02-09T02:48:00.000Z",
        "voteCount": 2,
        "content": "NO, you can not have any other codes between END TRY and BEGIN CATCH"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 167,
    "url": "https://www.examtopics.com/discussions/microsoft/view/8667-exam-70-761-topic-1-question-167-discussion/",
    "body": "Note: This question is part of a series of questions that present the same scenario. Each question in the series contains a unique solution that might meet the stated goals. Some question sets might have more than one correct solution, while others might not have a correct solution.<br>After you answer a question in this section, you will NOT be able to return to it. As a result, these questions will not appear in the review screen.<br>You are creating indexes in a data warehouse.<br>You have a dimension table named Table1 that has 10,000 rows. The rows are used to generate several reports.<br>The reports join a column that is the primary key.<br>The execution plan contains bookmark lookups for Table1.<br>You discover that the reports run slower than expected.<br>You need to reduce the amount of time it takes to run the reports.<br>Solution: You create a nonclustered index on the primary key column that does NOT include columns.<br>Does this meet the goal?<br>",
    "options": [
      "<span class=\"multi-choice-letter\" data-choice-letter=\"A\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tYes",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"B\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tB.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tNo"
    ],
    "answer": "A",
    "answerDescription": "References:<br>https://docs.microsoft.com/en-us/sql/relational-databases/indexes/clustered-and-nonclustered-indexes-described?view=sql-server-2017",
    "votes": [],
    "comments": [
      {
        "date": "2019-11-20T03:25:00.000Z",
        "voteCount": 12,
        "content": "I think the answer is B, because Primary Keys should have a clustered Index ."
      },
      {
        "date": "2019-11-20T03:28:00.000Z",
        "voteCount": 6,
        "content": "when creating a primary key automatically creates a corresponding unique clustered index, or a nonclustered index if specified as such, therefore, if the table has a Primary Key an index already exists. \nIf the Index already exists, it may be :\n\u00bb Clustered, therefore changing the index to a non-clustered index will not help\n\u00bb non-clustered, therefore the change will no be much"
      },
      {
        "date": "2021-01-04T17:42:00.000Z",
        "voteCount": 1,
        "content": "The answer is B not because of the reason you have given. The answer is B because for starters the suggested solution does not solve the problem of bookmark lookups."
      },
      {
        "date": "2021-01-25T20:39:00.000Z",
        "voteCount": 1,
        "content": "https://stackoverflow.com/questions/820714/what-is-a-bookmark-lookup-in-sql-server"
      },
      {
        "date": "2021-01-17T03:35:00.000Z",
        "voteCount": 1,
        "content": "so which is best answer?"
      },
      {
        "date": "2020-11-13T20:42:00.000Z",
        "voteCount": 1,
        "content": "https://askinglot.com/open-detail/559990\nFrom it: No is correct, explaination:\n\"\nLookup Table in SQL Server. It can be basically considered as a reference to link the related tables with the help of a unique primary key.\n\"\n\"\nConsider a situation, where an organization needs to maintain a database to store its employee information. A SQL table is created with the fields (Emp ID, Name, Membership). Only four membership options are present in the organization, so the membership field can hold a value out of the four different options. In case of thousand records, the membership field will be repeating among all the records and this field is a kind of static field, which does not change frequently. So, the user can choose to create a child table i.e., lookup table containing Emp id and membership fields of the main table. So, we can easily reference the fields of the child table with the main table of the database.\n\""
      },
      {
        "date": "2020-07-06T08:16:00.000Z",
        "voteCount": 2,
        "content": "B. i agree with the other comments in this discussion."
      },
      {
        "date": "2020-04-15T08:11:00.000Z",
        "voteCount": 3,
        "content": "The question states \"The execution plan contains bookmark lookups for Table1. \"\nAdding an index \"without any columns\" will not fix this  and additionally as already mentioned a clustered index already exists...answer should be B"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 168,
    "url": "https://www.examtopics.com/discussions/microsoft/view/36974-exam-70-761-topic-1-question-168-discussion/",
    "body": "Note: This question is part of a series of questions that present the same scenario. Each question in the series contains a unique solution that might meet the stated goals. Some question sets might have more than one correct solution, while others might not have a correct solution.<br>After you answer a question in this section, you will NOT be able to return to it. As a result, these questions will not appear in the review screen.<br>You create a table named Customer by running the following Transact-SQL statement:<br><img src=\"/assets/media/exam-media/02675/0036100001.png\" class=\"in-exam-image\"><br>You create a cursor by running the following Transact-SQL statement:<br><img src=\"/assets/media/exam-media/02675/0036200001.png\" class=\"in-exam-image\"><br>If the credit limit is zero, you must delete the customer record while fetching data.<br>You need to add the DELETE statement.<br>Solution: You add the following Transact-SQL statement:<br><img src=\"/assets/media/exam-media/02675/0036200002.png\" class=\"in-exam-image\"><br>Does the solution meet the goal?<br>",
    "options": [
      "<span class=\"multi-choice-letter\" data-choice-letter=\"A\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tYes",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"B\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tB.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tNo"
    ],
    "answer": "B",
    "answerDescription": "Use a WHERE CURRENT OF clause, which deletes at the current position of the specified cursor.<br>References:<br>https://docs.microsoft.com/en-us/sql/t-sql/statements/delete-transact-sql",
    "votes": [],
    "comments": [
      {
        "date": "2020-11-13T20:49:00.000Z",
        "voteCount": 3,
        "content": "https://stackoverflow.com/questions/8813961/how-i-can-use-cursor-to-delete-record-from-table"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 169,
    "url": "https://www.examtopics.com/discussions/microsoft/view/29310-exam-70-761-topic-1-question-169-discussion/",
    "body": "Note: This question is part of a series of questions that present the same scenario. Each question in the series contains a unique solution that might meet the stated goals. Some question sets might have more than one correct solution, while others might not have a correct solution.<br>After you answer a question in this section, you will NOT be able to return to it. As a result, these questions will not appear in the review screen.<br>You create a table named Customer by running the following Transact-SQL statement:<br><img src=\"/assets/media/exam-media/02675/0036300001.png\" class=\"in-exam-image\"><br>You create a cursor by running the following Transact-SQL statement:<br><img src=\"/assets/media/exam-media/02675/0036400001.png\" class=\"in-exam-image\"><br>If the credit limit is zero, you must delete the customer record while fetching data.<br>You need to add the DELETE statement.<br>Solution: You add the following Transact-SQL statement:<br><img src=\"/assets/media/exam-media/02675/0036400002.jpg\" class=\"in-exam-image\"><br>Does the solution meet the goal?<br>",
    "options": [
      "<span class=\"multi-choice-letter\" data-choice-letter=\"A\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tYes",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"B\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tB.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tNo"
    ],
    "answer": "A",
    "answerDescription": "CURRENT OF specifies that the DELETE is performed at the current position of the specified cursor.<br>References:<br>https://docs.microsoft.com/en-us/sql/t-sql/statements/delete-transact-sql",
    "votes": [],
    "comments": [
      {
        "date": "2020-09-20T13:11:00.000Z",
        "voteCount": 5,
        "content": "missed something - should be \"delete FROM customer"
      },
      {
        "date": "2020-11-13T21:02:00.000Z",
        "voteCount": 3,
        "content": "from is optional check syntax here: https://docs.microsoft.com/en-us/sql/t-sql/statements/delete-transact-sql?view=sql-server-ver15\n\nand example from the same page:\nDELETE Production.ProductCostHistory  \nWHERE StandardCost BETWEEN 12.00 AND 14.00  \n      AND EndDate IS NULL;  \nPRINT 'Number of rows deleted is ' + CAST(@@ROWCOUNT as char(3));"
      },
      {
        "date": "2020-08-22T17:54:00.000Z",
        "voteCount": 4,
        "content": "Confirmed A.\nhttps://stackoverflow.com/questions/8813961/how-i-can-use-cursor-to-delete-record-from-table"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 170,
    "url": "https://www.examtopics.com/discussions/microsoft/view/3887-exam-70-761-topic-1-question-170-discussion/",
    "body": "HOTSPOT -<br>You create a table to store sales information for an online sales application by running the following Transact-SQL statement:<br><img src=\"/assets/media/exam-media/02675/0036500001.png\" class=\"in-exam-image\"><br>You have a historical report that summarizes the sales for each quarter and year. The query that generated the data for the report is no longer available. A representative report contains the following data:<br><img src=\"/assets/media/exam-media/02675/0036600001.png\" class=\"in-exam-image\"><br>You need to recreate the query for the report.<br>How should you complete the Transact-SQL statement? To answer, select the appropriate Transact-SQL segments in the answer area.<br>NOTE: Each correct selection is worth one point.<br>Hot Area:<br><img src=\"/assets/media/exam-media/02675/0036700001.png\" class=\"in-exam-image\"><br>",
    "options": [],
    "answer": "<img src=\"/assets/media/exam-media/02675/0036800001.png\" class=\"in-exam-image\">",
    "answerDescription": "WHEN expression is a simple expression to which input_expression is compared when the simple CASE format is used and is any valid expression.<br>ELSE is the expression returned if no comparison operation evaluates as TRUE.<br>DATEPART returns an integer which represents the specified datepart of the date, such as day, month, year, quarter etc.<br>References:<br>https://docs.microsoft.com/en-us/sql/t-sql/language-elements/case-transact-sql?view=sql-server-2017 https://docs.microsoft.com/en-us/sql/t-sql/functions/datepart-transact-sql?view=sql-server-2017",
    "votes": [],
    "comments": [
      {
        "date": "2019-08-21T05:29:00.000Z",
        "voteCount": 31,
        "content": "should be \n1. option: GROUPING\n2. option: GROUPING\n3. option: year, quarter WITH ROLLUP"
      },
      {
        "date": "2019-11-20T06:28:00.000Z",
        "voteCount": 23,
        "content": "IF OBJECT_ID('TEMPDB..#SALES') IS NOT NULL DROP TABLE #SALES\n\nCREATE TABLE #SALES\n(\n\tSalesOrderID\tINT IDENTITY NOT NULL\n\t, OrderDate\t\tDATETIME NOT NULL\n\t, Total\t\t\tMONEY NULL\n)\n\n\nINSERT INTO #SALES(Total, OrderDate)\nVALUES\t('8771886.36', '20130101')\n\t\t, ('14373277.48', '20140101')\n\t\t, ('12225061.38', '20130401')\n\t\t, ('8046220.84', '20140401')\n\t\t, ('14339319.19', '20130701')\n\t\t, ('13629621.04', '20131001')\n\n\nSELECT\tSUM(Total)\t\t\t\t\t\tAS Total\n\t\t, DATEPART(QUARTER, OrderDate)\tAS [Quarter]\n\t\t, YEAR(OrderDate)\t\t\t\tAS [YEAR]\n\t\t, GROUPING(DATEPART(QUARTER, OrderDate))\t\tAS G1\n\t\t, GROUPING(DATEPART(YEAR, OrderDate))\t\tAS G2\nFROM\t#SALES\nGROUP BY\t\n\tDATEPART(QUARTER, OrderDate), YEAR(OrderDate) WITH ROLLUP"
      },
      {
        "date": "2020-02-09T16:11:00.000Z",
        "voteCount": 3,
        "content": "thank you for the codes. it works exactly as it should be."
      },
      {
        "date": "2020-03-02T08:46:00.000Z",
        "voteCount": 1,
        "content": "I guess it should be vice versa from big to fine groupings:\n...\nGROUP BY \nYEAR(OrderDate), DATEPART(QUARTER, OrderDate) WITH ROLLUP;\n\nElse you would sum up all quarters of all years and then all years without quarters."
      },
      {
        "date": "2020-09-08T17:26:00.000Z",
        "voteCount": 1,
        "content": "This is 100 % correct. Tried the other ways not even close."
      },
      {
        "date": "2020-06-05T11:12:00.000Z",
        "voteCount": 2,
        "content": "But there is no GROUPING(DATEPART(YEAR, OrderDate)) AS G2. \nIt is just GROUPING((YEAR, OrderDate)) AS G2. And like this it doesn't work"
      },
      {
        "date": "2020-06-05T11:23:00.000Z",
        "voteCount": 1,
        "content": "OK. Tested. It is Grouping both. First With DATEPART and second without."
      },
      {
        "date": "2020-11-28T15:49:00.000Z",
        "voteCount": 1,
        "content": "YEAR() is also a function, to get the year of a given date."
      },
      {
        "date": "2020-07-23T03:07:00.000Z",
        "voteCount": 2,
        "content": "Your solution is correct, had it on exam and passed"
      },
      {
        "date": "2021-01-01T20:49:00.000Z",
        "voteCount": 1,
        "content": "Correct answer is Quarter, Year with ROLLUP. Not intuitive but you can see it summarizes quarter at highest level and NULLs Year so much. The rest is correct. Whole thing:\nSELECT SUM(Total) AS Total\n, DATEPART(QUARTER, OrderDate) AS [Quarter]\n, YEAR(OrderDate) AS [YEAR]\n, GROUPING(DATEPART(QUARTER, OrderDate)) AS G1\n, GROUPING(DATEPART(YEAR, OrderDate)) AS G2\nFROM #SALES\nGROUP BY\nDATEPART(QUARTER, OrderDate), YEAR(OrderDate) WITH ROLLUP"
      },
      {
        "date": "2020-12-15T20:42:00.000Z",
        "voteCount": 1,
        "content": "Ahh it can't be =NULL definitely"
      },
      {
        "date": "2020-02-14T11:46:00.000Z",
        "voteCount": 2,
        "content": "if change case when to 'is null' then could use case when"
      },
      {
        "date": "2020-11-28T15:58:00.000Z",
        "voteCount": 1,
        "content": "You may think it works, but it doesn't, the difference here is that CASE won't know if that NULL is due to its column being part of a group or not. It will just return 0 or 1 if there is a NULL or not, but it won't be able to evaluate if it is a NULL coming from the column because it is NULL or a NULL because it is part of the grouping or not."
      },
      {
        "date": "2020-01-21T07:03:00.000Z",
        "voteCount": 1,
        "content": "\"WITH ROLLUP\" - isn't it a MYSQL syntax?"
      },
      {
        "date": "2020-03-02T08:24:00.000Z",
        "voteCount": 1,
        "content": "It's an old notation. WITH ROLLUP and WITH CUBE are non-ISO compliant syntax and will be removed in a future version."
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 171,
    "url": "https://www.examtopics.com/discussions/microsoft/view/39939-exam-70-761-topic-1-question-171-discussion/",
    "body": "DRAG DROP -<br>Note: This question is part of a series of questions that use the same scenario. For your convenience, the scenario is repeated in each question. Each question presents a different goal and answer choices, but the text of the scenario is exactly the same in each question in this series.<br><br>Start of repeated scenario -<br>You are developing a database to track customer orders. The database contains the following tables: Sales.Customers, Sales.Orders, and Sales.OrderLines. The following table describes the columns in Sales.Customers.<br><img src=\"/assets/media/exam-media/02675/0036900001.png\" class=\"in-exam-image\"><br>The following table describes the columns in Sales.Orders.<br><img src=\"/assets/media/exam-media/02675/0036900002.png\" class=\"in-exam-image\"><br>The following table describes the columns in Sales.OrderLines.<br><img src=\"/assets/media/exam-media/02675/0037000001.png\" class=\"in-exam-image\"><br><br>End of repeated scenario -<br>You need to create a common table expression (CTE) that returns the total number of orders per year for each customer.<br>Which five Transact-SQL segments should you use to develop the solution? To answer, move the appropriate Transact-SQL segments from the list of Transact-<br>SQL segments to the answer area and arrange them in the correct order.<br>Select and Place:<br><img src=\"/assets/media/exam-media/02675/0037000002.jpg\" class=\"in-exam-image\"><br>",
    "options": [],
    "answer": "<img src=\"/assets/media/exam-media/02675/0037100001.jpg\" class=\"in-exam-image\">",
    "answerDescription": "References:<br>https://docs.microsoft.com/en-us/sql/t-sql/queries/with-common-table-expression-transact-sql?view=sql-server-2017",
    "votes": [],
    "comments": [
      {
        "date": "2020-12-15T11:24:00.000Z",
        "voteCount": 2,
        "content": "Correctimundo"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 172,
    "url": "https://www.examtopics.com/discussions/microsoft/view/4000-exam-70-761-topic-1-question-172-discussion/",
    "body": "You have a table named Table1 that contains 200 million rows. Table1 contains a column named SaleDate that has a data type of DateTime2(3).<br>Users report that the following query runs slowly.<br><img src=\"/assets/media/exam-media/02675/0037200001.png\" class=\"in-exam-image\"><br>You need to reduce the amount of time it takes to run the query.<br>What should you use to replace the WHERE statement?<br>",
    "options": [
      "<span class=\"multi-choice-letter\" data-choice-letter=\"A\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tWHERE SaleDate &gt;= '2017-01-01' AND SaleDate &lt; '2018-01-01'",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"B\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tB.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tWHERE cast(SaleDate as varchar(10)) BETWEEN '2017-01-01' AND '2017-12-31'",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"C\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tC.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tWHERE cast(SaleDate as date) BETWEEN '2017-01-01' AND '2017-12-31'",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"D\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tD.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tWHERE 2017 = year(SaleDate)"
    ],
    "answer": "C",
    "answerDescription": "References:<br>https://docs.microsoft.com/en-us/sql/t-sql/queries/select-transact-sql?view=sql-server-2017",
    "votes": [],
    "comments": [
      {
        "date": "2019-08-24T05:14:00.000Z",
        "voteCount": 36,
        "content": "Correct answer is A."
      },
      {
        "date": "2020-02-09T16:27:00.000Z",
        "voteCount": 2,
        "content": "ANSWER C actually will not include the date of 12-31-2017"
      },
      {
        "date": "2020-08-29T08:28:00.000Z",
        "voteCount": 1,
        "content": "Correct Answer is C. According to the book \"Contained in\" excludes  12--31-2017, but \"Between\" would include the date 12-31-2017."
      },
      {
        "date": "2020-02-07T09:35:00.000Z",
        "voteCount": 13,
        "content": "Answer is A: In order for a query to be saragable, it should not use a function. https://www.sqlshack.com/how-to-use-sargable-expressions-in-t-sql-queries-performance-advantages-and-examples/"
      },
      {
        "date": "2021-01-19T03:09:00.000Z",
        "voteCount": 1,
        "content": "100% sure A. if you want the query to run faster never use functions in the where column."
      },
      {
        "date": "2021-01-01T20:54:00.000Z",
        "voteCount": 1,
        "content": "Definitely A - need to get function off search argument to optimize"
      },
      {
        "date": "2021-01-11T12:38:00.000Z",
        "voteCount": 1,
        "content": "exactly, when you cast it in the WHERE clause the optimizer (mostly) can't and won't rely on the index anymore thus it just assumes the values have changed. This makes it perform index scans (slower) instead of index seeks (faster)."
      },
      {
        "date": "2020-10-01T00:44:00.000Z",
        "voteCount": 1,
        "content": "C defaults to 12-31 00:00 AM"
      },
      {
        "date": "2020-09-08T17:50:00.000Z",
        "voteCount": 2,
        "content": "The correct answer is A. How does any of the other solutions optimize better? gtc108  is right SARGABLE. Sure one answer might run correctly but this site has a lot of errors."
      },
      {
        "date": "2020-07-06T15:33:00.000Z",
        "voteCount": 1,
        "content": "The correct answer is B and tested in MS SQL 2019. The A and C both will fail due to datetime2 to varchar implicit conversion. Answer B is casting the datetime to varchar which will return the records."
      },
      {
        "date": "2020-07-15T04:54:00.000Z",
        "voteCount": 1,
        "content": "Answer B does not make any sense. B may work to get correct result, but not in the context of question which asks for optimization. It is illogical to run CAST(SaleDate as varchar(10)) because such cast is a total waste of time, the result will have to be cast to DATE because the comparison used in BETWEEN is totally meaningless for VARCHAR. So you run an explicit CAST which hqs to be erased by implicit CAST. The only answers that make any sense are A and C, both work, the only issue is which one is faster for 200 million rows"
      },
      {
        "date": "2020-06-22T12:31:00.000Z",
        "voteCount": 2,
        "content": "Both answers A and C are correct. The question should ask for two answers and not one. Answer C has an explicit cast, answer A does the same cast anyway although implicitly"
      },
      {
        "date": "2020-04-21T21:35:00.000Z",
        "voteCount": 3,
        "content": "Just created a table and tested the aggregate with the where clause in both A and C. They worked perfectly fast on 5M records. I think the most meaningful answer is A. Because C uses a function to cast which consumes extra time..."
      },
      {
        "date": "2020-04-01T08:42:00.000Z",
        "voteCount": 2,
        "content": "I think A is wrong because as datetime2 we have to give time also. C is correct because Between And in SQL use closed interval."
      },
      {
        "date": "2020-02-14T13:01:00.000Z",
        "voteCount": 4,
        "content": "you could check with your SSMS, all A,B,C could work. And gtc108 is correct, without function makes perform best"
      },
      {
        "date": "2020-01-19T10:37:00.000Z",
        "voteCount": 1,
        "content": "The correct answer is C. SQL Server implicitly convert varchar on the right side to date type."
      },
      {
        "date": "2019-12-22T01:01:00.000Z",
        "voteCount": 2,
        "content": "Answer A has type mismatch - SaleDate is DateTime2 type column, condition is varchar. There's same misteke in C. \nB is correct"
      },
      {
        "date": "2020-12-17T12:37:00.000Z",
        "voteCount": 1,
        "content": "'A' works strings implicitly converts into datetime because datetime has higher precedence level."
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 173,
    "url": "https://www.examtopics.com/discussions/microsoft/view/5223-exam-70-761-topic-1-question-173-discussion/",
    "body": "You have a database that tracks customer complaints.<br>The database contains a table named Complaints that includes the following columns:<br><img src=\"/assets/media/exam-media/02675/0037200002.png\" class=\"in-exam-image\"><br>You need to create a query that lists complaints about defective products. The report must include complaints where the exact phrase \"defective product\" occurs, as well as complaints where similar phrases occur.<br>Which Transact-SQL statement should you run?<br>",
    "options": [
      "<span class=\"multi-choice-letter\" data-choice-letter=\"A\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tSELECT ComplaintID, ComplaintTranscript FROM Complaints WHERE CONTAINS(CustomerTranscript, 'defective') AND CONTAINS(CustomerTranscript, 'product')",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"B\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tB.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tSELECT ComplaintID, CustomerTranscript FROM Complaints WHERE SOUNDEX('defective') = SOUNDEX('product')",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"C\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tC.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tSELECT ComplaintID, CustomerTranscript FROM Complaints WHERE FREETEXT(CustomerTranscript, 'defective product')",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"D\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tD.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tSELECT ComplaintID, Customer Transcript FROM Complaints WHERE CustomerTranscript like '%defective product%'"
    ],
    "answer": "A",
    "answerDescription": "References:<br>https://docs.microsoft.com/en-us/sql/t-sql/queries/contains-transact-sql?view=sql-server-2017",
    "votes": [],
    "comments": [
      {
        "date": "2019-11-20T09:03:00.000Z",
        "voteCount": 6,
        "content": "FREETEXT \u00bb this predicate searches for values that match the meaning and not just the exact wording of the words in the search condition.\n\nhttps://docs.microsoft.com/en-us/sql/t-sql/queries/freetext-transact-sql?view=sql-server-ver15"
      },
      {
        "date": "2021-01-19T03:15:00.000Z",
        "voteCount": 1,
        "content": "The answer is D :\n\"where the exact phrase \"defective product\" occurs, as well as complaints where similar phrases occur.\"\nThe like statement in this case includes both, which is what we want."
      },
      {
        "date": "2020-12-30T11:44:00.000Z",
        "voteCount": 2,
        "content": "cannot be A because it has \"ComplaintTranscript\"  in the select clause. There is NO such column name. so answer is C."
      },
      {
        "date": "2020-12-16T15:00:00.000Z",
        "voteCount": 1,
        "content": "C\n\nhttps://docs.microsoft.com/en-us/sql/t-sql/queries/freetext-transact-sql?view=sql-server-ver15"
      },
      {
        "date": "2020-11-28T19:32:00.000Z",
        "voteCount": 3,
        "content": "I think answer is C. Cuz' A is adding separate terms, and we are looking for the phrase and similar phrases."
      },
      {
        "date": "2020-09-08T18:10:00.000Z",
        "voteCount": 2,
        "content": "D is the answer none of the columns is a Full Text index.If it was then the answer is A. First off you need to turn Full Text Search on in the designer and then make an index. If this question assumes that then it is A."
      },
      {
        "date": "2020-08-27T05:00:00.000Z",
        "voteCount": 1,
        "content": "as the question says, the exact phrase \"defective product\" occurs as well as complaints where similar phrases occur. \"defective product\" is a phrase, so it should be the one with wild card on both side of this phrase. So D"
      },
      {
        "date": "2020-08-18T21:28:00.000Z",
        "voteCount": 1,
        "content": "Task requirements is: \"where the exact phrase \"defective product\" occurs\".\nLike works with spaces, therefore correct answer is D."
      },
      {
        "date": "2020-07-10T02:51:00.000Z",
        "voteCount": 1,
        "content": "C) and D) only return exact phrase; they fail the 'similar phrase' requirement"
      },
      {
        "date": "2020-12-17T03:38:00.000Z",
        "voteCount": 1,
        "content": "Not true. Freetext doesn't only return exact phrases. Answer = C"
      },
      {
        "date": "2020-07-06T08:46:00.000Z",
        "voteCount": 3,
        "content": "A) will return all records that contain both words, including records with the exact phrase"
      },
      {
        "date": "2020-05-30T16:55:00.000Z",
        "voteCount": 1,
        "content": "D is the correct one BUT it must not have space"
      },
      {
        "date": "2020-05-31T12:08:00.000Z",
        "voteCount": 2,
        "content": "Well, D is for exactly 'Defective product' but in case of \"similar phrases\" I assuem it stand for 'defective' or 'product'. So the right answer is C. Tested"
      },
      {
        "date": "2021-01-04T17:16:00.000Z",
        "voteCount": 2,
        "content": "This was retarded. Smh."
      },
      {
        "date": "2019-09-16T01:04:00.000Z",
        "voteCount": 4,
        "content": "What mean 'similar' ?\nIf is a free-text column the answer is C (verified) otherwise is D the like"
      },
      {
        "date": "2020-02-27T09:35:00.000Z",
        "voteCount": 1,
        "content": "The D searches only for exact phrase, so it looks like the answer is C or A."
      },
      {
        "date": "2020-04-14T05:23:00.000Z",
        "voteCount": 3,
        "content": "To be A or C you suppose to create a full text index.  Error message:  \"Cannot use a CONTAINS or FREETEXT predicate on table or indexed view '#Complaint' because it is not full-text indexed.\" In this case without full text index the best option is D."
      },
      {
        "date": "2020-04-30T10:17:00.000Z",
        "voteCount": 1,
        "content": "Sorry, D is not going to work because of the column name there is space between two words"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 174,
    "url": "https://www.examtopics.com/discussions/microsoft/view/39940-exam-70-761-topic-1-question-174-discussion/",
    "body": "You run the following Transact-SQL statements:<br><img src=\"/assets/media/exam-media/02675/0037300001.png\" class=\"in-exam-image\"><br>You need to create a query that returns the total number of attendees for each combination of CourseID, CourseDate, and the following locations: Lisbon, London, and Seattle. The result set should resemble the following:<br><img src=\"/assets/media/exam-media/02675/0037400001.png\" class=\"in-exam-image\"><br>Which Transact-SQL code segment should you run?<br>",
    "options": [
      "<span class=\"multi-choice-letter\" data-choice-letter=\"A\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tSELECT * FROM CourseParticipants PIVOT(SUM(NumParticipants) FOR LocationDescription IN (Lisbon, London, Seattle))",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"B\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tB.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tSELECT * FROM CourseParticipants PIVOT(SUM(NumParticipants) FOR LocationDescription IN (Lisbon, London, Seattle)) as PVTTable",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"C\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tC.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tSELECT * FROM CourseParticipants UNPIVOT(SUM(NumParticipants) FOR LocationDescription IN (Lisbon, London, Seattle)",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"D\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tD.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tSELECT * FROM CourseParticipants UNPIVOT(SUM(NumParticipants) FOR LocationDescription IN (Lisbon, London, Seattle) AS PVTTable"
    ],
    "answer": "B",
    "answerDescription": "References:<br>https://www.techonthenet.com/sql_server/pivot.php",
    "votes": [],
    "comments": [
      {
        "date": "2020-12-15T11:28:00.000Z",
        "voteCount": 4,
        "content": "Correctimundo"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 175,
    "url": "https://www.examtopics.com/discussions/microsoft/view/3918-exam-70-761-topic-1-question-175-discussion/",
    "body": "You have a project management application. The application uses a Microsoft SQL Server database to store data. You are developing a software bug tracking add-on for the application.<br>The add-on must meet the following requirements:<br>\u2711 Allow case sensitive searches for product.<br>\u2711 Filter search results based on exact text in the description.<br>\u2711 Support multibyte Unicode characters.<br>You run the following Transact-SQL statement:<br><img src=\"/assets/media/exam-media/02675/0037500004.png\" class=\"in-exam-image\"><br>Users connect to an instance of the bug tracking application that is hosted in New York City. Users in Seattle must be able to display the local date and time for any bugs that they create.<br>You need to ensure that the DateCreated column displays correctly.<br>Which Transact-SQL statement should you run?<br>",
    "options": [
      "<span class=\"multi-choice-letter\" data-choice-letter=\"A\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tSELECT Id,Product, DateCreated AT TIME ZONE 'Pacific Standard Time' FROM Bug",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"B\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tB.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tSELECT Id,Product, DATEADD(hh, -8, DateCreated) FROM Bug",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"C\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tC.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tSELECT Id,Product, TODATETIMEOFFSET(DateCreated, -8) FROM Bug",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"D\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tD.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tSELECT Id,Product, CAST(DateCreated AS DATETIMEOFFSET) FROM Bug"
    ],
    "answer": "C",
    "answerDescription": "References:<br>https://docs.microsoft.com/en-us/sql/t-sql/functions/todatetimeoffset-transact-sql?view=sql-server-2017",
    "votes": [],
    "comments": [
      {
        "date": "2019-08-22T06:30:00.000Z",
        "voteCount": 25,
        "content": "I think the correct answer should be A. Because time off set between seattle and newyork is 3 hours and not 8 hours. and seattle is in 'Pacific Standrad TIme'. At time zone does the trick here."
      },
      {
        "date": "2021-02-10T06:16:00.000Z",
        "voteCount": 1,
        "content": "Isn't it B? Cause other variants don't change the returned time.\n\nselect getdate() AT TIME ZONE 'Pacific Standard Time'  AS A , \ndateadd(hh,-8,getdate()) AS B,\ntodatetimeoffset(getdate(),'-08:00') AS C, \ncast (getdate() as datetimeoffset) AS D"
      },
      {
        "date": "2020-04-15T08:31:00.000Z",
        "voteCount": 3,
        "content": "Answer should be A :\nSELECT GETDATE() AS CurDate,  GETDATE() AT TIME ZONE 'Pacific Standard Time'  AS Pacific, \n TODATETIMEOFFSET(GETDATE(), -8) AS Offset"
      },
      {
        "date": "2020-09-15T15:48:00.000Z",
        "voteCount": 1,
        "content": "Besides, the argument in todatetimeoffset is wrong. It's just -8 minutes. In order to set the correct time it needs to specify '-7:00' which it's the difference from GMT\n\ndeclare @var_date datetime = getdate()\n\nSELECT @var_date AT TIME ZONE 'Pacific Standard Time' AS Pacific,\nTODATETIMEOFFSET(@var_date, '-07:00' ) AS Offset"
      },
      {
        "date": "2020-02-23T05:15:00.000Z",
        "voteCount": 1,
        "content": "c wrong there is a difference between TODATETIMEOFFSET(  ....,'-08:00') and TODATETIMEOFFSET(...,-8) the other is hours and the other minutes"
      },
      {
        "date": "2019-10-19T06:50:00.000Z",
        "voteCount": 1,
        "content": "is possibile check this view sys.time_zone_info"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 176,
    "url": "https://www.examtopics.com/discussions/microsoft/view/3817-exam-70-761-topic-1-question-176-discussion/",
    "body": "DRAG DROP -<br>You have a project management application. The application uses a Microsoft SQL Server database to store data. You are developing a software bug tracking add-on for the application.<br>The add-on must meet the following requirements:<br>\u2711 Allow case sensitive searches for product.<br>\u2711 Filter search results based on exact text in the description.<br>\u2711 Support multibyte Unicode characters.<br>You run the following Transact-SQL statement:<br><img src=\"/assets/media/exam-media/02675/0037600004.png\" class=\"in-exam-image\"><br>You need to display a comma separated list of all product bugs filed by a user named User1.<br>How should you complete the Transact-SQL statement? To answer, drag the appropriate Transact-SQL segments to the correct locations. Each Transact-SQL segment may be used once, more than once, or not at all. You may need to drag the split bar between panes or scroll to view content.<br>NOTE: Each correct selection is worth one point.<br>Select and Place:<br><img src=\"/assets/media/exam-media/02675/0037700001.jpg\" class=\"in-exam-image\"><br>",
    "options": [],
    "answer": "<img src=\"/assets/media/exam-media/02675/0037700002.jpg\" class=\"in-exam-image\">",
    "answerDescription": "References:<br>https://docs.microsoft.com/en-us/sql/t-sql/functions/string-split-transact-sql?view=sql-server-2017",
    "votes": [],
    "comments": [
      {
        "date": "2019-08-19T09:20:00.000Z",
        "voteCount": 29,
        "content": "Select Statement is wrong. Choose @List = Product + ', ' + @List"
      },
      {
        "date": "2020-11-29T08:46:00.000Z",
        "voteCount": 7,
        "content": "Sample code:\nDECLARE @tb1 AS TABLE\n(\nProduct Nvarchar(25)\n)\n\nINSERT INTO @tb1 VALUES\n\t\t\t\t\t\t('Azul')\n\t\t\t\t\t\t,('Verde')\n\t\t\t\t\t\t,('Rosa')\n\t\t\t\t\t\t,('Morado')\n\t\t\t\t\t\t,('blanco')\n\t\t\t\t\t\t,('Negro')\n\nDECLARE @List Nvarchar(MAX) = ' '\nSELECT @List = Product + ',' + @List\nFROM @tb1\nSELECT @List;"
      },
      {
        "date": "2021-01-01T21:29:00.000Z",
        "voteCount": 1,
        "content": "See @BabyBee - thanks!"
      },
      {
        "date": "2020-12-22T09:08:00.000Z",
        "voteCount": 1,
        "content": "To remove the first comma:\ndeclare @list nvarchar(max); --default is NULL\nselect @list = COALESCE (@list + ',' ,'' ) + product \nFrom Bug\nselect @list"
      },
      {
        "date": "2020-05-31T03:24:00.000Z",
        "voteCount": 4,
        "content": "Correct answer:\ndeclare @List nvarchar(MAX) = ''\nselect @List=Product +','+@List\nfrom Bug where reportinguser = 'User1' (It must be in comma!!)\nSelect @List"
      },
      {
        "date": "2020-05-21T14:30:00.000Z",
        "voteCount": 3,
        "content": "You can't start with @List, or the first thing in the list will be a comma"
      },
      {
        "date": "2020-01-22T08:42:00.000Z",
        "voteCount": 5,
        "content": "@List = @List + ', ' + Product looks correct too."
      },
      {
        "date": "2020-10-15T00:05:00.000Z",
        "voteCount": 1,
        "content": "True, then the result will start with comma, but it will give the proper list of products anyway."
      },
      {
        "date": "2019-10-20T20:28:00.000Z",
        "voteCount": 3,
        "content": "wrong answer in select cant use table."
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 177,
    "url": "https://www.examtopics.com/discussions/microsoft/view/15398-exam-70-761-topic-1-question-177-discussion/",
    "body": "DRAG DROP -<br>You create a table to track sales persons by running the following Transact-SQL statement:<br><img src=\"/assets/media/exam-media/02675/0037800001.png\" class=\"in-exam-image\"><br>You need to create a report that shows the sales people within each territory for each year. The report must display sales people in order by highest sales amount.<br>How should you complete the Transact-SQL statement? To answer, drag the appropriate Transact-SQL segments to the correct locations. Each Transact-SQL segment may be used once, more than once, or not at all. You may need to drag the split bar between panes or scroll to view content.<br>NOTE: Each correct selection is worth one point.<br>Select and Place:<br><img src=\"/assets/media/exam-media/02675/0037900001.jpg\" class=\"in-exam-image\"><br>",
    "options": [],
    "answer": "<img src=\"/assets/media/exam-media/02675/0037900002.jpg\" class=\"in-exam-image\">",
    "answerDescription": "Ranking rows results in the partition of a result set being returned.<br>PARTITION BY divides the query result into partition.<br>ORDER BY defines the logical order of the rows.<br>References:<br>https://docs.microsoft.com/en-us/sql/t-sql/functions/rank-transact-sql?view=sql-server-2017",
    "votes": [],
    "comments": [
      {
        "date": "2020-03-04T01:29:00.000Z",
        "voteCount": 8,
        "content": "From my point of view it should be \"... ORDER BY Sales DESC)\" if you like to have the highest sales amount on rank 1, but that's not included in the answer segments."
      },
      {
        "date": "2020-04-17T10:04:00.000Z",
        "voteCount": 1,
        "content": "it is already ordering by sales, but first 'partition by' has to come. partition by territory and year and then order by sales"
      },
      {
        "date": "2020-11-29T09:43:00.000Z",
        "voteCount": 4,
        "content": "Sample code:\nDROP TABLE IF EXISTS #SalesPerson;\nCREATE TABLE #SalesPerson\n(\nid int NOT NULL\n,TerritoryID int NULL\n,Sales MONEY NOT NULL\n,EntryDate DATETIME NOT NULL\n);\nINSERT INTO #SalesPerson VALUES\n\t\t\t\t\t\t\t\t(1, 1, 5000, '10/12/2015 15:22:00')\n\t\t\t\t\t\t\t\t,(2, 1, 8000, '1/12/2015 13:00:00')\n\t\t\t\t\t\t\t\t,(3, 1, 12000, '1/12/2016 13:00:00')\n\t\t\t\t\t\t\t\t, (4, 2, 15000, '03/10/2016 15:22:00')\n\t\t\t\t\t\t\t\t, (5, 2, 18000, '12/10/2016 15:22:00')\n\t\t\t\t\t\t\t\t,(6, 3, 7000, '4/01/2017 13:00:00')\n\t\t\t\t\t\t\t\t,(7, 3, 4000, '5/02/2017 13:00:00');\n--SELECT * FROM #SalesPerson;\nSELECT id, territoryID, Sales, YEAR(EntryDate) AS [Year],\nRANK() OVER (PARTITION BY TerritoryID, YEAR(EntryDate) ORDER BY Sales DESC) AS Ranking\nFROM #SalesPerson"
      },
      {
        "date": "2020-07-07T09:39:00.000Z",
        "voteCount": 3,
        "content": "yes i agree  order by sales DESC"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 178,
    "url": "https://www.examtopics.com/discussions/microsoft/view/18552-exam-70-761-topic-1-question-178-discussion/",
    "body": "SIMULATION -<br>You have a database that includes the following tables. All of the tables are in the Production schema.<br><img src=\"/assets/media/exam-media/02675/0038000001.jpg\" class=\"in-exam-image\"><br>You need to create a query that returns a list of product names for all products in the Beverages category.<br>Construct the query using the following guidelines:<br>\u2711 Use the first letter of the table name as the table alias.<br>\u2711 Use two-part column names.<br>\u2711 Do not surround object names with square brackets.<br>\u2711 Do not use implicit joins.<br>\u2711 Do not use variables.<br>\u2711 Use single quotes to surround literal values.<br>Part of the correct Transact-SQL has been provided in the answer area below. Enter the code in the answer area that resolves the problem and meets the stated goals or requirements. You can add code within the code that has been provided as well as below it.<br><img src=\"/assets/media/exam-media/02675/0038100001.png\" class=\"in-exam-image\"><br><img src=\"/assets/media/exam-media/02675/0038200001.png\" class=\"in-exam-image\"><br>",
    "options": [],
    "answer": "See the explanation below.",
    "answerDescription": "1. SELECT p.productname<br>2. FROM Production.Categories As c<br>3. JOIN Production.Products As p<br>ON ( c.categoryid = p.categoryid )<br>4. WHERE c.categoryname = 'Beverages'<br>References:<br>https://docs.microsoft.com/en-us/sql/relational-databases/performance/joins?view=sql-server-2017",
    "votes": [],
    "comments": [
      {
        "date": "2021-01-07T14:27:00.000Z",
        "voteCount": 1,
        "content": "Repeat from Q101"
      },
      {
        "date": "2020-08-18T22:01:00.000Z",
        "voteCount": 1,
        "content": "Should be INNER JOIN as required to use explicit joins."
      },
      {
        "date": "2020-12-15T19:32:00.000Z",
        "voteCount": 1,
        "content": "join is explicit... from x, b its implicit"
      },
      {
        "date": "2021-01-04T16:52:00.000Z",
        "voteCount": 1,
        "content": "\"JOIN\" is the same as \"INNER JOIN\". smh."
      },
      {
        "date": "2020-04-15T23:56:00.000Z",
        "voteCount": 3,
        "content": "no need for the brackets"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 179,
    "url": "https://www.examtopics.com/discussions/microsoft/view/12509-exam-70-761-topic-1-question-179-discussion/",
    "body": "Note: This question is part of a series of questions that use the same or similar answer choices. An answer choice may be correct for more than one question in the series. Each question is independent of the other questions in this series. Information and details provided in a question apply only to that question.<br>You have a table named Person that contains information about employees. Users are requesting a way to access specific columns from the Person table without specifying the Person table in the query statement. The columns that users can access will be determined when the query is running against the data. There are some records that are restricted, and a trigger will evaluate whether the request is attempting to access a restricted record.<br>You need to ensure that users can access the needed columns while minimizing storage on the database server.<br>What should you implement?<br>",
    "options": [
      "<span class=\"multi-choice-letter\" data-choice-letter=\"A\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tthe COALESCE function",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"B\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tB.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\ta view",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"C\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tC.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\ta table-valued function",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"D\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tD.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tthe TRY_PARSE function",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"E\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tE.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\ta stored procedure",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"F\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tF.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tthe ISNULL function",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"G\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tG.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\ta scalar function",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"H\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tH.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tthe TRY_CONVERT function"
    ],
    "answer": "B",
    "answerDescription": "References:<br>https://docs.microsoft.com/en-us/sql/t-sql/statements/create-view-transact-sql?view=sql-server-2017",
    "votes": [],
    "comments": [
      {
        "date": "2020-02-10T08:02:00.000Z",
        "voteCount": 10,
        "content": "trigger are supported only on tables, views, schema or database, not on functions"
      },
      {
        "date": "2020-10-15T01:11:00.000Z",
        "voteCount": 1,
        "content": "That's true, but going deeper in details: what kind of trigger can be used here, when users only want to query the data (access doesn't explicitly mean altering the data, I suppose)? None of DDL, DML or logon triggers will give the opportunity to \"evaluate whether the request is attempting to access a restricted record\" in case of querying the data. If \"access\" means altering the data, then the view is the best answer."
      },
      {
        "date": "2021-01-01T21:45:00.000Z",
        "voteCount": 1,
        "content": "Best answer is to write an INSTEAD OF trigger on a VIEW to do everything require. Can't do on a function"
      },
      {
        "date": "2020-12-20T01:02:00.000Z",
        "voteCount": 1,
        "content": "The answer is View!"
      },
      {
        "date": "2020-12-03T14:41:00.000Z",
        "voteCount": 1,
        "content": "this is a table value function."
      },
      {
        "date": "2020-09-16T06:38:00.000Z",
        "voteCount": 2,
        "content": "I think the answer is store procedure, because:\n1) it can run a dynamic SQL (functions can't), because the columns will be defined dynamically.\n2) it can save the invalid access in a table (Functions can't_"
      },
      {
        "date": "2020-01-22T09:18:00.000Z",
        "voteCount": 2,
        "content": "Can views do that: \"The columns that users can access will be determined when the query is running against the data.\"? It looks like some logic should be implemented to determine the columns, so possibly a table valued function can do that."
      },
      {
        "date": "2020-03-04T01:53:00.000Z",
        "voteCount": 1,
        "content": "I had the exact same thoughts. I would be interested in how this could be implemented exactly. No problem with a table valued function, but how you would do this with a trigger?"
      },
      {
        "date": "2020-12-16T07:01:00.000Z",
        "voteCount": 1,
        "content": "When you running a view  I don't see the columns : SELECT * FROM vView"
      },
      {
        "date": "2020-12-16T07:02:00.000Z",
        "voteCount": 1,
        "content": "Sorry I meant when you're running ... You don't see"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 180,
    "url": "https://www.examtopics.com/discussions/microsoft/view/3838-exam-70-761-topic-1-question-180-discussion/",
    "body": "You have a table that was created by running the following Transact-SQL statement:<br><img src=\"/assets/media/exam-media/02675/0038300001.png\" class=\"in-exam-image\"><br>You need to query the Courses table and return the result set as JSON. The output from the query must resemble the following format:<br><img src=\"/assets/media/exam-media/02675/0038300002.png\" class=\"in-exam-image\"><br>",
    "options": [
      "<span class=\"multi-choice-letter\" data-choice-letter=\"A\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tSELECT CourseID AS [Course ID], Course as Name FROM Courses FOR JSON PATH('Courses')",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"B\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tB.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tSELECT CourseID AS 'Course ID', Course AS Name FROM Courses FOR JSON ROOT('Courses')",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"C\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tC.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tSELECT CourseID AS [Course ID], Course AS Name FROM Courses FOR JSON AUTO, ROOT('Courses')",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"D\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tD.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tSELECT CourseID AS 'Course ID', Course AS Name FROM Courses FOR JSON AUTO, INCLUDE_NULL_VALUES('Courses')"
    ],
    "answer": "D",
    "answerDescription": "References:<br>https://docs.microsoft.com/en-us/sql/relational-databases/json/include-null-values-in-json-include-null-values-option?view=sql-server-2017",
    "votes": [],
    "comments": [
      {
        "date": "2019-08-19T22:21:00.000Z",
        "voteCount": 19,
        "content": "In my test this is not possible. Correct answer should be C.Since Auto formats the JSON Output automatically due to this requirements, in addtion the ROOT Parameter defines the root node in the output."
      },
      {
        "date": "2019-08-23T03:54:00.000Z",
        "voteCount": 1,
        "content": "But Nulls are by default excluded from the JSON output, for both AUTO and PATH modes."
      },
      {
        "date": "2019-10-04T19:18:00.000Z",
        "voteCount": 8,
        "content": "C is right answer.  D would have been right if it would have 'SELECT CourseID AS 'Course ID', Course AS Name FROM Courses FOR JSON AUTO, INCLUDE_NULL_VALUES, ROOT('Courses')' instead of 'SELECT CourseID AS 'Course ID', Course AS Name FROM Courses FOR JSON AUTO, INCLUDE_NULL_VALUES('Courses') '"
      },
      {
        "date": "2021-01-19T07:42:00.000Z",
        "voteCount": 1,
        "content": "The null values are not a specfic requirement , otherwise this would be the answer\n\nSELECT CourseID AS 'Course ID', Course AS Name\nFROM #Courses FOR JSON AUTO, ROOT('Courses'),INCLUDE_NULL_VALUES"
      },
      {
        "date": "2020-07-30T00:18:00.000Z",
        "voteCount": 3,
        "content": "We cannot have INCLUDE_NULL_VALUES('Courses'). It is only INCLUDE_NULL_VALUES.\n\nhttps://docs.microsoft.com/en-us/sql/relational-databases/json/include-null-values-in-json-include-null-values-option?view=sql-server-ver15."
      },
      {
        "date": "2020-05-31T04:11:00.000Z",
        "voteCount": 3,
        "content": "Tested. Its C"
      },
      {
        "date": "2020-05-25T00:23:00.000Z",
        "voteCount": 2,
        "content": "https://docs.microsoft.com/en-us/sql/relational-databases/json/format-query-results-as-json-with-for-json-sql-server?view=sql-server-ver15"
      },
      {
        "date": "2020-05-18T07:57:00.000Z",
        "voteCount": 2,
        "content": "C is the right answer, this was tested and it works fine\n\n  CREATE TABLE #Courses \n(\n\tCourseID INT IDENTITY(1, 1) NOT NULL,\n\tCourse VARCHAR(50) NULL\n)\ngo\n\ninsert into #Courses (Course)\nvalues ('Database Development'), ('Programing in C#')\n\nselect *\nfrom #Courses\n\n\n\nSELECT CourseID AS 'Course ID', Course AS Name\nFROM #Courses FOR JSON AUTO, ROOT('Courses')"
      },
      {
        "date": "2020-09-16T06:51:00.000Z",
        "voteCount": 1,
        "content": "You're right. In fact all the others give a sintax error. I use your script to test them:\nselect courseid as [Course id], course as name from #courses for json path('Courses' )\n\nselect courseid as [Course id], course as name from #courses for json root('Courses' )\n\nselect courseid as [Course id], course as name from #courses for json auto, root('Courses' )\n\nselect courseid as [Course id], course as name from #courses for json auto, include_null_values('Courses' )"
      },
      {
        "date": "2019-09-24T10:46:00.000Z",
        "voteCount": 7,
        "content": "Correct answer is C"
      },
      {
        "date": "2019-08-23T00:26:00.000Z",
        "voteCount": 6,
        "content": "I agree with Dieter option C should be the correct answer I have ran it maually on PC and only option with AUTO and ROOT will give us the required format.\n\nC. SELECT CourseID AS [Course ID], Course AS Name FROM Courses FOR JSON AUTO, ROOT('Courses')"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 181,
    "url": "https://www.examtopics.com/discussions/microsoft/view/25031-exam-70-761-topic-1-question-181-discussion/",
    "body": "A company's sales team is divided in two different regions, North and South. You create tables named SalesNorth and SalesSouth. The SalesNorth table stores sales data from the North region. The SalesSouth table stores sales data from the South region. Both tables use the following structure:<br><img src=\"/assets/media/exam-media/02675/0038400001.png\" class=\"in-exam-image\"><br>You need to create a consolidated result set that includes all records from both tables.<br>Which Transact-SQL statement should you run?<br>",
    "options": [
      "<span class=\"multi-choice-letter\" data-choice-letter=\"A\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tSELECT SalesNorth.salesID, SalesNorth.customer, SalesNorth.amount, SalesSouth.SalesID, SalesSouth.customer, SalesSouth.amount FROM SalesNorth JOIN SalesSouth ON SalesNorth.salesID = SalesSouth.salesID",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"B\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tB.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tSELECT SalesNorth.salesID, SalesNorth.customer, SalesNorth.amount, SalesSouth.salesID, SalesSouth.customer, SalesSouth.amount FROM SalesNorth LEFT JOIN SalesSouth ON SalesNorth.salesID=SalesSouth.salesID",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"C\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tC.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tSELECT salesID, customer, amount FROM SalesNorth UNION ALL SELECT salesID, customer, amount FROM SalesSouth",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"D\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tD.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tSELECT salesID, customer, amount FROM SalesNorth UNION SELECT salesID, customer, amount FROM SalesSouth"
    ],
    "answer": "C",
    "answerDescription": "References:<br>https://docs.microsoft.com/en-us/sql/t-sql/queries/from-transact-sql?view=sql-server-2017",
    "votes": [],
    "comments": [
      {
        "date": "2021-01-01T21:50:00.000Z",
        "voteCount": 1,
        "content": "No primary key and two different databases - I go with UNION ALL to make sure I don't miss anything and add key later"
      },
      {
        "date": "2020-11-29T18:10:00.000Z",
        "voteCount": 1,
        "content": "Isn't it valid in the same weight using UNION or UNION ALL? Or is it because of all the Nulls allow not to miss any possible client getting products from both North and South regions?"
      },
      {
        "date": "2021-01-12T11:37:00.000Z",
        "voteCount": 1,
        "content": "\"all records\" requires a union all because like you said, clients can potentially have sales from both regions. When requiring ALL RECORDS from multiple tables it's 'never' safe enough to just do a union."
      },
      {
        "date": "2020-07-07T09:59:00.000Z",
        "voteCount": 2,
        "content": "seems odd that no answer includes the region field"
      },
      {
        "date": "2021-01-12T11:35:00.000Z",
        "voteCount": 1,
        "content": "it's asking for a consolidated result; no region column needed."
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 182,
    "url": "https://www.examtopics.com/discussions/microsoft/view/3966-exam-70-761-topic-1-question-182-discussion/",
    "body": "DRAG DROP -<br>You need to create a stored procedure that meets the following requirements:<br>\u2711 Produces a warning if the credit limit parameter is greater than 7,000<br>\u2711 Propagates all unexpected errors to the calling process<br>How should you complete the Transact-SQL statement? To answer, drag the appropriate Transact-SQL segments to the correct locations. Each Transact-SQL segments may be used once, more than once, or not at all. You may need to drag the split bar between panes or scroll to view content.<br>Select and Place:<br><img src=\"/assets/media/exam-media/02675/0038600001.jpg\" class=\"in-exam-image\"><br>",
    "options": [],
    "answer": "<img src=\"/assets/media/exam-media/02675/0038600002.jpg\" class=\"in-exam-image\">",
    "answerDescription": "Box 1: THROW 51000, 'Warning: Credit limit is over 7,000!\",1<br>THROW raises an exception and transfers execution to a CATCH block of a TRY\"\u00a6CATCH construct in SQL Server.<br>THROW syntax:<br>THROW [ { error_number | @local_variable },<br>{ message | @local_variable },<br>{ state | @local_variable } ]<br>[ ; ]<br>Box2: RAISERROR (@ErrorMessage, 16,1)<br>RAISERROR generates an error message and initiates error processing for the session. RAISERROR can either reference a user-defined message stored in the sys.messages catalog view or build a message dynamically. The message is returned as a server error message to the calling application or to an associated<br>CATCH block of a TRY\"\u00a6CATCH construct. New applications should use THROW instead.<br>Severity levels from 0 through 18 can be specified by any user. Severity levels from 19through 25 can only be specified by members of the sysadmin fixed server role or users with ALTER TRACE permissions. For severity levels from 19 through 25, the WITH LOG option is required.<br>On Severity level 16. Using THROW to raise an exception<br>The following example shows how to use the THROW statement to raise an exception.<br><br>Transact-SQL -<br>THROW 51000, 'The record does not exist.', 1;<br>Here is the result set.<br>Msg 51000, Level 16, State 1, Line 1<br>The record does not exist.<br>Note: RAISERROR syntax:<br>RAISERROR( { msg_id | msg_str | @local_variable }<br>{ ,severity ,state }<br>[ ,argument [ ,...n ] ] )<br>[ WITH option [ ,...n ] ]<br>Note: The ERROR_MESSAGE function returns the message text of the error that caused the CATCH block of a TRY\"\u00a6CATCH construct to be run.<br>References:<br>https://msdn.microsoft.com/en-us/library/ms178592.aspx<br>https://msdn.microsoft.com/en-us/library/ms190358.aspx<br>https://msdn.microsoft.com/en-us/library/ee677615.aspx",
    "votes": [],
    "comments": [
      {
        "date": "2019-09-16T02:12:00.000Z",
        "voteCount": 13,
        "content": "From Microsoft.\nIf you raise an error that has a severity level of 10 or less, which is a warning, no exception is raised. \n\nhttps://support.microsoft.com/en-ca/help/321903/how-to-return-errors-and-warnings-from-a-sql-server-stored-procedure-i\n\nCorrect answer for first box RAISEERROR ('..', 10, 1)"
      },
      {
        "date": "2020-01-22T09:42:00.000Z",
        "voteCount": 1,
        "content": "\"10 or less\" means: if severity level is 10, then no exception is raised. So severity should be 11 or more."
      },
      {
        "date": "2020-02-28T08:06:00.000Z",
        "voteCount": 1,
        "content": "Sorry, it looks like I misunderstood the question"
      },
      {
        "date": "2019-08-23T04:18:00.000Z",
        "voteCount": 8,
        "content": "As the first requirement is to produce a warning and the second is an error, the severity in RAISERROR() should be 0-10 and 11-19 respectively. Severity 20-25 is fatal and terminates the current connection."
      },
      {
        "date": "2021-01-19T08:43:00.000Z",
        "voteCount": 1,
        "content": "Anette's answer is right.. Just tested it : If you uncomment the select 1/0, you see that the catch block is reached. This is the 'unexpected error' type. Throw does not work anywhere in this case\n\ndrop table #test\ncreate table #test \n(\ncustid varchar(5) not null\n,income money\n)\n\nif object_ID('abort_test','P') IS NOT NULL\ndrop proc abort_test\ngo\ncreate proc abort_test as\nbegin\n\t\tdeclare @creditlimit int = 8000\n\t\tdeclare @errormessage varchar(1000)\n\t\tbegin try\n\t\tif @creditlimit &gt; 7000\n\t\t\tprint 'Preparing for warning in try block............'\n\t\t\traiserror ('Warning: Credit limit is over 7,000', 10 ,1)\n\t\t\tinsert into #test (custid, income) values ('A5666', 20000)\n\t\t\t--select 1/0\n\t\tend try\n\tbegin catch\n\t\tprint 'Preparing for raiserror in catch block............'\n\t\tset @errormessage = error_message()\n\t\t\t\t\traiserror (@errormessage, 16,1)\n\tend catch;\n\tend\n\n\tset xact_abort OFF;\n\texec abort_test"
      },
      {
        "date": "2021-01-19T08:13:00.000Z",
        "voteCount": 1,
        "content": "For raiserror you have to generate an error of the appropriate severity, an error at severity 0 thru 10 do not cause you to jump to the catch block, so either raiserror or throw without the variable in it and with a severity level of 16 (which throw has by default) would do in the TRY block."
      },
      {
        "date": "2021-01-01T21:54:00.000Z",
        "voteCount": 1,
        "content": "Since you need to raise a warning --&gt; RAISERERROR 10-15 severity\nPropogate to calling code -&gt; THROW\nRAISEERROR ('..', 10, 1) -&gt; to raise the warning\nTHROW 51000, @ErrorMessage, 1 -&gt; to 'Propagates all unexpected errors .."
      },
      {
        "date": "2020-08-15T05:49:00.000Z",
        "voteCount": 5,
        "content": "i think the answers are:\n1 box: RAISEERROR ('..', 10, 1)  -&gt; to raise the warning \n2 box: THROW 51000, @ErrorMessage, 1 -&gt; to 'Propagates all unexpected errors ..'"
      },
      {
        "date": "2020-07-11T08:58:00.000Z",
        "voteCount": 1,
        "content": "The req \"Propagates all unexpected errors to the calling process\" eliminates all choices with RAISERROR() for second target because all hardcode the severity, and you should get the severity by calling ERROR_SEVERITY(). Since  @ErrorMessage is defined you have to use it, so the only possibility is THROW 51000, @ErrorMessage, 1\n\nSince THROW is used for second target you should also use THROW for the first target and the best choice is \nTHROW 51000, 'Warning: Credit limit is over 7000', 1\n\nso the answer should be \n\nTHROW 51000, 'Warning: Credit limit is over 7000', 1\nTHROW 51000, @ErrorMessage, 1"
      },
      {
        "date": "2020-05-31T07:27:00.000Z",
        "voteCount": 6,
        "content": "Correct solution:\n1. RAISERROR('Warning: Credit limit is over 7,000!', 10,1)\n2. RAISERROR('Warning: Credit limit is over 7,000!', 16,1)\n\nTested :)"
      },
      {
        "date": "2020-05-31T07:30:00.000Z",
        "voteCount": 1,
        "content": "sorry second box does not have any sense but throw fits here. Even just throw or throw 51000, @ErrorMessage, 1"
      },
      {
        "date": "2020-05-31T07:35:00.000Z",
        "voteCount": 1,
        "content": "But I would go with just Throw, since it gives the error code from SQL server and it might not only be 51000 but depends from type of error which occurs. So, Second box is just Throw in my opinion."
      },
      {
        "date": "2020-05-31T07:38:00.000Z",
        "voteCount": 5,
        "content": "SORRY I see the semicolon here is the problem for Throw. If we use Throw it might need ; before and since we do not have it, We are obliged to go with raiseerror, and the valuable option here is RAISERROR (@errormessage, 16, 1). This is FINAL for BOx 2."
      },
      {
        "date": "2020-02-23T11:03:00.000Z",
        "voteCount": 6,
        "content": "&lt;Produces a warning if the credit limit parameter is greater than 7,000&gt; : This doesn't mean that the credit limit can't be inserted into the table, it's just a warning, therefore the 1st Statmente should be Raiserror ('Warning.... ', 10,1). Only on a runtime error the procedure have to walk into the the Catch block, log the errormessage and probagate the error status to the calling process. Just the \"THROW;\" without paramenters seems to be enough as second statement."
      },
      {
        "date": "2020-04-16T00:52:00.000Z",
        "voteCount": 1,
        "content": "no semi colon before throw though does not work then I think"
      },
      {
        "date": "2020-04-20T01:30:00.000Z",
        "voteCount": 1,
        "content": "makes sense to use raiserror here as you capture the error for a reason into your variable"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 183,
    "url": "https://www.examtopics.com/discussions/microsoft/view/3972-exam-70-761-topic-1-question-183-discussion/",
    "body": "You have a date related query that would benefit from an indexed view.<br>You need to create the indexed view.<br>Which two Transact-SQL functions can you use? Each correct answer presents a complete solution.<br>NOTE: Each correct selection is worth one point.<br>",
    "options": [
      "<span class=\"multi-choice-letter\" data-choice-letter=\"A\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tDATEADD",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"B\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tB.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tAT TIME ZONE",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"C\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tC.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tGETUTCDATE",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"D\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tD.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tDATEDIFF"
    ],
    "answer": "CD",
    "answerDescription": "References:<br>https://docs.microsoft.com/en-us/sql/t-sql/functions/date-and-time-data-types-and-functions-transact-sql?view=sql-server-2017#DateandTimeFunctions",
    "votes": [],
    "comments": [
      {
        "date": "2019-08-23T04:56:00.000Z",
        "voteCount": 15,
        "content": "Hi, I think the question here is related to deterministic versus non-deterministic functions. An index can not be created for a non-deterministic function. Therefore, the correct answer should be \"DATEADD\" and \"DATEDIFF\", because both of them are always deterministic functions as per below microsoft link.\n\nhttps://docs.microsoft.com/en-us/sql/relational-databases/user-defined-functions/deterministic-and-nondeterministic-functions?view=sql-server-2017"
      },
      {
        "date": "2019-09-16T03:17:00.000Z",
        "voteCount": 2,
        "content": "Agree. But the question is on VIEW, I try all 4 statements inside an INDEXED VIEW and ALL 4 working properly !"
      },
      {
        "date": "2020-10-27T02:13:00.000Z",
        "voteCount": 1,
        "content": "A clustered index cannot be created on a view if the view references any nondeterministic functions."
      },
      {
        "date": "2020-01-16T02:35:00.000Z",
        "voteCount": 12,
        "content": "The definition of an indexed view must be deterministic. DATEADD and DATEDIFF are deterministic"
      },
      {
        "date": "2021-01-19T10:26:00.000Z",
        "voteCount": 1,
        "content": "Answer = A/D. Just tested this\n\n\nUSE [70-461]\nGO\nif exists\n(\nselect * from INFORMATION_SCHEMA.VIEWS\nwhere [TABLE_NAME] = 'ViewByDepartment' and [TABLE_SCHEMA] = 'dbo'\n)\ndrop view dbo.ViewByDepartment\nGO\nCREATE view [dbo].[ViewByDepartment] with schemabinding as \nselect D.Department\n\t\t, T.EmployeeNumber\n\t\t, T.DateOfTransaction\n\t\t, T.Amount as TotalAmount\n\t\t--,SYSDATETIMEOFFSET()  at time zone 'Central European Standard Time'  timezone_column2 --&gt;nondeterministic\n\t\t--,getutcdate() as utc_date --&gt; nondeterministic\n\t\t,dateadd(day,1,t.dateoftransaction) as day_plus_1 --&gt;deterministic\n\t\t,datediff(hh, t.dateoftransaction,t.dateoftransaction) as diff_both_dates --&gt; deterministic\nfrom dbo.tblDepartment as D \ninner join dbo.tblMedewerker as E\non D.Department = E.Department\ninner join dbo.tblTransacties as T\non E.EmployeeNumber = T.EmployeeNumber \nwhere T.EmployeeNumber between 100 and 300\nGO"
      },
      {
        "date": "2019-10-19T07:38:00.000Z",
        "voteCount": 5,
        "content": "DATEADD e DATEDIFF are deterministic"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 184,
    "url": "https://www.examtopics.com/discussions/microsoft/view/3698-exam-70-761-topic-1-question-184-discussion/",
    "body": "You are developing a database to track employee progress relative to training goals. You run the following Transact-SQL statements:<br><img src=\"/assets/media/exam-media/02675/0038900001.jpg\" class=\"in-exam-image\"><br>You must build a report that shows all Employees and the courses that they have taken. Employees that have not taken training courses must still appear in the report. The report must display NULL in the course column for these employees.<br>You need to create a query for the report.<br><img src=\"/assets/media/exam-media/02675/0038900002.png\" class=\"in-exam-image\"><br>A.<br><img src=\"/assets/media/exam-media/02675/0039000001.png\" class=\"in-exam-image\"><br>B.<br><img src=\"/assets/media/exam-media/02675/0039000002.png\" class=\"in-exam-image\"><br>C.<br><img src=\"/assets/media/exam-media/02675/0039000003.png\" class=\"in-exam-image\"><br>D.<br>",
    "options": [],
    "answer": "C",
    "answerDescription": "Incorrect Answers:<br>A, B: JOIN and INNER JOIN displays only the rows that have a match in both joined tables<br>References:<br>https://www.mssqltips.com/sqlservertip/1667/sql-server-join-example/",
    "votes": [],
    "comments": [
      {
        "date": "2019-08-18T04:57:00.000Z",
        "voteCount": 42,
        "content": "Answer should be D because all employees need to be returned."
      },
      {
        "date": "2019-10-19T07:41:00.000Z",
        "voteCount": 7,
        "content": "RIGHT JOIN  is correct (answer D)"
      },
      {
        "date": "2020-07-06T06:54:00.000Z",
        "voteCount": 1,
        "content": "D is only answer that all employees are returned."
      },
      {
        "date": "2020-06-16T07:11:00.000Z",
        "voteCount": 1,
        "content": "it could be right or left join.  It depends upon which side the employee table is located.  Since the order is  Courses -&gt; course taken -&gt; employee,   left join appeared to be more correct."
      },
      {
        "date": "2020-05-31T08:42:00.000Z",
        "voteCount": 1,
        "content": "Right Join is needed. D"
      },
      {
        "date": "2019-08-23T05:03:00.000Z",
        "voteCount": 6,
        "content": "I agree with AshleyLiang because we need all employees whether they have taken courses or not and since the employee table is at the right side in the multiple join query therefore RIGHT JOIN will return the employees with NULL as stated in the question"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 185,
    "url": "https://www.examtopics.com/discussions/microsoft/view/15944-exam-70-761-topic-1-question-185-discussion/",
    "body": "Note: This question is part of a series of questions that present the same scenario. Each question in the series contains a unique solution that might meet the stated goals. Some question sets might have more than one correct solution, while others might not have a correct solution.<br>After you answer a question in this section. You will NOT be able to return to it. As a result, these questions will not appear in the review screen.<br>You have a database that includes the tables shown in the exhibit (Click the Exhibit button.)<br><img src=\"/assets/media/exam-media/02675/0039100001.png\" class=\"in-exam-image\"><br>You need to create a Transact-SQL query that returns the following information:<br>\u2711 the customer number<br>\u2711 the customer contact name<br>\u2711 the date the order was placed, with a name of DateofOrder<br>\u2711 a column named Salesperson, formatted with the employee first name, a space, and the employee last name<br>\u2711 orders for customers where the employee identifier equals 4<br>The output must be sorted by order date, with the newest orders first.<br>The solution must return only the most recent order for each customer.<br>Solution: You run the following Transact-SQL statement:<br><img src=\"/assets/media/exam-media/02675/0039200001.png\" class=\"in-exam-image\"><br>Does the solution meet the goal?<br>",
    "options": [
      "<span class=\"multi-choice-letter\" data-choice-letter=\"A\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tYes",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"B\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tB.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tNo"
    ],
    "answer": "B",
    "answerDescription": "We cannot use the column alias Salesperson in the GROUP BY clause, since in Oracle and SQL Server, you cannot use a term in the GROUP BY clause that you define in the SELECT clause because the GROUP BY is executed before the SELECT clause.<br>References:<br>https://stackoverflow.com/questions/3841295/sql-using-alias-in-group-by/3841804",
    "votes": [],
    "comments": [
      {
        "date": "2020-04-04T03:59:00.000Z",
        "voteCount": 7,
        "content": "---&gt; group by c.custid,contactname,e.firstname,e.lastname (ALIAS not permitted en group by, only en order by)"
      },
      {
        "date": "2021-01-01T22:00:00.000Z",
        "voteCount": 1,
        "content": "MAX(OrderDate) wrong as well as using alias in GROUP BY clause"
      },
      {
        "date": "2020-04-04T04:00:00.000Z",
        "voteCount": 1,
        "content": "This its more right---&gt; group by c.custid,c.contactname,e.firstname,e.lastname (ALIAS not permitted en group by, only en order by)"
      },
      {
        "date": "2020-03-09T06:31:00.000Z",
        "voteCount": 2,
        "content": "Additionally the last order date was not requested and the space between the first and last date is missing."
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 186,
    "url": "https://www.examtopics.com/discussions/microsoft/view/22708-exam-70-761-topic-1-question-186-discussion/",
    "body": "Note: This question is part of a series of questions that present the same scenario. Each question in the series contains a unique solution that might meet the stated goals. Some question sets might have more than one correct solution, while others might not have a correct solution.<br>After you answer a question in this section, you will NOT be able to return to it. As a result, these questions will not appear in the review screen.<br>You have a database named DB1 that contains two tables named Sales.Customers and Sales.Orders. Sales.Customers has a foreign key relationship to a column named CustomerID in Sales.Orders.<br>You need to recommend a query that returns all the customers. The query must also return the number of orders that each customer placed in 2016.<br>Solution: You recommend the following query:<br><img src=\"/assets/media/exam-media/02675/0039300001.png\" class=\"in-exam-image\"><br>Does this meet the goal?<br>",
    "options": [
      "<span class=\"multi-choice-letter\" data-choice-letter=\"A\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tYes",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"B\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tB.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tNo"
    ],
    "answer": "B",
    "answerDescription": "References:<br>https://docs.microsoft.com/en-us/sql/t-sql/functions/count-transact-sql?view=sql-server-2017",
    "votes": [],
    "comments": [
      {
        "date": "2020-06-10T00:08:00.000Z",
        "voteCount": 7,
        "content": "The JOIN definition is wrong here. Should be \"ON Cust.CustomerID = Ord.CustomerID\"."
      },
      {
        "date": "2020-07-06T06:59:00.000Z",
        "voteCount": 5,
        "content": "good catch. i missed that but still chose B because there is nothing the query to reference 2016 only"
      },
      {
        "date": "2021-01-01T22:03:00.000Z",
        "voteCount": 1,
        "content": "The HAVING clause will also eliminate customers who haven't ordered"
      },
      {
        "date": "2020-10-01T09:38:00.000Z",
        "voteCount": 4,
        "content": "COUNT&gt;0 will eliminates some customers"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 187,
    "url": "https://www.examtopics.com/discussions/microsoft/view/5226-exam-70-761-topic-1-question-187-discussion/",
    "body": "Note: This question is part of a series of questions that present the same scenario. Each question in the series contains a unique solution that might meet the stated goals. Some question sets might have more than one correct solution, while others might not have a correct solution.<br>After you answer a question in this section. You will NOT be able to return to it. As a result, these questions will not appear in the review screen.<br>You create a table named Products by running the following Transact-SQL statement:<br><img src=\"/assets/media/exam-media/02675/0039400001.png\" class=\"in-exam-image\"><br>You have the following stored procedure:<br><img src=\"/assets/media/exam-media/02675/0039400002.png\" class=\"in-exam-image\"><br>You need to modify the stored procedure to meet the following new requirements:<br>\u2711 Insert product records as a single unit of work.<br>\u2711 Return error number 51000 when a product fails to insert into the database.<br>\u2711 If a product record insert operation fails, the product information must not be permanently written to the database.<br>Solution: You run the following Transact-SQL statement:<br><img src=\"/assets/media/exam-media/02675/0039500004.png\" class=\"in-exam-image\"><br>Does this meet the goal?<br>",
    "options": [
      "<span class=\"multi-choice-letter\" data-choice-letter=\"A\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tYes",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"B\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tB.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tNo"
    ],
    "answer": "B",
    "answerDescription": "XACT_STATE is a scalar function that reports the user transaction state of a current running request. XACT_STATE indicates whether the request has an active user transaction, and whether the transaction is capable of being committed.<br>The states of XACT_STATE are:<br>\u2711 0 There is no active user transaction for the current request.<br>\u2711 1 The current request has an active user transaction. The request can perform any actions, including writing data and committing the transaction.<br>\u2711 2 The current request has an active user transaction, but an error has occurred that has caused the transaction to be classified as an uncommittable transaction.<br>Example of correct use:<br><br>BEGIN CATCH -<br>-- Test XACT_STATE for 0, 1, or -1.<br>-- If 1, the transaction is committable.<br>-- If -1, the transaction is uncommittable and should<br>--     be rolled back.<br>-- XACT_STATE = 0 means there is no transaction and<br>--     a commit or rollback operation would generate an error.<br>-- Test whether the transaction is uncommittable.<br><br>IF (XACT_STATE()) = -1 -<br><br>BEGIN -<br>PRINT 'The transaction is in an uncommittable state.' +<br>' Rolling back transaction.'<br>ROLLBACK TRANSACTION;<br>END;<br>-- Test whether the transaction is active and valid.<br><br>IF (XACT_STATE()) = 1 -<br><br>BEGIN -<br>PRINT 'The transaction is committable.' +<br>' Committing transaction.'<br>COMMIT TRANSACTION;<br>END;<br>END CATCH;<br>References:<br>https://msdn.microsoft.com/en-us/library/ms188792.aspx<br>https://msdn.microsoft.com/en-us/library/ms189797.aspx",
    "votes": [],
    "comments": [
      {
        "date": "2019-09-16T03:39:00.000Z",
        "voteCount": 16,
        "content": "Wrong ! The explanation says about XACT_STATE but the firs line of code is XACT_ABORT that rollback in case of any error. Correct answer YES."
      },
      {
        "date": "2020-10-04T22:07:00.000Z",
        "voteCount": 1,
        "content": "Although the transaction gets rolled back with XACT_ABORT and it woks to satisfy requirements without coding rollback, several Microsoft links show code for rolling back transaction for XACT_STATE = -1  - see here - https://docs.microsoft.com/en-us/sql/t-sql/language-elements/try-catch-transact-sql?view=sql-server-ver15   And  here - https://docs.microsoft.com/en-us/sql/t-sql/language-elements/try-catch-transact-sql?view=sql-server-ver15#uncommittable-transactions-and-xact_state   - And here - https://docs.microsoft.com/en-us/sql/t-sql/functions/xact-state-transact-sql?view=sql-server-ver15  Are you saying these are all wrong?"
      },
      {
        "date": "2020-05-21T17:04:00.000Z",
        "voteCount": 7,
        "content": "When you use XACT_STATE ON, THROW will roll back the transaction even if there is no ROLL BACK TRANS clause!"
      },
      {
        "date": "2021-01-19T10:46:00.000Z",
        "voteCount": 1,
        "content": "M4x is right. Answer A is correct."
      },
      {
        "date": "2020-07-07T10:41:00.000Z",
        "voteCount": 3,
        "content": "if you copy flash's example, and replace the contents of the catch with:\nprint XACT_STATE();\nprint @@TRANCOUNT\n\nrunning it yields:\n(0 rows affected)\n-1\n1\nMsg 3998, Level 16, State 1, Line 84\nUncommittable transaction is detected at the end of the batch. The transaction is rolled back."
      },
      {
        "date": "2020-11-30T15:44:00.000Z",
        "voteCount": 1,
        "content": "If you print it before ;THROW yes, there will be open transaction, but you run it again after ;throw and it returns 0.  ;THROW will rollback the transactions. Reading the Querying book only setting XACT_ABORT ON will do the trick in a batch with a BEGIN TRAN, and since there is a TRY CATCH block the error will jump to CATCH and THROW will rollback."
      },
      {
        "date": "2020-07-06T07:04:00.000Z",
        "voteCount": 1,
        "content": "i tried it too:\n\n(0 rows affected)\nMsg 51000, Level 16, State 1, Line 30\nMANUAL MSG ERROR\n\nanswer =  Yes"
      },
      {
        "date": "2020-05-19T06:05:00.000Z",
        "voteCount": 1,
        "content": "The answer (B) is correct, but the explenation is not. What is missing is an actual ROLLBACK statement in the CATCH block (in whichever form you prefer it). Without an explicit ROLLBACK, a transaction would never be rolled back. Hence, unwanted changes to the database could occur."
      },
      {
        "date": "2020-10-25T05:22:00.000Z",
        "voteCount": 1,
        "content": "not true, when xact_abort is on, a throw will abort transaction and automatically roll back."
      },
      {
        "date": "2021-09-19T07:02:00.000Z",
        "voteCount": 1,
        "content": "this is not true: xact_abort will only rollback a transaction when the error happens outside of the try block: it does not catch errors inside the tryblock"
      },
      {
        "date": "2020-02-09T08:25:00.000Z",
        "voteCount": 6,
        "content": "I agree with M4x, the correct answer is YES. I tested:\nCREATE TABLE [dbo].[DISTRICTS](\n\t[ID_District] [int] IDENTITY(1,1) NOT NULL,\n\t[DistrictName] [varchar](255) NOT NULL,\n\t[City] [varchar](2) NULL\n) ON [PRIMARY]\nGO\n\n\nBEGIN\nSET XACT_ABORT ON\n\tBEGIN TRY\n\t\tBEGIN TRANSACTION   \n\t\t\tINSERT INTO DISTRICTS (DISTRICTNAME,CITY)\n\t\t\tVALUES ('LIS', 'TRETRT')\n\t\tCOMMIT TRANSACTION;\n\tEND TRY\n\tBEGIN CATCH\n\t\tTHROW 51000, 'MANUAL MSG ERROR',1\n\tEND CATCH\nEND\n;\n\nerror message:\n(0 rows affected)\nMsg 51000, Level 16, State 1, Line 10\nMANUAL MSG ERROR"
      },
      {
        "date": "2020-09-03T11:05:00.000Z",
        "voteCount": 1,
        "content": "The transaction is not completed but it does not mean it has been rolled back - the question asks to roll it back. In your example, the transaction is left hanging in error state"
      },
      {
        "date": "2019-11-20T13:39:00.000Z",
        "voteCount": 3,
        "content": "answer is NO as it will not be possible with XACT on to return error 51000"
      },
      {
        "date": "2021-01-04T01:45:00.000Z",
        "voteCount": 1,
        "content": "false. you are wrong. the correct answer is \"YES\"."
      },
      {
        "date": "2019-09-24T05:45:00.000Z",
        "voteCount": 4,
        "content": "Correct answer = \"No\"\n\n\nThere is another option for trapping errors that is one step toward structured error handling:\nSET XACT_ABORT (where XACT stands for \"transaction\"). XACT_ABORT works with all types\nof code and affects the entire batch. You can make an entire batch fail if any error occurs by\nbeginning it with SET XACT_ABORT ON. You set XACT_ABORT per session. After it is set to\nON, all remaining transactions in that setting are subject to it until it is set to OFF.\nSET XACT_ABORT has some advantages. It causes a transaction to roll back based on any\nerror with severity &gt; 10. However, XACT_ABORT has many limitations, such as the following:\n\u25a0\u25a0 You cannot trap for the error or capture the error number.\n\u25a0\u25a0 Any error with severity level &gt; 10 causes the transaction to roll back.\n\u25a0\u25a0 None of the remaining code in the transaction is executed. Even the final PRINT statements\nof the transaction are not executed.\n\u25a0\u25a0 After the transaction is aborted, you can only infer what statements failed by inspecting\nthe error message returned to the client by SQL Server."
      },
      {
        "date": "2020-02-28T08:26:00.000Z",
        "voteCount": 1,
        "content": "Did you test it? \"None of the remaining code in the transaction is executed.\" - that might mean  the remaining code in begin tran...commit tran."
      },
      {
        "date": "2020-04-16T01:23:00.000Z",
        "voteCount": 1,
        "content": "XACT abort works different than what you are describing if you are using a TRY/CATCH statement. XACT abort icw try/catch just throws everything to catch; so this works just fine."
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 188,
    "url": "https://www.examtopics.com/discussions/microsoft/view/39941-exam-70-761-topic-1-question-188-discussion/",
    "body": "You are performing a code review of stored procedures. Code at line SP03 fails to run (Line numbers are included for reference only.)<br><img src=\"/assets/media/exam-media/02675/0039700001.png\" class=\"in-exam-image\"><br>You need to ensure that transactions are rolled back when an error occurs.<br>Which Transact-SQL segment should you insert at line SP07?<br>",
    "options": [
      "<span class=\"multi-choice-letter\" data-choice-letter=\"A\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tIf @@Error &lt;&gt; 0",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"B\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tB.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tIf @@ TRANCOUNT = 0",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"C\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tC.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tIf @@ TRANCOUNT &gt; 0",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"D\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tD.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tIf @@ Error = 0"
    ],
    "answer": "C",
    "answerDescription": "Using TRY...CATCH in a transaction<br>The following example shows how a TRY...CATCH block works inside a transaction. The statement inside the TRY block generates a constraint violation error.<br>BEGIN TRANSACTION;<br><br>BEGIN TRY -<br>-- Generate a constraint violation error.<br><br>DELETE FROM Production.Product -<br>WHERE ProductID = 980;<br><br>END TRY -<br><br>BEGIN CATCH -<br><br>SELECT -<br><br>ERROR_NUMBER() AS ErrorNumber -<br>,ERROR_SEVERITY() AS ErrorSeverity<br>,ERROR_STATE() AS ErrorState<br>,ERROR_PROCEDURE() AS ErrorProcedure<br>,ERROR_LINE() AS ErrorLine<br>,ERROR_MESSAGE() AS ErrorMessage;<br><br>IF @@TRANCOUNT &gt; 0 -<br>ROLLBACK TRANSACTION;<br>END CATCH;<br><br>IF @@TRANCOUNT &gt; 0 -<br>COMMIT TRANSACTION;<br><br>GO -<br>References:<br>https://docs.microsoft.com/en-us/sql/t-sql/language-elements/try-catch-transact-sql",
    "votes": [],
    "comments": [
      {
        "date": "2020-12-16T08:49:00.000Z",
        "voteCount": 2,
        "content": "no comments"
      },
      {
        "date": "2020-12-15T11:41:00.000Z",
        "voteCount": 3,
        "content": "Correctimundo"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 189,
    "url": "https://www.examtopics.com/discussions/microsoft/view/21668-exam-70-761-topic-1-question-189-discussion/",
    "body": "DRAG DROP -<br>You are developing a training management solution. You run the following Transact-SQL statement:<br><img src=\"/assets/media/exam-media/02675/0039800001.png\" class=\"in-exam-image\"><br>You need to create an indexed view to return all the courses where the value of TrainerEval is equal to or higher than 8.5.<br>Which three Transact-SQL segments should you use to develop the solution? To answer, move the appropriate Transact-SQL segments from the list of Transact-<br>SQL segments to the answer area and arrange them in the correct order.<br>Select and Place:<br><img src=\"/assets/media/exam-media/02675/0039900001.png\" class=\"in-exam-image\"><br>",
    "options": [],
    "answer": "<img src=\"/assets/media/exam-media/02675/0040000001.png\" class=\"in-exam-image\">",
    "answerDescription": "References:<br>https://docs.microsoft.com/en-us/sql/relational-databases/views/create-indexed-views",
    "votes": [],
    "comments": [
      {
        "date": "2021-01-01T22:13:00.000Z",
        "voteCount": 1,
        "content": "view must be created WITH SCHEMABINDING and first index must be UNIQUE CLUSTERED"
      },
      {
        "date": "2020-09-14T15:41:00.000Z",
        "voteCount": 1,
        "content": "You would need a GO batch separator to run it. CREATE in general has to be the first statement in a batch, otherwise the code is fine since it doesn't talk about what comes before it."
      },
      {
        "date": "2020-12-25T20:34:00.000Z",
        "voteCount": 1,
        "content": "'GO' is proprietary for SSMS."
      },
      {
        "date": "2020-05-31T09:40:00.000Z",
        "voteCount": 1,
        "content": "it shows error:\nIncorrect syntax near the keyword 'create'."
      },
      {
        "date": "2020-12-25T20:34:00.000Z",
        "voteCount": 1,
        "content": "it won't work in one batch ."
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 190,
    "url": "https://www.examtopics.com/discussions/microsoft/view/39942-exam-70-761-topic-1-question-190-discussion/",
    "body": "HOTSPOT -<br>Note: This question is part of a series of questions that use the same scenario. For your convenience, the scenario is repeated in each question. Each question presents a different goal and answer choices, but the text of the scenario is exactly the same in each question in this series.<br>You are developing a database to track customer orders. The database contains the following tables: Sales.Customers, Sales.Orders, and Sales.OrderLines.<br>The following table describes the columns in Sales.Customers.<br><img src=\"/assets/media/exam-media/02675/0040100001.png\" class=\"in-exam-image\"><br>The following table describes the columns in Sales.Orders.<br><img src=\"/assets/media/exam-media/02675/0040100002.png\" class=\"in-exam-image\"><br>The following table describes the columns in Sales.OrderLines.<br><img src=\"/assets/media/exam-media/02675/0040100003.png\" class=\"in-exam-image\"><br>You need to design an indexed view to return customer information.<br>What are the requirements for creating an indexed view? Use the drop-down menus to select the answer choice that completes each statement.<br>Hot Area:<br><img src=\"/assets/media/exam-media/02675/0040200001.jpg\" class=\"in-exam-image\"><br>",
    "options": [],
    "answer": "<img src=\"/assets/media/exam-media/02675/0040300001.jpg\" class=\"in-exam-image\">",
    "answerDescription": "Box 1: Deterministic -<br>The definition of an indexed view must be deterministic. A view is deterministic if all expressions in the select list, as well as the WHERE and GROUP BY clauses, are deterministic.<br><br>Box 2: SCHEMABINDING -<br>Create the view by using the WITH SCHEMABINDING option.<br><br>Box 3: unique clustered -<br>The first index created on a view must be a unique clustered index.<br>References:<br>https://docs.microsoft.com/en-us/sql/relational-databases/views/create-indexed-views",
    "votes": [],
    "comments": [
      {
        "date": "2021-01-04T02:14:00.000Z",
        "voteCount": 1,
        "content": "The provided answer is correct."
      },
      {
        "date": "2021-01-26T01:42:00.000Z",
        "voteCount": 1,
        "content": "Eggstaker, you are right"
      },
      {
        "date": "2020-12-15T11:43:00.000Z",
        "voteCount": 3,
        "content": "Correctimundo"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 191,
    "url": "https://www.examtopics.com/discussions/microsoft/view/5232-exam-70-761-topic-1-question-191-discussion/",
    "body": "You have a database that tracks customer complaints.<br>The database contains a table named Complaints that includes the following columns:<br><img src=\"/assets/media/exam-media/02675/0040400001.png\" class=\"in-exam-image\"><br>You need to create a query that lists complaints about defective products. The report must include complaints where the exact phrase \"defective product\" occurs, as well as complaints where similar phrases occur.<br><img src=\"/assets/media/exam-media/02675/0040400002.png\" class=\"in-exam-image\"><br>A.<br><img src=\"/assets/media/exam-media/02675/0040400003.png\" class=\"in-exam-image\"><br>B.<br><img src=\"/assets/media/exam-media/02675/0040400004.png\" class=\"in-exam-image\"><br>C.<br><img src=\"/assets/media/exam-media/02675/0040400005.png\" class=\"in-exam-image\"><br>D.<br>",
    "options": [],
    "answer": "D",
    "answerDescription": "References:<br>https://docs.microsoft.com/en-us/sql/t-sql/queries/contains-transact-sql?view=sql-server-2017",
    "votes": [],
    "comments": [
      {
        "date": "2019-09-16T05:10:00.000Z",
        "voteCount": 5,
        "content": "as well as complaints where similar phrases occur. \nAnswer A"
      },
      {
        "date": "2020-02-09T08:45:00.000Z",
        "voteCount": 1,
        "content": "where the exact phrase \"defective product\" ..."
      },
      {
        "date": "2020-02-09T08:49:00.000Z",
        "voteCount": 2,
        "content": "FREETEXTTABLE\n\nhttp://msdn.microsoft.com/en-us/library/ms177652(v=SQL.90).aspx Returns a table of zero, one, or more rows for those columns containing character-based data types for values that match the meaning, but not the exact wording, of the text in the specified freetext_string. FREETEXTTABLE can be referenced in the FROM clause of a SELECT statement like a regular table name."
      },
      {
        "date": "2020-02-17T09:02:00.000Z",
        "voteCount": 2,
        "content": "then at least it should be C, not D, since that it is 'defective product' not 'defective' &amp; 'product'"
      },
      {
        "date": "2020-03-04T12:27:00.000Z",
        "voteCount": 2,
        "content": "\"The report must include complaints where the exact phrase \"defective product\" occurs, as well as complaints where similar phrases occur.\"\n\nC would only look for the exact phrase \"defective product\"\nD would contain similar phrases and also \"defective product\""
      },
      {
        "date": "2020-10-25T05:39:00.000Z",
        "voteCount": 1,
        "content": "it says: 'but not just the exact wording'. so the exact wording is included. Hence, A is true"
      },
      {
        "date": "2020-12-16T15:15:00.000Z",
        "voteCount": 1,
        "content": "It doesn't say \"just\", you've just added that word in which changes the whole meaning of it. It says 'but not the exact wording' therefore it can't be A. \n\nhttps://docs.microsoft.com/en-us/sql/t-sql/queries/freetext-transact-sql?view=sql-server-ver15"
      },
      {
        "date": "2020-12-16T15:17:00.000Z",
        "voteCount": 1,
        "content": "Ignore my above link, the above URL is for FREETEXT which isn't involved in this question. Question A relates to FREETEXTTABLE where I reference the following: \n\nhttps://docs.microsoft.com/en-us/sql/relational-databases/system-functions/freetexttable-transact-sql?view=sql-server-ver15"
      },
      {
        "date": "2020-12-16T15:21:00.000Z",
        "voteCount": 1,
        "content": "Sorry for all the comments guys. Don't mean to add confusion. It seems Jonasdv is in fact correct. When I was quoting \"but not the exact wording\" it was from the below link which seems to be an older version and therefore deprecated:\n\nhttps://docs.microsoft.com/en-us/previous-versions/sql/sql-server-2005/ms177652(v=sql.90)\n\nThe link I posted above is more up to date, and that includes \"not just the exact wording\"\n\nSo I'd go for A in this instance."
      },
      {
        "date": "2021-01-26T01:53:00.000Z",
        "voteCount": 1,
        "content": "if object_ID('complaints','U') IS NOT NULL\ndrop table complaints\ngo\n\ncreate table complaints \n(   complaintID int not null\n\t,CustomerTranscript nvarchar(max)\n)\n\ncreate unique clustered index PK_complaint on complaints (complaintid)\n\ninsert into complaints values\n(1, 'In this string you will find defective product')\n,(2,'defective product')\n,(3, 'not present in this string')\n,(4, 'present in this string defective product')\n\nselect * from complaints\n\nCREATE FULLTEXT CATALOG fulltextCatalog2 AS DEFAULT; \nCREATE FULLTEXT INDEX ON dbo.complaints(CustomerTranscript) \nKEY INDEX PK_complaint \nWITH STOPLIST = SYSTEM;\n\n--ANSWER A\nSELECT\tcomplaintid, \n\t\tcustomertranscript,\n   KEY_TBL.RANK\nFROM complaints AS C INNER JOIN\n   FREETEXTTABLE(complaints, CustomerTranscript, 'defective product') AS KEY_TBL\n   ON c.complaintid = KEY_TBL.[KEY]\nGO\n--ANSWER D\nSELECT\tcomplaintid, \n\t\tcustomertranscript\n\t\tfrom complaints\n\t\twhere contains (customertranscript, 'defective') \n\t\tand contains (CustomerTranscript , 'product')"
      },
      {
        "date": "2021-01-19T13:28:00.000Z",
        "voteCount": 1,
        "content": "A and D do what is required"
      },
      {
        "date": "2021-01-13T09:55:00.000Z",
        "voteCount": 1,
        "content": "It must be B, although there are some syntax errors (assuming it's a typo not being made on the exam). https://docs.microsoft.com/en-us/sql/relational-databases/search/query-with-full-text-search?view=sql-server-ver15 clearly states:\n-To match words and phrases, use CONTAINS and CONTAINSTABLE.\n-To match the meaning, but not the exact wording, use FREETEXT and FREETEXTTABLE.\nOnly B would meet the requirements here."
      },
      {
        "date": "2020-08-28T07:12:00.000Z",
        "voteCount": 2,
        "content": "Tested all. \nB and C return syntax error\nA and D returns the requirements"
      },
      {
        "date": "2020-07-10T03:27:00.000Z",
        "voteCount": 1,
        "content": "A)B)C) can't find similar phrases like \"product is defective'. D) can find that."
      },
      {
        "date": "2020-05-31T12:16:00.000Z",
        "voteCount": 3,
        "content": "Only A fits here. I guess that similar phrases include 'product' or 'defective'. Also for B and C execution gives error: \nSyntax error near 'product' in the full-text search condition 'defective product'/'defective% product%'.\nMust put the Word NEAR between 2 words in order to execute without errors. And even after putting NEAR it gives results only for complaints which contain 'defective' and 'products' words, sot similar with only one of the words. \nAs conclusion, I think it is answer A."
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 192,
    "url": "https://www.examtopics.com/discussions/microsoft/view/39943-exam-70-761-topic-1-question-192-discussion/",
    "body": "Note: This question is part of a series of questions that present the same scenario. Each question in the series contains a unique solution that might meet the stated goals. Some question sets might have more than one correct solution, while others might not have a correct solution.<br>After you answer a question in this section, you will NOT be able to return to it. As a result, these questions will not appear in the review screen.<br>You create a table named Customer by running the following Transact-SQL statement:<br><img src=\"/assets/media/exam-media/02675/0040500001.png\" class=\"in-exam-image\"><br>You create a cursor by running the following Transact-SQL statement:<br><img src=\"/assets/media/exam-media/02675/0040600001.png\" class=\"in-exam-image\"><br>If the credit limit is zero, you must delete the customer record while fetching data.<br>You need to add the DELETE statement.<br>Solution: You add the following Transact-SQL statement:<br><img src=\"/assets/media/exam-media/02675/0040600002.png\" class=\"in-exam-image\"><br>Does the solution meet the goal?<br>",
    "options": [
      "<span class=\"multi-choice-letter\" data-choice-letter=\"A\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tYes",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"B\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tB.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tNo"
    ],
    "answer": "B",
    "answerDescription": "Use a WHERE CURRENT OF clause, which deletes at the current position of the specified cursor.<br>References:<br>https://docs.microsoft.com/en-us/sql/t-sql/statements/delete-transact-sql",
    "votes": [],
    "comments": [
      {
        "date": "2020-12-15T11:44:00.000Z",
        "voteCount": 1,
        "content": "Correctimundo"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 193,
    "url": "https://www.examtopics.com/discussions/microsoft/view/8782-exam-70-761-topic-1-question-193-discussion/",
    "body": "DRAG DROP -<br>You are a database administrator for an online retail store. You create a table to track orders by running the following Transact-SQL statement:<br><img src=\"/assets/media/exam-media/02675/0040700001.png\" class=\"in-exam-image\"><br>You need to create a report that includes the following information:<br>\u2711 Total sales for each year<br>\u2711 Total sales for each category<br>\u2711 Total sales for each category per year<br>How should you complete the Transact-SQL statement? To answer, drag the appropriate Transact-SQL segment to the correct locations. Each Transact-SQL segment may be used once, more than once, or not at all. You may need to drag the split bar between panes or scroll to view content.<br>NOTE: Each correct selection is worth one point.<br>Select and Place:<br><img src=\"/assets/media/exam-media/02675/0040800001.jpg\" class=\"in-exam-image\"><br>",
    "options": [],
    "answer": "<img src=\"/assets/media/exam-media/02675/0040800002.jpg\" class=\"in-exam-image\">",
    "answerDescription": "Box 1: GROUP BY -<br><br>Box 2: CUBE -<br>GROUP BY CUBE creates groups for all possible combinations of columns. For GROUP BY CUBE (a, b) the results has groups for unique values of (a, b), (NULL, b), (a, NULL), and (NULL, NULL).<br>Example: This code runs a GROUP BY CUBE operation on Country and Region.<br>SELECT Country, Region, SUM(Sales) AS TotalSales<br><br>FROM Sales -<br>GROUP BY CUBE (Country, Region);<br>References:<br>https://docs.microsoft.com/en-us/sql/t-sql/queries/select-group-by-transact-sql",
    "votes": [],
    "comments": [
      {
        "date": "2020-02-03T03:42:00.000Z",
        "voteCount": 20,
        "content": "With ROLL UP returns\nGROUP BY (category_id, YEAR(OrderDate))\nGROUP BY (category_id)\nGROUP BY ()\n\nWhich means that there is no Total Sales for each year. Corect answer is GROUP BY CUBE."
      },
      {
        "date": "2020-02-12T20:33:00.000Z",
        "voteCount": 2,
        "content": "roll up does not return all possible result\nSo roll up is not suitable for this place"
      },
      {
        "date": "2020-04-15T09:31:00.000Z",
        "voteCount": 5,
        "content": "Correct!\n\nDROP TABLE IF EXISTS test\n\nCREATE TABLE test(\nOrderId INT NOT NULL,\nAmount MONEY NOT NULL,\nCategoryID INT NOT NULL,\nOrderDate Datetime NOT null\n)\nGO\n\nInsert INTO test (OrderId , Amount , CategoryID ,OrderDate )\nVALUES\n\t(1, 20.5, 1, GETDATE()),\n\t(1, 20.00, 3, DATEADD(MONTH,1,GETDATE())),\n\t(1, 50.5,2,DATEADD(MONTH,2,GETDATE())),\n\t(1, 70.5,1, DATEADD(MONTH,23,GETDATE())),\n\t(1, 20.00,2, DATEADD(MONTH,4,GETDATE())),\n\t(1, 25.5,2, DATEADD(MONTH,5,GETDATE())),\n\t(1, 30.5,1, DATEADD(MONTH,12,GETDATE()))\n\n\n\n\nSELECT  COALESCE(CONVERT(NVARCHAR(20),CategoryID),'YearTotal'), COALESCE(CONVERT(NVARCHAR(20),YEAR(OrderDate)),'CatTotal') AS Year,SUM(Amount) AS Value\nFROM dbo.test\nGROUP BY ROLLUP (CategoryID, YEAR(OrderDate) )\n\nSELECT COALESCE(CONVERT(NVARCHAR(20),CategoryID),'YearTotal'), COALESCE(CONVERT(NVARCHAR(20),YEAR(OrderDate)),'CatTotal') AS Year,SUM(Amount) AS Value\nFROM dbo.test\nGROUP BY cube (CategoryID, YEAR(OrderDate) )"
      },
      {
        "date": "2019-11-28T07:00:00.000Z",
        "voteCount": 2,
        "content": "Why ROLLUP?"
      },
      {
        "date": "2019-11-21T07:16:00.000Z",
        "voteCount": 2,
        "content": "I disagree, I think the right answer is ROLLUP"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 194,
    "url": "https://www.examtopics.com/discussions/microsoft/view/11768-exam-70-761-topic-1-question-194-discussion/",
    "body": "HOTSPOT -<br>You are creating a database solution to track sales achievements of your training courses. You run the following statements:<br><img src=\"/assets/media/exam-media/02675/0040900001.png\" class=\"in-exam-image\"><br>You plan to add courses to a table named HighlightedCourses. You must add courses that have been delivered to more than 100 participants only.<br>If the total number of participants for a course is lower than 100, the course must not be added to the HighlightedCourses table. In addition, an error message must be displayed and remaining Transact-SQL code must not run.<br>How should you complete the Transact-SQL statement? To answer, select the appropriate Transact-SQL segments in the answer area.<br>NOTE: Each correct selection is worth one point.<br>Hot Area:<br>",
    "options": [],
    "answer": "Explanation",
    "answerDescription": "Box 1: THROW -<br>TRHOW raises an exception and transfers execution to a CATCH block of a TRY...CATCH construct.<br>If a TRY...CATCH construct is not available, the statement batch is terminated. The line number and procedure where the exception is raised are set.<br>Box 2: IF (@TotalParticipants &lt; 100)<br>Incorrect Answers:<br>Not BREAK: BREAK exits the current WHILE loop. If the current WHILE loop is nested inside another, BREAK exits only the current loop, and control is given to the next statement in the outer loop.<br>Not RAISERROR: Microsoft recommends that THROW should be used instead of RAISERROR.<br>References:<br>https://docs.microsoft.com/en-us/sql/t-sql/language-elements/throw-transact-sql",
    "votes": [],
    "comments": [
      {
        "date": "2020-01-11T08:02:00.000Z",
        "voteCount": 8,
        "content": "Sorry, but I do not see any boxes to choose from :("
      },
      {
        "date": "2021-01-19T14:09:00.000Z",
        "voteCount": 1,
        "content": "something like this\n\t\tdeclare @participants int = 90\n\t\tbegin try\n\t\t\t\t\tbegin tran\n\t\t\t\t\tif @participants &gt;= 100\n\t\t\t\t\tprint 'Let s add some courses............'\n\t\t\t\t\tcommit tran\n\t\t\t\t\tif @participants &lt; 100\n\t\t\t\t\traiserror ('Go to catch block to display error',16,1)\n\t\t\tend try\n\t    begin catch\n\t\tprint 'Let s print the error message............';\n\t\t\tthrow 51000, 'No insert', 1\n\t\tend catch;"
      },
      {
        "date": "2020-12-09T04:50:00.000Z",
        "voteCount": 1,
        "content": "can we really use throw even though there is no \";\" after the PRINT @TotalParticipants"
      },
      {
        "date": "2020-05-31T18:13:00.000Z",
        "voteCount": 3,
        "content": "I found this Transact-SQL statement:\ndeclare @courseid int\ndeclare @totalparticipants int \nset @courseid = 1\nset @totalparticipants = (select sum(cp.numparticipants)\nfrom courses_189 c inner join courseparticipants cp \non c.courseid = cp.courseid\nwhere c.courseid = @courseid \ngroup by c.courseid)\nprint @totalparticipants\nCHOOSE P1 -   IF (@ROWCOUNT &gt; 100)\n                          IF (@totalparticipants &lt; 100)             \nCHOOSE P2 -   BREAK\n                          CONTINUE\n                          RAISERROR('Course is not admissible.',16,0)\n                          THROW 50000,'Course is not admissible.',0"
      },
      {
        "date": "2020-05-31T18:15:00.000Z",
        "voteCount": 2,
        "content": "I think P1 is IF (@TotalParticipants &lt; 100) but I am not sure for P2 It seems like Both RAISERROR and THROW fits well here. Any hint?"
      },
      {
        "date": "2020-05-31T18:22:00.000Z",
        "voteCount": 2,
        "content": "Well, Throw terminates the statement and fits better I think."
      },
      {
        "date": "2021-01-26T02:18:00.000Z",
        "voteCount": 1,
        "content": "@ROWCOUNT does not, because  you must refer to @@ROWCOUNT. It is THROW indeed, because nothing will run after THROW."
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 195,
    "url": "https://www.examtopics.com/discussions/microsoft/view/13664-exam-70-761-topic-1-question-195-discussion/",
    "body": "HOTSPOT -<br>A company creates marketing photographs of products for online retailers. Photographs and related information are stored in a database that has the following structure:<br><img src=\"/assets/media/exam-media/02675/0041100001.png\" class=\"in-exam-image\"><br>You must create a report that returns a list of all product photos, and whether the product has a primary photo.<br>How should you complete the Transact-SQL statement? To answer, select the appropriate Transact-SQL segments in the answer area.<br>NOTE: Each correct selection is worth one point.<br>Hot Area:<br>",
    "options": [],
    "answer": "Explanation",
    "answerDescription": "Box 1: LEFT JOIN -<br>We want a list of all product photos, and whether the product has a primary photo.<br><br>Box 2:  FULL OUTER JOIN -<br>The FULL OUTER JOIN keyword return all records when there is a match in either left (table1) or right (table2) table records.<br>Box 3: AND",
    "votes": [],
    "comments": [
      {
        "date": "2021-01-26T12:26:00.000Z",
        "voteCount": 1,
        "content": "answer in another exam says :\nproduct\nleft join\nproductproductphoto\non product.productid=productproductphoto.productid\nfull outer join\nproductphoto\non productproductphoto.productphotoid=productphoto.productphotoid"
      },
      {
        "date": "2021-01-20T01:25:00.000Z",
        "voteCount": 1,
        "content": "i saw an exam with the exhibit, but still this question is extremely vague. No idea what they want exactly."
      },
      {
        "date": "2020-12-22T11:56:00.000Z",
        "voteCount": 1,
        "content": "I believe  second one should also be  right join because ProductPhoto  table is in the right part of the query Since we need all rows ProductPhoto then RIGHT JOIN would be appropriate."
      },
      {
        "date": "2020-12-22T12:06:00.000Z",
        "voteCount": 1,
        "content": "Sorry, I agree : Right Join ... Left Join ."
      },
      {
        "date": "2020-12-22T11:51:00.000Z",
        "voteCount": 1,
        "content": "There is not  HOT AREA in the question . We cannot judge . Because I saw the hot area for the  question in another dumps . It has options for the presented code. FROM clause there looks like:  FROM Product /Option/  ProductProductPhoto  /Opton / ProudctPhoto"
      },
      {
        "date": "2020-11-29T23:58:00.000Z",
        "voteCount": 3,
        "content": "The Query is:\nSELECT\n   ProductPhoto.ProductPhotoID\n   ,Product.ProductID\n   ,ProductProductPhoto.IsPrimary\nFROM Product\n    Box 1 [LEFT JOIN; RIGHT JOIN; CROSS JOIN; FULL OUTER JOIN]\n   ProductPhoto\n   Box 2 [LEFT JOIN; RIGHT JOIN; CROSS JOIN; FULL OUTER JOIN]\n   ProductProductPhoto ON\nProductProductPhoto.ProductPhotoID = ProductPhoto.ProductPhotoID\nBox 3 [OR; AND; AND NOT]\nProductProductPhoto.ProductID=Product.ProductID\n\nIt says: \"You must create a report that returns a list of all product photos\"\nSo I beleive we need to bring all the rows for the table ProductPhoto, which I think would be RIGHT JOIN / LEFT JOIN / AND"
      },
      {
        "date": "2020-06-05T11:56:00.000Z",
        "voteCount": 3,
        "content": "There is no SQL statement :/"
      },
      {
        "date": "2020-04-25T03:34:00.000Z",
        "voteCount": 3,
        "content": "LEFT JOIN / LEFT JOIN ?"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 196,
    "url": "https://www.examtopics.com/discussions/microsoft/view/13665-exam-70-761-topic-1-question-196-discussion/",
    "body": "Note: This question is part of a series of questions that present the same scenario. Each question in the series contains a unique solution that might meet the stated goals. Some question sets might have more than one correct solution, while others might not have a correct solution.<br>After you answer a question in this section, you will NOT be able to return to it. As a result, these questions will not appear in the review screen.<br>You are building a stored procedure that will be used by hundreds of users concurrently.<br>You need to store rows that will be processed later by the stored procedure. The object that stores the rows must meet the following requirements:<br>\u2711 Be indexable<br>\u2711 Contain up-to-date statistics<br>\u2711 Be able to scale between 10 and 100,000 rows<br>The solution must prevent users from accessing one another's data.<br>Solution: You create a user-defined table in the stored procedure.<br>Does this meet the goal?<br>",
    "options": [
      "<span class=\"multi-choice-letter\" data-choice-letter=\"A\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tYes",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"B\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tB.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tNo"
    ],
    "answer": "B",
    "answerDescription": "",
    "votes": [],
    "comments": [
      {
        "date": "2020-12-20T20:06:00.000Z",
        "voteCount": 1,
        "content": "The answer is NO, because sql server doesn't maintian up-to-date statistics \non user-defined tables. Actually one of the drawbacks of User-defined tables\nis the fact that sql server doesn not maintain statistics on the TVP columns."
      },
      {
        "date": "2020-12-15T11:50:00.000Z",
        "voteCount": 1,
        "content": "Correctimundo"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 197,
    "url": "https://www.examtopics.com/discussions/microsoft/view/26475-exam-70-761-topic-1-question-197-discussion/",
    "body": "DRAG DROP -<br>You are a developing a solution to manage employee training records. You have the following Transact-SQL statement:<br><img src=\"/assets/media/exam-media/02675/0041300001.png\" class=\"in-exam-image\"><br>You need to create a stored procedure that returns the total number of participants for a specific course.<br>How should you complete the procedure? To answer, drag the appropriate Transact-SQL segments to the correct locations. Each Transact-SQL segment may be used once, more than once, or not at all. You may need to drag the split bar between panes or scroll to view content.<br>NOTE: Each correct selection is worth one point.<br>Select and Place:<br><img src=\"/assets/media/exam-media/02675/0041400001.jpg\" class=\"in-exam-image\"><br>",
    "options": [],
    "answer": "<img src=\"/assets/media/exam-media/02675/0041500001.jpg\" class=\"in-exam-image\">",
    "answerDescription": "",
    "votes": [],
    "comments": [
      {
        "date": "2020-07-23T03:04:00.000Z",
        "voteCount": 11,
        "content": "Solution is correct. Had it on exam and passed with 970 score."
      },
      {
        "date": "2021-01-07T14:59:00.000Z",
        "voteCount": 1,
        "content": "@totalParticipants should be the bigint, @courseId is declared as an int"
      },
      {
        "date": "2020-12-14T08:58:00.000Z",
        "voteCount": 2,
        "content": "Why would we be using big int here?"
      },
      {
        "date": "2021-01-03T16:33:00.000Z",
        "voteCount": 1,
        "content": "Nothing you can do about it. That's what it is declared as."
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 198,
    "url": "https://www.examtopics.com/discussions/microsoft/view/39944-exam-70-761-topic-1-question-198-discussion/",
    "body": "You run the following Transact-SQL statement:<br><img src=\"/assets/media/exam-media/02675/0041600001.png\" class=\"in-exam-image\"><br>You use the table to store data about training courses: when they finished the location, and the number of participants in the courses.<br>You need to display a result set that shows aggregates for all possible combinations of the number of participants.<br>Which Transact-SQL statement should you run?<br>",
    "options": [
      "<span class=\"multi-choice-letter\" data-choice-letter=\"A\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tSELECT CourseID, CourseDate, SUM(NumParticipants) FROM CourseParticipants GROUP BY CourseID, CourseDate",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"B\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tB.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tSELECT CourseID, CourseDate, SUM(DISTINCT NumParticipants) FROM CourseParticipants GROUP BY CourseID, CourseDate",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"C\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tC.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tSELECT CourseID, CourseDate, SUM(NumParticipants) FROM CourseParticipants GROUP BY CourseID, CourseDate WITH CUBE",
      "<span class=\"multi-choice-letter\" data-choice-letter=\"D\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tD.\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tSELECT CourseID, CourseDate, SUM(DISTINCT NumParticipants) FROM CourseParticipants GROUP BY CourseID, CourseDate WITH ROLLUP"
    ],
    "answer": "C",
    "answerDescription": "The WITH CUBE clause causes the query to compute all possible totals<br>References:<br>https://blogs.msdn.microsoft.com/craigfr/2007/09/27/aggregation-with-cube/",
    "votes": [],
    "comments": [
      {
        "date": "2020-12-15T11:51:00.000Z",
        "voteCount": 3,
        "content": "Correctimundo"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 199,
    "url": "https://www.examtopics.com/discussions/microsoft/view/3890-exam-70-761-topic-1-question-199-discussion/",
    "body": "Note: This question is part of a series of questions that use the same or similar answer choices. An answer choice may be correct for more than one question in the series. Each question is independent of the other questions in this series. Information and details provided in a question apply only to that question.<br>You have a database that contains tables named Customer_CRMSystem and Customer_HRSystem. Both tables use the following structure:<br><img src=\"/assets/media/exam-media/02675/0041700001.png\" class=\"in-exam-image\"><br>The tables include the data below:<br><br>Customer_CRMSystem -<br><img src=\"/assets/media/exam-media/02675/0041700002.png\" class=\"in-exam-image\"><br><br>Customer_HRSystem -<br><img src=\"/assets/media/exam-media/02675/0041800001.png\" class=\"in-exam-image\"><br>Records that contain null values for CustomerCode can be uniquely identified by CustomerName.<br>You need to display customers who appear in both tables and have a non-null CustomerCode.<br>Which Transact-SQL statement should you run?<br><img src=\"/assets/media/exam-media/02675/0041800002.png\" class=\"in-exam-image\"><br>A.<br><img src=\"/assets/media/exam-media/02675/0041800003.png\" class=\"in-exam-image\"><br>B.<br><img src=\"/assets/media/exam-media/02675/0041800004.png\" class=\"in-exam-image\"><br>C.<br><img src=\"/assets/media/exam-media/02675/0041900001.png\" class=\"in-exam-image\"><br>D.<br><img src=\"/assets/media/exam-media/02675/0041900002.png\" class=\"in-exam-image\"><br>E.<br><img src=\"/assets/media/exam-media/02675/0041900003.png\" class=\"in-exam-image\"><br>F.<br><img src=\"/assets/media/exam-media/02675/0041900004.png\" class=\"in-exam-image\"><br>G.<br><img src=\"/assets/media/exam-media/02675/0041900005.png\" class=\"in-exam-image\"><br>H.<br>",
    "options": [],
    "answer": "B",
    "answerDescription": "INTERSECT returns distinct rows that are output by both the left and right input queries operator.<br>Incorrect Answers:<br>A: INNER JOIN returns records that have matching values in both tables but it returns duplicate records.<br>C: LEFT OUTER JOIN returns ALL records from the left table, and the matched records from the right table.<br>D: EXCEPT returns distinct rows from the left input query that are not output by the right input query.<br>E, F: UNION and UNION ALL combines the results of two or more queries into a single result set that includes all the rows that belong to all queries in the union.<br>G: CROSS JOIN returns all possible combinations of data from both tables.<br>H: FULL OUTER JOIN returns all records when there is a match in either left or right table<br>Note: NULL values are treated as distinct values in join operations.<br>References:<br>https://docs.microsoft.com/en-us/sql/relational-databases/performance/joins?view=sql-server-2017 https://docs.microsoft.com/en-us/sql/t-sql/language-elements/set-operators-except-and-intersect-transact-sql?view=sql-server-2017 https://docs.microsoft.com/en-us/sql/t-sql/language-elements/set-operators-union-transact-sql?view=sql-server-2017 https://www.w3schools.com/sql/sql_join.asp",
    "votes": [],
    "comments": [
      {
        "date": "2019-08-21T07:52:00.000Z",
        "voteCount": 28,
        "content": "I dont think that this is correct. it needs to be inner join since with intersect there are also NULL values in the customercode included."
      },
      {
        "date": "2020-02-09T09:33:00.000Z",
        "voteCount": 22,
        "content": "CREATE TABLE #Customer_CRMSystem(\nCustomerID INT IDENTITY (1,1)\n, CustomerCode char(4)\n, CustomerName VARCHAR(150)\n);\nGO\n\nCREATE TABLE #Customer_HRSystem  (\nCustomerID INT IDENTITY (1,1)\n, CustomerCode char(4)\n, CustomerName VARCHAR(150)\n);\nGO\n\nINSERT INTO #Customer_CRMSystem(CustomerCode, CustomerName)\nVALUES \n  ('CUS1', 'Roya')\n, ('CUS9', 'Almudena')\n, ('CUS4', 'Jack')\n, (NULL, 'Jane')\n, (NULL, 'Francisco');\nGO\n\nINSERT INTO #Customer_HRSystem(CustomerCode, CustomerName)\nVALUES \n  ('CUS1', 'Roya')\n, ('CUS2', 'Jose')\n, ('CUS9', 'Almudena')\n, (NULL, 'Jane')\nGO\n\nSELECT C.CustomerCode,C.CustomerName,H.CustomerCode,H.CustomerName\nFROM #Customer_CRMSystem C INNER JOIN\n\t#Customer_HRSystem H ON C.CustomerCode = H.CustomerCode \n\tAND C.CustomerName=H.CustomerName\n\t;\n\nRESULT:\nCustomerCode\tCustomerName\tCustomerCode\tCustomerName\nCUS1\tRoya\tCUS1\tRoya\nCUS9\tAlmudena\tCUS9\tAlmudena\n\nSO, \"A\" IS A CORRECT ANSWER"
      },
      {
        "date": "2020-04-13T16:47:00.000Z",
        "voteCount": 2,
        "content": "Question is asking to display customers who appear in both tables and have a non-null CustomerCode, which we need to return\u2019Cus 1\u2019, \u2018Cus2\u2019, \u2018Cus 4\u2019, \u2018Cus 9\u2019 for the result set. Inner join Only gave \u2018Cus 1\u2019, \u2018Cus 4\u2019, \u2018Cus 9"
      },
      {
        "date": "2021-01-01T23:03:00.000Z",
        "voteCount": 1,
        "content": "A is not good - it drops Jane from the picture because JOINS on NULL (and to make it worse, using AND) don't work. INTERSECT does the job because it preserves Jane with the NULL code. Borrowed from FLASH:\nCREATE TABLE #Customer_CRMSystem(\nCustomerID INT IDENTITY (1,1)\n, CustomerCode char(4)\n, CustomerName VARCHAR(150)\n);\nGO\n\nCREATE TABLE #Customer_HRSystem (\nCustomerID INT IDENTITY (1,1)\n, CustomerCode char(4)\n, CustomerName VARCHAR(150)\n);\nGO\n\nINSERT INTO #Customer_CRMSystem(CustomerCode, CustomerName)\nVALUES\n('CUS1', 'Roya')\n, ('CUS9', 'Almudena')\n, ('CUS4', 'Jack')\n, (NULL, 'Jane')\n, (NULL, 'Francisco');\nGO\n\nINSERT INTO #Customer_HRSystem(CustomerCode, CustomerName)\nVALUES\n('CUS1', 'Roya')\n, ('CUS2', 'Jose')\n, ('CUS9', 'Almudena')\n, (NULL, 'Jane')\nGO\n\nSELECT C.CustomerCode,C.CustomerName\nFROM #Customer_CRMSystem C INTERSECT\nSELECT H.CustomerCode,H.CustomerName FROM #Customer_HRSystem H"
      },
      {
        "date": "2021-01-01T23:04:00.000Z",
        "voteCount": 1,
        "content": "NULL AND &lt;anything&gt; gives NULL"
      },
      {
        "date": "2021-01-13T10:26:00.000Z",
        "voteCount": 1,
        "content": "you just proved A is correct... the intersect also returns jane which is not what they want; it has a NULL as a customer code. The inner join evauluates NULL = NULL as false, hence jane doesn't make the cut, as required."
      },
      {
        "date": "2020-12-20T21:21:00.000Z",
        "voteCount": 1,
        "content": "A is good!"
      },
      {
        "date": "2020-07-10T04:20:00.000Z",
        "voteCount": 2,
        "content": "A) is correct...it will return matching custnames and custcodes only; if custcode is null it won't be included. that is the req"
      },
      {
        "date": "2020-05-18T06:37:00.000Z",
        "voteCount": 3,
        "content": "Agree with \"flashed\" A is the correct one."
      },
      {
        "date": "2020-03-12T23:30:00.000Z",
        "voteCount": 4,
        "content": "A is correct answer, definitely. Create tables and try every combination and you will see."
      },
      {
        "date": "2019-11-20T22:48:00.000Z",
        "voteCount": 5,
        "content": "None of the options will work for this question!!!!!!!!!!!"
      },
      {
        "date": "2019-12-22T12:04:00.000Z",
        "voteCount": 2,
        "content": "Indeed. B returns doesn't exlude null values, C returns empty table. \nA is better answer: join excludes nulls and values that don't match. But if 'customer name' field has null values but 'customer code' hasn't, it removes rows that haven't to be excluded"
      },
      {
        "date": "2020-01-23T02:52:00.000Z",
        "voteCount": 1,
        "content": "\"it removes rows that haven't to be excluded\" - could you please provide an example? As per the requirement the null values should be excluded."
      },
      {
        "date": "2020-02-28T08:53:00.000Z",
        "voteCount": 2,
        "content": "and  'customer name'  can't have null values as per the table definition in the requirement."
      },
      {
        "date": "2020-08-28T07:32:00.000Z",
        "voteCount": 1,
        "content": "i agree. there is no filter for null CustomerCode."
      },
      {
        "date": "2020-08-28T07:46:00.000Z",
        "voteCount": 1,
        "content": "ill correct myself, we cant join tables using NULL fields. so the INNER JOIN answer will really work. tested the answer of flashed."
      },
      {
        "date": "2019-10-17T18:00:00.000Z",
        "voteCount": 10,
        "content": "INNER JOIN WILL WORK.\nINTERSECT LEAVE RECORD WITH NULL."
      },
      {
        "date": "2019-09-27T11:03:00.000Z",
        "voteCount": 1,
        "content": "C is correct answer"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 200,
    "url": "https://www.examtopics.com/discussions/microsoft/view/3839-exam-70-761-topic-1-question-200-discussion/",
    "body": "HOTSPOT -<br>You are creating a training management application. You run the following Transact-SQL statement:<br><img src=\"/assets/media/exam-media/02675/0042000001.png\" class=\"in-exam-image\"><br>You must build a report that returns course identifiers and the average evaluation score for each course. The result set must include only one score for each employee for each course.<br>You need to create a query that returns the required data.<br>How should you complete the Transact-SQL statement? To answer, select the appropriate options in the answer area.<br>NOTE: Each correct selection is worth one point.<br>Hot Area:<br><img src=\"/assets/media/exam-media/02675/0042100001.png\" class=\"in-exam-image\"><br>",
    "options": [],
    "answer": "<img src=\"/assets/media/exam-media/02675/0042200001.png\" class=\"in-exam-image\">",
    "answerDescription": "",
    "votes": [],
    "comments": [
      {
        "date": "2019-11-03T20:14:00.000Z",
        "voteCount": 5,
        "content": "cant use distinct in group by clause"
      },
      {
        "date": "2021-01-26T03:52:00.000Z",
        "voteCount": 1,
        "content": "Asked: \"one score for each employee for each course.\"\nso the group by should be on employee and course. I only see course."
      },
      {
        "date": "2021-01-01T23:06:00.000Z",
        "voteCount": 1,
        "content": "This is a repeated question - better version earlier with all parameters mentioned"
      },
      {
        "date": "2020-10-01T10:56:00.000Z",
        "voteCount": 2,
        "content": "doe not mention employee at all"
      },
      {
        "date": "2020-10-03T19:28:00.000Z",
        "voteCount": 2,
        "content": "right, there is no option to fulfill the last request - The result set must include only one score for each employee for each course , so there are not enough options to build right query. AVG (distinct Eval) will remove duplicate evaluation even if two different people got same Eval for the same course, which is wrong."
      },
      {
        "date": "2020-06-05T08:50:00.000Z",
        "voteCount": 1,
        "content": "in order to fulfill one evaluation for customer, I think there should be included broup by employeeid also"
      },
      {
        "date": "2019-08-19T23:11:00.000Z",
        "voteCount": 1,
        "content": "Why not using AVG(DISTINCT(Eval) in order to fullfill the requirements (only one evaluation for each customer)?"
      },
      {
        "date": "2019-12-13T04:41:00.000Z",
        "voteCount": 8,
        "content": "Then the AVG will be for distinct values in the Eval column. I guess that is not what is asked in the question"
      },
      {
        "date": "2020-03-11T02:01:00.000Z",
        "voteCount": 3,
        "content": "I guess that's exactly what is asked for: don't include double entries in the average calculation and this clearly makes a difference. If you like to try it out:\n\n-- create table\nCREATE TABLE dbo.Evaluations (\n\tEvaluationID INT NOT NULL,\n\tEmployeeID INT NULL,\n\tCourseID INT NULL,\n\tEval INT NOT NULL\n);\n\n-- insert demo data\nINSERT INTO dbo.Evaluations (EvaluationID, EmployeeID, CourseID, Eval)\nVALUES\n(1, 5, 1, 13),\n(2, 10, 2, 77),\n(3, 10, 2, 77), -- dupe from preceding line \n(4, 12, 2, 28),\n(5, 13, 1, 51);\n\n-- results\nSELECT \n\tCourseID, \n\tAVG(DISTINCT Eval) AS AvgWithDistinct,\n\tAVG(Eval) AS AvgWithoutDistinct\nFROM Evaluations\nGROUP BY CourseID;\n\n-- clean up\nDROP TABLE dbo.Evaluations;\n\nOutput: \nCourseID AvgWithDistinct AvgWithoutDistinct\n1\t32\t32\n2\t52\t60\n\nSo \"AVG(DISTINCT Eval)\" is the right answer from my point of view."
      },
      {
        "date": "2020-05-21T10:01:00.000Z",
        "voteCount": 3,
        "content": "But this is assuming that duplicate employeeIDs will have the same eval score."
      },
      {
        "date": "2020-06-05T10:23:00.000Z",
        "voteCount": 1,
        "content": "What if one employees evaluate with same course more than once? This means that it is calculated  more than one score for one employee for one course"
      },
      {
        "date": "2020-06-05T10:23:00.000Z",
        "voteCount": 1,
        "content": "What if one employee evaluates same course more than once? This means that it is calculated more than one score for one employee for one course**"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  },
  {
    "topic": 1,
    "index": 201,
    "url": "https://www.examtopics.com/discussions/microsoft/view/7670-exam-70-761-topic-1-question-201-discussion/",
    "body": "You have a database named MyDb. You run the following Transact-SQL statements:<br><img src=\"/assets/media/exam-media/02675/0042300001.jpg\" class=\"in-exam-image\"><br>A value of 1 in the IsActive column indicates that a user is active.<br>You need to create a count for active users in each role. If a role has no active users, you must display a zero as the active users count.<br>Which Transact-SQL statement should you run?<br><img src=\"/assets/media/exam-media/02675/0042300002.png\" class=\"in-exam-image\"><br>A.<br><img src=\"/assets/media/exam-media/02675/0042300003.png\" class=\"in-exam-image\"><br>B.<br><img src=\"/assets/media/exam-media/02675/0042300004.jpg\" class=\"in-exam-image\"><br>C.<br><img src=\"/assets/media/exam-media/02675/0042300005.png\" class=\"in-exam-image\"><br>D.<br>",
    "options": [],
    "answer": "A",
    "answerDescription": "",
    "votes": [],
    "comments": [
      {
        "date": "2020-03-05T10:15:00.000Z",
        "voteCount": 2,
        "content": "A should be using a RIGHT JOIN as we want a list of all roles"
      },
      {
        "date": "2020-03-08T11:23:00.000Z",
        "voteCount": 3,
        "content": "Nope. tbl roles is on the left which will list all roles."
      },
      {
        "date": "2019-11-03T18:28:00.000Z",
        "voteCount": 1,
        "content": "should include isNull function to put zero when role name gives null"
      },
      {
        "date": "2020-02-09T09:59:00.000Z",
        "voteCount": 12,
        "content": "don't need the count goes to zero when it is null.\n\nCREATE TABLE #ROLES(\n\tROLEID INT IDENTITY(1,1) PRIMARY KEY,\n\tROLENAME VARCHAR(20)\n)\n\nCREATE TABLE #USERS(\n\tUSERID INT IDENTITY(1,1) PRIMARY KEY,\n\tUSERNAME VARCHAR(20),\n\tROLEID INT NULL FOREIGN KEY REFERENCES #ROLES(ROLEID),\n\tISACTIVE BIT NOT NULL DEFAULT(1)\n)\n\nINSERT INTO #ROLES\nVALUES\n('ADMIN'),('SERVER'),('MANAGER'),('USER')\n;\n\nINSERT INTO #USERS\nVALUES\n('HUGO',1,0),('NUNO',2,1),('PEDRO',3,1)\n;\n\nSELECT * FROM #ROLES\nSELECT * FROM #USERS\n\n\nSELECT R.ROLENAME, COUNT(U.USERID) AS ACTIVEUSERCOUNT\nFROM #ROLES R LEFT JOIN\n\t(SELECT U.USERID,U.ROLEID FROM #USERS U WHERE U.ISACTIVE=1) U\n\tON R.ROLEID = U.ROLEID\nGROUP BY R.ROLENAME\n;\nOUTPUT:\nROLENAME\tACTIVEUSERCOUNT\nADMIN\t0\nMANAGER\t1\nSERVER\t1\nUSER\t0"
      }
    ],
    "examNameCode": "70-761",
    "topicNumber": "1"
  }
]